<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 20 Model assumptions | Psych 710: Statistical Methods II</title>
  <meta name="description" content="Course notes for Psych 710." />
  <meta name="generator" content="bookdown 0.34 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 20 Model assumptions | Psych 710: Statistical Methods II" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Course notes for Psych 710." />
  <meta name="github-repo" content="SocialInteractionLab/psych710-notes" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 20 Model assumptions | Psych 710: Statistical Methods II" />
  
  <meta name="twitter:description" content="Course notes for Psych 710." />
  

<meta name="author" content="Robert Hawkins" />


<meta name="date" content="2024-01-11" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="appendix-b-data-wrangling.html"/>
<link rel="next" href="reporting-statistics.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<script src="libs/viz-1.8.2/viz.js"></script>
<link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="libs/grViz-binding-1.0.10/grViz.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.31/datatables.js"></script>
<link href="libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Psych 252</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#course-homepage"><i class="fa fa-check"></i>Course homepage</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#license-and-citation"><i class="fa fa-check"></i>License and citation</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="probability.html"><a href="probability.html"><i class="fa fa-check"></i><b>1</b> Probability</a>
<ul>
<li class="chapter" data-level="1.1" data-path="probability.html"><a href="probability.html#load-packages-load-data-set-theme"><i class="fa fa-check"></i><b>1.1</b> Load packages, load data, set theme</a></li>
<li class="chapter" data-level="1.2" data-path="probability.html"><a href="probability.html#learning-goals"><i class="fa fa-check"></i><b>1.2</b> Learning goals</a></li>
<li class="chapter" data-level="1.3" data-path="probability.html"><a href="probability.html#counting"><i class="fa fa-check"></i><b>1.3</b> Counting</a></li>
<li class="chapter" data-level="1.4" data-path="probability.html"><a href="probability.html#sampling"><i class="fa fa-check"></i><b>1.4</b> Sampling</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="probability.html"><a href="probability.html#drawing-rows-from-a-data-frame"><i class="fa fa-check"></i><b>1.4.1</b> Drawing rows from a data frame</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="probability.html"><a href="probability.html#more-complex-counting-matching"><i class="fa fa-check"></i><b>1.5</b> More complex counting / matching</a></li>
<li class="chapter" data-level="1.6" data-path="probability.html"><a href="probability.html#conditional-probability"><i class="fa fa-check"></i><b>1.6</b> Conditional probability</a></li>
<li class="chapter" data-level="1.7" data-path="probability.html"><a href="probability.html#law-of-total-probability"><i class="fa fa-check"></i><b>1.7</b> Law of total probability</a></li>
<li class="chapter" data-level="1.8" data-path="probability.html"><a href="probability.html#additional-resources"><i class="fa fa-check"></i><b>1.8</b> Additional resources</a>
<ul>
<li class="chapter" data-level="1.8.1" data-path="probability.html"><a href="probability.html#cheatsheets"><i class="fa fa-check"></i><b>1.8.1</b> Cheatsheets</a></li>
<li class="chapter" data-level="1.8.2" data-path="probability.html"><a href="probability.html#books-and-chapters"><i class="fa fa-check"></i><b>1.8.2</b> Books and chapters</a></li>
<li class="chapter" data-level="1.8.3" data-path="probability.html"><a href="probability.html#misc"><i class="fa fa-check"></i><b>1.8.3</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="1.9" data-path="probability.html"><a href="probability.html#session-info"><i class="fa fa-check"></i><b>1.9</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="estimation.html"><a href="estimation.html"><i class="fa fa-check"></i><b>2</b> Estimation</a>
<ul>
<li class="chapter" data-level="2.1" data-path="estimation.html"><a href="estimation.html#load-packages-and-set-plotting-theme"><i class="fa fa-check"></i><b>2.1</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="2.2" data-path="estimation.html"><a href="estimation.html#working-with-distributions"><i class="fa fa-check"></i><b>2.2</b> Working with distributions</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="estimation.html"><a href="estimation.html#plotting-distributions"><i class="fa fa-check"></i><b>2.2.1</b> Plotting distributions</a></li>
<li class="chapter" data-level="2.2.2" data-path="estimation.html"><a href="estimation.html#sampling-from-distributions"><i class="fa fa-check"></i><b>2.2.2</b> Sampling from distributions</a></li>
<li class="chapter" data-level="2.2.3" data-path="estimation.html"><a href="estimation.html#understanding-density"><i class="fa fa-check"></i><b>2.2.3</b> Understanding <code>density()</code></a></li>
<li class="chapter" data-level="2.2.4" data-path="estimation.html"><a href="estimation.html#cumulative-probability-distributions"><i class="fa fa-check"></i><b>2.2.4</b> Cumulative probability distributions</a></li>
<li class="chapter" data-level="2.2.5" data-path="estimation.html"><a href="estimation.html#inverse-cumulative-distribution"><i class="fa fa-check"></i><b>2.2.5</b> Inverse cumulative distribution</a></li>
<li class="chapter" data-level="2.2.6" data-path="estimation.html"><a href="estimation.html#computing-probabilities"><i class="fa fa-check"></i><b>2.2.6</b> Computing probabilities</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="estimation.html"><a href="estimation.html#estimating-a-coin"><i class="fa fa-check"></i><b>2.3</b> Estimating a coin</a></li>
<li class="chapter" data-level="2.4" data-path="estimation.html"><a href="estimation.html#bayesian-inference-with-the-normal-distribution"><i class="fa fa-check"></i><b>2.4</b> Bayesian inference with the normal distribution</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="estimation.html"><a href="estimation.html#analytic-solution"><i class="fa fa-check"></i><b>2.4.1</b> Analytic solution</a></li>
<li class="chapter" data-level="2.4.2" data-path="estimation.html"><a href="estimation.html#solution-via-sampling"><i class="fa fa-check"></i><b>2.4.2</b> Solution via sampling</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="estimation.html"><a href="estimation.html#additional-resources-1"><i class="fa fa-check"></i><b>2.5</b> Additional resources</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="estimation.html"><a href="estimation.html#datacamp"><i class="fa fa-check"></i><b>2.5.1</b> Datacamp</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="estimation.html"><a href="estimation.html#session-info-1"><i class="fa fa-check"></i><b>2.6</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="modeling-data.html"><a href="modeling-data.html"><i class="fa fa-check"></i><b>3</b> Modeling data</a>
<ul>
<li class="chapter" data-level="3.1" data-path="modeling-data.html"><a href="modeling-data.html#load-packages-and-set-plotting-theme-1"><i class="fa fa-check"></i><b>3.1</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="3.2" data-path="modeling-data.html"><a href="modeling-data.html#modeling-data-1"><i class="fa fa-check"></i><b>3.2</b> Modeling data</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="modeling-data.html"><a href="modeling-data.html#simplicity-vs.-accuracy-trade-off"><i class="fa fa-check"></i><b>3.2.1</b> Simplicity vs. accuracy trade-off</a></li>
<li class="chapter" data-level="3.2.2" data-path="modeling-data.html"><a href="modeling-data.html#sampling-distributions-for-median-and-mean"><i class="fa fa-check"></i><b>3.2.2</b> Sampling distributions for median and mean</a></li>
<li class="chapter" data-level="3.2.3" data-path="modeling-data.html"><a href="modeling-data.html#residuals-need-to-be-normally-distributed-not-the-data-itself"><i class="fa fa-check"></i><b>3.2.3</b> Residuals need to be normally distributed, not the data itself</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="modeling-data.html"><a href="modeling-data.html#hypothesis-testing-one-sample-t-test"><i class="fa fa-check"></i><b>3.3</b> Hypothesis testing: “One-sample t-test”</a></li>
<li class="chapter" data-level="3.4" data-path="modeling-data.html"><a href="modeling-data.html#building-a-sampling-distribution-of-pre"><i class="fa fa-check"></i><b>3.4</b> Building a sampling distribution of PRE</a></li>
<li class="chapter" data-level="3.5" data-path="modeling-data.html"><a href="modeling-data.html#misc-1"><i class="fa fa-check"></i><b>3.5</b> Misc</a></li>
<li class="chapter" data-level="3.6" data-path="modeling-data.html"><a href="modeling-data.html#additional-resources-2"><i class="fa fa-check"></i><b>3.6</b> Additional resources</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="modeling-data.html"><a href="modeling-data.html#reading"><i class="fa fa-check"></i><b>3.6.1</b> Reading</a></li>
<li class="chapter" data-level="3.6.2" data-path="modeling-data.html"><a href="modeling-data.html#datacamp-1"><i class="fa fa-check"></i><b>3.6.2</b> Datacamp</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="modeling-data.html"><a href="modeling-data.html#session-info-2"><i class="fa fa-check"></i><b>3.7</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="inference.html"><a href="inference.html"><i class="fa fa-check"></i><b>4</b> Inference</a>
<ul>
<li class="chapter" data-level="4.1" data-path="inference.html"><a href="inference.html#load-packages-and-set-plotting-theme-2"><i class="fa fa-check"></i><b>4.1</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="4.2" data-path="inference.html"><a href="inference.html#making-statistical-inferences-frequentist-style"><i class="fa fa-check"></i><b>4.2</b> Making statistical inferences (frequentist style)</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="inference.html"><a href="inference.html#population-distribution"><i class="fa fa-check"></i><b>4.2.1</b> Population distribution</a></li>
<li class="chapter" data-level="4.2.2" data-path="inference.html"><a href="inference.html#distribution-of-a-single-sample"><i class="fa fa-check"></i><b>4.2.2</b> Distribution of a single sample</a></li>
<li class="chapter" data-level="4.2.3" data-path="inference.html"><a href="inference.html#the-sampling-distribution"><i class="fa fa-check"></i><b>4.2.3</b> The sampling distribution</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="inference.html"><a href="inference.html#understanding-p-values"><i class="fa fa-check"></i><b>4.3</b> Understanding p-values</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="inference.html"><a href="inference.html#permutation-test"><i class="fa fa-check"></i><b>4.3.1</b> Permutation test</a></li>
<li class="chapter" data-level="4.3.2" data-path="inference.html"><a href="inference.html#t-test-by-hand"><i class="fa fa-check"></i><b>4.3.2</b> t-test by hand</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="inference.html"><a href="inference.html#confidence-intervals"><i class="fa fa-check"></i><b>4.4</b> Confidence intervals</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="inference.html"><a href="inference.html#mean_cl_boot-explained"><i class="fa fa-check"></i><b>4.4.1</b> <code>mean_cl_boot()</code> explained</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="inference.html"><a href="inference.html#additional-resources-3"><i class="fa fa-check"></i><b>4.5</b> Additional resources</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="inference.html"><a href="inference.html#misc-2"><i class="fa fa-check"></i><b>4.5.1</b> Misc</a></li>
<li class="chapter" data-level="4.5.2" data-path="inference.html"><a href="inference.html#datacamp-2"><i class="fa fa-check"></i><b>4.5.2</b> Datacamp</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="inference.html"><a href="inference.html#session-info-3"><i class="fa fa-check"></i><b>4.6</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="linear-regression.html"><a href="linear-regression.html"><i class="fa fa-check"></i><b>5</b> Linear regression</a>
<ul>
<li class="chapter" data-level="5.1" data-path="linear-regression.html"><a href="linear-regression.html#learning-goals-1"><i class="fa fa-check"></i><b>5.1</b> Learning goals</a></li>
<li class="chapter" data-level="5.2" data-path="linear-regression.html"><a href="linear-regression.html#load-packages-and-set-plotting-theme-3"><i class="fa fa-check"></i><b>5.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="5.3" data-path="linear-regression.html"><a href="linear-regression.html#load-data-sets"><i class="fa fa-check"></i><b>5.3</b> Load data sets</a></li>
<li class="chapter" data-level="5.4" data-path="linear-regression.html"><a href="linear-regression.html#multiple-continuous-variables"><i class="fa fa-check"></i><b>5.4</b> Multiple continuous variables</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="linear-regression.html"><a href="linear-regression.html#explore-correlations"><i class="fa fa-check"></i><b>5.4.1</b> Explore correlations</a></li>
<li class="chapter" data-level="5.4.2" data-path="linear-regression.html"><a href="linear-regression.html#multipe-regression"><i class="fa fa-check"></i><b>5.4.2</b> Multipe regression</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="linear-regression.html"><a href="linear-regression.html#one-categorical-variable"><i class="fa fa-check"></i><b>5.5</b> One categorical variable</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="linear-regression.html"><a href="linear-regression.html#visualization-of-the-model-predictions"><i class="fa fa-check"></i><b>5.5.1</b> Visualization of the model predictions</a></li>
<li class="chapter" data-level="5.5.2" data-path="linear-regression.html"><a href="linear-regression.html#dummy-coding"><i class="fa fa-check"></i><b>5.5.2</b> Dummy coding</a></li>
<li class="chapter" data-level="5.5.3" data-path="linear-regression.html"><a href="linear-regression.html#reporting-the-results"><i class="fa fa-check"></i><b>5.5.3</b> Reporting the results</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="linear-regression.html"><a href="linear-regression.html#one-continuous-and-one-categorical-variable"><i class="fa fa-check"></i><b>5.6</b> One continuous and one categorical variable</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="linear-regression.html"><a href="linear-regression.html#visualization-of-the-model-predictions-1"><i class="fa fa-check"></i><b>5.6.1</b> Visualization of the model predictions</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="linear-regression.html"><a href="linear-regression.html#interactions"><i class="fa fa-check"></i><b>5.7</b> Interactions</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="linear-regression.html"><a href="linear-regression.html#visualization-1"><i class="fa fa-check"></i><b>5.7.1</b> Visualization</a></li>
<li class="chapter" data-level="5.7.2" data-path="linear-regression.html"><a href="linear-regression.html#hypothesis-test"><i class="fa fa-check"></i><b>5.7.2</b> Hypothesis test</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="linear-regression.html"><a href="linear-regression.html#additional-resources-4"><i class="fa fa-check"></i><b>5.8</b> Additional resources</a>
<ul>
<li class="chapter" data-level="5.8.1" data-path="linear-regression.html"><a href="linear-regression.html#datacamp-3"><i class="fa fa-check"></i><b>5.8.1</b> Datacamp</a></li>
<li class="chapter" data-level="5.8.2" data-path="linear-regression.html"><a href="linear-regression.html#misc-3"><i class="fa fa-check"></i><b>5.8.2</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="5.9" data-path="linear-regression.html"><a href="linear-regression.html#session-info-4"><i class="fa fa-check"></i><b>5.9</b> Session info</a></li>
<li class="chapter" data-level="5.10" data-path="linear-regression.html"><a href="linear-regression.html#references"><i class="fa fa-check"></i><b>5.10</b> References</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="power.html"><a href="power.html"><i class="fa fa-check"></i><b>6</b> Power</a>
<ul>
<li class="chapter" data-level="6.1" data-path="power.html"><a href="power.html#learning-goals-2"><i class="fa fa-check"></i><b>6.1</b> Learning goals</a></li>
<li class="chapter" data-level="6.2" data-path="power.html"><a href="power.html#load-packages-and-set-plotting-theme-4"><i class="fa fa-check"></i><b>6.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="6.3" data-path="power.html"><a href="power.html#load-data-sets-1"><i class="fa fa-check"></i><b>6.3</b> Load data sets</a></li>
<li class="chapter" data-level="6.4" data-path="power.html"><a href="power.html#decision-making"><i class="fa fa-check"></i><b>6.4</b> Decision-making</a></li>
<li class="chapter" data-level="6.5" data-path="power.html"><a href="power.html#effect-sizes"><i class="fa fa-check"></i><b>6.5</b> Effect sizes</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="power.html"><a href="power.html#cohens-d"><i class="fa fa-check"></i><b>6.5.1</b> Cohen’s d</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="power.html"><a href="power.html#determining-sample-size"><i class="fa fa-check"></i><b>6.6</b> Determining sample size</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="power.html"><a href="power.html#pwr-package"><i class="fa fa-check"></i><b>6.6.1</b> <code>pwr</code> package</a></li>
<li class="chapter" data-level="6.6.2" data-path="power.html"><a href="power.html#power-analysis"><i class="fa fa-check"></i><b>6.6.2</b> Power analysis</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="power.html"><a href="power.html#additional-resources-5"><i class="fa fa-check"></i><b>6.7</b> Additional resources</a>
<ul>
<li class="chapter" data-level="6.7.1" data-path="power.html"><a href="power.html#datacamp-4"><i class="fa fa-check"></i><b>6.7.1</b> Datacamp</a></li>
<li class="chapter" data-level="6.7.2" data-path="power.html"><a href="power.html#cheatsheets-1"><i class="fa fa-check"></i><b>6.7.2</b> Cheatsheets</a></li>
<li class="chapter" data-level="6.7.3" data-path="power.html"><a href="power.html#misc-4"><i class="fa fa-check"></i><b>6.7.3</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="6.8" data-path="power.html"><a href="power.html#session-info-5"><i class="fa fa-check"></i><b>6.8</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html"><i class="fa fa-check"></i><b>7</b> Linear mixed effects models 1</a>
<ul>
<li class="chapter" data-level="7.1" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html#learning-goals-3"><i class="fa fa-check"></i><b>7.1</b> Learning goals</a></li>
<li class="chapter" data-level="7.2" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html#load-packages-and-set-plotting-theme-5"><i class="fa fa-check"></i><b>7.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="7.3" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html#dependence"><i class="fa fa-check"></i><b>7.3</b> Dependence</a></li>
<li class="chapter" data-level="7.4" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html#additional-resources-6"><i class="fa fa-check"></i><b>7.4</b> Additional resources</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html#readings"><i class="fa fa-check"></i><b>7.4.1</b> Readings</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html#session-info-6"><i class="fa fa-check"></i><b>7.5</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html"><i class="fa fa-check"></i><b>8</b> Linear mixed effects models 2</a>
<ul>
<li class="chapter" data-level="8.1" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#learning-goals-4"><i class="fa fa-check"></i><b>8.1</b> Learning goals</a></li>
<li class="chapter" data-level="8.2" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#load-packages-and-set-plotting-theme-6"><i class="fa fa-check"></i><b>8.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="8.3" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#a-worked-example"><i class="fa fa-check"></i><b>8.3</b> A worked example</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#complete-pooling"><i class="fa fa-check"></i><b>8.3.1</b> Complete pooling</a></li>
<li class="chapter" data-level="8.3.2" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#no-pooling"><i class="fa fa-check"></i><b>8.3.2</b> No pooling</a></li>
<li class="chapter" data-level="8.3.3" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#partial-pooling"><i class="fa fa-check"></i><b>8.3.3</b> Partial pooling</a></li>
<li class="chapter" data-level="8.3.4" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#compare-results"><i class="fa fa-check"></i><b>8.3.4</b> Compare results</a></li>
<li class="chapter" data-level="8.3.5" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#getting-p-values"><i class="fa fa-check"></i><b>8.3.5</b> Getting p-values</a></li>
<li class="chapter" data-level="8.3.6" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#reporting-results"><i class="fa fa-check"></i><b>8.3.6</b> Reporting results</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#simulating-a-linear-mixed-effects-model"><i class="fa fa-check"></i><b>8.4</b> Simulating a linear mixed effects model</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#the-effect-of-outliers"><i class="fa fa-check"></i><b>8.4.1</b> The effect of outliers</a></li>
<li class="chapter" data-level="8.4.2" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#different-slopes"><i class="fa fa-check"></i><b>8.4.2</b> Different slopes</a></li>
<li class="chapter" data-level="8.4.3" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#simpsons-paradox"><i class="fa fa-check"></i><b>8.4.3</b> Simpson’s paradox</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#additional-resources-7"><i class="fa fa-check"></i><b>8.5</b> Additional resources</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#readings-1"><i class="fa fa-check"></i><b>8.5.1</b> Readings</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#session-info-7"><i class="fa fa-check"></i><b>8.6</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html"><i class="fa fa-check"></i><b>9</b> Linear mixed effects models 3</a>
<ul>
<li class="chapter" data-level="9.1" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#learning-goals-5"><i class="fa fa-check"></i><b>9.1</b> Learning goals</a></li>
<li class="chapter" data-level="9.2" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#load-packages-and-set-plotting-theme-7"><i class="fa fa-check"></i><b>9.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="9.3" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#load-data-sets-2"><i class="fa fa-check"></i><b>9.3</b> Load data sets</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#sleep-data"><i class="fa fa-check"></i><b>9.3.1</b> Sleep data</a></li>
<li class="chapter" data-level="9.3.2" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#reasoning-data"><i class="fa fa-check"></i><b>9.3.2</b> Reasoning data</a></li>
<li class="chapter" data-level="9.3.3" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#weight-loss-data"><i class="fa fa-check"></i><b>9.3.3</b> Weight loss data</a></li>
<li class="chapter" data-level="9.3.4" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#politness-data"><i class="fa fa-check"></i><b>9.3.4</b> Politness data</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#understanding-the-lmer-syntax"><i class="fa fa-check"></i><b>9.4</b> Understanding the lmer() syntax</a></li>
<li class="chapter" data-level="9.5" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#anova-vs.-lmer"><i class="fa fa-check"></i><b>9.5</b> ANOVA vs. Lmer</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#between-subjects-anova"><i class="fa fa-check"></i><b>9.5.1</b> Between subjects ANOVA</a></li>
<li class="chapter" data-level="9.5.2" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#repeated-measures-anova"><i class="fa fa-check"></i><b>9.5.2</b> Repeated-measures ANOVA</a></li>
<li class="chapter" data-level="9.5.3" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#mixed-anova"><i class="fa fa-check"></i><b>9.5.3</b> Mixed ANOVA</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#session-info-8"><i class="fa fa-check"></i><b>9.6</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html"><i class="fa fa-check"></i><b>10</b> Linear mixed effects models 4</a>
<ul>
<li class="chapter" data-level="10.1" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#learning-goals-6"><i class="fa fa-check"></i><b>10.1</b> Learning goals</a></li>
<li class="chapter" data-level="10.2" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#load-packages-and-set-plotting-theme-8"><i class="fa fa-check"></i><b>10.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="10.3" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#load-data-sets-3"><i class="fa fa-check"></i><b>10.3</b> Load data sets</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#sleep-data-1"><i class="fa fa-check"></i><b>10.3.1</b> Sleep data</a></li>
<li class="chapter" data-level="10.3.2" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#reasoning-data-1"><i class="fa fa-check"></i><b>10.3.2</b> Reasoning data</a></li>
<li class="chapter" data-level="10.3.3" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#weight-loss-data-1"><i class="fa fa-check"></i><b>10.3.3</b> Weight loss data</a></li>
<li class="chapter" data-level="10.3.4" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#politness-data-1"><i class="fa fa-check"></i><b>10.3.4</b> Politness data</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#follow-up-tests-with-emmeans"><i class="fa fa-check"></i><b>10.4</b> Follow-up tests with emmeans</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#sleep-study"><i class="fa fa-check"></i><b>10.4.1</b> Sleep study</a></li>
<li class="chapter" data-level="10.4.2" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#weight-loss-study"><i class="fa fa-check"></i><b>10.4.2</b> Weight loss study</a></li>
<li class="chapter" data-level="10.4.3" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#politeness-study"><i class="fa fa-check"></i><b>10.4.3</b> Politeness study</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#mixtures-of-participants"><i class="fa fa-check"></i><b>10.5</b> Mixtures of participants</a></li>
<li class="chapter" data-level="10.6" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#bootstrapping"><i class="fa fa-check"></i><b>10.6</b> Bootstrapping</a>
<ul>
<li class="chapter" data-level="10.6.1" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#linear-model"><i class="fa fa-check"></i><b>10.6.1</b> Linear model</a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#session-info-9"><i class="fa fa-check"></i><b>10.7</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="contrasts.html"><a href="contrasts.html"><i class="fa fa-check"></i><b>11</b> Contrasts</a>
<ul>
<li class="chapter" data-level="11.1" data-path="contrasts.html"><a href="contrasts.html#learning-goals-7"><i class="fa fa-check"></i><b>11.1</b> Learning goals</a></li>
<li class="chapter" data-level="11.2" data-path="contrasts.html"><a href="contrasts.html#load-packages-and-set-plotting-theme-9"><i class="fa fa-check"></i><b>11.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="11.3" data-path="contrasts.html"><a href="contrasts.html#load-data-sets-4"><i class="fa fa-check"></i><b>11.3</b> Load data sets</a></li>
<li class="chapter" data-level="11.4" data-path="contrasts.html"><a href="contrasts.html#one-way-anova"><i class="fa fa-check"></i><b>11.4</b> One-way ANOVA</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="contrasts.html"><a href="contrasts.html#visualization-2"><i class="fa fa-check"></i><b>11.4.1</b> Visualization</a></li>
<li class="chapter" data-level="11.4.2" data-path="contrasts.html"><a href="contrasts.html#model-fitting"><i class="fa fa-check"></i><b>11.4.2</b> Model fitting</a></li>
<li class="chapter" data-level="11.4.3" data-path="contrasts.html"><a href="contrasts.html#hypothesis-test-1"><i class="fa fa-check"></i><b>11.4.3</b> Hypothesis test</a></li>
<li class="chapter" data-level="11.4.4" data-path="contrasts.html"><a href="contrasts.html#visualize-the-models-predictions"><i class="fa fa-check"></i><b>11.4.4</b> Visualize the model’s predictions</a></li>
<li class="chapter" data-level="11.4.5" data-path="contrasts.html"><a href="contrasts.html#dummy-coding-1"><i class="fa fa-check"></i><b>11.4.5</b> Dummy coding</a></li>
<li class="chapter" data-level="11.4.6" data-path="contrasts.html"><a href="contrasts.html#follow-up-questions"><i class="fa fa-check"></i><b>11.4.6</b> Follow up questions</a></li>
<li class="chapter" data-level="11.4.7" data-path="contrasts.html"><a href="contrasts.html#variance-decomposition"><i class="fa fa-check"></i><b>11.4.7</b> Variance decomposition</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="contrasts.html"><a href="contrasts.html#two-way-anova"><i class="fa fa-check"></i><b>11.5</b> Two-way ANOVA</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="contrasts.html"><a href="contrasts.html#visualization-3"><i class="fa fa-check"></i><b>11.5.1</b> Visualization</a></li>
<li class="chapter" data-level="11.5.2" data-path="contrasts.html"><a href="contrasts.html#model-fitting-1"><i class="fa fa-check"></i><b>11.5.2</b> Model fitting</a></li>
<li class="chapter" data-level="11.5.3" data-path="contrasts.html"><a href="contrasts.html#interpreting-interactions"><i class="fa fa-check"></i><b>11.5.3</b> Interpreting interactions</a></li>
<li class="chapter" data-level="11.5.4" data-path="contrasts.html"><a href="contrasts.html#variance-decomposition-1"><i class="fa fa-check"></i><b>11.5.4</b> Variance decomposition</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="contrasts.html"><a href="contrasts.html#two-way-anova-with-interaction"><i class="fa fa-check"></i><b>11.6</b> Two-way ANOVA (with interaction)</a></li>
<li class="chapter" data-level="11.7" data-path="contrasts.html"><a href="contrasts.html#anova-with-unbalanced-design"><i class="fa fa-check"></i><b>11.7</b> ANOVA with unbalanced design</a></li>
<li class="chapter" data-level="11.8" data-path="contrasts.html"><a href="contrasts.html#interpreting-parameters-very-important"><i class="fa fa-check"></i><b>11.8</b> Interpreting parameters (very important!)</a></li>
<li class="chapter" data-level="11.9" data-path="contrasts.html"><a href="contrasts.html#linear-contrasts"><i class="fa fa-check"></i><b>11.9</b> Linear contrasts</a>
<ul>
<li class="chapter" data-level="11.9.1" data-path="contrasts.html"><a href="contrasts.html#hypothetical-data"><i class="fa fa-check"></i><b>11.9.1</b> Hypothetical data</a></li>
<li class="chapter" data-level="11.9.2" data-path="contrasts.html"><a href="contrasts.html#visualization-4"><i class="fa fa-check"></i><b>11.9.2</b> Visualization</a></li>
<li class="chapter" data-level="11.9.3" data-path="contrasts.html"><a href="contrasts.html#orthogonal-contrasts"><i class="fa fa-check"></i><b>11.9.3</b> Orthogonal contrasts</a></li>
<li class="chapter" data-level="11.9.4" data-path="contrasts.html"><a href="contrasts.html#post-hoc-tests"><i class="fa fa-check"></i><b>11.9.4</b> Post-hoc tests</a></li>
<li class="chapter" data-level="11.9.5" data-path="contrasts.html"><a href="contrasts.html#understanding-dummy-coding"><i class="fa fa-check"></i><b>11.9.5</b> Understanding dummy coding</a></li>
<li class="chapter" data-level="11.9.6" data-path="contrasts.html"><a href="contrasts.html#understanding-sum-coding"><i class="fa fa-check"></i><b>11.9.6</b> Understanding sum coding</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html"><i class="fa fa-check"></i><b>12</b> Generalized linear model</a>
<ul>
<li class="chapter" data-level="12.1" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#learning-goals-8"><i class="fa fa-check"></i><b>12.1</b> Learning goals</a></li>
<li class="chapter" data-level="12.2" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#load-packages-and-set-plotting-theme-10"><i class="fa fa-check"></i><b>12.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="12.3" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#load-data-set"><i class="fa fa-check"></i><b>12.3</b> Load data set</a></li>
<li class="chapter" data-level="12.4" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#logistic-regression"><i class="fa fa-check"></i><b>12.4</b> Logistic regression</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#interpreting-the-parameters"><i class="fa fa-check"></i><b>12.4.1</b> Interpreting the parameters</a></li>
<li class="chapter" data-level="12.4.2" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#binary-predictor"><i class="fa fa-check"></i><b>12.4.2</b> Binary predictor</a></li>
<li class="chapter" data-level="12.4.3" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#continuous-predictor"><i class="fa fa-check"></i><b>12.4.3</b> Continuous predictor</a></li>
<li class="chapter" data-level="12.4.4" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#several-predictors"><i class="fa fa-check"></i><b>12.4.4</b> Several predictors</a></li>
<li class="chapter" data-level="12.4.5" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#using-the-ggeffects-package"><i class="fa fa-check"></i><b>12.4.5</b> Using the “ggeffects” package</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#simulate-a-logistic-regression"><i class="fa fa-check"></i><b>12.5</b> Simulate a logistic regression</a>
<ul>
<li class="chapter" data-level="12.5.1" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#calculate-the-models-likelihood"><i class="fa fa-check"></i><b>12.5.1</b> Calculate the model’s likelihood</a></li>
</ul></li>
<li class="chapter" data-level="12.6" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#testing-hypotheses"><i class="fa fa-check"></i><b>12.6</b> Testing hypotheses</a></li>
<li class="chapter" data-level="12.7" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#logistic-mixed-effects-model"><i class="fa fa-check"></i><b>12.7</b> Logistic mixed effects model</a></li>
<li class="chapter" data-level="12.8" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#additional-information"><i class="fa fa-check"></i><b>12.8</b> Additional information</a>
<ul>
<li class="chapter" data-level="12.8.1" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#misc-5"><i class="fa fa-check"></i><b>12.8.1</b> Misc</a></li>
<li class="chapter" data-level="12.8.2" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#datacamp-5"><i class="fa fa-check"></i><b>12.8.2</b> Datacamp</a></li>
</ul></li>
<li class="chapter" data-level="12.9" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#session-info-10"><i class="fa fa-check"></i><b>12.9</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="model-comparison.html"><a href="model-comparison.html"><i class="fa fa-check"></i><b>13</b> Model comparison</a>
<ul>
<li class="chapter" data-level="13.1" data-path="model-comparison.html"><a href="model-comparison.html#learning-goals-9"><i class="fa fa-check"></i><b>13.1</b> Learning goals</a></li>
<li class="chapter" data-level="13.2" data-path="model-comparison.html"><a href="model-comparison.html#load-packages-and-set-plotting-theme-11"><i class="fa fa-check"></i><b>13.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="13.3" data-path="model-comparison.html"><a href="model-comparison.html#model-comparison-1"><i class="fa fa-check"></i><b>13.3</b> Model comparison</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="model-comparison.html"><a href="model-comparison.html#fitting-vs.-predicting"><i class="fa fa-check"></i><b>13.3.1</b> Fitting vs. predicting</a></li>
<li class="chapter" data-level="13.3.2" data-path="model-comparison.html"><a href="model-comparison.html#f-test"><i class="fa fa-check"></i><b>13.3.2</b> F-test</a></li>
<li class="chapter" data-level="13.3.3" data-path="model-comparison.html"><a href="model-comparison.html#cross-validation"><i class="fa fa-check"></i><b>13.3.3</b> Cross-validation</a></li>
<li class="chapter" data-level="13.3.4" data-path="model-comparison.html"><a href="model-comparison.html#bootstrap"><i class="fa fa-check"></i><b>13.3.4</b> Bootstrap</a></li>
<li class="chapter" data-level="13.3.5" data-path="model-comparison.html"><a href="model-comparison.html#aic-and-bic"><i class="fa fa-check"></i><b>13.3.5</b> AIC and BIC</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="model-comparison.html"><a href="model-comparison.html#additional-resources-8"><i class="fa fa-check"></i><b>13.4</b> Additional resources</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="model-comparison.html"><a href="model-comparison.html#datacamp-course"><i class="fa fa-check"></i><b>13.4.1</b> Datacamp course</a></li>
<li class="chapter" data-level="13.4.2" data-path="model-comparison.html"><a href="model-comparison.html#reading-1"><i class="fa fa-check"></i><b>13.4.2</b> Reading</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="model-comparison.html"><a href="model-comparison.html#session-info-11"><i class="fa fa-check"></i><b>13.5</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="bayesian-data-analysis-1.html"><a href="bayesian-data-analysis-1.html"><i class="fa fa-check"></i><b>14</b> Bayesian data analysis 1</a>
<ul>
<li class="chapter" data-level="14.1" data-path="bayesian-data-analysis-1.html"><a href="bayesian-data-analysis-1.html#learning-goals-10"><i class="fa fa-check"></i><b>14.1</b> Learning goals</a></li>
<li class="chapter" data-level="14.2" data-path="bayesian-data-analysis-1.html"><a href="bayesian-data-analysis-1.html#load-packages-and-set-plotting-theme-12"><i class="fa fa-check"></i><b>14.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="14.3" data-path="bayesian-data-analysis-1.html"><a href="bayesian-data-analysis-1.html#doing-bayesian-inference-by-hand"><i class="fa fa-check"></i><b>14.3</b> Doing Bayesian inference “by hand”</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="bayesian-data-analysis-1.html"><a href="bayesian-data-analysis-1.html#sequential-updating-based-on-the-beta-distribution"><i class="fa fa-check"></i><b>14.3.1</b> Sequential updating based on the Beta distribution</a></li>
<li class="chapter" data-level="14.3.2" data-path="bayesian-data-analysis-1.html"><a href="bayesian-data-analysis-1.html#coin-flip-example"><i class="fa fa-check"></i><b>14.3.2</b> Coin flip example</a></li>
<li class="chapter" data-level="14.3.3" data-path="bayesian-data-analysis-1.html"><a href="bayesian-data-analysis-1.html#bayesian-inference-by-discretization"><i class="fa fa-check"></i><b>14.3.3</b> Bayesian inference by discretization</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="bayesian-data-analysis-1.html"><a href="bayesian-data-analysis-1.html#doing-bayesian-inference-with-greta"><i class="fa fa-check"></i><b>14.4</b> Doing Bayesian inference with Greta</a>
<ul>
<li class="chapter" data-level="14.4.1" data-path="bayesian-data-analysis-1.html"><a href="bayesian-data-analysis-1.html#attitude-data-set"><i class="fa fa-check"></i><b>14.4.1</b> Attitude data set</a></li>
<li class="chapter" data-level="14.4.2" data-path="bayesian-data-analysis-1.html"><a href="bayesian-data-analysis-1.html#frequentist-analysis"><i class="fa fa-check"></i><b>14.4.2</b> Frequentist analysis</a></li>
<li class="chapter" data-level="14.4.3" data-path="bayesian-data-analysis-1.html"><a href="bayesian-data-analysis-1.html#bayesian-regression"><i class="fa fa-check"></i><b>14.4.3</b> Bayesian regression</a></li>
</ul></li>
<li class="chapter" data-level="14.5" data-path="bayesian-data-analysis-1.html"><a href="bayesian-data-analysis-1.html#additional-resources-9"><i class="fa fa-check"></i><b>14.5</b> Additional resources</a>
<ul>
<li class="chapter" data-level="14.5.1" data-path="bayesian-data-analysis-1.html"><a href="bayesian-data-analysis-1.html#books-and-chapters-1"><i class="fa fa-check"></i><b>14.5.1</b> Books and chapters</a></li>
</ul></li>
<li class="chapter" data-level="14.6" data-path="bayesian-data-analysis-1.html"><a href="bayesian-data-analysis-1.html#session-info-12"><i class="fa fa-check"></i><b>14.6</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html"><i class="fa fa-check"></i><b>15</b> Bayesian data analysis 2</a>
<ul>
<li class="chapter" data-level="15.1" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#learning-goals-11"><i class="fa fa-check"></i><b>15.1</b> Learning goals</a></li>
<li class="chapter" data-level="15.2" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#load-packages-and-set-plotting-theme-13"><i class="fa fa-check"></i><b>15.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="15.3" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#load-data-sets-5"><i class="fa fa-check"></i><b>15.3</b> Load data sets</a></li>
<li class="chapter" data-level="15.4" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#poker"><i class="fa fa-check"></i><b>15.4</b> Poker</a>
<ul>
<li class="chapter" data-level="15.4.1" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#visualize-the-data"><i class="fa fa-check"></i><b>15.4.1</b> 1. Visualize the data</a></li>
<li class="chapter" data-level="15.4.2" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#specify-and-fit-the-model"><i class="fa fa-check"></i><b>15.4.2</b> 2. Specify and fit the model</a></li>
<li class="chapter" data-level="15.4.3" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#model-evaluation"><i class="fa fa-check"></i><b>15.4.3</b> 3. Model evaluation</a></li>
<li class="chapter" data-level="15.4.4" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#interpret-the-model-parameters"><i class="fa fa-check"></i><b>15.4.4</b> 4. Interpret the model parameters</a></li>
<li class="chapter" data-level="15.4.5" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#test-specific-hypotheses"><i class="fa fa-check"></i><b>15.4.5</b> 5. Test specific hypotheses</a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#sleep-study-1"><i class="fa fa-check"></i><b>15.5</b> Sleep study</a>
<ul>
<li class="chapter" data-level="15.5.1" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#visualize-the-data-1"><i class="fa fa-check"></i><b>15.5.1</b> 1. Visualize the data</a></li>
<li class="chapter" data-level="15.5.2" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#specify-and-fit-the-model-1"><i class="fa fa-check"></i><b>15.5.2</b> 2. Specify and fit the model</a></li>
<li class="chapter" data-level="15.5.3" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#model-evaluation-1"><i class="fa fa-check"></i><b>15.5.3</b> 3. Model evaluation</a></li>
<li class="chapter" data-level="15.5.4" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#interpret-the-parameters"><i class="fa fa-check"></i><b>15.5.4</b> 4. Interpret the parameters</a></li>
<li class="chapter" data-level="15.5.5" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#test-specific-hypotheses-1"><i class="fa fa-check"></i><b>15.5.5</b> 5. Test specific hypotheses</a></li>
<li class="chapter" data-level="15.5.6" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#report-results"><i class="fa fa-check"></i><b>15.5.6</b> 6. Report results</a></li>
</ul></li>
<li class="chapter" data-level="15.6" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#titanic-study"><i class="fa fa-check"></i><b>15.6</b> Titanic study</a>
<ul>
<li class="chapter" data-level="15.6.1" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#visualize-the-data-2"><i class="fa fa-check"></i><b>15.6.1</b> 1. Visualize the data</a></li>
<li class="chapter" data-level="15.6.2" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#specify-and-fit-the-model-2"><i class="fa fa-check"></i><b>15.6.2</b> 2. Specify and fit the model</a></li>
<li class="chapter" data-level="15.6.3" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#model-evaluation-2"><i class="fa fa-check"></i><b>15.6.3</b> 3. Model evaluation</a></li>
<li class="chapter" data-level="15.6.4" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#interpret-the-parameters-1"><i class="fa fa-check"></i><b>15.6.4</b> 4. Interpret the parameters</a></li>
<li class="chapter" data-level="15.6.5" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#test-specific-hypotheses-2"><i class="fa fa-check"></i><b>15.6.5</b> 5. Test specific hypotheses</a></li>
<li class="chapter" data-level="15.6.6" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#report-results-1"><i class="fa fa-check"></i><b>15.6.6</b> 6. Report results</a></li>
</ul></li>
<li class="chapter" data-level="15.7" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#politeness-data"><i class="fa fa-check"></i><b>15.7</b> Politeness data</a>
<ul>
<li class="chapter" data-level="15.7.1" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#visualize-the-data-3"><i class="fa fa-check"></i><b>15.7.1</b> 1. Visualize the data</a></li>
<li class="chapter" data-level="15.7.2" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#specify-and-fit-the-model-3"><i class="fa fa-check"></i><b>15.7.2</b> 2. Specify and fit the model</a></li>
<li class="chapter" data-level="15.7.3" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#test-specific-hypotheses-3"><i class="fa fa-check"></i><b>15.7.3</b> 5. Test specific hypotheses</a></li>
</ul></li>
<li class="chapter" data-level="15.8" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#additional-resources-10"><i class="fa fa-check"></i><b>15.8</b> Additional resources</a></li>
<li class="chapter" data-level="15.9" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#session-info-13"><i class="fa fa-check"></i><b>15.9</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html"><i class="fa fa-check"></i><b>16</b> Bayesian data analysis 3</a>
<ul>
<li class="chapter" data-level="16.1" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#learning-goals-12"><i class="fa fa-check"></i><b>16.1</b> Learning goals</a></li>
<li class="chapter" data-level="16.2" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#load-packages-and-set-plotting-theme-14"><i class="fa fa-check"></i><b>16.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="16.3" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#evidence-for-the-null-hypothesis"><i class="fa fa-check"></i><b>16.3</b> Evidence for the null hypothesis</a>
<ul>
<li class="chapter" data-level="16.3.1" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#bayes-factor-1"><i class="fa fa-check"></i><b>16.3.1</b> Bayes factor</a></li>
<li class="chapter" data-level="16.3.2" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#loo"><i class="fa fa-check"></i><b>16.3.2</b> LOO</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#dealing-with-heteroscedasticity"><i class="fa fa-check"></i><b>16.4</b> Dealing with heteroscedasticity</a>
<ul>
<li class="chapter" data-level="16.4.1" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#visualize-the-data-4"><i class="fa fa-check"></i><b>16.4.1</b> Visualize the data</a></li>
<li class="chapter" data-level="16.4.2" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#frequentist-analysis-4"><i class="fa fa-check"></i><b>16.4.2</b> Frequentist analysis</a></li>
<li class="chapter" data-level="16.4.3" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#bayesian-analysis-3"><i class="fa fa-check"></i><b>16.4.3</b> Bayesian analysis</a></li>
</ul></li>
<li class="chapter" data-level="16.5" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#zero-one-inflated-beta-binomial-model"><i class="fa fa-check"></i><b>16.5</b> Zero-one inflated beta binomial model</a></li>
<li class="chapter" data-level="16.6" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#ordinal-regression"><i class="fa fa-check"></i><b>16.6</b> Ordinal regression</a>
<ul>
<li class="chapter" data-level="16.6.1" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#ordinal-regression-assuming-equal-variance"><i class="fa fa-check"></i><b>16.6.1</b> Ordinal regression (assuming equal variance)</a></li>
<li class="chapter" data-level="16.6.2" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#gaussian-regression-assuming-equal-variance"><i class="fa fa-check"></i><b>16.6.2</b> Gaussian regression (assuming equal variance)</a></li>
<li class="chapter" data-level="16.6.3" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#oridnal-regression-unequal-variance"><i class="fa fa-check"></i><b>16.6.3</b> Oridnal regression (unequal variance)</a></li>
<li class="chapter" data-level="16.6.4" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#gaussian-regression-unequal-variance"><i class="fa fa-check"></i><b>16.6.4</b> Gaussian regression (unequal variance)</a></li>
<li class="chapter" data-level="16.6.5" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#model-comparison-2"><i class="fa fa-check"></i><b>16.6.5</b> Model comparison</a></li>
</ul></li>
<li class="chapter" data-level="16.7" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#additional-resources-11"><i class="fa fa-check"></i><b>16.7</b> Additional resources</a></li>
<li class="chapter" data-level="16.8" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#session-info-14"><i class="fa fa-check"></i><b>16.8</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="appendix-a-visualization.html"><a href="appendix-a-visualization.html"><i class="fa fa-check"></i><b>17</b> Appendix A: Visualization</a>
<ul>
<li class="chapter" data-level="17.1" data-path="appendix-a-visualization.html"><a href="appendix-a-visualization.html#learning-goals-13"><i class="fa fa-check"></i><b>17.1</b> Learning goals</a></li>
<li class="chapter" data-level="17.2" data-path="appendix-a-visualization.html"><a href="appendix-a-visualization.html#load-packages"><i class="fa fa-check"></i><b>17.2</b> Load packages</a></li>
<li class="chapter" data-level="17.3" data-path="appendix-a-visualization.html"><a href="appendix-a-visualization.html#why-visualize-data"><i class="fa fa-check"></i><b>17.3</b> Why visualize data?</a></li>
<li class="chapter" data-level="17.4" data-path="appendix-a-visualization.html"><a href="appendix-a-visualization.html#some-basics"><i class="fa fa-check"></i><b>17.4</b> Some basics</a>
<ul>
<li class="chapter" data-level="17.4.1" data-path="appendix-a-visualization.html"><a href="appendix-a-visualization.html#setting-up-rstudio"><i class="fa fa-check"></i><b>17.4.1</b> Setting up RStudio</a></li>
<li class="chapter" data-level="17.4.2" data-path="appendix-a-visualization.html"><a href="appendix-a-visualization.html#getting-help"><i class="fa fa-check"></i><b>17.4.2</b> Getting help</a></li>
<li class="chapter" data-level="17.4.3" data-path="appendix-a-visualization.html"><a href="appendix-a-visualization.html#r-markdown-infos"><i class="fa fa-check"></i><b>17.4.3</b> R Markdown infos</a></li>
<li class="chapter" data-level="17.4.4" data-path="appendix-a-visualization.html"><a href="appendix-a-visualization.html#helpful-keyboard-shortcuts"><i class="fa fa-check"></i><b>17.4.4</b> Helpful keyboard shortcuts</a></li>
</ul></li>
<li class="chapter" data-level="17.5" data-path="appendix-a-visualization.html"><a href="appendix-a-visualization.html#data-visualization"><i class="fa fa-check"></i><b>17.5</b> Data visualization</a>
<ul>
<li class="chapter" data-level="17.5.1" data-path="appendix-a-visualization.html"><a href="appendix-a-visualization.html#setting-up-a-plot"><i class="fa fa-check"></i><b>17.5.1</b> Setting up a plot</a></li>
<li class="chapter" data-level="17.5.2" data-path="appendix-a-visualization.html"><a href="appendix-a-visualization.html#bar-plot"><i class="fa fa-check"></i><b>17.5.2</b> Bar plot</a></li>
<li class="chapter" data-level="17.5.3" data-path="appendix-a-visualization.html"><a href="appendix-a-visualization.html#setting-the-default-plot-theme"><i class="fa fa-check"></i><b>17.5.3</b> Setting the default plot theme</a></li>
<li class="chapter" data-level="17.5.4" data-path="appendix-a-visualization.html"><a href="appendix-a-visualization.html#scatter-plot"><i class="fa fa-check"></i><b>17.5.4</b> Scatter plot</a></li>
<li class="chapter" data-level="17.5.5" data-path="appendix-a-visualization.html"><a href="appendix-a-visualization.html#line-plot"><i class="fa fa-check"></i><b>17.5.5</b> Line plot</a></li>
<li class="chapter" data-level="17.5.6" data-path="appendix-a-visualization.html"><a href="appendix-a-visualization.html#adding-error-bars"><i class="fa fa-check"></i><b>17.5.6</b> Adding error bars</a></li>
<li class="chapter" data-level="17.5.7" data-path="appendix-a-visualization.html"><a href="appendix-a-visualization.html#order-matters"><i class="fa fa-check"></i><b>17.5.7</b> Order matters</a></li>
<li class="chapter" data-level="17.5.8" data-path="appendix-a-visualization.html"><a href="appendix-a-visualization.html#grouping-data"><i class="fa fa-check"></i><b>17.5.8</b> Grouping data</a></li>
<li class="chapter" data-level="17.5.9" data-path="appendix-a-visualization.html"><a href="appendix-a-visualization.html#making-facets"><i class="fa fa-check"></i><b>17.5.9</b> Making facets</a></li>
<li class="chapter" data-level="17.5.10" data-path="appendix-a-visualization.html"><a href="appendix-a-visualization.html#global-local-and-setting-aes"><i class="fa fa-check"></i><b>17.5.10</b> Global, local, and setting <code>aes()</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="18" data-path="visualization-2-1.html"><a href="visualization-2-1.html"><i class="fa fa-check"></i><b>18</b> Visualization 2</a>
<ul>
<li class="chapter" data-level="18.1" data-path="visualization-2-1.html"><a href="visualization-2-1.html#learning-objectives"><i class="fa fa-check"></i><b>18.1</b> Learning objectives</a></li>
<li class="chapter" data-level="18.2" data-path="visualization-2-1.html"><a href="visualization-2-1.html#install-and-load-packages-load-data-set-theme"><i class="fa fa-check"></i><b>18.2</b> Install and load packages, load data, set theme</a></li>
<li class="chapter" data-level="18.3" data-path="visualization-2-1.html"><a href="visualization-2-1.html#overview-of-different-plot-types-for-different-things"><i class="fa fa-check"></i><b>18.3</b> Overview of different plot types for different things</a>
<ul>
<li class="chapter" data-level="18.3.1" data-path="visualization-2-1.html"><a href="visualization-2-1.html#proportions"><i class="fa fa-check"></i><b>18.3.1</b> Proportions</a></li>
<li class="chapter" data-level="18.3.2" data-path="visualization-2-1.html"><a href="visualization-2-1.html#comparisons"><i class="fa fa-check"></i><b>18.3.2</b> Comparisons</a></li>
<li class="chapter" data-level="18.3.3" data-path="visualization-2-1.html"><a href="visualization-2-1.html#relationships"><i class="fa fa-check"></i><b>18.3.3</b> Relationships</a></li>
<li class="chapter" data-level="18.3.4" data-path="visualization-2-1.html"><a href="visualization-2-1.html#temporal-data"><i class="fa fa-check"></i><b>18.3.4</b> Temporal data</a></li>
</ul></li>
<li class="chapter" data-level="18.4" data-path="visualization-2-1.html"><a href="visualization-2-1.html#customizing-plots"><i class="fa fa-check"></i><b>18.4</b> Customizing plots</a>
<ul>
<li class="chapter" data-level="18.4.1" data-path="visualization-2-1.html"><a href="visualization-2-1.html#anatomy-of-a-ggplot"><i class="fa fa-check"></i><b>18.4.1</b> Anatomy of a <code>ggplot</code></a></li>
<li class="chapter" data-level="18.4.2" data-path="visualization-2-1.html"><a href="visualization-2-1.html#changing-the-order-of-things"><i class="fa fa-check"></i><b>18.4.2</b> Changing the order of things</a></li>
<li class="chapter" data-level="18.4.3" data-path="visualization-2-1.html"><a href="visualization-2-1.html#dealing-with-legends"><i class="fa fa-check"></i><b>18.4.3</b> Dealing with legends</a></li>
<li class="chapter" data-level="18.4.4" data-path="visualization-2-1.html"><a href="visualization-2-1.html#choosing-good-colors"><i class="fa fa-check"></i><b>18.4.4</b> Choosing good colors</a></li>
<li class="chapter" data-level="18.4.5" data-path="visualization-2-1.html"><a href="visualization-2-1.html#customizing-themes"><i class="fa fa-check"></i><b>18.4.5</b> Customizing themes</a></li>
</ul></li>
<li class="chapter" data-level="18.5" data-path="visualization-2-1.html"><a href="visualization-2-1.html#saving-plots"><i class="fa fa-check"></i><b>18.5</b> Saving plots</a></li>
<li class="chapter" data-level="18.6" data-path="visualization-2-1.html"><a href="visualization-2-1.html#creating-figure-panels"><i class="fa fa-check"></i><b>18.6</b> Creating figure panels</a></li>
<li class="chapter" data-level="18.7" data-path="visualization-2-1.html"><a href="visualization-2-1.html#peeking-behind-the-scenes"><i class="fa fa-check"></i><b>18.7</b> Peeking behind the scenes</a></li>
<li class="chapter" data-level="18.8" data-path="visualization-2-1.html"><a href="visualization-2-1.html#making-animations"><i class="fa fa-check"></i><b>18.8</b> Making animations</a></li>
<li class="chapter" data-level="18.9" data-path="visualization-2-1.html"><a href="visualization-2-1.html#shiny-apps"><i class="fa fa-check"></i><b>18.9</b> Shiny apps</a></li>
<li class="chapter" data-level="18.10" data-path="visualization-2-1.html"><a href="visualization-2-1.html#defining-snippets"><i class="fa fa-check"></i><b>18.10</b> Defining snippets</a></li>
<li class="chapter" data-level="18.11" data-path="visualization-2-1.html"><a href="visualization-2-1.html#additional-resources-12"><i class="fa fa-check"></i><b>18.11</b> Additional resources</a>
<ul>
<li class="chapter" data-level="18.11.1" data-path="visualization-2-1.html"><a href="visualization-2-1.html#cheatsheets-2"><i class="fa fa-check"></i><b>18.11.1</b> Cheatsheets</a></li>
<li class="chapter" data-level="18.11.2" data-path="visualization-2-1.html"><a href="visualization-2-1.html#datacamp-courses"><i class="fa fa-check"></i><b>18.11.2</b> Datacamp courses</a></li>
<li class="chapter" data-level="18.11.3" data-path="visualization-2-1.html"><a href="visualization-2-1.html#books-and-chapters-2"><i class="fa fa-check"></i><b>18.11.3</b> Books and chapters</a></li>
<li class="chapter" data-level="18.11.4" data-path="visualization-2-1.html"><a href="visualization-2-1.html#misc-6"><i class="fa fa-check"></i><b>18.11.4</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="18.12" data-path="visualization-2-1.html"><a href="visualization-2-1.html#session-info-15"><i class="fa fa-check"></i><b>18.12</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="appendix-b-data-wrangling.html"><a href="appendix-b-data-wrangling.html"><i class="fa fa-check"></i><b>19</b> Appendix B: Data wrangling</a>
<ul>
<li class="chapter" data-level="19.1" data-path="appendix-b-data-wrangling.html"><a href="appendix-b-data-wrangling.html#learning-goals-14"><i class="fa fa-check"></i><b>19.1</b> Learning goals</a></li>
<li class="chapter" data-level="19.2" data-path="appendix-b-data-wrangling.html"><a href="appendix-b-data-wrangling.html#load-packages-1"><i class="fa fa-check"></i><b>19.2</b> Load packages</a></li>
<li class="chapter" data-level="19.3" data-path="appendix-b-data-wrangling.html"><a href="appendix-b-data-wrangling.html#some-r-basics"><i class="fa fa-check"></i><b>19.3</b> Some R basics</a>
<ul>
<li class="chapter" data-level="19.3.1" data-path="appendix-b-data-wrangling.html"><a href="appendix-b-data-wrangling.html#modes"><i class="fa fa-check"></i><b>19.3.1</b> Modes</a></li>
<li class="chapter" data-level="19.3.2" data-path="appendix-b-data-wrangling.html"><a href="appendix-b-data-wrangling.html#data-types"><i class="fa fa-check"></i><b>19.3.2</b> Data types</a></li>
<li class="chapter" data-level="19.3.3" data-path="appendix-b-data-wrangling.html"><a href="appendix-b-data-wrangling.html#operators"><i class="fa fa-check"></i><b>19.3.3</b> Operators</a></li>
<li class="chapter" data-level="19.3.4" data-path="appendix-b-data-wrangling.html"><a href="appendix-b-data-wrangling.html#control-flow"><i class="fa fa-check"></i><b>19.3.4</b> Control flow</a></li>
<li class="chapter" data-level="19.3.5" data-path="appendix-b-data-wrangling.html"><a href="appendix-b-data-wrangling.html#functions"><i class="fa fa-check"></i><b>19.3.5</b> Functions</a></li>
<li class="chapter" data-level="19.3.6" data-path="appendix-b-data-wrangling.html"><a href="appendix-b-data-wrangling.html#the-pipe-operator"><i class="fa fa-check"></i><b>19.3.6</b> The pipe operator <code>%&gt;%</code></a></li>
</ul></li>
<li class="chapter" data-level="19.4" data-path="appendix-b-data-wrangling.html"><a href="appendix-b-data-wrangling.html#a-quick-note-on-naming-things"><i class="fa fa-check"></i><b>19.4</b> A quick note on naming things</a></li>
<li class="chapter" data-level="19.5" data-path="appendix-b-data-wrangling.html"><a href="appendix-b-data-wrangling.html#looking-at-data"><i class="fa fa-check"></i><b>19.5</b> Looking at data</a>
<ul>
<li class="chapter" data-level="19.5.1" data-path="appendix-b-data-wrangling.html"><a href="appendix-b-data-wrangling.html#head"><i class="fa fa-check"></i><b>19.5.1</b> <code>head()</code></a></li>
<li class="chapter" data-level="19.5.2" data-path="appendix-b-data-wrangling.html"><a href="appendix-b-data-wrangling.html#glimpse"><i class="fa fa-check"></i><b>19.5.2</b> <code>glimpse()</code></a></li>
<li class="chapter" data-level="19.5.3" data-path="appendix-b-data-wrangling.html"><a href="appendix-b-data-wrangling.html#distinct"><i class="fa fa-check"></i><b>19.5.3</b> <code>distinct()</code></a></li>
<li class="chapter" data-level="19.5.4" data-path="appendix-b-data-wrangling.html"><a href="appendix-b-data-wrangling.html#count"><i class="fa fa-check"></i><b>19.5.4</b> <code>count()</code></a></li>
<li class="chapter" data-level="19.5.5" data-path="appendix-b-data-wrangling.html"><a href="appendix-b-data-wrangling.html#datatable"><i class="fa fa-check"></i><b>19.5.5</b> <code>datatable()</code></a></li>
<li class="chapter" data-level="19.5.6" data-path="appendix-b-data-wrangling.html"><a href="appendix-b-data-wrangling.html#other-tools-for-taking-a-quick-look-at-data"><i class="fa fa-check"></i><b>19.5.6</b> Other tools for taking a quick look at data</a></li>
</ul></li>
<li class="chapter" data-level="19.6" data-path="appendix-b-data-wrangling.html"><a href="appendix-b-data-wrangling.html#wrangling-data"><i class="fa fa-check"></i><b>19.6</b> Wrangling data</a>
<ul>
<li class="chapter" data-level="19.6.1" data-path="appendix-b-data-wrangling.html"><a href="appendix-b-data-wrangling.html#filter"><i class="fa fa-check"></i><b>19.6.1</b> <code>filter()</code></a></li>
<li class="chapter" data-level="19.6.2" data-path="appendix-b-data-wrangling.html"><a href="appendix-b-data-wrangling.html#arrange"><i class="fa fa-check"></i><b>19.6.2</b> <code>arrange()</code></a></li>
<li class="chapter" data-level="19.6.3" data-path="appendix-b-data-wrangling.html"><a href="appendix-b-data-wrangling.html#rename"><i class="fa fa-check"></i><b>19.6.3</b> <code>rename()</code></a></li>
<li class="chapter" data-level="19.6.4" data-path="appendix-b-data-wrangling.html"><a href="appendix-b-data-wrangling.html#relocate"><i class="fa fa-check"></i><b>19.6.4</b> <code>relocate()</code></a></li>
<li class="chapter" data-level="19.6.5" data-path="appendix-b-data-wrangling.html"><a href="appendix-b-data-wrangling.html#select"><i class="fa fa-check"></i><b>19.6.5</b> <code>select()</code></a></li>
<li class="chapter" data-level="19.6.6" data-path="appendix-b-data-wrangling.html"><a href="appendix-b-data-wrangling.html#practice-2"><i class="fa fa-check"></i><b>19.6.6</b> Practice 2</a></li>
<li class="chapter" data-level="19.6.7" data-path="appendix-b-data-wrangling.html"><a href="appendix-b-data-wrangling.html#mutate"><i class="fa fa-check"></i><b>19.6.7</b> <code>mutate()</code></a></li>
<li class="chapter" data-level="19.6.8" data-path="appendix-b-data-wrangling.html"><a href="appendix-b-data-wrangling.html#practice-3"><i class="fa fa-check"></i><b>19.6.8</b> Practice 3</a></li>
<li class="chapter" data-level="19.6.9" data-path="appendix-b-data-wrangling.html"><a href="appendix-b-data-wrangling.html#summarizing-data"><i class="fa fa-check"></i><b>19.6.9</b> Summarizing data</a></li>
<li class="chapter" data-level="19.6.10" data-path="appendix-b-data-wrangling.html"><a href="appendix-b-data-wrangling.html#reshaping-data"><i class="fa fa-check"></i><b>19.6.10</b> Reshaping data</a></li>
<li class="chapter" data-level="19.6.11" data-path="appendix-b-data-wrangling.html"><a href="appendix-b-data-wrangling.html#joining-multiple-data-frames"><i class="fa fa-check"></i><b>19.6.11</b> Joining multiple data frames</a></li>
<li class="chapter" data-level="19.6.12" data-path="appendix-b-data-wrangling.html"><a href="appendix-b-data-wrangling.html#dealing-with-missing-data"><i class="fa fa-check"></i><b>19.6.12</b> Dealing with missing data</a></li>
</ul></li>
<li class="chapter" data-level="19.7" data-path="appendix-b-data-wrangling.html"><a href="appendix-b-data-wrangling.html#reading-in-data"><i class="fa fa-check"></i><b>19.7</b> Reading in data</a>
<ul>
<li class="chapter" data-level="19.7.1" data-path="appendix-b-data-wrangling.html"><a href="appendix-b-data-wrangling.html#csv"><i class="fa fa-check"></i><b>19.7.1</b> csv</a></li>
<li class="chapter" data-level="19.7.2" data-path="appendix-b-data-wrangling.html"><a href="appendix-b-data-wrangling.html#rdata"><i class="fa fa-check"></i><b>19.7.2</b> RData</a></li>
</ul></li>
<li class="chapter" data-level="19.8" data-path="appendix-b-data-wrangling.html"><a href="appendix-b-data-wrangling.html#saving-data"><i class="fa fa-check"></i><b>19.8</b> Saving data</a>
<ul>
<li class="chapter" data-level="19.8.1" data-path="appendix-b-data-wrangling.html"><a href="appendix-b-data-wrangling.html#csv-1"><i class="fa fa-check"></i><b>19.8.1</b> csv</a></li>
<li class="chapter" data-level="19.8.2" data-path="appendix-b-data-wrangling.html"><a href="appendix-b-data-wrangling.html#rdata-1"><i class="fa fa-check"></i><b>19.8.2</b> RData</a></li>
</ul></li>
<li class="chapter" data-level="19.9" data-path="appendix-b-data-wrangling.html"><a href="appendix-b-data-wrangling.html#additional-resources-13"><i class="fa fa-check"></i><b>19.9</b> Additional resources</a>
<ul>
<li class="chapter" data-level="19.9.1" data-path="appendix-b-data-wrangling.html"><a href="appendix-b-data-wrangling.html#cheatsheets-3"><i class="fa fa-check"></i><b>19.9.1</b> Cheatsheets</a></li>
<li class="chapter" data-level="19.9.2" data-path="appendix-b-data-wrangling.html"><a href="appendix-b-data-wrangling.html#data-camp-courses"><i class="fa fa-check"></i><b>19.9.2</b> Data camp courses</a></li>
<li class="chapter" data-level="19.9.3" data-path="appendix-b-data-wrangling.html"><a href="appendix-b-data-wrangling.html#books-and-chapters-3"><i class="fa fa-check"></i><b>19.9.3</b> Books and chapters</a></li>
</ul></li>
<li class="chapter" data-level="19.10" data-path="appendix-b-data-wrangling.html"><a href="appendix-b-data-wrangling.html#session-info-16"><i class="fa fa-check"></i><b>19.10</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="model-assumptions.html"><a href="model-assumptions.html"><i class="fa fa-check"></i><b>20</b> Model assumptions</a>
<ul>
<li class="chapter" data-level="20.1" data-path="model-assumptions.html"><a href="model-assumptions.html#learning-goals-15"><i class="fa fa-check"></i><b>20.1</b> Learning goals</a></li>
<li class="chapter" data-level="20.2" data-path="model-assumptions.html"><a href="model-assumptions.html#load-packages-and-set-plotting-theme-15"><i class="fa fa-check"></i><b>20.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="20.3" data-path="model-assumptions.html"><a href="model-assumptions.html#model-assumptions-and-what-to-do-if-they-are-violated"><i class="fa fa-check"></i><b>20.3</b> Model assumptions and what to do if they are violated</a>
<ul>
<li class="chapter" data-level="20.3.1" data-path="model-assumptions.html"><a href="model-assumptions.html#influential-data-points"><i class="fa fa-check"></i><b>20.3.1</b> Influential data points</a></li>
<li class="chapter" data-level="20.3.2" data-path="model-assumptions.html"><a href="model-assumptions.html#linear-and-additive"><i class="fa fa-check"></i><b>20.3.2</b> Linear and additive</a></li>
<li class="chapter" data-level="20.3.3" data-path="model-assumptions.html"><a href="model-assumptions.html#normally-distributed-residuals"><i class="fa fa-check"></i><b>20.3.3</b> Normally distributed residuals</a></li>
<li class="chapter" data-level="20.3.4" data-path="model-assumptions.html"><a href="model-assumptions.html#non-parametric-tests"><i class="fa fa-check"></i><b>20.3.4</b> Non-parametric tests</a></li>
<li class="chapter" data-level="20.3.5" data-path="model-assumptions.html"><a href="model-assumptions.html#bootstrapping-regressions"><i class="fa fa-check"></i><b>20.3.5</b> Bootstrapping regressions</a></li>
</ul></li>
<li class="chapter" data-level="20.4" data-path="model-assumptions.html"><a href="model-assumptions.html#additional-resources-14"><i class="fa fa-check"></i><b>20.4</b> Additional resources</a></li>
<li class="chapter" data-level="20.5" data-path="model-assumptions.html"><a href="model-assumptions.html#session-info-17"><i class="fa fa-check"></i><b>20.5</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="reporting-statistics.html"><a href="reporting-statistics.html"><i class="fa fa-check"></i><b>21</b> Reporting statistics</a>
<ul>
<li class="chapter" data-level="21.1" data-path="reporting-statistics.html"><a href="reporting-statistics.html#general-advice"><i class="fa fa-check"></i><b>21.1</b> General advice</a>
<ul>
<li class="chapter" data-level="21.1.1" data-path="reporting-statistics.html"><a href="reporting-statistics.html#make-good-figures"><i class="fa fa-check"></i><b>21.1.1</b> Make good figures!</a></li>
<li class="chapter" data-level="21.1.2" data-path="reporting-statistics.html"><a href="reporting-statistics.html#use-statistical-models-to-answer-concrete-research-questions."><i class="fa fa-check"></i><b>21.1.2</b> Use statistical models to answer concrete research questions.</a></li>
<li class="chapter" data-level="21.1.3" data-path="reporting-statistics.html"><a href="reporting-statistics.html#illustrate-the-uncertainty-in-your-statistical-inferences."><i class="fa fa-check"></i><b>21.1.3</b> Illustrate the uncertainty in your statistical inferences.</a></li>
<li class="chapter" data-level="21.1.4" data-path="reporting-statistics.html"><a href="reporting-statistics.html#report-effect-sizes."><i class="fa fa-check"></i><b>21.1.4</b> Report effect sizes.</a></li>
<li class="chapter" data-level="21.1.5" data-path="reporting-statistics.html"><a href="reporting-statistics.html#reporting-statistical-results-using-rmarkdown"><i class="fa fa-check"></i><b>21.1.5</b> Reporting statistical results using RMarkdown</a></li>
</ul></li>
<li class="chapter" data-level="21.2" data-path="reporting-statistics.html"><a href="reporting-statistics.html#some-concrete-example"><i class="fa fa-check"></i><b>21.2</b> Some concrete example</a>
<ul>
<li class="chapter" data-level="21.2.1" data-path="reporting-statistics.html"><a href="reporting-statistics.html#frequentist-statistics"><i class="fa fa-check"></i><b>21.2.1</b> Frequentist statistics</a></li>
</ul></li>
<li class="chapter" data-level="21.3" data-path="reporting-statistics.html"><a href="reporting-statistics.html#additional-resources-15"><i class="fa fa-check"></i><b>21.3</b> Additional resources</a>
<ul>
<li class="chapter" data-level="21.3.1" data-path="reporting-statistics.html"><a href="reporting-statistics.html#misc-7"><i class="fa fa-check"></i><b>21.3.1</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="21.4" data-path="reporting-statistics.html"><a href="reporting-statistics.html#session-info-18"><i class="fa fa-check"></i><b>21.4</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="cheatsheets-4.html"><a href="cheatsheets-4.html"><i class="fa fa-check"></i><b>22</b> Cheatsheets</a>
<ul>
<li class="chapter" data-level="22.1" data-path="cheatsheets-4.html"><a href="cheatsheets-4.html#statistics"><i class="fa fa-check"></i><b>22.1</b> Statistics</a></li>
<li class="chapter" data-level="22.2" data-path="cheatsheets-4.html"><a href="cheatsheets-4.html#r"><i class="fa fa-check"></i><b>22.2</b> R</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references-1.html"><a href="references-1.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Psych 710: Statistical Methods II</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="model-assumptions" class="section level1 hasAnchor" number="20">
<h1><span class="header-section-number">Chapter 20</span> Model assumptions<a href="model-assumptions.html#model-assumptions" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="learning-goals-15" class="section level2 hasAnchor" number="20.1">
<h2><span class="header-section-number">20.1</span> Learning goals<a href="model-assumptions.html#learning-goals-15" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>Review model assumptions.</li>
<li>Explore how to test for model assumptions.</li>
<li>What to do if model assumptions aren’t met.</li>
</ul>
</div>
<div id="load-packages-and-set-plotting-theme-15" class="section level2 hasAnchor" number="20.2">
<h2><span class="header-section-number">20.2</span> Load packages and set plotting theme<a href="model-assumptions.html#load-packages-and-set-plotting-theme-15" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb1373"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1373-1"><a href="model-assumptions.html#cb1373-1" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;knitr&quot;</span>)      <span class="co"># for knitting RMarkdown </span></span>
<span id="cb1373-2"><a href="model-assumptions.html#cb1373-2" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;kableExtra&quot;</span>) <span class="co"># for nice RMarkdown tables</span></span>
<span id="cb1373-3"><a href="model-assumptions.html#cb1373-3" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;tidybayes&quot;</span>)  <span class="co"># tidying up results from Bayesian models</span></span>
<span id="cb1373-4"><a href="model-assumptions.html#cb1373-4" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;lme4&quot;</span>)       <span class="co"># for linear mixed effects models </span></span></code></pre></div>
<pre><code>## Warning: package &#39;lme4&#39; was built under R version 4.3.1</code></pre>
<pre><code>## Warning: package &#39;Matrix&#39; was built under R version 4.3.1</code></pre>
<div class="sourceCode" id="cb1376"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1376-1"><a href="model-assumptions.html#cb1376-1" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;brms&quot;</span>)       <span class="co"># Bayesian regression models with Stan</span></span>
<span id="cb1376-2"><a href="model-assumptions.html#cb1376-2" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;car&quot;</span>)        <span class="co"># for bootstrapping regression models </span></span>
<span id="cb1376-3"><a href="model-assumptions.html#cb1376-3" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;broom&quot;</span>)      <span class="co"># for tidy regression results</span></span>
<span id="cb1376-4"><a href="model-assumptions.html#cb1376-4" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;janitor&quot;</span>)    <span class="co"># for cleaning up variable names </span></span>
<span id="cb1376-5"><a href="model-assumptions.html#cb1376-5" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;patchwork&quot;</span>)  <span class="co"># for figure panels</span></span>
<span id="cb1376-6"><a href="model-assumptions.html#cb1376-6" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;ggeffects&quot;</span>)  <span class="co"># for visualizing estimated marginal means</span></span></code></pre></div>
<pre><code>## Warning: package &#39;ggeffects&#39; was built under R version 4.3.1</code></pre>
<div class="sourceCode" id="cb1378"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1378-1"><a href="model-assumptions.html#cb1378-1" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;stargazer&quot;</span>)  <span class="co"># for latex regression tables </span></span>
<span id="cb1378-2"><a href="model-assumptions.html#cb1378-2" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;sjPlot&quot;</span>)     <span class="co"># for nice RMarkdown regression tables</span></span>
<span id="cb1378-3"><a href="model-assumptions.html#cb1378-3" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;xtable&quot;</span>)     <span class="co"># for latex tables</span></span>
<span id="cb1378-4"><a href="model-assumptions.html#cb1378-4" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;ggrepel&quot;</span>)    <span class="co"># for smart text annotation in ggplot</span></span></code></pre></div>
<pre><code>## Warning: package &#39;ggrepel&#39; was built under R version 4.3.1</code></pre>
<pre><code>## Warning: package &#39;ggplot2&#39; was built under R version 4.3.1</code></pre>
<div class="sourceCode" id="cb1381"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1381-1"><a href="model-assumptions.html#cb1381-1" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;tidyverse&quot;</span>)  <span class="co"># for wrangling, plotting, etc. </span></span></code></pre></div>
<pre><code>## Warning: package &#39;dplyr&#39; was built under R version 4.3.1</code></pre>
<div class="sourceCode" id="cb1383"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1383-1"><a href="model-assumptions.html#cb1383-1" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_classic</span>() <span class="sc">+</span> <span class="co">#set the theme </span></span>
<span id="cb1383-2"><a href="model-assumptions.html#cb1383-2" tabindex="-1"></a>            <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>))) <span class="co">#set the default text size</span></span>
<span id="cb1383-3"><a href="model-assumptions.html#cb1383-3" tabindex="-1"></a></span>
<span id="cb1383-4"><a href="model-assumptions.html#cb1383-4" tabindex="-1"></a><span class="co"># set rstan options</span></span>
<span id="cb1383-5"><a href="model-assumptions.html#cb1383-5" tabindex="-1"></a>rstan<span class="sc">::</span><span class="fu">rstan_options</span>(<span class="at">auto_write =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1383-6"><a href="model-assumptions.html#cb1383-6" tabindex="-1"></a><span class="fu">options</span>(<span class="at">mc.cores =</span> parallel<span class="sc">::</span><span class="fu">detectCores</span>())</span></code></pre></div>
</div>
<div id="model-assumptions-and-what-to-do-if-they-are-violated" class="section level2 hasAnchor" number="20.3">
<h2><span class="header-section-number">20.3</span> Model assumptions and what to do if they are violated<a href="model-assumptions.html#model-assumptions-and-what-to-do-if-they-are-violated" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>“Regression diagnostics are methods for determining whether a fitted regression model adequately represents the data.” (p. 385) <span class="citation">(<a href="#ref-fox2018r">Fox and Weisberg 2018</a>)</span></p>
<div id="influential-data-points" class="section level3 hasAnchor" number="20.3.1">
<h3><span class="header-section-number">20.3.1</span> Influential data points<a href="model-assumptions.html#influential-data-points" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Because linear regression models are fitted by minimizing the squared error between prediction and data, the results can be strongly influenced by outliers. There are a number of ways of checking for outliers.</p>
<div id="leverage-hat-values" class="section level4 hasAnchor" number="20.3.1.1">
<h4><span class="header-section-number">20.3.1.1</span> Leverage: Hat-values<a href="model-assumptions.html#leverage-hat-values" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Data points that are far from the center of the predictor space have potentially greater influence on the results – these points have <em>high leverage</em>. hat-values are a way of characterizing how much influence individual data points have.</p>
<div class="sourceCode" id="cb1384"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1384-1"><a href="model-assumptions.html#cb1384-1" tabindex="-1"></a>df.credit <span class="ot">=</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/credit.csv&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1384-2"><a href="model-assumptions.html#cb1384-2" tabindex="-1"></a>  <span class="fu">clean_names</span>()</span>
<span id="cb1384-3"><a href="model-assumptions.html#cb1384-3" tabindex="-1"></a></span>
<span id="cb1384-4"><a href="model-assumptions.html#cb1384-4" tabindex="-1"></a>fit.credit <span class="ot">=</span> <span class="fu">lm</span>(<span class="at">formula =</span> balance <span class="sc">~</span> income,</span>
<span id="cb1384-5"><a href="model-assumptions.html#cb1384-5" tabindex="-1"></a>                <span class="at">data =</span> df.credit)</span>
<span id="cb1384-6"><a href="model-assumptions.html#cb1384-6" tabindex="-1"></a></span>
<span id="cb1384-7"><a href="model-assumptions.html#cb1384-7" tabindex="-1"></a><span class="co"># fit model without the data point of interest </span></span>
<span id="cb1384-8"><a href="model-assumptions.html#cb1384-8" tabindex="-1"></a>fit.credit2 <span class="ot">=</span> <span class="fu">update</span>(fit.credit,</span>
<span id="cb1384-9"><a href="model-assumptions.html#cb1384-9" tabindex="-1"></a>                     <span class="at">data =</span> df.credit <span class="sc">%&gt;%</span> </span>
<span id="cb1384-10"><a href="model-assumptions.html#cb1384-10" tabindex="-1"></a>                       <span class="fu">filter</span>(x1 <span class="sc">!=</span> <span class="dv">324</span>))</span>
<span id="cb1384-11"><a href="model-assumptions.html#cb1384-11" tabindex="-1"></a></span>
<span id="cb1384-12"><a href="model-assumptions.html#cb1384-12" tabindex="-1"></a>res_with_outlier <span class="ot">=</span> fit.credit <span class="sc">%&gt;%</span> </span>
<span id="cb1384-13"><a href="model-assumptions.html#cb1384-13" tabindex="-1"></a>  <span class="fu">augment</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1384-14"><a href="model-assumptions.html#cb1384-14" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">row_number</span>() <span class="sc">==</span> <span class="dv">324</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1384-15"><a href="model-assumptions.html#cb1384-15" tabindex="-1"></a>  <span class="fu">pull</span>(.resid)</span>
<span id="cb1384-16"><a href="model-assumptions.html#cb1384-16" tabindex="-1"></a></span>
<span id="cb1384-17"><a href="model-assumptions.html#cb1384-17" tabindex="-1"></a>res_without_outlier <span class="ot">=</span> fit.credit2 <span class="sc">%&gt;%</span> </span>
<span id="cb1384-18"><a href="model-assumptions.html#cb1384-18" tabindex="-1"></a>  <span class="fu">augment</span>(<span class="at">newdata =</span> df.credit) <span class="sc">%&gt;%</span> </span>
<span id="cb1384-19"><a href="model-assumptions.html#cb1384-19" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">.resid =</span> balance <span class="sc">-</span> .fitted) <span class="sc">%&gt;%</span> </span>
<span id="cb1384-20"><a href="model-assumptions.html#cb1384-20" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">row_number</span>() <span class="sc">==</span> <span class="dv">324</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1384-21"><a href="model-assumptions.html#cb1384-21" tabindex="-1"></a>  <span class="fu">pull</span>(.resid)</span>
<span id="cb1384-22"><a href="model-assumptions.html#cb1384-22" tabindex="-1"></a></span>
<span id="cb1384-23"><a href="model-assumptions.html#cb1384-23" tabindex="-1"></a>hat1 <span class="ot">=</span> <span class="dv">1</span> <span class="sc">-</span> (res_with_outlier<span class="sc">/</span>res_without_outlier) <span class="sc">%&gt;%</span> </span>
<span id="cb1384-24"><a href="model-assumptions.html#cb1384-24" tabindex="-1"></a>  <span class="fu">round</span>(<span class="dv">3</span>)</span>
<span id="cb1384-25"><a href="model-assumptions.html#cb1384-25" tabindex="-1"></a></span>
<span id="cb1384-26"><a href="model-assumptions.html#cb1384-26" tabindex="-1"></a>hat2 <span class="ot">=</span> fit.credit <span class="sc">%&gt;%</span> </span>
<span id="cb1384-27"><a href="model-assumptions.html#cb1384-27" tabindex="-1"></a>  <span class="fu">augment</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1384-28"><a href="model-assumptions.html#cb1384-28" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">row_number</span>() <span class="sc">==</span> <span class="dv">324</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1384-29"><a href="model-assumptions.html#cb1384-29" tabindex="-1"></a>  <span class="fu">pull</span>(.hat) <span class="sc">%&gt;%</span> </span>
<span id="cb1384-30"><a href="model-assumptions.html#cb1384-30" tabindex="-1"></a>  <span class="fu">round</span>(<span class="dv">3</span>)</span>
<span id="cb1384-31"><a href="model-assumptions.html#cb1384-31" tabindex="-1"></a></span>
<span id="cb1384-32"><a href="model-assumptions.html#cb1384-32" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">str_c</span>(<span class="st">&quot;hat1: &quot;</span>, hat1))</span></code></pre></div>
<pre><code>## [1] &quot;hat1: 0.041&quot;</code></pre>
<div class="sourceCode" id="cb1386"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1386-1"><a href="model-assumptions.html#cb1386-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">str_c</span>(<span class="st">&quot;hat2: &quot;</span>, hat2))</span></code></pre></div>
<pre><code>## [1] &quot;hat2: 0.041&quot;</code></pre>
<p>Cook’s distance is defined as</p>
<p><span class="math display">\[D_i = \frac{e^2_{Si}}{k + 1} \times \frac{h_i}{1-h_1}\]</span>,</p>
<p>where <span class="math inline">\(e^2_{Si}\)</span> is the squared standardized residual, <span class="math inline">\(k\)</span> is the number of coefficients in the model (excluding the intercept), and <span class="math inline">\(h_i\)</span> is the hat-value for case <span class="math inline">\(i\)</span>.</p>
<p>Let’s double check here:</p>
<div class="sourceCode" id="cb1388"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1388-1"><a href="model-assumptions.html#cb1388-1" tabindex="-1"></a>fit.credit <span class="sc">%&gt;%</span> </span>
<span id="cb1388-2"><a href="model-assumptions.html#cb1388-2" tabindex="-1"></a>  <span class="fu">augment</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1388-3"><a href="model-assumptions.html#cb1388-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cook =</span> ((.std.resid<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span>(<span class="dv">2</span> <span class="sc">+</span> <span class="dv">1</span>)) <span class="sc">*</span> (.hat<span class="sc">/</span>(<span class="dv">1</span> <span class="sc">-</span> .hat))) <span class="sc">%&gt;%</span> </span>
<span id="cb1388-4"><a href="model-assumptions.html#cb1388-4" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">contains</span>(<span class="st">&quot;cook&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1388-5"><a href="model-assumptions.html#cb1388-5" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">10</span>)</span></code></pre></div>
<pre><code>## # A tibble: 10 × 2
##        .cooksd        cook
##          &lt;dbl&gt;       &lt;dbl&gt;
##  1 0.000000169 0.000000113
##  2 0.00000706  0.00000471 
##  3 0.00264     0.00176    
##  4 0.00257     0.00171    
##  5 0.000530    0.000353   
##  6 0.00265     0.00177    
##  7 0.000324    0.000216   
##  8 0.000441    0.000294   
##  9 0.0000457   0.0000304  
## 10 0.00529     0.00353</code></pre>
<p>Looking good!</p>
<div class="sourceCode" id="cb1390"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1390-1"><a href="model-assumptions.html#cb1390-1" tabindex="-1"></a>fit.credit <span class="sc">%&gt;%</span> </span>
<span id="cb1390-2"><a href="model-assumptions.html#cb1390-2" tabindex="-1"></a>  <span class="fu">augment</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1390-3"><a href="model-assumptions.html#cb1390-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> .hat,</span>
<span id="cb1390-4"><a href="model-assumptions.html#cb1390-4" tabindex="-1"></a>             <span class="at">y =</span> .std.resid)) <span class="sc">+</span> </span>
<span id="cb1390-5"><a href="model-assumptions.html#cb1390-5" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb1390-6"><a href="model-assumptions.html#cb1390-6" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> .cooksd),</span>
<span id="cb1390-7"><a href="model-assumptions.html#cb1390-7" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="25-assumptions_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<div id="toy-example" class="section level5 hasAnchor" number="20.3.1.1.1">
<h5><span class="header-section-number">20.3.1.1.1</span> Toy example<a href="model-assumptions.html#toy-example" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Generate some data with an outlier.</p>
<div class="sourceCode" id="cb1391"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1391-1"><a href="model-assumptions.html#cb1391-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb1391-2"><a href="model-assumptions.html#cb1391-2" tabindex="-1"></a>df.hat <span class="ot">=</span> <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">runif</span>(<span class="at">n =</span> <span class="dv">5</span>),</span>
<span id="cb1391-3"><a href="model-assumptions.html#cb1391-3" tabindex="-1"></a>                <span class="at">y =</span> <span class="dv">10</span> <span class="sc">*</span> x <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">5</span>, <span class="at">sd =</span> <span class="dv">2</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1391-4"><a href="model-assumptions.html#cb1391-4" tabindex="-1"></a>  <span class="fu">bind_rows</span>(<span class="fu">tibble</span>(<span class="at">x =</span> <span class="fl">0.7</span>,</span>
<span id="cb1391-5"><a href="model-assumptions.html#cb1391-5" tabindex="-1"></a>                   <span class="at">y =</span> <span class="dv">15</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1391-6"><a href="model-assumptions.html#cb1391-6" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">index =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>())</span></code></pre></div>
<p>Illustrate the hat-values and cook’s distance.</p>
<div class="sourceCode" id="cb1392"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1392-1"><a href="model-assumptions.html#cb1392-1" tabindex="-1"></a>fit.hat <span class="ot">=</span> <span class="fu">lm</span>(<span class="at">formula =</span> y <span class="sc">~</span> x,</span>
<span id="cb1392-2"><a href="model-assumptions.html#cb1392-2" tabindex="-1"></a>             <span class="at">data =</span> df.hat)</span>
<span id="cb1392-3"><a href="model-assumptions.html#cb1392-3" tabindex="-1"></a></span>
<span id="cb1392-4"><a href="model-assumptions.html#cb1392-4" tabindex="-1"></a>fit.hat <span class="sc">%&gt;%</span> </span>
<span id="cb1392-5"><a href="model-assumptions.html#cb1392-5" tabindex="-1"></a>  <span class="fu">augment</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1392-6"><a href="model-assumptions.html#cb1392-6" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">index =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb1392-7"><a href="model-assumptions.html#cb1392-7" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> .hat,</span>
<span id="cb1392-8"><a href="model-assumptions.html#cb1392-8" tabindex="-1"></a>             <span class="at">y =</span> .std.resid)) <span class="sc">+</span> </span>
<span id="cb1392-9"><a href="model-assumptions.html#cb1392-9" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb1392-10"><a href="model-assumptions.html#cb1392-10" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> .cooksd),</span>
<span id="cb1392-11"><a href="model-assumptions.html#cb1392-11" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb1392-12"><a href="model-assumptions.html#cb1392-12" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> index),</span>
<span id="cb1392-13"><a href="model-assumptions.html#cb1392-13" tabindex="-1"></a>            <span class="at">nudge_y =</span> <span class="sc">-</span><span class="fl">0.2</span>)</span></code></pre></div>
<p><img src="25-assumptions_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<p>Illustrate what the regression line looks like when all points are fit vs. one of the points is excluded.</p>
<div class="sourceCode" id="cb1393"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1393-1"><a href="model-assumptions.html#cb1393-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df.hat,</span>
<span id="cb1393-2"><a href="model-assumptions.html#cb1393-2" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> x,</span>
<span id="cb1393-3"><a href="model-assumptions.html#cb1393-3" tabindex="-1"></a>                     <span class="at">y =</span> y)) <span class="sc">+</span> </span>
<span id="cb1393-4"><a href="model-assumptions.html#cb1393-4" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb1393-5"><a href="model-assumptions.html#cb1393-5" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>,</span>
<span id="cb1393-6"><a href="model-assumptions.html#cb1393-6" tabindex="-1"></a>              <span class="at">se =</span> F,</span>
<span id="cb1393-7"><a href="model-assumptions.html#cb1393-7" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span> </span>
<span id="cb1393-8"><a href="model-assumptions.html#cb1393-8" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">data =</span> df.hat <span class="sc">%&gt;%</span> </span>
<span id="cb1393-9"><a href="model-assumptions.html#cb1393-9" tabindex="-1"></a>                <span class="fu">filter</span>(index <span class="sc">!=</span> <span class="dv">6</span>),</span>
<span id="cb1393-10"><a href="model-assumptions.html#cb1393-10" tabindex="-1"></a>                <span class="at">method =</span> <span class="st">&quot;lm&quot;</span>,</span>
<span id="cb1393-11"><a href="model-assumptions.html#cb1393-11" tabindex="-1"></a>              <span class="at">se =</span> F,</span>
<span id="cb1393-12"><a href="model-assumptions.html#cb1393-12" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;
## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="25-assumptions_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<p>Summary of each observation.</p>
<div class="sourceCode" id="cb1395"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1395-1"><a href="model-assumptions.html#cb1395-1" tabindex="-1"></a>fit.hat <span class="sc">%&gt;%</span> </span>
<span id="cb1395-2"><a href="model-assumptions.html#cb1395-2" tabindex="-1"></a>  <span class="fu">augment</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1395-3"><a href="model-assumptions.html#cb1395-3" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1395-4"><a href="model-assumptions.html#cb1395-4" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">digits =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1395-5"><a href="model-assumptions.html#cb1395-5" tabindex="-1"></a>  <span class="fu">kable_styling</span>()</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
y
</th>
<th style="text-align:right;">
x
</th>
<th style="text-align:right;">
fitted
</th>
<th style="text-align:right;">
resid
</th>
<th style="text-align:right;">
hat
</th>
<th style="text-align:right;">
sigma
</th>
<th style="text-align:right;">
cooksd
</th>
<th style="text-align:right;">
std_resid
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
5.20
</td>
<td style="text-align:right;">
0.27
</td>
<td style="text-align:right;">
3.58
</td>
<td style="text-align:right;">
1.62
</td>
<td style="text-align:right;">
0.32
</td>
<td style="text-align:right;">
5.00
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
0.44
</td>
</tr>
<tr>
<td style="text-align:right;">
4.55
</td>
<td style="text-align:right;">
0.37
</td>
<td style="text-align:right;">
4.67
</td>
<td style="text-align:right;">
-0.12
</td>
<td style="text-align:right;">
0.21
</td>
<td style="text-align:right;">
5.12
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
-0.03
</td>
</tr>
<tr>
<td style="text-align:right;">
2.65
</td>
<td style="text-align:right;">
0.57
</td>
<td style="text-align:right;">
6.72
</td>
<td style="text-align:right;">
-4.07
</td>
<td style="text-align:right;">
0.18
</td>
<td style="text-align:right;">
4.42
</td>
<td style="text-align:right;">
0.11
</td>
<td style="text-align:right;">
-1.01
</td>
</tr>
<tr>
<td style="text-align:right;">
7.22
</td>
<td style="text-align:right;">
0.91
</td>
<td style="text-align:right;">
10.13
</td>
<td style="text-align:right;">
-2.91
</td>
<td style="text-align:right;">
0.61
</td>
<td style="text-align:right;">
4.37
</td>
<td style="text-align:right;">
0.84
</td>
<td style="text-align:right;">
-1.05
</td>
</tr>
<tr>
<td style="text-align:right;">
1.43
</td>
<td style="text-align:right;">
0.20
</td>
<td style="text-align:right;">
2.93
</td>
<td style="text-align:right;">
-1.51
</td>
<td style="text-align:right;">
0.41
</td>
<td style="text-align:right;">
5.00
</td>
<td style="text-align:right;">
0.07
</td>
<td style="text-align:right;">
-0.44
</td>
</tr>
<tr>
<td style="text-align:right;">
15.00
</td>
<td style="text-align:right;">
0.70
</td>
<td style="text-align:right;">
8.01
</td>
<td style="text-align:right;">
6.99
</td>
<td style="text-align:right;">
0.27
</td>
<td style="text-align:right;">
1.98
</td>
<td style="text-align:right;">
0.63
</td>
<td style="text-align:right;">
1.84
</td>
</tr>
</tbody>
</table>
<p>Compute cook’s distance</p>
<div class="sourceCode" id="cb1396"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1396-1"><a href="model-assumptions.html#cb1396-1" tabindex="-1"></a>fit.hat_with <span class="ot">=</span> <span class="fu">lm</span>(<span class="at">formula =</span> y <span class="sc">~</span> x,</span>
<span id="cb1396-2"><a href="model-assumptions.html#cb1396-2" tabindex="-1"></a>                  <span class="at">data =</span> df.hat)</span>
<span id="cb1396-3"><a href="model-assumptions.html#cb1396-3" tabindex="-1"></a></span>
<span id="cb1396-4"><a href="model-assumptions.html#cb1396-4" tabindex="-1"></a>fit.hat_without <span class="ot">=</span> <span class="fu">lm</span>(<span class="at">formula =</span> y <span class="sc">~</span> x,</span>
<span id="cb1396-5"><a href="model-assumptions.html#cb1396-5" tabindex="-1"></a>                     <span class="at">data =</span> df.hat <span class="sc">%&gt;%</span> </span>
<span id="cb1396-6"><a href="model-assumptions.html#cb1396-6" tabindex="-1"></a>                       <span class="fu">filter</span>(index <span class="sc">!=</span> <span class="dv">6</span>))</span>
<span id="cb1396-7"><a href="model-assumptions.html#cb1396-7" tabindex="-1"></a></span>
<span id="cb1396-8"><a href="model-assumptions.html#cb1396-8" tabindex="-1"></a>residual_without <span class="ot">=</span> fit.hat_without <span class="sc">%&gt;%</span> </span>
<span id="cb1396-9"><a href="model-assumptions.html#cb1396-9" tabindex="-1"></a>  <span class="fu">augment</span>(<span class="at">newdata =</span> df.hat) <span class="sc">%&gt;%</span> </span>
<span id="cb1396-10"><a href="model-assumptions.html#cb1396-10" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1396-11"><a href="model-assumptions.html#cb1396-11" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">resid =</span> y <span class="sc">-</span> fitted) <span class="sc">%&gt;%</span> </span>
<span id="cb1396-12"><a href="model-assumptions.html#cb1396-12" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">row_number</span>() <span class="sc">==</span> <span class="dv">6</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1396-13"><a href="model-assumptions.html#cb1396-13" tabindex="-1"></a>  <span class="fu">pull</span>(resid)</span>
<span id="cb1396-14"><a href="model-assumptions.html#cb1396-14" tabindex="-1"></a></span>
<span id="cb1396-15"><a href="model-assumptions.html#cb1396-15" tabindex="-1"></a>residual_with <span class="ot">=</span> fit.hat <span class="sc">%&gt;%</span> </span>
<span id="cb1396-16"><a href="model-assumptions.html#cb1396-16" tabindex="-1"></a>  <span class="fu">augment</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1396-17"><a href="model-assumptions.html#cb1396-17" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1396-18"><a href="model-assumptions.html#cb1396-18" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">row_number</span>() <span class="sc">==</span> <span class="dv">6</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1396-19"><a href="model-assumptions.html#cb1396-19" tabindex="-1"></a>  <span class="fu">pull</span>(resid)</span>
<span id="cb1396-20"><a href="model-assumptions.html#cb1396-20" tabindex="-1"></a></span>
<span id="cb1396-21"><a href="model-assumptions.html#cb1396-21" tabindex="-1"></a>hat <span class="ot">=</span> <span class="dv">1</span> <span class="sc">-</span> (residual_with<span class="sc">/</span>residual_without)</span>
<span id="cb1396-22"><a href="model-assumptions.html#cb1396-22" tabindex="-1"></a>hat</span></code></pre></div>
<pre><code>## [1] 0.270516</code></pre>
</div>
</div>
</div>
<div id="linear-and-additive" class="section level3 hasAnchor" number="20.3.2">
<h3><span class="header-section-number">20.3.2</span> Linear and additive<a href="model-assumptions.html#linear-and-additive" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb1398"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1398-1"><a href="model-assumptions.html#cb1398-1" tabindex="-1"></a>df.car <span class="ot">=</span> mtcars</span></code></pre></div>
<div class="sourceCode" id="cb1399"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1399-1"><a href="model-assumptions.html#cb1399-1" tabindex="-1"></a>df.car <span class="sc">%&gt;%</span> </span>
<span id="cb1399-2"><a href="model-assumptions.html#cb1399-2" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">6</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1399-3"><a href="model-assumptions.html#cb1399-3" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">digits =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1399-4"><a href="model-assumptions.html#cb1399-4" tabindex="-1"></a>  <span class="fu">kable_styling</span>()</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
mpg
</th>
<th style="text-align:right;">
cyl
</th>
<th style="text-align:right;">
disp
</th>
<th style="text-align:right;">
hp
</th>
<th style="text-align:right;">
drat
</th>
<th style="text-align:right;">
wt
</th>
<th style="text-align:right;">
qsec
</th>
<th style="text-align:right;">
vs
</th>
<th style="text-align:right;">
am
</th>
<th style="text-align:right;">
gear
</th>
<th style="text-align:right;">
carb
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Mazda RX4
</td>
<td style="text-align:right;">
21.0
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
160
</td>
<td style="text-align:right;">
110
</td>
<td style="text-align:right;">
3.90
</td>
<td style="text-align:right;">
2.62
</td>
<td style="text-align:right;">
16.46
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:left;">
Mazda RX4 Wag
</td>
<td style="text-align:right;">
21.0
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
160
</td>
<td style="text-align:right;">
110
</td>
<td style="text-align:right;">
3.90
</td>
<td style="text-align:right;">
2.88
</td>
<td style="text-align:right;">
17.02
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:left;">
Datsun 710
</td>
<td style="text-align:right;">
22.8
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
108
</td>
<td style="text-align:right;">
93
</td>
<td style="text-align:right;">
3.85
</td>
<td style="text-align:right;">
2.32
</td>
<td style="text-align:right;">
18.61
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
Hornet 4 Drive
</td>
<td style="text-align:right;">
21.4
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
258
</td>
<td style="text-align:right;">
110
</td>
<td style="text-align:right;">
3.08
</td>
<td style="text-align:right;">
3.21
</td>
<td style="text-align:right;">
19.44
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
Hornet Sportabout
</td>
<td style="text-align:right;">
18.7
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
360
</td>
<td style="text-align:right;">
175
</td>
<td style="text-align:right;">
3.15
</td>
<td style="text-align:right;">
3.44
</td>
<td style="text-align:right;">
17.02
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
Valiant
</td>
<td style="text-align:right;">
18.1
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
225
</td>
<td style="text-align:right;">
105
</td>
<td style="text-align:right;">
2.76
</td>
<td style="text-align:right;">
3.46
</td>
<td style="text-align:right;">
20.22
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb1400"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1400-1"><a href="model-assumptions.html#cb1400-1" tabindex="-1"></a>fit.car <span class="ot">=</span> <span class="fu">lm</span>(<span class="at">formula =</span> mpg <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> hp,</span>
<span id="cb1400-2"><a href="model-assumptions.html#cb1400-2" tabindex="-1"></a>             <span class="at">data =</span> df.car)</span>
<span id="cb1400-3"><a href="model-assumptions.html#cb1400-3" tabindex="-1"></a></span>
<span id="cb1400-4"><a href="model-assumptions.html#cb1400-4" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df.car,</span>
<span id="cb1400-5"><a href="model-assumptions.html#cb1400-5" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> hp,</span>
<span id="cb1400-6"><a href="model-assumptions.html#cb1400-6" tabindex="-1"></a>                     <span class="at">y =</span> mpg)) <span class="sc">+</span> </span>
<span id="cb1400-7"><a href="model-assumptions.html#cb1400-7" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>) <span class="sc">+</span> </span>
<span id="cb1400-8"><a href="model-assumptions.html#cb1400-8" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">color =</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb1400-9"><a href="model-assumptions.html#cb1400-9" tabindex="-1"></a>              <span class="at">se =</span> F) <span class="sc">+</span> </span>
<span id="cb1400-10"><a href="model-assumptions.html#cb1400-10" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;
## `geom_smooth()` using method = &#39;loess&#39; and formula = &#39;y ~ x&#39;</code></pre>
<p><img src="25-assumptions_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<p>Residual plot</p>
<div class="sourceCode" id="cb1402"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1402-1"><a href="model-assumptions.html#cb1402-1" tabindex="-1"></a>fit.car <span class="sc">%&gt;%</span> </span>
<span id="cb1402-2"><a href="model-assumptions.html#cb1402-2" tabindex="-1"></a>  <span class="fu">augment</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1402-3"><a href="model-assumptions.html#cb1402-3" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1402-4"><a href="model-assumptions.html#cb1402-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> .,</span>
<span id="cb1402-5"><a href="model-assumptions.html#cb1402-5" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> fitted,</span>
<span id="cb1402-6"><a href="model-assumptions.html#cb1402-6" tabindex="-1"></a>                       <span class="at">y =</span> resid)) <span class="sc">+</span> </span>
<span id="cb1402-7"><a href="model-assumptions.html#cb1402-7" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, </span>
<span id="cb1402-8"><a href="model-assumptions.html#cb1402-8" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb1402-9"><a href="model-assumptions.html#cb1402-9" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb1402-10"><a href="model-assumptions.html#cb1402-10" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">color =</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb1402-11"><a href="model-assumptions.html#cb1402-11" tabindex="-1"></a>              <span class="at">se =</span> F)</span></code></pre></div>
<p><img src="25-assumptions_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<p>Include a squared predictor</p>
<div class="sourceCode" id="cb1403"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1403-1"><a href="model-assumptions.html#cb1403-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df.car,</span>
<span id="cb1403-2"><a href="model-assumptions.html#cb1403-2" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> hp,</span>
<span id="cb1403-3"><a href="model-assumptions.html#cb1403-3" tabindex="-1"></a>                     <span class="at">y =</span> mpg)) <span class="sc">+</span> </span>
<span id="cb1403-4"><a href="model-assumptions.html#cb1403-4" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>,</span>
<span id="cb1403-5"><a href="model-assumptions.html#cb1403-5" tabindex="-1"></a>              <span class="at">formula =</span> y <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb1403-6"><a href="model-assumptions.html#cb1403-6" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="25-assumptions_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<div class="sourceCode" id="cb1404"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1404-1"><a href="model-assumptions.html#cb1404-1" tabindex="-1"></a>fit.car2 <span class="ot">=</span> <span class="fu">lm</span>(<span class="at">formula =</span> mpg <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> hp <span class="sc">+</span> <span class="fu">I</span>(hp<span class="sc">^</span><span class="dv">2</span>),</span>
<span id="cb1404-2"><a href="model-assumptions.html#cb1404-2" tabindex="-1"></a>             <span class="at">data =</span> df.car)</span>
<span id="cb1404-3"><a href="model-assumptions.html#cb1404-3" tabindex="-1"></a></span>
<span id="cb1404-4"><a href="model-assumptions.html#cb1404-4" tabindex="-1"></a>fit.car2 <span class="sc">%&gt;%</span> </span>
<span id="cb1404-5"><a href="model-assumptions.html#cb1404-5" tabindex="-1"></a>  <span class="fu">augment</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1404-6"><a href="model-assumptions.html#cb1404-6" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1404-7"><a href="model-assumptions.html#cb1404-7" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> .,</span>
<span id="cb1404-8"><a href="model-assumptions.html#cb1404-8" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> fitted,</span>
<span id="cb1404-9"><a href="model-assumptions.html#cb1404-9" tabindex="-1"></a>                       <span class="at">y =</span> resid)) <span class="sc">+</span> </span>
<span id="cb1404-10"><a href="model-assumptions.html#cb1404-10" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, </span>
<span id="cb1404-11"><a href="model-assumptions.html#cb1404-11" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb1404-12"><a href="model-assumptions.html#cb1404-12" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb1404-13"><a href="model-assumptions.html#cb1404-13" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">color =</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb1404-14"><a href="model-assumptions.html#cb1404-14" tabindex="-1"></a>              <span class="at">se =</span> F)</span></code></pre></div>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39; and formula = &#39;y ~ x&#39;</code></pre>
<p><img src="25-assumptions_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
</div>
<div id="normally-distributed-residuals" class="section level3 hasAnchor" number="20.3.3">
<h3><span class="header-section-number">20.3.3</span> Normally distributed residuals<a href="model-assumptions.html#normally-distributed-residuals" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let’s look at the residuals for the credit card model.</p>
<div class="sourceCode" id="cb1406"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1406-1"><a href="model-assumptions.html#cb1406-1" tabindex="-1"></a>fit.credit <span class="sc">%&gt;%</span> </span>
<span id="cb1406-2"><a href="model-assumptions.html#cb1406-2" tabindex="-1"></a>  <span class="fu">augment</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1406-3"><a href="model-assumptions.html#cb1406-3" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1406-4"><a href="model-assumptions.html#cb1406-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> ., </span>
<span id="cb1406-5"><a href="model-assumptions.html#cb1406-5" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> fitted,</span>
<span id="cb1406-6"><a href="model-assumptions.html#cb1406-6" tabindex="-1"></a>                     <span class="at">y =</span> resid)) <span class="sc">+</span> </span>
<span id="cb1406-7"><a href="model-assumptions.html#cb1406-7" tabindex="-1"></a>  <span class="fu">geom_point</span>()  </span></code></pre></div>
<p><img src="25-assumptions_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
<p>This plot helps assess whether there is homogeneity of variance. Overall, the residual plot looks pretty ok. The diagonal points in the bottom left of th plot arise because credit card balance is not an unbounded variable, and some of the people have a credit card balance of 0.</p>
<p>We can also check whether the residuals are normally distributed by plotting a density of the residuals, and a quantile quantile plot.</p>
<div class="sourceCode" id="cb1407"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1407-1"><a href="model-assumptions.html#cb1407-1" tabindex="-1"></a>df.plot <span class="ot">=</span> fit.credit <span class="sc">%&gt;%</span> </span>
<span id="cb1407-2"><a href="model-assumptions.html#cb1407-2" tabindex="-1"></a>  <span class="fu">augment</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1407-3"><a href="model-assumptions.html#cb1407-3" tabindex="-1"></a>  <span class="fu">clean_names</span>()</span>
<span id="cb1407-4"><a href="model-assumptions.html#cb1407-4" tabindex="-1"></a></span>
<span id="cb1407-5"><a href="model-assumptions.html#cb1407-5" tabindex="-1"></a>p1 <span class="ot">=</span> <span class="fu">ggplot</span>(<span class="at">data =</span> df.plot,</span>
<span id="cb1407-6"><a href="model-assumptions.html#cb1407-6" tabindex="-1"></a>            <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> resid)) <span class="sc">+</span> </span>
<span id="cb1407-7"><a href="model-assumptions.html#cb1407-7" tabindex="-1"></a>  <span class="fu">geom_density</span>() <span class="sc">+</span></span>
<span id="cb1407-8"><a href="model-assumptions.html#cb1407-8" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Density plot&quot;</span>)</span>
<span id="cb1407-9"><a href="model-assumptions.html#cb1407-9" tabindex="-1"></a></span>
<span id="cb1407-10"><a href="model-assumptions.html#cb1407-10" tabindex="-1"></a>p2 <span class="ot">=</span> <span class="fu">ggplot</span>(<span class="at">data =</span> df.plot,</span>
<span id="cb1407-11"><a href="model-assumptions.html#cb1407-11" tabindex="-1"></a>            <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">sample =</span> <span class="fu">scale</span>(resid))) <span class="sc">+</span></span>
<span id="cb1407-12"><a href="model-assumptions.html#cb1407-12" tabindex="-1"></a>  <span class="fu">geom_qq_line</span>() <span class="sc">+</span> </span>
<span id="cb1407-13"><a href="model-assumptions.html#cb1407-13" tabindex="-1"></a>  <span class="fu">geom_qq</span>() <span class="sc">+</span> </span>
<span id="cb1407-14"><a href="model-assumptions.html#cb1407-14" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;QQ plot&quot;</span>,</span>
<span id="cb1407-15"><a href="model-assumptions.html#cb1407-15" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;theoretical&quot;</span>,</span>
<span id="cb1407-16"><a href="model-assumptions.html#cb1407-16" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;standardized residuals&quot;</span>)</span>
<span id="cb1407-17"><a href="model-assumptions.html#cb1407-17" tabindex="-1"></a></span>
<span id="cb1407-18"><a href="model-assumptions.html#cb1407-18" tabindex="-1"></a>p1 <span class="sc">+</span> p2</span></code></pre></div>
<p><img src="25-assumptions_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<p>The residuals aren’t really normally distributed. As both the density and the QQ plot show, residuals with low/negative values are more frequent than residuals with high/positive values.</p>
<div id="transforming-the-outcome-variable" class="section level4 hasAnchor" number="20.3.3.1">
<h4><span class="header-section-number">20.3.3.1</span> Transforming the outcome variable<a href="model-assumptions.html#transforming-the-outcome-variable" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>When the residuals aren’t normally distributed and/or when the variance is not homogeneous, one option is to transform some of the variables.</p>
<div id="logarithmic-transform" class="section level5 hasAnchor" number="20.3.3.1.1">
<h5><span class="header-section-number">20.3.3.1.1</span> Logarithmic transform<a href="model-assumptions.html#logarithmic-transform" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb1408"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1408-1"><a href="model-assumptions.html#cb1408-1" tabindex="-1"></a>df.un <span class="ot">=</span> UN <span class="sc">%&gt;%</span> </span>
<span id="cb1408-2"><a href="model-assumptions.html#cb1408-2" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1408-3"><a href="model-assumptions.html#cb1408-3" tabindex="-1"></a>  <span class="fu">drop_na</span>(infant_mortality, ppgdp)</span>
<span id="cb1408-4"><a href="model-assumptions.html#cb1408-4" tabindex="-1"></a></span>
<span id="cb1408-5"><a href="model-assumptions.html#cb1408-5" tabindex="-1"></a>df.un <span class="sc">%&gt;%</span> </span>
<span id="cb1408-6"><a href="model-assumptions.html#cb1408-6" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">5</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1408-7"><a href="model-assumptions.html#cb1408-7" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">digits =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1408-8"><a href="model-assumptions.html#cb1408-8" tabindex="-1"></a>  <span class="fu">kable_styling</span>()</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
region
</th>
<th style="text-align:left;">
group
</th>
<th style="text-align:right;">
fertility
</th>
<th style="text-align:right;">
ppgdp
</th>
<th style="text-align:right;">
life_exp_f
</th>
<th style="text-align:right;">
pct_urban
</th>
<th style="text-align:right;">
infant_mortality
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Afghanistan
</td>
<td style="text-align:left;">
Asia
</td>
<td style="text-align:left;">
other
</td>
<td style="text-align:right;">
5.97
</td>
<td style="text-align:right;">
499.0
</td>
<td style="text-align:right;">
49.49
</td>
<td style="text-align:right;">
23
</td>
<td style="text-align:right;">
124.53
</td>
</tr>
<tr>
<td style="text-align:left;">
Albania
</td>
<td style="text-align:left;">
Europe
</td>
<td style="text-align:left;">
other
</td>
<td style="text-align:right;">
1.52
</td>
<td style="text-align:right;">
3677.2
</td>
<td style="text-align:right;">
80.40
</td>
<td style="text-align:right;">
53
</td>
<td style="text-align:right;">
16.56
</td>
</tr>
<tr>
<td style="text-align:left;">
Algeria
</td>
<td style="text-align:left;">
Africa
</td>
<td style="text-align:left;">
africa
</td>
<td style="text-align:right;">
2.14
</td>
<td style="text-align:right;">
4473.0
</td>
<td style="text-align:right;">
75.00
</td>
<td style="text-align:right;">
67
</td>
<td style="text-align:right;">
21.46
</td>
</tr>
<tr>
<td style="text-align:left;">
Angola
</td>
<td style="text-align:left;">
Africa
</td>
<td style="text-align:left;">
africa
</td>
<td style="text-align:right;">
5.14
</td>
<td style="text-align:right;">
4321.9
</td>
<td style="text-align:right;">
53.17
</td>
<td style="text-align:right;">
59
</td>
<td style="text-align:right;">
96.19
</td>
</tr>
<tr>
<td style="text-align:left;">
Argentina
</td>
<td style="text-align:left;">
Latin Amer
</td>
<td style="text-align:left;">
other
</td>
<td style="text-align:right;">
2.17
</td>
<td style="text-align:right;">
9162.1
</td>
<td style="text-align:right;">
79.89
</td>
<td style="text-align:right;">
93
</td>
<td style="text-align:right;">
12.34
</td>
</tr>
</tbody>
</table>
<p>The linear model fit (blue) versus the “loess” (local regression) fit (red).</p>
<div class="sourceCode" id="cb1409"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1409-1"><a href="model-assumptions.html#cb1409-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df.un,</span>
<span id="cb1409-2"><a href="model-assumptions.html#cb1409-2" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> ppgdp,</span>
<span id="cb1409-3"><a href="model-assumptions.html#cb1409-3" tabindex="-1"></a>                     <span class="at">y =</span> infant_mortality)) <span class="sc">+</span> </span>
<span id="cb1409-4"><a href="model-assumptions.html#cb1409-4" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb1409-5"><a href="model-assumptions.html#cb1409-5" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>,</span>
<span id="cb1409-6"><a href="model-assumptions.html#cb1409-6" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">color =</span> <span class="st">&quot;lm&quot;</span>),</span>
<span id="cb1409-7"><a href="model-assumptions.html#cb1409-7" tabindex="-1"></a>              <span class="at">fill =</span> <span class="st">&quot;blue&quot;</span>,</span>
<span id="cb1409-8"><a href="model-assumptions.html#cb1409-8" tabindex="-1"></a>              <span class="at">alpha =</span> <span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb1409-9"><a href="model-assumptions.html#cb1409-9" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="st">&quot;loess&quot;</span>),</span>
<span id="cb1409-10"><a href="model-assumptions.html#cb1409-10" tabindex="-1"></a>              <span class="at">fill =</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb1409-11"><a href="model-assumptions.html#cb1409-11" tabindex="-1"></a>              <span class="at">alpha =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb1409-12"><a href="model-assumptions.html#cb1409-12" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>)) <span class="sc">+</span></span>
<span id="cb1409-13"><a href="model-assumptions.html#cb1409-13" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb1409-14"><a href="model-assumptions.html#cb1409-14" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb1409-15"><a href="model-assumptions.html#cb1409-15" tabindex="-1"></a>        <span class="at">legend.justification =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb1409-16"><a href="model-assumptions.html#cb1409-16" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">fill =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>)),</span>
<span id="cb1409-17"><a href="model-assumptions.html#cb1409-17" tabindex="-1"></a>                              <span class="at">reverse =</span> T))</span></code></pre></div>
<p><img src="25-assumptions_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
<p>Densities of the untransformed and log-transformed variables.</p>
<div class="sourceCode" id="cb1410"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1410-1"><a href="model-assumptions.html#cb1410-1" tabindex="-1"></a>p1 <span class="ot">=</span> <span class="fu">ggplot</span>(<span class="at">data =</span> df.un,</span>
<span id="cb1410-2"><a href="model-assumptions.html#cb1410-2" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> infant_mortality)) <span class="sc">+</span> </span>
<span id="cb1410-3"><a href="model-assumptions.html#cb1410-3" tabindex="-1"></a>  <span class="fu">geom_density</span>()</span>
<span id="cb1410-4"><a href="model-assumptions.html#cb1410-4" tabindex="-1"></a></span>
<span id="cb1410-5"><a href="model-assumptions.html#cb1410-5" tabindex="-1"></a><span class="co"># log transformed </span></span>
<span id="cb1410-6"><a href="model-assumptions.html#cb1410-6" tabindex="-1"></a>p2 <span class="ot">=</span> <span class="fu">ggplot</span>(<span class="at">data =</span> df.un,</span>
<span id="cb1410-7"><a href="model-assumptions.html#cb1410-7" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">log</span>(infant_mortality))) <span class="sc">+</span> </span>
<span id="cb1410-8"><a href="model-assumptions.html#cb1410-8" tabindex="-1"></a>  <span class="fu">geom_density</span>()</span>
<span id="cb1410-9"><a href="model-assumptions.html#cb1410-9" tabindex="-1"></a></span>
<span id="cb1410-10"><a href="model-assumptions.html#cb1410-10" tabindex="-1"></a>p3 <span class="ot">=</span> <span class="fu">ggplot</span>(<span class="at">data =</span> df.un,</span>
<span id="cb1410-11"><a href="model-assumptions.html#cb1410-11" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> ppgdp)) <span class="sc">+</span> </span>
<span id="cb1410-12"><a href="model-assumptions.html#cb1410-12" tabindex="-1"></a>  <span class="fu">geom_density</span>()</span>
<span id="cb1410-13"><a href="model-assumptions.html#cb1410-13" tabindex="-1"></a></span>
<span id="cb1410-14"><a href="model-assumptions.html#cb1410-14" tabindex="-1"></a><span class="co"># log transformed </span></span>
<span id="cb1410-15"><a href="model-assumptions.html#cb1410-15" tabindex="-1"></a>p4 <span class="ot">=</span> <span class="fu">ggplot</span>(<span class="at">data =</span> df.un,</span>
<span id="cb1410-16"><a href="model-assumptions.html#cb1410-16" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">log</span>(ppgdp))) <span class="sc">+</span> </span>
<span id="cb1410-17"><a href="model-assumptions.html#cb1410-17" tabindex="-1"></a>  <span class="fu">geom_density</span>()</span>
<span id="cb1410-18"><a href="model-assumptions.html#cb1410-18" tabindex="-1"></a></span>
<span id="cb1410-19"><a href="model-assumptions.html#cb1410-19" tabindex="-1"></a>p1 <span class="sc">+</span> p2 <span class="sc">+</span> p3 <span class="sc">+</span> p4 <span class="sc">+</span> </span>
<span id="cb1410-20"><a href="model-assumptions.html#cb1410-20" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">nrow =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="25-assumptions_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
<p>Fitting different models with / without transformations.</p>
<div class="sourceCode" id="cb1411"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1411-1"><a href="model-assumptions.html#cb1411-1" tabindex="-1"></a>fit.mortality1 <span class="ot">=</span> <span class="fu">lm</span>(<span class="at">formula =</span> infant_mortality <span class="sc">~</span> ppgdp,</span>
<span id="cb1411-2"><a href="model-assumptions.html#cb1411-2" tabindex="-1"></a>                   <span class="at">data =</span> df.un)</span>
<span id="cb1411-3"><a href="model-assumptions.html#cb1411-3" tabindex="-1"></a></span>
<span id="cb1411-4"><a href="model-assumptions.html#cb1411-4" tabindex="-1"></a>fit.mortality2 <span class="ot">=</span> <span class="fu">lm</span>(<span class="at">formula =</span> <span class="fu">log</span>(infant_mortality) <span class="sc">~</span> <span class="fu">log</span>(ppgdp),</span>
<span id="cb1411-5"><a href="model-assumptions.html#cb1411-5" tabindex="-1"></a>                   <span class="at">data =</span> df.un)</span>
<span id="cb1411-6"><a href="model-assumptions.html#cb1411-6" tabindex="-1"></a></span>
<span id="cb1411-7"><a href="model-assumptions.html#cb1411-7" tabindex="-1"></a>fit.mortality3 <span class="ot">=</span> <span class="fu">lm</span>(<span class="at">formula =</span> <span class="fu">log</span>(infant_mortality) <span class="sc">~</span> ppgdp,</span>
<span id="cb1411-8"><a href="model-assumptions.html#cb1411-8" tabindex="-1"></a>                   <span class="at">data =</span> df.un)</span>
<span id="cb1411-9"><a href="model-assumptions.html#cb1411-9" tabindex="-1"></a></span>
<span id="cb1411-10"><a href="model-assumptions.html#cb1411-10" tabindex="-1"></a>fit.mortality4 <span class="ot">=</span> <span class="fu">lm</span>(<span class="at">formula =</span> infant_mortality <span class="sc">~</span> <span class="fu">log</span>(ppgdp),</span>
<span id="cb1411-11"><a href="model-assumptions.html#cb1411-11" tabindex="-1"></a>                   <span class="at">data =</span> df.un)</span>
<span id="cb1411-12"><a href="model-assumptions.html#cb1411-12" tabindex="-1"></a></span>
<span id="cb1411-13"><a href="model-assumptions.html#cb1411-13" tabindex="-1"></a><span class="fu">summary</span>(fit.mortality1)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = infant_mortality ~ ppgdp, data = df.un)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -31.48 -18.65  -8.59  10.86  83.59 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 41.3780016  2.2157454  18.675  &lt; 2e-16 ***
## ppgdp       -0.0008656  0.0001041  -8.312 1.73e-14 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 25.13 on 191 degrees of freedom
## Multiple R-squared:  0.2656, Adjusted R-squared:  0.2618 
## F-statistic: 69.08 on 1 and 191 DF,  p-value: 1.73e-14</code></pre>
<div class="sourceCode" id="cb1413"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1413-1"><a href="model-assumptions.html#cb1413-1" tabindex="-1"></a><span class="fu">summary</span>(fit.mortality2)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = log(infant_mortality) ~ log(ppgdp), data = df.un)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1.16789 -0.36738 -0.02351  0.24544  2.43503 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  8.10377    0.21087   38.43   &lt;2e-16 ***
## log(ppgdp)  -0.61680    0.02465  -25.02   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.5281 on 191 degrees of freedom
## Multiple R-squared:  0.7662, Adjusted R-squared:  0.765 
## F-statistic: 625.9 on 1 and 191 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb1415"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1415-1"><a href="model-assumptions.html#cb1415-1" tabindex="-1"></a><span class="fu">summary</span>(fit.mortality3)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = log(infant_mortality) ~ ppgdp, data = df.un)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1.61611 -0.48094 -0.07858  0.53930  2.17745 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  3.479e+00  6.537e-02   53.23   &lt;2e-16 ***
## ppgdp       -4.595e-05  3.072e-06  -14.96   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.7413 on 191 degrees of freedom
## Multiple R-squared:  0.5394, Adjusted R-squared:  0.537 
## F-statistic: 223.7 on 1 and 191 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb1417"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1417-1"><a href="model-assumptions.html#cb1417-1" tabindex="-1"></a><span class="fu">summary</span>(fit.mortality4)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = infant_mortality ~ log(ppgdp), data = df.un)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -38.239 -11.609  -2.829   8.122  82.183 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 155.7698     7.2431   21.51   &lt;2e-16 ***
## log(ppgdp)  -14.8617     0.8468  -17.55   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 18.14 on 191 degrees of freedom
## Multiple R-squared:  0.6172, Adjusted R-squared:  0.6152 
## F-statistic:   308 on 1 and 191 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>Diagnostics plots for the model without transformed variables.</p>
<div class="sourceCode" id="cb1419"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1419-1"><a href="model-assumptions.html#cb1419-1" tabindex="-1"></a>fit.mortality1 <span class="sc">%&gt;%</span> </span>
<span id="cb1419-2"><a href="model-assumptions.html#cb1419-2" tabindex="-1"></a>  <span class="fu">plot</span>()</span></code></pre></div>
<p><img src="25-assumptions_files/figure-html/unnamed-chunk-23-1.png" width="672" /><img src="25-assumptions_files/figure-html/unnamed-chunk-23-2.png" width="672" /><img src="25-assumptions_files/figure-html/unnamed-chunk-23-3.png" width="672" /><img src="25-assumptions_files/figure-html/unnamed-chunk-23-4.png" width="672" /></p>
<p>Residual plot using ggplot.</p>
<div class="sourceCode" id="cb1420"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1420-1"><a href="model-assumptions.html#cb1420-1" tabindex="-1"></a>fit.mortality1 <span class="sc">%&gt;%</span> </span>
<span id="cb1420-2"><a href="model-assumptions.html#cb1420-2" tabindex="-1"></a>  <span class="fu">augment</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1420-3"><a href="model-assumptions.html#cb1420-3" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1420-4"><a href="model-assumptions.html#cb1420-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> .,</span>
<span id="cb1420-5"><a href="model-assumptions.html#cb1420-5" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> fitted,</span>
<span id="cb1420-6"><a href="model-assumptions.html#cb1420-6" tabindex="-1"></a>                       <span class="at">y =</span> resid)) <span class="sc">+</span> </span>
<span id="cb1420-7"><a href="model-assumptions.html#cb1420-7" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, </span>
<span id="cb1420-8"><a href="model-assumptions.html#cb1420-8" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb1420-9"><a href="model-assumptions.html#cb1420-9" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb1420-10"><a href="model-assumptions.html#cb1420-10" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">color =</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb1420-11"><a href="model-assumptions.html#cb1420-11" tabindex="-1"></a>              <span class="at">se =</span> F)</span></code></pre></div>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39; and formula = &#39;y ~ x&#39;</code></pre>
<p><img src="25-assumptions_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
<p>Diagnostic plots for the log-log transformed model.</p>
<div class="sourceCode" id="cb1422"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1422-1"><a href="model-assumptions.html#cb1422-1" tabindex="-1"></a>fit.mortality2 <span class="sc">%&gt;%</span> </span>
<span id="cb1422-2"><a href="model-assumptions.html#cb1422-2" tabindex="-1"></a>  <span class="fu">plot</span>()</span></code></pre></div>
<p><img src="25-assumptions_files/figure-html/unnamed-chunk-25-1.png" width="672" /><img src="25-assumptions_files/figure-html/unnamed-chunk-25-2.png" width="672" /><img src="25-assumptions_files/figure-html/unnamed-chunk-25-3.png" width="672" /><img src="25-assumptions_files/figure-html/unnamed-chunk-25-4.png" width="672" /></p>
<p>Model fit.</p>
<div class="sourceCode" id="cb1423"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1423-1"><a href="model-assumptions.html#cb1423-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df.un,</span>
<span id="cb1423-2"><a href="model-assumptions.html#cb1423-2" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">log</span>(ppgdp),</span>
<span id="cb1423-3"><a href="model-assumptions.html#cb1423-3" tabindex="-1"></a>                     <span class="at">y =</span> <span class="fu">log</span>(infant_mortality))) <span class="sc">+</span> </span>
<span id="cb1423-4"><a href="model-assumptions.html#cb1423-4" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb1423-5"><a href="model-assumptions.html#cb1423-5" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>,</span>
<span id="cb1423-6"><a href="model-assumptions.html#cb1423-6" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>,</span>
<span id="cb1423-7"><a href="model-assumptions.html#cb1423-7" tabindex="-1"></a>              <span class="at">fill =</span> <span class="st">&quot;blue&quot;</span>,</span>
<span id="cb1423-8"><a href="model-assumptions.html#cb1423-8" tabindex="-1"></a>              <span class="at">alpha =</span> <span class="fl">0.1</span>)</span></code></pre></div>
<p><img src="25-assumptions_files/figure-html/unnamed-chunk-26-1.png" width="672" /></p>
<p>Illustration of the model predictions in the original scale.</p>
<div class="sourceCode" id="cb1424"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1424-1"><a href="model-assumptions.html#cb1424-1" tabindex="-1"></a>fit.mortality2 <span class="sc">%&gt;%</span> </span>
<span id="cb1424-2"><a href="model-assumptions.html#cb1424-2" tabindex="-1"></a>  <span class="fu">ggpredict</span>(<span class="at">terms =</span> <span class="st">&quot;ppgdp&quot;</span>)</span></code></pre></div>
<pre><code>## Model has log-transformed response. Back-transforming predictions to
##   original response scale. Standard errors are still on the log-scale.</code></pre>
<pre><code>## # Predicted values of infant_mortality
## 
##  ppgdp | Predicted |       95% CI
## ---------------------------------
##      0 |       Inf |             
##  15000 |      8.78 | [7.99, 9.66]
##  25000 |      6.41 | [5.73, 7.17]
##  40000 |      4.80 | [4.21, 5.46]
##  55000 |      3.94 | [3.42, 4.55]
##  70000 |      3.40 | [2.91, 3.96]
##  85000 |      3.01 | [2.56, 3.54]
## 110000 |      2.57 | [2.16, 3.05]</code></pre>
<pre><code>## 
## Not all rows are shown in the output. Use `print(..., n = Inf)` to show
##   all rows.</code></pre>
<div class="sourceCode" id="cb1428"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1428-1"><a href="model-assumptions.html#cb1428-1" tabindex="-1"></a>fit.mortality2 <span class="sc">%&gt;%</span> </span>
<span id="cb1428-2"><a href="model-assumptions.html#cb1428-2" tabindex="-1"></a>  <span class="fu">ggpredict</span>(<span class="at">terms =</span> <span class="st">&quot;ppgdp [exp]&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1428-3"><a href="model-assumptions.html#cb1428-3" tabindex="-1"></a>  <span class="fu">plot</span>()</span></code></pre></div>
<pre><code>## Model has log-transformed response. Back-transforming predictions to
##   original response scale. Standard errors are still on the log-scale.</code></pre>
<p><img src="25-assumptions_files/figure-html/unnamed-chunk-27-1.png" width="672" /></p>
<p>Model predictions for models with multiple predictors.</p>
<div class="sourceCode" id="cb1430"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1430-1"><a href="model-assumptions.html#cb1430-1" tabindex="-1"></a><span class="co"># with log transforms </span></span>
<span id="cb1430-2"><a href="model-assumptions.html#cb1430-2" tabindex="-1"></a>fit.mortality5 <span class="ot">=</span> <span class="fu">lm</span>(<span class="at">formula =</span> <span class="fu">log</span>(infant_mortality) <span class="sc">~</span> <span class="fu">log</span>(ppgdp) <span class="sc">+</span> group,</span>
<span id="cb1430-3"><a href="model-assumptions.html#cb1430-3" tabindex="-1"></a>                   <span class="at">data =</span> df.un)</span>
<span id="cb1430-4"><a href="model-assumptions.html#cb1430-4" tabindex="-1"></a></span>
<span id="cb1430-5"><a href="model-assumptions.html#cb1430-5" tabindex="-1"></a><span class="co"># without log transforms </span></span>
<span id="cb1430-6"><a href="model-assumptions.html#cb1430-6" tabindex="-1"></a>fit.mortality6 <span class="ot">=</span> <span class="fu">lm</span>(<span class="at">formula =</span> infant_mortality <span class="sc">~</span> ppgdp <span class="sc">+</span> group,</span>
<span id="cb1430-7"><a href="model-assumptions.html#cb1430-7" tabindex="-1"></a>                   <span class="at">data =</span> df.un)</span>
<span id="cb1430-8"><a href="model-assumptions.html#cb1430-8" tabindex="-1"></a></span>
<span id="cb1430-9"><a href="model-assumptions.html#cb1430-9" tabindex="-1"></a>p1 <span class="ot">=</span> <span class="fu">ggpredict</span>(fit.mortality5,</span>
<span id="cb1430-10"><a href="model-assumptions.html#cb1430-10" tabindex="-1"></a>          <span class="at">terms =</span> <span class="fu">c</span>(<span class="st">&quot;ppgdp [exp]&quot;</span>, <span class="st">&quot;group&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1430-11"><a href="model-assumptions.html#cb1430-11" tabindex="-1"></a>  <span class="fu">plot</span>() <span class="sc">+</span> </span>
<span id="cb1430-12"><a href="model-assumptions.html#cb1430-12" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Prediction with log transform&quot;</span>) <span class="sc">+</span></span>
<span id="cb1430-13"><a href="model-assumptions.html#cb1430-13" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">20000</span>))</span>
<span id="cb1430-14"><a href="model-assumptions.html#cb1430-14" tabindex="-1"></a></span>
<span id="cb1430-15"><a href="model-assumptions.html#cb1430-15" tabindex="-1"></a>p2 <span class="ot">=</span> <span class="fu">ggpredict</span>(fit.mortality6,</span>
<span id="cb1430-16"><a href="model-assumptions.html#cb1430-16" tabindex="-1"></a>          <span class="at">terms =</span> <span class="fu">c</span>(<span class="st">&quot;ppgdp&quot;</span>, <span class="st">&quot;group&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1430-17"><a href="model-assumptions.html#cb1430-17" tabindex="-1"></a>  <span class="fu">plot</span>() <span class="sc">+</span> </span>
<span id="cb1430-18"><a href="model-assumptions.html#cb1430-18" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Prediction without log transform&quot;</span>) <span class="sc">+</span></span>
<span id="cb1430-19"><a href="model-assumptions.html#cb1430-19" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">20000</span>))</span>
<span id="cb1430-20"><a href="model-assumptions.html#cb1430-20" tabindex="-1"></a></span>
<span id="cb1430-21"><a href="model-assumptions.html#cb1430-21" tabindex="-1"></a>p1 <span class="sc">+</span> p2</span></code></pre></div>
<p><img src="25-assumptions_files/figure-html/unnamed-chunk-28-1.png" width="672" /></p>
</div>
</div>
</div>
<div id="non-parametric-tests" class="section level3 hasAnchor" number="20.3.4">
<h3><span class="header-section-number">20.3.4</span> Non-parametric tests<a href="model-assumptions.html#non-parametric-tests" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="mann-whitney" class="section level4 hasAnchor" number="20.3.4.1">
<h4><span class="header-section-number">20.3.4.1</span> Mann-Whitney<a href="model-assumptions.html#mann-whitney" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb1431"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1431-1"><a href="model-assumptions.html#cb1431-1" tabindex="-1"></a>df.ttest <span class="ot">=</span> <span class="fu">tibble</span>(<span class="at">group1 =</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">20</span>, <span class="at">mean =</span> <span class="dv">10</span>, <span class="at">sd =</span> <span class="dv">1</span>),</span>
<span id="cb1431-2"><a href="model-assumptions.html#cb1431-2" tabindex="-1"></a>                  <span class="at">group2 =</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">20</span>, <span class="at">mean =</span> <span class="dv">8</span>, <span class="at">sd =</span> <span class="dv">3</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1431-3"><a href="model-assumptions.html#cb1431-3" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">everything</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb1431-4"><a href="model-assumptions.html#cb1431-4" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">participant =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>())</span></code></pre></div>
<div class="sourceCode" id="cb1432"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1432-1"><a href="model-assumptions.html#cb1432-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df.ttest,</span>
<span id="cb1432-2"><a href="model-assumptions.html#cb1432-2" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> name,</span>
<span id="cb1432-3"><a href="model-assumptions.html#cb1432-3" tabindex="-1"></a>                     <span class="at">y =</span> value)) <span class="sc">+</span> </span>
<span id="cb1432-4"><a href="model-assumptions.html#cb1432-4" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>,</span>
<span id="cb1432-5"><a href="model-assumptions.html#cb1432-5" tabindex="-1"></a>             <span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="at">width =</span> <span class="fl">0.1</span>)) <span class="sc">+</span> </span>
<span id="cb1432-6"><a href="model-assumptions.html#cb1432-6" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> <span class="st">&quot;mean_cl_boot&quot;</span>)</span></code></pre></div>
<p><img src="25-assumptions_files/figure-html/unnamed-chunk-30-1.png" width="672" /></p>
<div class="sourceCode" id="cb1433"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1433-1"><a href="model-assumptions.html#cb1433-1" tabindex="-1"></a><span class="fu">t.test</span>(<span class="at">formula =</span> value <span class="sc">~</span> name,</span>
<span id="cb1433-2"><a href="model-assumptions.html#cb1433-2" tabindex="-1"></a>       <span class="at">data =</span> df.ttest)</span></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  value by name
## t = 3.3, df = 22.304, p-value = 0.003221
## alternative hypothesis: true difference in means between group group1 and group group2 is not equal to 0
## 95 percent confidence interval:
##  0.8300203 3.6319540
## sample estimates:
## mean in group group1 mean in group group2 
##            10.035302             7.804315</code></pre>
<div class="sourceCode" id="cb1435"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1435-1"><a href="model-assumptions.html#cb1435-1" tabindex="-1"></a><span class="fu">wilcox.test</span>(<span class="at">formula =</span> value <span class="sc">~</span> name,</span>
<span id="cb1435-2"><a href="model-assumptions.html#cb1435-2" tabindex="-1"></a>            <span class="at">data =</span> df.ttest)</span></code></pre></div>
<pre><code>## 
##  Wilcoxon rank sum exact test
## 
## data:  value by name
## W = 287, p-value = 0.01809
## alternative hypothesis: true location shift is not equal to 0</code></pre>
</div>
</div>
<div id="bootstrapping-regressions" class="section level3 hasAnchor" number="20.3.5">
<h3><span class="header-section-number">20.3.5</span> Bootstrapping regressions<a href="model-assumptions.html#bootstrapping-regressions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This section is based on this post <a href="https://ademos.people.uic.edu/Chapter12.html#4_what_about_a_more_problematic_example">here</a>.</p>
<div class="sourceCode" id="cb1437"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1437-1"><a href="model-assumptions.html#cb1437-1" tabindex="-1"></a><span class="co"># make reproducible</span></span>
<span id="cb1437-2"><a href="model-assumptions.html#cb1437-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb1437-3"><a href="model-assumptions.html#cb1437-3" tabindex="-1"></a></span>
<span id="cb1437-4"><a href="model-assumptions.html#cb1437-4" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">250</span> </span>
<span id="cb1437-5"><a href="model-assumptions.html#cb1437-5" tabindex="-1"></a>df.turkey <span class="ot">=</span> <span class="fu">tibble</span>(<span class="at">turkey_time =</span> <span class="fu">runif</span>(<span class="at">n =</span> n, <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="dv">50</span>),</span>
<span id="cb1437-6"><a href="model-assumptions.html#cb1437-6" tabindex="-1"></a>                   <span class="at">nap_time =</span> <span class="dv">500</span> <span class="sc">+</span> turkey_time <span class="sc">^</span> <span class="dv">2</span> <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">sd =</span> <span class="dv">16</span>))</span></code></pre></div>
<p>Visualize the data</p>
<div class="sourceCode" id="cb1438"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1438-1"><a href="model-assumptions.html#cb1438-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df.turkey, </span>
<span id="cb1438-2"><a href="model-assumptions.html#cb1438-2" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> turkey_time,</span>
<span id="cb1438-3"><a href="model-assumptions.html#cb1438-3" tabindex="-1"></a>                     <span class="at">y =</span> nap_time)) <span class="sc">+</span> </span>
<span id="cb1438-4"><a href="model-assumptions.html#cb1438-4" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>) <span class="sc">+</span></span>
<span id="cb1438-5"><a href="model-assumptions.html#cb1438-5" tabindex="-1"></a>  <span class="fu">geom_point</span>()  </span></code></pre></div>
<p><img src="25-assumptions_files/figure-html/unnamed-chunk-34-1.png" width="672" /></p>
<p>A simple linear regression doesn’t fit the data well (not suprising since we included a squared predictor).</p>
<p>Let’s fit a simple linear model and print out the model summary.</p>
<div class="sourceCode" id="cb1439"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1439-1"><a href="model-assumptions.html#cb1439-1" tabindex="-1"></a>fit.turkey <span class="ot">=</span> <span class="fu">lm</span>(<span class="at">formula =</span> nap_time <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> turkey_time,</span>
<span id="cb1439-2"><a href="model-assumptions.html#cb1439-2" tabindex="-1"></a>                <span class="at">data =</span> df.turkey)</span>
<span id="cb1439-3"><a href="model-assumptions.html#cb1439-3" tabindex="-1"></a></span>
<span id="cb1439-4"><a href="model-assumptions.html#cb1439-4" tabindex="-1"></a><span class="fu">summary</span>(fit.turkey)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = nap_time ~ 1 + turkey_time, data = df.turkey)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -212.82 -146.78  -55.17  125.74  462.52 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  15.4974    23.3827   0.663    0.508    
## turkey_time  51.5746     0.8115  63.557   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 172.4 on 248 degrees of freedom
## Multiple R-squared:  0.9422, Adjusted R-squared:  0.9419 
## F-statistic:  4039 on 1 and 248 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>A regression with a squared predictor would fit well.</p>
<div class="sourceCode" id="cb1441"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1441-1"><a href="model-assumptions.html#cb1441-1" tabindex="-1"></a>fit.turkey2 <span class="ot">=</span> <span class="fu">lm</span>(<span class="at">formula =</span> nap_time <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> <span class="fu">I</span>(turkey_time <span class="sc">^</span> <span class="dv">2</span>),</span>
<span id="cb1441-2"><a href="model-assumptions.html#cb1441-2" tabindex="-1"></a>                <span class="at">data =</span> df.turkey)</span>
<span id="cb1441-3"><a href="model-assumptions.html#cb1441-3" tabindex="-1"></a></span>
<span id="cb1441-4"><a href="model-assumptions.html#cb1441-4" tabindex="-1"></a><span class="fu">summary</span>(fit.turkey2)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = nap_time ~ 1 + I(turkey_time^2), data = df.turkey)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -45.611  -9.911  -0.652  11.137  43.008 
## 
## Coefficients:
##                   Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)      4.994e+02  1.575e+00   317.0   &lt;2e-16 ***
## I(turkey_time^2) 1.001e+00  1.439e-03   695.3   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 16.23 on 248 degrees of freedom
## Multiple R-squared:  0.9995, Adjusted R-squared:  0.9995 
## F-statistic: 4.835e+05 on 1 and 248 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb1443"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1443-1"><a href="model-assumptions.html#cb1443-1" tabindex="-1"></a>fit.turkey2 <span class="sc">%&gt;%</span> </span>
<span id="cb1443-2"><a href="model-assumptions.html#cb1443-2" tabindex="-1"></a>  <span class="fu">augment</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1443-3"><a href="model-assumptions.html#cb1443-3" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1443-4"><a href="model-assumptions.html#cb1443-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> ., </span>
<span id="cb1443-5"><a href="model-assumptions.html#cb1443-5" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> i_turkey_time_2,</span>
<span id="cb1443-6"><a href="model-assumptions.html#cb1443-6" tabindex="-1"></a>                     <span class="at">y =</span> nap_time)) <span class="sc">+</span> </span>
<span id="cb1443-7"><a href="model-assumptions.html#cb1443-7" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">y =</span> fitted),</span>
<span id="cb1443-8"><a href="model-assumptions.html#cb1443-8" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb1443-9"><a href="model-assumptions.html#cb1443-9" tabindex="-1"></a>  <span class="fu">geom_point</span>()  </span></code></pre></div>
<p><img src="25-assumptions_files/figure-html/unnamed-chunk-37-1.png" width="672" /></p>
<p>Let’s fit a bootstrap regression.</p>
<div class="sourceCode" id="cb1444"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1444-1"><a href="model-assumptions.html#cb1444-1" tabindex="-1"></a>boot.turkey <span class="ot">=</span> <span class="fu">Boot</span>(fit.turkey)</span>
<span id="cb1444-2"><a href="model-assumptions.html#cb1444-2" tabindex="-1"></a><span class="fu">summary</span>(boot.turkey)</span></code></pre></div>
<pre><code>## 
## Number of bootstrap replications R = 999 
##             original  bootBias bootSE bootMed
## (Intercept)   15.497 -1.130589 29.330  15.080
## turkey_time   51.575  0.023717  1.058  51.625</code></pre>
<div class="sourceCode" id="cb1446"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1446-1"><a href="model-assumptions.html#cb1446-1" tabindex="-1"></a>fit.turkey <span class="sc">%&gt;%</span> </span>
<span id="cb1446-2"><a href="model-assumptions.html#cb1446-2" tabindex="-1"></a>  <span class="fu">tidy</span>(<span class="at">conf.int =</span> T) <span class="sc">%&gt;%</span> </span>
<span id="cb1446-3"><a href="model-assumptions.html#cb1446-3" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">digits =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1446-4"><a href="model-assumptions.html#cb1446-4" tabindex="-1"></a>  <span class="fu">kable_styling</span>()</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
term
</th>
<th style="text-align:right;">
estimate
</th>
<th style="text-align:right;">
std.error
</th>
<th style="text-align:right;">
statistic
</th>
<th style="text-align:right;">
p.value
</th>
<th style="text-align:right;">
conf.low
</th>
<th style="text-align:right;">
conf.high
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
(Intercept)
</td>
<td style="text-align:right;">
15.50
</td>
<td style="text-align:right;">
23.38
</td>
<td style="text-align:right;">
0.66
</td>
<td style="text-align:right;">
0.51
</td>
<td style="text-align:right;">
-30.56
</td>
<td style="text-align:right;">
61.55
</td>
</tr>
<tr>
<td style="text-align:left;">
turkey_time
</td>
<td style="text-align:right;">
51.57
</td>
<td style="text-align:right;">
0.81
</td>
<td style="text-align:right;">
63.56
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
49.98
</td>
<td style="text-align:right;">
53.17
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb1447"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1447-1"><a href="model-assumptions.html#cb1447-1" tabindex="-1"></a>boot.turkey <span class="sc">%&gt;%</span> </span>
<span id="cb1447-2"><a href="model-assumptions.html#cb1447-2" tabindex="-1"></a>  <span class="fu">tidy</span>(<span class="at">conf.int =</span> T) <span class="sc">%&gt;%</span> </span>
<span id="cb1447-3"><a href="model-assumptions.html#cb1447-3" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">digits =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1447-4"><a href="model-assumptions.html#cb1447-4" tabindex="-1"></a>  <span class="fu">kable_styling</span>()</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
term
</th>
<th style="text-align:right;">
statistic
</th>
<th style="text-align:right;">
bias
</th>
<th style="text-align:right;">
std.error
</th>
<th style="text-align:right;">
conf.low
</th>
<th style="text-align:right;">
conf.high
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
(Intercept)
</td>
<td style="text-align:right;">
15.50
</td>
<td style="text-align:right;">
-1.13
</td>
<td style="text-align:right;">
29.33
</td>
<td style="text-align:right;">
-47.64
</td>
<td style="text-align:right;">
71.64
</td>
</tr>
<tr>
<td style="text-align:left;">
turkey_time
</td>
<td style="text-align:right;">
51.57
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
1.06
</td>
<td style="text-align:right;">
49.35
</td>
<td style="text-align:right;">
53.61
</td>
</tr>
</tbody>
</table>
<p>We see that the confidence intervals using the bootstrap method are wider than the ones that use the linear regression model (particularly for the intercept).</p>
</div>
</div>
<div id="additional-resources-14" class="section level2 hasAnchor" number="20.4">
<h2><span class="header-section-number">20.4</span> Additional resources<a href="model-assumptions.html#additional-resources-14" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li><a href="http://r-statistics.co-Linear-Regression.html">Assumptions of a linear regression</a></li>
</ul>
</div>
<div id="session-info-17" class="section level2 hasAnchor" number="20.5">
<h2><span class="header-section-number">20.5</span> Session info<a href="model-assumptions.html#session-info-17" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Information about this R session including which version of R was used, and what packages were loaded.</p>
<div class="sourceCode" id="cb1448"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1448-1"><a href="model-assumptions.html#cb1448-1" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span></code></pre></div>
<pre><code>## R version 4.3.0 (2023-04-21)
## Platform: aarch64-apple-darwin20 (64-bit)
## Running under: macOS 14.1.1
## 
## Matrix products: default
## BLAS:   /Library/Frameworks/R.framework/Versions/4.3-arm64/Resources/lib/libRblas.0.dylib 
## LAPACK: /Library/Frameworks/R.framework/Versions/4.3-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.11.0
## 
## locale:
## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
## 
## time zone: America/Chicago
## tzcode source: internal
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
##  [1] lubridate_1.9.2  forcats_1.0.0    stringr_1.5.0    dplyr_1.1.4     
##  [5] purrr_1.0.2      readr_2.1.4      tidyr_1.3.0      tibble_3.2.1    
##  [9] tidyverse_2.0.0  ggrepel_0.9.4    ggplot2_3.4.4    xtable_1.8-4    
## [13] sjPlot_2.8.15    stargazer_5.2.3  ggeffects_1.3.4  patchwork_1.1.3 
## [17] janitor_2.2.0    broom_1.0.5      car_3.1-2        carData_3.0-5   
## [21] brms_2.20.1      Rcpp_1.0.10      lme4_1.1-35.1    Matrix_1.6-4    
## [25] tidybayes_3.0.6  kableExtra_1.3.4 knitr_1.42      
## 
## loaded via a namespace (and not attached):
##   [1] svUnit_1.0.6         shinythemes_1.2.0    splines_4.3.0       
##   [4] later_1.3.1          datawizard_0.9.1     rpart_4.1.19        
##   [7] xts_0.13.1           lifecycle_1.0.3      StanHeaders_2.26.28 
##  [10] processx_3.8.1       lattice_0.21-8       vroom_1.6.3         
##  [13] MASS_7.3-58.4        insight_0.19.7       crosstalk_1.2.0     
##  [16] ggdist_3.3.0         backports_1.4.1      magrittr_2.0.3      
##  [19] Hmisc_5.1-1          sass_0.4.6           rmarkdown_2.21      
##  [22] jquerylib_0.1.4      yaml_2.3.7           httpuv_1.6.11       
##  [25] pkgbuild_1.4.2       minqa_1.2.5          abind_1.4-5         
##  [28] rvest_1.0.3          nnet_7.3-18          tensorA_0.36.2      
##  [31] inline_0.3.19        performance_0.10.8   bridgesampling_1.1-2
##  [34] svglite_2.1.1        codetools_0.2-19     DT_0.31             
##  [37] xml2_1.3.4           tidyselect_1.2.0     bayesplot_1.10.0    
##  [40] farver_2.1.1         matrixStats_1.0.0    stats4_4.3.0        
##  [43] base64enc_0.1-3      webshot_0.5.4        jsonlite_1.8.4      
##  [46] Formula_1.2-5        ellipsis_0.3.2       emmeans_1.9.0       
##  [49] systemfonts_1.0.4    tools_4.3.0          glue_1.6.2          
##  [52] gridExtra_2.3        xfun_0.39            mgcv_1.8-42         
##  [55] distributional_0.3.2 loo_2.6.0            withr_2.5.0         
##  [58] fastmap_1.1.1        boot_1.3-28.1        fansi_1.0.4         
##  [61] shinyjs_2.1.0        callr_3.7.3          digest_0.6.31       
##  [64] timechange_0.2.0     R6_2.5.1             mime_0.12           
##  [67] estimability_1.4.1   colorspace_2.1-0     gtools_3.9.4        
##  [70] markdown_1.7         threejs_0.3.3        utf8_1.2.3          
##  [73] generics_0.1.3       data.table_1.14.8    prettyunits_1.1.1   
##  [76] httr_1.4.6           htmlwidgets_1.6.2    pkgconfig_2.0.3     
##  [79] dygraphs_1.1.1.6     gtable_0.3.3         htmltools_0.5.5     
##  [82] bookdown_0.34        scales_1.3.0         posterior_1.4.1     
##  [85] snakecase_0.11.0     rstudioapi_0.14      tzdb_0.4.0          
##  [88] reshape2_1.4.4       coda_0.19-4          checkmate_2.2.0     
##  [91] nlme_3.1-162         curl_5.0.1           nloptr_2.0.3        
##  [94] cachem_1.0.8         zoo_1.8-12           sjlabelled_1.2.0    
##  [97] parallel_4.3.0       miniUI_0.1.1.1       foreign_0.8-84      
## [100] pillar_1.9.0         grid_4.3.0           vctrs_0.6.5         
## [103] shinystan_2.6.0      promises_1.2.1       arrayhelpers_1.1-0  
## [106] cluster_2.1.4        htmlTable_2.4.2      evaluate_0.21       
## [109] mvtnorm_1.2-3        cli_3.6.1            compiler_4.3.0      
## [112] rlang_1.1.1          crayon_1.5.2         rstantools_2.3.1.1  
## [115] modelr_0.1.11        labeling_0.4.2       ps_1.7.5            
## [118] plyr_1.8.8           sjmisc_2.8.9         stringi_1.7.12      
## [121] rstan_2.32.3         viridisLite_0.4.2    QuickJSR_1.0.9      
## [124] munsell_0.5.0        colourpicker_1.3.0   Brobdingnag_1.2-9   
## [127] bayestestR_0.13.1    V8_4.4.1             sjstats_0.18.2      
## [130] hms_1.1.3            bit64_4.0.5          shiny_1.7.5         
## [133] highr_0.10           haven_2.5.2          igraph_1.5.1        
## [136] RcppParallel_5.1.7   bslib_0.4.2          bit_4.0.5</code></pre>

</div>
</div>
<h3>References<a href="references-1.html#references-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-fox2018r" class="csl-entry">
Fox, John, and Sanford Weisberg. 2018. <em>An r Companion to Applied Regression</em>. Sage publications.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="appendix-b-data-wrangling.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="reporting-statistics.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"],
"google": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/psych252/psych252book/edit/master/25-assumptions.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": false,
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"toc_depth": 3
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
