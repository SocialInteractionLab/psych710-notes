<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 7 Simulation 1 | Psych 252: Statistical Methods for Behavioral and Social Sciences</title>
  <meta name="description" content="Course notes for Psych 252." />
  <meta name="generator" content="bookdown 0.26 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 7 Simulation 1 | Psych 252: Statistical Methods for Behavioral and Social Sciences" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Course notes for Psych 252." />
  <meta name="github-repo" content="psych252/psych252book" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 7 Simulation 1 | Psych 252: Statistical Methods for Behavioral and Social Sciences" />
  
  <meta name="twitter:description" content="Course notes for Psych 252." />
  

<meta name="author" content="Tobias Gerstenberg" />


<meta name="date" content="2022-05-08" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="probability-and-causality.html"/>
<link rel="next" href="simulation-2.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.22/datatables.js"></script>
<link href="libs/dt-core-1.11.3/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.11.3/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.11.3/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<script src="libs/viz-1.8.2/viz.js"></script>
<link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="libs/grViz-binding-1.0.9/grViz.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Psych 252</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#course-description"><i class="fa fa-check"></i>Course description</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#course-homepage"><i class="fa fa-check"></i>Course homepage</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#thanks"><i class="fa fa-check"></i><b>1.1</b> Thanks</a></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#list-of-r-packages-used-in-this-book"><i class="fa fa-check"></i><b>1.2</b> List of R packages used in this book</a></li>
<li class="chapter" data-level="1.3" data-path="introduction.html"><a href="introduction.html#installing-packages"><i class="fa fa-check"></i><b>1.3</b> Installing packages</a></li>
<li class="chapter" data-level="1.4" data-path="introduction.html"><a href="introduction.html#session-info"><i class="fa fa-check"></i><b>1.4</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="visualization-1.html"><a href="visualization-1.html"><i class="fa fa-check"></i><b>2</b> Visualization 1</a>
<ul>
<li class="chapter" data-level="2.1" data-path="visualization-1.html"><a href="visualization-1.html#learning-goals"><i class="fa fa-check"></i><b>2.1</b> Learning goals</a></li>
<li class="chapter" data-level="2.2" data-path="visualization-1.html"><a href="visualization-1.html#load-packages"><i class="fa fa-check"></i><b>2.2</b> Load packages</a></li>
<li class="chapter" data-level="2.3" data-path="visualization-1.html"><a href="visualization-1.html#why-visualize-data"><i class="fa fa-check"></i><b>2.3</b> Why visualize data?</a></li>
<li class="chapter" data-level="2.4" data-path="visualization-1.html"><a href="visualization-1.html#some-basics"><i class="fa fa-check"></i><b>2.4</b> Some basics</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="visualization-1.html"><a href="visualization-1.html#setting-up-rstudio"><i class="fa fa-check"></i><b>2.4.1</b> Setting up RStudio</a></li>
<li class="chapter" data-level="2.4.2" data-path="visualization-1.html"><a href="visualization-1.html#getting-help"><i class="fa fa-check"></i><b>2.4.2</b> Getting help</a></li>
<li class="chapter" data-level="2.4.3" data-path="visualization-1.html"><a href="visualization-1.html#r-markdown-infos"><i class="fa fa-check"></i><b>2.4.3</b> R Markdown infos</a></li>
<li class="chapter" data-level="2.4.4" data-path="visualization-1.html"><a href="visualization-1.html#helpful-keyboard-shortcuts"><i class="fa fa-check"></i><b>2.4.4</b> Helpful keyboard shortcuts</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="visualization-1.html"><a href="visualization-1.html#data-visualization"><i class="fa fa-check"></i><b>2.5</b> Data visualization</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="visualization-1.html"><a href="visualization-1.html#setting-up-a-plot"><i class="fa fa-check"></i><b>2.5.1</b> Setting up a plot</a></li>
<li class="chapter" data-level="2.5.2" data-path="visualization-1.html"><a href="visualization-1.html#bar-plot"><i class="fa fa-check"></i><b>2.5.2</b> Bar plot</a></li>
<li class="chapter" data-level="2.5.3" data-path="visualization-1.html"><a href="visualization-1.html#setting-the-default-plot-theme"><i class="fa fa-check"></i><b>2.5.3</b> Setting the default plot theme</a></li>
<li class="chapter" data-level="2.5.4" data-path="visualization-1.html"><a href="visualization-1.html#scatter-plot"><i class="fa fa-check"></i><b>2.5.4</b> Scatter plot</a></li>
<li class="chapter" data-level="2.5.5" data-path="visualization-1.html"><a href="visualization-1.html#line-plot"><i class="fa fa-check"></i><b>2.5.5</b> Line plot</a></li>
<li class="chapter" data-level="2.5.6" data-path="visualization-1.html"><a href="visualization-1.html#adding-error-bars"><i class="fa fa-check"></i><b>2.5.6</b> Adding error bars</a></li>
<li class="chapter" data-level="2.5.7" data-path="visualization-1.html"><a href="visualization-1.html#order-matters"><i class="fa fa-check"></i><b>2.5.7</b> Order matters</a></li>
<li class="chapter" data-level="2.5.8" data-path="visualization-1.html"><a href="visualization-1.html#grouping-data"><i class="fa fa-check"></i><b>2.5.8</b> Grouping data</a></li>
<li class="chapter" data-level="2.5.9" data-path="visualization-1.html"><a href="visualization-1.html#making-facets"><i class="fa fa-check"></i><b>2.5.9</b> Making facets</a></li>
<li class="chapter" data-level="2.5.10" data-path="visualization-1.html"><a href="visualization-1.html#global-local-and-setting-aes"><i class="fa fa-check"></i><b>2.5.10</b> Global, local, and setting <code>aes()</code></a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="visualization-1.html"><a href="visualization-1.html#additional-resources"><i class="fa fa-check"></i><b>2.6</b> Additional resources</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="visualization-1.html"><a href="visualization-1.html#cheatsheets"><i class="fa fa-check"></i><b>2.6.1</b> Cheatsheets</a></li>
<li class="chapter" data-level="2.6.2" data-path="visualization-1.html"><a href="visualization-1.html#datacamp-courses"><i class="fa fa-check"></i><b>2.6.2</b> Datacamp courses</a></li>
<li class="chapter" data-level="2.6.3" data-path="visualization-1.html"><a href="visualization-1.html#books-and-chapters"><i class="fa fa-check"></i><b>2.6.3</b> Books and chapters</a></li>
<li class="chapter" data-level="2.6.4" data-path="visualization-1.html"><a href="visualization-1.html#misc"><i class="fa fa-check"></i><b>2.6.4</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="visualization-1.html"><a href="visualization-1.html#session-info-1"><i class="fa fa-check"></i><b>2.7</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="visualization-2.html"><a href="visualization-2.html"><i class="fa fa-check"></i><b>3</b> Visualization 2</a>
<ul>
<li class="chapter" data-level="3.1" data-path="visualization-2.html"><a href="visualization-2.html#learning-objectives"><i class="fa fa-check"></i><b>3.1</b> Learning objectives</a></li>
<li class="chapter" data-level="3.2" data-path="visualization-2.html"><a href="visualization-2.html#install-and-load-packages-load-data-set-theme"><i class="fa fa-check"></i><b>3.2</b> Install and load packages, load data, set theme</a></li>
<li class="chapter" data-level="3.3" data-path="visualization-2.html"><a href="visualization-2.html#overview-of-different-plot-types-for-different-things"><i class="fa fa-check"></i><b>3.3</b> Overview of different plot types for different things</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="visualization-2.html"><a href="visualization-2.html#proportions"><i class="fa fa-check"></i><b>3.3.1</b> Proportions</a></li>
<li class="chapter" data-level="3.3.2" data-path="visualization-2.html"><a href="visualization-2.html#comparisons"><i class="fa fa-check"></i><b>3.3.2</b> Comparisons</a></li>
<li class="chapter" data-level="3.3.3" data-path="visualization-2.html"><a href="visualization-2.html#relationships"><i class="fa fa-check"></i><b>3.3.3</b> Relationships</a></li>
<li class="chapter" data-level="3.3.4" data-path="visualization-2.html"><a href="visualization-2.html#temporal-data"><i class="fa fa-check"></i><b>3.3.4</b> Temporal data</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="visualization-2.html"><a href="visualization-2.html#customizing-plots"><i class="fa fa-check"></i><b>3.4</b> Customizing plots</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="visualization-2.html"><a href="visualization-2.html#anatomy-of-a-ggplot"><i class="fa fa-check"></i><b>3.4.1</b> Anatomy of a <code>ggplot</code></a></li>
<li class="chapter" data-level="3.4.2" data-path="visualization-2.html"><a href="visualization-2.html#changing-the-order-of-things"><i class="fa fa-check"></i><b>3.4.2</b> Changing the order of things</a></li>
<li class="chapter" data-level="3.4.3" data-path="visualization-2.html"><a href="visualization-2.html#dealing-with-legends"><i class="fa fa-check"></i><b>3.4.3</b> Dealing with legends</a></li>
<li class="chapter" data-level="3.4.4" data-path="visualization-2.html"><a href="visualization-2.html#choosing-good-colors"><i class="fa fa-check"></i><b>3.4.4</b> Choosing good colors</a></li>
<li class="chapter" data-level="3.4.5" data-path="visualization-2.html"><a href="visualization-2.html#customizing-themes"><i class="fa fa-check"></i><b>3.4.5</b> Customizing themes</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="visualization-2.html"><a href="visualization-2.html#saving-plots"><i class="fa fa-check"></i><b>3.5</b> Saving plots</a></li>
<li class="chapter" data-level="3.6" data-path="visualization-2.html"><a href="visualization-2.html#creating-figure-panels"><i class="fa fa-check"></i><b>3.6</b> Creating figure panels</a></li>
<li class="chapter" data-level="3.7" data-path="visualization-2.html"><a href="visualization-2.html#peeking-behind-the-scenes"><i class="fa fa-check"></i><b>3.7</b> Peeking behind the scenes</a></li>
<li class="chapter" data-level="3.8" data-path="visualization-2.html"><a href="visualization-2.html#making-animations"><i class="fa fa-check"></i><b>3.8</b> Making animations</a></li>
<li class="chapter" data-level="3.9" data-path="visualization-2.html"><a href="visualization-2.html#shiny-apps"><i class="fa fa-check"></i><b>3.9</b> Shiny apps</a></li>
<li class="chapter" data-level="3.10" data-path="visualization-2.html"><a href="visualization-2.html#defining-snippets"><i class="fa fa-check"></i><b>3.10</b> Defining snippets</a></li>
<li class="chapter" data-level="3.11" data-path="visualization-2.html"><a href="visualization-2.html#additional-resources-1"><i class="fa fa-check"></i><b>3.11</b> Additional resources</a>
<ul>
<li class="chapter" data-level="3.11.1" data-path="visualization-2.html"><a href="visualization-2.html#cheatsheets-1"><i class="fa fa-check"></i><b>3.11.1</b> Cheatsheets</a></li>
<li class="chapter" data-level="3.11.2" data-path="visualization-2.html"><a href="visualization-2.html#data-camp-courses"><i class="fa fa-check"></i><b>3.11.2</b> Data camp courses</a></li>
<li class="chapter" data-level="3.11.3" data-path="visualization-2.html"><a href="visualization-2.html#books-and-chapters-1"><i class="fa fa-check"></i><b>3.11.3</b> Books and chapters</a></li>
<li class="chapter" data-level="3.11.4" data-path="visualization-2.html"><a href="visualization-2.html#misc-1"><i class="fa fa-check"></i><b>3.11.4</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="3.12" data-path="visualization-2.html"><a href="visualization-2.html#session-info-2"><i class="fa fa-check"></i><b>3.12</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html"><i class="fa fa-check"></i><b>4</b> Data wrangling 1</a>
<ul>
<li class="chapter" data-level="4.1" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#learning-goals-1"><i class="fa fa-check"></i><b>4.1</b> Learning goals</a></li>
<li class="chapter" data-level="4.2" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#load-packages-1"><i class="fa fa-check"></i><b>4.2</b> Load packages</a></li>
<li class="chapter" data-level="4.3" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#some-r-basics"><i class="fa fa-check"></i><b>4.3</b> Some R basics</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#modes"><i class="fa fa-check"></i><b>4.3.1</b> Modes</a></li>
<li class="chapter" data-level="4.3.2" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#data-types"><i class="fa fa-check"></i><b>4.3.2</b> Data types</a></li>
<li class="chapter" data-level="4.3.3" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#operators"><i class="fa fa-check"></i><b>4.3.3</b> Operators</a></li>
<li class="chapter" data-level="4.3.4" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#control-flow"><i class="fa fa-check"></i><b>4.3.4</b> Control flow</a></li>
<li class="chapter" data-level="4.3.5" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#functions"><i class="fa fa-check"></i><b>4.3.5</b> Functions</a></li>
<li class="chapter" data-level="4.3.6" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#the-pipe-operator"><i class="fa fa-check"></i><b>4.3.6</b> The pipe operator <code>%&gt;%</code></a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#a-quick-note-on-naming-things"><i class="fa fa-check"></i><b>4.4</b> A quick note on naming things</a></li>
<li class="chapter" data-level="4.5" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#looking-at-data"><i class="fa fa-check"></i><b>4.5</b> Looking at data</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#head"><i class="fa fa-check"></i><b>4.5.1</b> <code>head()</code></a></li>
<li class="chapter" data-level="4.5.2" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#glimpse"><i class="fa fa-check"></i><b>4.5.2</b> <code>glimpse()</code></a></li>
<li class="chapter" data-level="4.5.3" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#distinct"><i class="fa fa-check"></i><b>4.5.3</b> <code>distinct()</code></a></li>
<li class="chapter" data-level="4.5.4" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#count"><i class="fa fa-check"></i><b>4.5.4</b> <code>count()</code></a></li>
<li class="chapter" data-level="4.5.5" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#datatable"><i class="fa fa-check"></i><b>4.5.5</b> <code>datatable()</code></a></li>
<li class="chapter" data-level="4.5.6" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#other-tools-for-taking-a-quick-look-at-data"><i class="fa fa-check"></i><b>4.5.6</b> Other tools for taking a quick look at data</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#wrangling-data"><i class="fa fa-check"></i><b>4.6</b> Wrangling data</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#filter"><i class="fa fa-check"></i><b>4.6.1</b> <code>filter()</code></a></li>
<li class="chapter" data-level="4.6.2" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#arrange"><i class="fa fa-check"></i><b>4.6.2</b> <code>arrange()</code></a></li>
<li class="chapter" data-level="4.6.3" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#rename"><i class="fa fa-check"></i><b>4.6.3</b> <code>rename()</code></a></li>
<li class="chapter" data-level="4.6.4" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#relocate"><i class="fa fa-check"></i><b>4.6.4</b> <code>relocate()</code></a></li>
<li class="chapter" data-level="4.6.5" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#select"><i class="fa fa-check"></i><b>4.6.5</b> <code>select()</code></a></li>
<li class="chapter" data-level="4.6.6" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#practice-2"><i class="fa fa-check"></i><b>4.6.6</b> Practice 2</a></li>
<li class="chapter" data-level="4.6.7" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#mutate"><i class="fa fa-check"></i><b>4.6.7</b> <code>mutate()</code></a></li>
<li class="chapter" data-level="4.6.8" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#practice-3"><i class="fa fa-check"></i><b>4.6.8</b> Practice 3</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#additional-resources-2"><i class="fa fa-check"></i><b>4.7</b> Additional resources</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#cheatsheets-2"><i class="fa fa-check"></i><b>4.7.1</b> Cheatsheets</a></li>
<li class="chapter" data-level="4.7.2" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#data-camp-courses-1"><i class="fa fa-check"></i><b>4.7.2</b> Data camp courses</a></li>
<li class="chapter" data-level="4.7.3" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#books-and-chapters-2"><i class="fa fa-check"></i><b>4.7.3</b> Books and chapters</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#session-info-3"><i class="fa fa-check"></i><b>4.8</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html"><i class="fa fa-check"></i><b>5</b> Data wrangling 2</a>
<ul>
<li class="chapter" data-level="5.1" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#learning-goals-2"><i class="fa fa-check"></i><b>5.1</b> Learning goals</a></li>
<li class="chapter" data-level="5.2" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#load-packages-2"><i class="fa fa-check"></i><b>5.2</b> Load packages</a></li>
<li class="chapter" data-level="5.3" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#settings"><i class="fa fa-check"></i><b>5.3</b> Settings</a></li>
<li class="chapter" data-level="5.4" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#wrangling-data-continued"><i class="fa fa-check"></i><b>5.4</b> Wrangling data (continued)</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#summarizing-data"><i class="fa fa-check"></i><b>5.4.1</b> Summarizing data</a></li>
<li class="chapter" data-level="5.4.2" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#reshaping-data"><i class="fa fa-check"></i><b>5.4.2</b> Reshaping data</a></li>
<li class="chapter" data-level="5.4.3" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#joining-multiple-data-frames"><i class="fa fa-check"></i><b>5.4.3</b> Joining multiple data frames</a></li>
<li class="chapter" data-level="5.4.4" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#dealing-with-missing-data"><i class="fa fa-check"></i><b>5.4.4</b> Dealing with missing data</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#reading-in-data"><i class="fa fa-check"></i><b>5.5</b> Reading in data</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#csv"><i class="fa fa-check"></i><b>5.5.1</b> csv</a></li>
<li class="chapter" data-level="5.5.2" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#rdata"><i class="fa fa-check"></i><b>5.5.2</b> RData</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#saving-data"><i class="fa fa-check"></i><b>5.6</b> Saving data</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#csv-1"><i class="fa fa-check"></i><b>5.6.1</b> csv</a></li>
<li class="chapter" data-level="5.6.2" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#rdata-1"><i class="fa fa-check"></i><b>5.6.2</b> RData</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#additional-resources-3"><i class="fa fa-check"></i><b>5.7</b> Additional resources</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#cheatsheets-3"><i class="fa fa-check"></i><b>5.7.1</b> Cheatsheets</a></li>
<li class="chapter" data-level="5.7.2" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#data-camp-courses-2"><i class="fa fa-check"></i><b>5.7.2</b> Data camp courses</a></li>
<li class="chapter" data-level="5.7.3" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#books-and-chapters-3"><i class="fa fa-check"></i><b>5.7.3</b> Books and chapters</a></li>
<li class="chapter" data-level="5.7.4" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#tutorials"><i class="fa fa-check"></i><b>5.7.4</b> Tutorials</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#session-info-4"><i class="fa fa-check"></i><b>5.8</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="probability-and-causality.html"><a href="probability-and-causality.html"><i class="fa fa-check"></i><b>6</b> Probability and causality</a>
<ul>
<li class="chapter" data-level="6.1" data-path="probability-and-causality.html"><a href="probability-and-causality.html#load-packages-load-data-set-theme"><i class="fa fa-check"></i><b>6.1</b> Load packages, load data, set theme</a></li>
<li class="chapter" data-level="6.2" data-path="probability-and-causality.html"><a href="probability-and-causality.html#counting"><i class="fa fa-check"></i><b>6.2</b> Counting</a></li>
<li class="chapter" data-level="6.3" data-path="probability-and-causality.html"><a href="probability-and-causality.html#the-random-secretary"><i class="fa fa-check"></i><b>6.3</b> The random secretary</a></li>
<li class="chapter" data-level="6.4" data-path="probability-and-causality.html"><a href="probability-and-causality.html#flipping-a-coin-many-times"><i class="fa fa-check"></i><b>6.4</b> Flipping a coin many times</a></li>
<li class="chapter" data-level="6.5" data-path="probability-and-causality.html"><a href="probability-and-causality.html#clue-guide-to-probability"><i class="fa fa-check"></i><b>6.5</b> Clue guide to probability</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="probability-and-causality.html"><a href="probability-and-causality.html#conditional-probability"><i class="fa fa-check"></i><b>6.5.1</b> Conditional probability</a></li>
<li class="chapter" data-level="6.5.2" data-path="probability-and-causality.html"><a href="probability-and-causality.html#law-of-total-probability"><i class="fa fa-check"></i><b>6.5.2</b> Law of total probability</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="probability-and-causality.html"><a href="probability-and-causality.html#probability-operations"><i class="fa fa-check"></i><b>6.6</b> Probability operations</a></li>
<li class="chapter" data-level="6.7" data-path="probability-and-causality.html"><a href="probability-and-causality.html#bayesian-reasoning-explained"><i class="fa fa-check"></i><b>6.7</b> Bayesian reasoning explained</a></li>
<li class="chapter" data-level="6.8" data-path="probability-and-causality.html"><a href="probability-and-causality.html#getting-bayes-right-matters"><i class="fa fa-check"></i><b>6.8</b> Getting Bayes right matters</a>
<ul>
<li class="chapter" data-level="6.8.1" data-path="probability-and-causality.html"><a href="probability-and-causality.html#bayesian-reasoning-example"><i class="fa fa-check"></i><b>6.8.1</b> Bayesian reasoning example</a></li>
<li class="chapter" data-level="6.8.2" data-path="probability-and-causality.html"><a href="probability-and-causality.html#bayesian-reasoning-example-covid-rapid-test"><i class="fa fa-check"></i><b>6.8.2</b> Bayesian reasoning example (COVID rapid test)</a></li>
<li class="chapter" data-level="6.8.3" data-path="probability-and-causality.html"><a href="probability-and-causality.html#most-people-in-the-hospital-are-vaccinated"><i class="fa fa-check"></i><b>6.8.3</b> Most people in the hospital are vaccinated</a></li>
</ul></li>
<li class="chapter" data-level="6.9" data-path="probability-and-causality.html"><a href="probability-and-causality.html#building-a-bayesis"><i class="fa fa-check"></i><b>6.9</b> Building a Bayesis</a>
<ul>
<li class="chapter" data-level="6.9.1" data-path="probability-and-causality.html"><a href="probability-and-causality.html#dice-example"><i class="fa fa-check"></i><b>6.9.1</b> Dice example</a></li>
</ul></li>
<li class="chapter" data-level="6.10" data-path="probability-and-causality.html"><a href="probability-and-causality.html#additional-resources-4"><i class="fa fa-check"></i><b>6.10</b> Additional resources</a>
<ul>
<li class="chapter" data-level="6.10.1" data-path="probability-and-causality.html"><a href="probability-and-causality.html#cheatsheets-4"><i class="fa fa-check"></i><b>6.10.1</b> Cheatsheets</a></li>
<li class="chapter" data-level="6.10.2" data-path="probability-and-causality.html"><a href="probability-and-causality.html#books-and-chapters-4"><i class="fa fa-check"></i><b>6.10.2</b> Books and chapters</a></li>
<li class="chapter" data-level="6.10.3" data-path="probability-and-causality.html"><a href="probability-and-causality.html#misc-2"><i class="fa fa-check"></i><b>6.10.3</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="6.11" data-path="probability-and-causality.html"><a href="probability-and-causality.html#session-info-5"><i class="fa fa-check"></i><b>6.11</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="simulation-1.html"><a href="simulation-1.html"><i class="fa fa-check"></i><b>7</b> Simulation 1</a>
<ul>
<li class="chapter" data-level="7.1" data-path="simulation-1.html"><a href="simulation-1.html#load-packages-and-set-plotting-theme"><i class="fa fa-check"></i><b>7.1</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="7.2" data-path="simulation-1.html"><a href="simulation-1.html#sampling"><i class="fa fa-check"></i><b>7.2</b> Sampling</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="simulation-1.html"><a href="simulation-1.html#drawing-numbers-from-a-vector"><i class="fa fa-check"></i><b>7.2.1</b> Drawing numbers from a vector</a></li>
<li class="chapter" data-level="7.2.2" data-path="simulation-1.html"><a href="simulation-1.html#drawing-rows-from-a-data-frame"><i class="fa fa-check"></i><b>7.2.2</b> Drawing rows from a data frame</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="simulation-1.html"><a href="simulation-1.html#working-with-distributions"><i class="fa fa-check"></i><b>7.3</b> Working with distributions</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="simulation-1.html"><a href="simulation-1.html#plotting-distributions"><i class="fa fa-check"></i><b>7.3.1</b> Plotting distributions</a></li>
<li class="chapter" data-level="7.3.2" data-path="simulation-1.html"><a href="simulation-1.html#sampling-from-distributions"><i class="fa fa-check"></i><b>7.3.2</b> Sampling from distributions</a></li>
<li class="chapter" data-level="7.3.3" data-path="simulation-1.html"><a href="simulation-1.html#understanding-density"><i class="fa fa-check"></i><b>7.3.3</b> Understanding <code>density()</code></a></li>
<li class="chapter" data-level="7.3.4" data-path="simulation-1.html"><a href="simulation-1.html#cumulative-probability-distribution"><i class="fa fa-check"></i><b>7.3.4</b> Cumulative probability distribution</a></li>
<li class="chapter" data-level="7.3.5" data-path="simulation-1.html"><a href="simulation-1.html#inverse-cumulative-distribution"><i class="fa fa-check"></i><b>7.3.5</b> Inverse cumulative distribution</a></li>
<li class="chapter" data-level="7.3.6" data-path="simulation-1.html"><a href="simulation-1.html#computing-probabilities"><i class="fa fa-check"></i><b>7.3.6</b> Computing probabilities</a></li>
<li class="chapter" data-level="7.3.7" data-path="simulation-1.html"><a href="simulation-1.html#make-the-plot"><i class="fa fa-check"></i><b>7.3.7</b> Make the plot</a></li>
<li class="chapter" data-level="7.3.8" data-path="simulation-1.html"><a href="simulation-1.html#analytic-solutions"><i class="fa fa-check"></i><b>7.3.8</b> Analytic solutions</a></li>
<li class="chapter" data-level="7.3.9" data-path="simulation-1.html"><a href="simulation-1.html#sampling-solution"><i class="fa fa-check"></i><b>7.3.9</b> Sampling solution</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="simulation-1.html"><a href="simulation-1.html#bayesian-inference-with-the-normal-distribution"><i class="fa fa-check"></i><b>7.4</b> Bayesian inference with the normal distribution</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="simulation-1.html"><a href="simulation-1.html#analytic-solution"><i class="fa fa-check"></i><b>7.4.1</b> Analytic solution</a></li>
<li class="chapter" data-level="7.4.2" data-path="simulation-1.html"><a href="simulation-1.html#solution-via-sampling"><i class="fa fa-check"></i><b>7.4.2</b> Solution via sampling</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="simulation-1.html"><a href="simulation-1.html#additional-resources-5"><i class="fa fa-check"></i><b>7.5</b> Additional resources</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="simulation-1.html"><a href="simulation-1.html#datacamp"><i class="fa fa-check"></i><b>7.5.1</b> Datacamp</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="simulation-1.html"><a href="simulation-1.html#session-info-6"><i class="fa fa-check"></i><b>7.6</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="simulation-2.html"><a href="simulation-2.html"><i class="fa fa-check"></i><b>8</b> Simulation 2</a>
<ul>
<li class="chapter" data-level="8.1" data-path="simulation-2.html"><a href="simulation-2.html#load-packages-and-set-plotting-theme-1"><i class="fa fa-check"></i><b>8.1</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="8.2" data-path="simulation-2.html"><a href="simulation-2.html#making-statistical-inferences-frequentist-style"><i class="fa fa-check"></i><b>8.2</b> Making statistical inferences (frequentist style)</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="simulation-2.html"><a href="simulation-2.html#population-distribution"><i class="fa fa-check"></i><b>8.2.1</b> Population distribution</a></li>
<li class="chapter" data-level="8.2.2" data-path="simulation-2.html"><a href="simulation-2.html#distribution-of-a-single-sample"><i class="fa fa-check"></i><b>8.2.2</b> Distribution of a single sample</a></li>
<li class="chapter" data-level="8.2.3" data-path="simulation-2.html"><a href="simulation-2.html#the-sampling-distribution"><i class="fa fa-check"></i><b>8.2.3</b> The sampling distribution</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="simulation-2.html"><a href="simulation-2.html#understanding-p-values"><i class="fa fa-check"></i><b>8.3</b> Understanding p-values</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="simulation-2.html"><a href="simulation-2.html#permutation-test"><i class="fa fa-check"></i><b>8.3.1</b> Permutation test</a></li>
<li class="chapter" data-level="8.3.2" data-path="simulation-2.html"><a href="simulation-2.html#t-test-by-hand"><i class="fa fa-check"></i><b>8.3.2</b> t-test by hand</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="simulation-2.html"><a href="simulation-2.html#confidence-intervals"><i class="fa fa-check"></i><b>8.4</b> Confidence intervals</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="simulation-2.html"><a href="simulation-2.html#mean_cl_boot-explained"><i class="fa fa-check"></i><b>8.4.1</b> <code>mean_cl_boot()</code> explained</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="simulation-2.html"><a href="simulation-2.html#additional-resources-6"><i class="fa fa-check"></i><b>8.5</b> Additional resources</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="simulation-2.html"><a href="simulation-2.html#datacamp-1"><i class="fa fa-check"></i><b>8.5.1</b> Datacamp</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="simulation-2.html"><a href="simulation-2.html#session-info-7"><i class="fa fa-check"></i><b>8.6</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="modeling-data.html"><a href="modeling-data.html"><i class="fa fa-check"></i><b>9</b> Modeling data</a>
<ul>
<li class="chapter" data-level="9.1" data-path="modeling-data.html"><a href="modeling-data.html#load-packages-and-set-plotting-theme-2"><i class="fa fa-check"></i><b>9.1</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="9.2" data-path="modeling-data.html"><a href="modeling-data.html#modeling-data-1"><i class="fa fa-check"></i><b>9.2</b> Modeling data</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="modeling-data.html"><a href="modeling-data.html#simplicity-vs.-accuracy-trade-off"><i class="fa fa-check"></i><b>9.2.1</b> Simplicity vs. accuracy trade-off</a></li>
<li class="chapter" data-level="9.2.2" data-path="modeling-data.html"><a href="modeling-data.html#sampling-distributions-for-median-and-mean"><i class="fa fa-check"></i><b>9.2.2</b> Sampling distributions for median and mean</a></li>
<li class="chapter" data-level="9.2.3" data-path="modeling-data.html"><a href="modeling-data.html#residuals-need-to-be-normally-distributed-not-the-data-itself"><i class="fa fa-check"></i><b>9.2.3</b> Residuals need to be normally distributed, not the data itself</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="modeling-data.html"><a href="modeling-data.html#hypothesis-testing-one-sample-t-test"><i class="fa fa-check"></i><b>9.3</b> Hypothesis testing: “One-sample t-test”</a></li>
<li class="chapter" data-level="9.4" data-path="modeling-data.html"><a href="modeling-data.html#building-a-sampling-distribution-of-pre"><i class="fa fa-check"></i><b>9.4</b> Building a sampling distribution of PRE</a></li>
<li class="chapter" data-level="9.5" data-path="modeling-data.html"><a href="modeling-data.html#misc-3"><i class="fa fa-check"></i><b>9.5</b> Misc</a></li>
<li class="chapter" data-level="9.6" data-path="modeling-data.html"><a href="modeling-data.html#additional-resources-7"><i class="fa fa-check"></i><b>9.6</b> Additional resources</a>
<ul>
<li class="chapter" data-level="9.6.1" data-path="modeling-data.html"><a href="modeling-data.html#reading"><i class="fa fa-check"></i><b>9.6.1</b> Reading</a></li>
<li class="chapter" data-level="9.6.2" data-path="modeling-data.html"><a href="modeling-data.html#datacamp-2"><i class="fa fa-check"></i><b>9.6.2</b> Datacamp</a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="modeling-data.html"><a href="modeling-data.html#session-info-8"><i class="fa fa-check"></i><b>9.7</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="linear-model-1.html"><a href="linear-model-1.html"><i class="fa fa-check"></i><b>10</b> Linear model 1</a>
<ul>
<li class="chapter" data-level="10.1" data-path="linear-model-1.html"><a href="linear-model-1.html#load-packages-and-set-plotting-theme-3"><i class="fa fa-check"></i><b>10.1</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="10.2" data-path="linear-model-1.html"><a href="linear-model-1.html#correlation"><i class="fa fa-check"></i><b>10.2</b> Correlation</a></li>
<li class="chapter" data-level="10.3" data-path="linear-model-1.html"><a href="linear-model-1.html#regression"><i class="fa fa-check"></i><b>10.3</b> Regression</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="linear-model-1.html"><a href="linear-model-1.html#define-and-fit-the-models"><i class="fa fa-check"></i><b>10.3.1</b> Define and fit the models</a></li>
<li class="chapter" data-level="10.3.2" data-path="linear-model-1.html"><a href="linear-model-1.html#calculate-the-sum-of-squared-errors-of-each-model"><i class="fa fa-check"></i><b>10.3.2</b> Calculate the sum of squared errors of each model</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="linear-model-1.html"><a href="linear-model-1.html#credit-example"><i class="fa fa-check"></i><b>10.4</b> Credit example</a></li>
<li class="chapter" data-level="10.5" data-path="linear-model-1.html"><a href="linear-model-1.html#additional-resources-8"><i class="fa fa-check"></i><b>10.5</b> Additional resources</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="linear-model-1.html"><a href="linear-model-1.html#datacamp-3"><i class="fa fa-check"></i><b>10.5.1</b> Datacamp</a></li>
<li class="chapter" data-level="10.5.2" data-path="linear-model-1.html"><a href="linear-model-1.html#misc-4"><i class="fa fa-check"></i><b>10.5.2</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="linear-model-1.html"><a href="linear-model-1.html#session-info-9"><i class="fa fa-check"></i><b>10.6</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="linear-model-2.html"><a href="linear-model-2.html"><i class="fa fa-check"></i><b>11</b> Linear model 2</a>
<ul>
<li class="chapter" data-level="11.1" data-path="linear-model-2.html"><a href="linear-model-2.html#learning-goals-3"><i class="fa fa-check"></i><b>11.1</b> Learning goals</a></li>
<li class="chapter" data-level="11.2" data-path="linear-model-2.html"><a href="linear-model-2.html#load-packages-and-set-plotting-theme-4"><i class="fa fa-check"></i><b>11.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="11.3" data-path="linear-model-2.html"><a href="linear-model-2.html#load-data-sets"><i class="fa fa-check"></i><b>11.3</b> Load data sets</a></li>
<li class="chapter" data-level="11.4" data-path="linear-model-2.html"><a href="linear-model-2.html#multiple-continuous-variables"><i class="fa fa-check"></i><b>11.4</b> Multiple continuous variables</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="linear-model-2.html"><a href="linear-model-2.html#explore-correlations"><i class="fa fa-check"></i><b>11.4.1</b> Explore correlations</a></li>
<li class="chapter" data-level="11.4.2" data-path="linear-model-2.html"><a href="linear-model-2.html#multipe-regression"><i class="fa fa-check"></i><b>11.4.2</b> Multipe regression</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="linear-model-2.html"><a href="linear-model-2.html#one-categorical-variable"><i class="fa fa-check"></i><b>11.5</b> One categorical variable</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="linear-model-2.html"><a href="linear-model-2.html#visualization-of-the-model-predictions"><i class="fa fa-check"></i><b>11.5.1</b> Visualization of the model predictions</a></li>
<li class="chapter" data-level="11.5.2" data-path="linear-model-2.html"><a href="linear-model-2.html#dummy-coding"><i class="fa fa-check"></i><b>11.5.2</b> Dummy coding</a></li>
<li class="chapter" data-level="11.5.3" data-path="linear-model-2.html"><a href="linear-model-2.html#reporting-the-results"><i class="fa fa-check"></i><b>11.5.3</b> Reporting the results</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="linear-model-2.html"><a href="linear-model-2.html#one-continuous-and-one-categorical-variable"><i class="fa fa-check"></i><b>11.6</b> One continuous and one categorical variable</a>
<ul>
<li class="chapter" data-level="11.6.1" data-path="linear-model-2.html"><a href="linear-model-2.html#visualization-of-the-model-predictions-1"><i class="fa fa-check"></i><b>11.6.1</b> Visualization of the model predictions</a></li>
</ul></li>
<li class="chapter" data-level="11.7" data-path="linear-model-2.html"><a href="linear-model-2.html#interactions"><i class="fa fa-check"></i><b>11.7</b> Interactions</a>
<ul>
<li class="chapter" data-level="11.7.1" data-path="linear-model-2.html"><a href="linear-model-2.html#visualization-3"><i class="fa fa-check"></i><b>11.7.1</b> Visualization</a></li>
<li class="chapter" data-level="11.7.2" data-path="linear-model-2.html"><a href="linear-model-2.html#hypothesis-test"><i class="fa fa-check"></i><b>11.7.2</b> Hypothesis test</a></li>
</ul></li>
<li class="chapter" data-level="11.8" data-path="linear-model-2.html"><a href="linear-model-2.html#additional-resources-9"><i class="fa fa-check"></i><b>11.8</b> Additional resources</a>
<ul>
<li class="chapter" data-level="11.8.1" data-path="linear-model-2.html"><a href="linear-model-2.html#datacamp-4"><i class="fa fa-check"></i><b>11.8.1</b> Datacamp</a></li>
<li class="chapter" data-level="11.8.2" data-path="linear-model-2.html"><a href="linear-model-2.html#misc-5"><i class="fa fa-check"></i><b>11.8.2</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="11.9" data-path="linear-model-2.html"><a href="linear-model-2.html#session-info-10"><i class="fa fa-check"></i><b>11.9</b> Session info</a></li>
<li class="chapter" data-level="11.10" data-path="linear-model-2.html"><a href="linear-model-2.html#references"><i class="fa fa-check"></i><b>11.10</b> References</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="linear-model-3.html"><a href="linear-model-3.html"><i class="fa fa-check"></i><b>12</b> Linear model 3</a>
<ul>
<li class="chapter" data-level="12.1" data-path="linear-model-3.html"><a href="linear-model-3.html#learning-goals-4"><i class="fa fa-check"></i><b>12.1</b> Learning goals</a></li>
<li class="chapter" data-level="12.2" data-path="linear-model-3.html"><a href="linear-model-3.html#load-packages-and-set-plotting-theme-5"><i class="fa fa-check"></i><b>12.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="12.3" data-path="linear-model-3.html"><a href="linear-model-3.html#load-data-sets-1"><i class="fa fa-check"></i><b>12.3</b> Load data sets</a></li>
<li class="chapter" data-level="12.4" data-path="linear-model-3.html"><a href="linear-model-3.html#one-way-anova"><i class="fa fa-check"></i><b>12.4</b> One-way ANOVA</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="linear-model-3.html"><a href="linear-model-3.html#visualization-4"><i class="fa fa-check"></i><b>12.4.1</b> Visualization</a></li>
<li class="chapter" data-level="12.4.2" data-path="linear-model-3.html"><a href="linear-model-3.html#model-fitting"><i class="fa fa-check"></i><b>12.4.2</b> Model fitting</a></li>
<li class="chapter" data-level="12.4.3" data-path="linear-model-3.html"><a href="linear-model-3.html#hypothesis-test-1"><i class="fa fa-check"></i><b>12.4.3</b> Hypothesis test</a></li>
<li class="chapter" data-level="12.4.4" data-path="linear-model-3.html"><a href="linear-model-3.html#visualize-the-models-predictions"><i class="fa fa-check"></i><b>12.4.4</b> Visualize the model’s predictions</a></li>
<li class="chapter" data-level="12.4.5" data-path="linear-model-3.html"><a href="linear-model-3.html#dummy-coding-1"><i class="fa fa-check"></i><b>12.4.5</b> Dummy coding</a></li>
<li class="chapter" data-level="12.4.6" data-path="linear-model-3.html"><a href="linear-model-3.html#follow-up-questions"><i class="fa fa-check"></i><b>12.4.6</b> Follow up questions</a></li>
<li class="chapter" data-level="12.4.7" data-path="linear-model-3.html"><a href="linear-model-3.html#variance-decomposition"><i class="fa fa-check"></i><b>12.4.7</b> Variance decomposition</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="linear-model-3.html"><a href="linear-model-3.html#two-way-anova"><i class="fa fa-check"></i><b>12.5</b> Two-way ANOVA</a>
<ul>
<li class="chapter" data-level="12.5.1" data-path="linear-model-3.html"><a href="linear-model-3.html#visualization-5"><i class="fa fa-check"></i><b>12.5.1</b> Visualization</a></li>
<li class="chapter" data-level="12.5.2" data-path="linear-model-3.html"><a href="linear-model-3.html#model-fitting-1"><i class="fa fa-check"></i><b>12.5.2</b> Model fitting</a></li>
<li class="chapter" data-level="12.5.3" data-path="linear-model-3.html"><a href="linear-model-3.html#interpreting-interactions"><i class="fa fa-check"></i><b>12.5.3</b> Interpreting interactions</a></li>
<li class="chapter" data-level="12.5.4" data-path="linear-model-3.html"><a href="linear-model-3.html#variance-decomposition-1"><i class="fa fa-check"></i><b>12.5.4</b> Variance decomposition</a></li>
</ul></li>
<li class="chapter" data-level="12.6" data-path="linear-model-3.html"><a href="linear-model-3.html#two-way-anova-with-interaction"><i class="fa fa-check"></i><b>12.6</b> Two-way ANOVA (with interaction)</a></li>
<li class="chapter" data-level="12.7" data-path="linear-model-3.html"><a href="linear-model-3.html#additional-resources-10"><i class="fa fa-check"></i><b>12.7</b> Additional resources</a>
<ul>
<li class="chapter" data-level="12.7.1" data-path="linear-model-3.html"><a href="linear-model-3.html#datacamp-5"><i class="fa fa-check"></i><b>12.7.1</b> Datacamp</a></li>
<li class="chapter" data-level="12.7.2" data-path="linear-model-3.html"><a href="linear-model-3.html#misc-6"><i class="fa fa-check"></i><b>12.7.2</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="12.8" data-path="linear-model-3.html"><a href="linear-model-3.html#session-info-11"><i class="fa fa-check"></i><b>12.8</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="linear-model-4.html"><a href="linear-model-4.html"><i class="fa fa-check"></i><b>13</b> Linear model 4</a>
<ul>
<li class="chapter" data-level="13.1" data-path="linear-model-4.html"><a href="linear-model-4.html#load-packages-and-set-plotting-theme-6"><i class="fa fa-check"></i><b>13.1</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="13.2" data-path="linear-model-4.html"><a href="linear-model-4.html#load-data-sets-2"><i class="fa fa-check"></i><b>13.2</b> Load data sets</a></li>
<li class="chapter" data-level="13.3" data-path="linear-model-4.html"><a href="linear-model-4.html#anova-with-unbalanced-design"><i class="fa fa-check"></i><b>13.3</b> ANOVA with unbalanced design</a></li>
<li class="chapter" data-level="13.4" data-path="linear-model-4.html"><a href="linear-model-4.html#interpreting-parameters-very-important"><i class="fa fa-check"></i><b>13.4</b> Interpreting parameters (very important!)</a></li>
<li class="chapter" data-level="13.5" data-path="linear-model-4.html"><a href="linear-model-4.html#linear-contrasts"><i class="fa fa-check"></i><b>13.5</b> Linear contrasts</a>
<ul>
<li class="chapter" data-level="13.5.1" data-path="linear-model-4.html"><a href="linear-model-4.html#hypothetical-data"><i class="fa fa-check"></i><b>13.5.1</b> Hypothetical data</a></li>
<li class="chapter" data-level="13.5.2" data-path="linear-model-4.html"><a href="linear-model-4.html#visualization-6"><i class="fa fa-check"></i><b>13.5.2</b> Visualization</a></li>
<li class="chapter" data-level="13.5.3" data-path="linear-model-4.html"><a href="linear-model-4.html#post-hoc-tests"><i class="fa fa-check"></i><b>13.5.3</b> Post-hoc tests</a></li>
<li class="chapter" data-level="13.5.4" data-path="linear-model-4.html"><a href="linear-model-4.html#understanding-dummy-coding"><i class="fa fa-check"></i><b>13.5.4</b> Understanding dummy coding</a></li>
<li class="chapter" data-level="13.5.5" data-path="linear-model-4.html"><a href="linear-model-4.html#understanding-sum-coding"><i class="fa fa-check"></i><b>13.5.5</b> Understanding sum coding</a></li>
</ul></li>
<li class="chapter" data-level="13.6" data-path="linear-model-4.html"><a href="linear-model-4.html#session-info-12"><i class="fa fa-check"></i><b>13.6</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="power-analysis.html"><a href="power-analysis.html"><i class="fa fa-check"></i><b>14</b> Power analysis</a>
<ul>
<li class="chapter" data-level="14.1" data-path="power-analysis.html"><a href="power-analysis.html#learning-goals-5"><i class="fa fa-check"></i><b>14.1</b> Learning goals</a></li>
<li class="chapter" data-level="14.2" data-path="power-analysis.html"><a href="power-analysis.html#load-packages-and-set-plotting-theme-7"><i class="fa fa-check"></i><b>14.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="14.3" data-path="power-analysis.html"><a href="power-analysis.html#load-data-sets-3"><i class="fa fa-check"></i><b>14.3</b> Load data sets</a></li>
<li class="chapter" data-level="14.4" data-path="power-analysis.html"><a href="power-analysis.html#decision-making"><i class="fa fa-check"></i><b>14.4</b> Decision-making</a></li>
<li class="chapter" data-level="14.5" data-path="power-analysis.html"><a href="power-analysis.html#effect-sizes"><i class="fa fa-check"></i><b>14.5</b> Effect sizes</a>
<ul>
<li class="chapter" data-level="14.5.1" data-path="power-analysis.html"><a href="power-analysis.html#cohens-d"><i class="fa fa-check"></i><b>14.5.1</b> Cohen’s d</a></li>
</ul></li>
<li class="chapter" data-level="14.6" data-path="power-analysis.html"><a href="power-analysis.html#determining-sample-size"><i class="fa fa-check"></i><b>14.6</b> Determining sample size</a>
<ul>
<li class="chapter" data-level="14.6.1" data-path="power-analysis.html"><a href="power-analysis.html#pwr-package"><i class="fa fa-check"></i><b>14.6.1</b> <code>pwr</code> package</a></li>
<li class="chapter" data-level="14.6.2" data-path="power-analysis.html"><a href="power-analysis.html#power-analysis-1"><i class="fa fa-check"></i><b>14.6.2</b> Power analysis</a></li>
</ul></li>
<li class="chapter" data-level="14.7" data-path="power-analysis.html"><a href="power-analysis.html#additional-resources-11"><i class="fa fa-check"></i><b>14.7</b> Additional resources</a>
<ul>
<li class="chapter" data-level="14.7.1" data-path="power-analysis.html"><a href="power-analysis.html#datacamp-6"><i class="fa fa-check"></i><b>14.7.1</b> Datacamp</a></li>
<li class="chapter" data-level="14.7.2" data-path="power-analysis.html"><a href="power-analysis.html#cheatsheets-5"><i class="fa fa-check"></i><b>14.7.2</b> Cheatsheets</a></li>
<li class="chapter" data-level="14.7.3" data-path="power-analysis.html"><a href="power-analysis.html#misc-7"><i class="fa fa-check"></i><b>14.7.3</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="14.8" data-path="power-analysis.html"><a href="power-analysis.html#session-info-13"><i class="fa fa-check"></i><b>14.8</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="model-comparison.html"><a href="model-comparison.html"><i class="fa fa-check"></i><b>15</b> Model comparison</a>
<ul>
<li class="chapter" data-level="15.1" data-path="model-comparison.html"><a href="model-comparison.html#learning-goals-6"><i class="fa fa-check"></i><b>15.1</b> Learning goals</a></li>
<li class="chapter" data-level="15.2" data-path="model-comparison.html"><a href="model-comparison.html#load-packages-and-set-plotting-theme-8"><i class="fa fa-check"></i><b>15.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="15.3" data-path="model-comparison.html"><a href="model-comparison.html#model-comparison-1"><i class="fa fa-check"></i><b>15.3</b> Model comparison</a>
<ul>
<li class="chapter" data-level="15.3.1" data-path="model-comparison.html"><a href="model-comparison.html#fitting-vs.-predicting"><i class="fa fa-check"></i><b>15.3.1</b> Fitting vs. predicting</a></li>
<li class="chapter" data-level="15.3.2" data-path="model-comparison.html"><a href="model-comparison.html#f-test"><i class="fa fa-check"></i><b>15.3.2</b> F-test</a></li>
<li class="chapter" data-level="15.3.3" data-path="model-comparison.html"><a href="model-comparison.html#cross-validation"><i class="fa fa-check"></i><b>15.3.3</b> Cross-validation</a></li>
<li class="chapter" data-level="15.3.4" data-path="model-comparison.html"><a href="model-comparison.html#bootstrap"><i class="fa fa-check"></i><b>15.3.4</b> Bootstrap</a></li>
<li class="chapter" data-level="15.3.5" data-path="model-comparison.html"><a href="model-comparison.html#aic-and-bic"><i class="fa fa-check"></i><b>15.3.5</b> AIC and BIC</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="model-comparison.html"><a href="model-comparison.html#additional-resources-12"><i class="fa fa-check"></i><b>15.4</b> Additional resources</a>
<ul>
<li class="chapter" data-level="15.4.1" data-path="model-comparison.html"><a href="model-comparison.html#datacamp-course"><i class="fa fa-check"></i><b>15.4.1</b> Datacamp course</a></li>
<li class="chapter" data-level="15.4.2" data-path="model-comparison.html"><a href="model-comparison.html#reading-1"><i class="fa fa-check"></i><b>15.4.2</b> Reading</a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="model-comparison.html"><a href="model-comparison.html#session-info-14"><i class="fa fa-check"></i><b>15.5</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="causation.html"><a href="causation.html"><i class="fa fa-check"></i><b>16</b> Causation</a>
<ul>
<li class="chapter" data-level="16.1" data-path="causation.html"><a href="causation.html#learning-goals-7"><i class="fa fa-check"></i><b>16.1</b> Learning goals</a></li>
<li class="chapter" data-level="16.2" data-path="causation.html"><a href="causation.html#recommended-reading"><i class="fa fa-check"></i><b>16.2</b> Recommended reading</a></li>
<li class="chapter" data-level="16.3" data-path="causation.html"><a href="causation.html#load-packages-and-set-plotting-theme-9"><i class="fa fa-check"></i><b>16.3</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="16.4" data-path="causation.html"><a href="causation.html#bayesian-networks"><i class="fa fa-check"></i><b>16.4</b> Bayesian networks</a>
<ul>
<li class="chapter" data-level="16.4.1" data-path="causation.html"><a href="causation.html#sprinkler-example"><i class="fa fa-check"></i><b>16.4.1</b> Sprinkler example</a></li>
</ul></li>
<li class="chapter" data-level="16.5" data-path="causation.html"><a href="causation.html#controlling-for-variables"><i class="fa fa-check"></i><b>16.5</b> Controlling for variables</a>
<ul>
<li class="chapter" data-level="16.5.1" data-path="causation.html"><a href="causation.html#illustration-of-the-d-separation-algorithm"><i class="fa fa-check"></i><b>16.5.1</b> Illustration of the d-separation algorithm</a></li>
<li class="chapter" data-level="16.5.2" data-path="causation.html"><a href="causation.html#good-controls"><i class="fa fa-check"></i><b>16.5.2</b> Good controls</a></li>
<li class="chapter" data-level="16.5.3" data-path="causation.html"><a href="causation.html#bad-controls"><i class="fa fa-check"></i><b>16.5.3</b> Bad controls</a></li>
</ul></li>
<li class="chapter" data-level="16.6" data-path="causation.html"><a href="causation.html#mediation"><i class="fa fa-check"></i><b>16.6</b> Mediation</a>
<ul>
<li class="chapter" data-level="16.6.1" data-path="causation.html"><a href="causation.html#generate-data"><i class="fa fa-check"></i><b>16.6.1</b> Generate data</a></li>
<li class="chapter" data-level="16.6.2" data-path="causation.html"><a href="causation.html#method-1-baron-kennys-1986-indirect-effect-method"><i class="fa fa-check"></i><b>16.6.2</b> Method 1: Baron &amp; Kenny’s (1986) indirect effect method</a></li>
<li class="chapter" data-level="16.6.3" data-path="causation.html"><a href="causation.html#method-2-sobel-test"><i class="fa fa-check"></i><b>16.6.3</b> Method 2: Sobel Test</a></li>
<li class="chapter" data-level="16.6.4" data-path="causation.html"><a href="causation.html#method-3-bootstrapping"><i class="fa fa-check"></i><b>16.6.4</b> Method 3: Bootstrapping</a></li>
<li class="chapter" data-level="16.6.5" data-path="causation.html"><a href="causation.html#be-careful-about-mediation"><i class="fa fa-check"></i><b>16.6.5</b> Be careful about mediation!</a></li>
</ul></li>
<li class="chapter" data-level="16.7" data-path="causation.html"><a href="causation.html#moderation"><i class="fa fa-check"></i><b>16.7</b> Moderation</a>
<ul>
<li class="chapter" data-level="16.7.1" data-path="causation.html"><a href="causation.html#generate-data-1"><i class="fa fa-check"></i><b>16.7.1</b> Generate data</a></li>
<li class="chapter" data-level="16.7.2" data-path="causation.html"><a href="causation.html#moderation-analysis"><i class="fa fa-check"></i><b>16.7.2</b> Moderation analysis</a></li>
</ul></li>
<li class="chapter" data-level="16.8" data-path="causation.html"><a href="causation.html#additional-resources-13"><i class="fa fa-check"></i><b>16.8</b> Additional resources</a>
<ul>
<li class="chapter" data-level="16.8.1" data-path="causation.html"><a href="causation.html#books"><i class="fa fa-check"></i><b>16.8.1</b> Books</a></li>
<li class="chapter" data-level="16.8.2" data-path="causation.html"><a href="causation.html#tutorials-1"><i class="fa fa-check"></i><b>16.8.2</b> Tutorials</a></li>
<li class="chapter" data-level="16.8.3" data-path="causation.html"><a href="causation.html#misc-8"><i class="fa fa-check"></i><b>16.8.3</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="16.9" data-path="causation.html"><a href="causation.html#session-info-15"><i class="fa fa-check"></i><b>16.9</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html"><i class="fa fa-check"></i><b>17</b> Linear mixed effects models 1</a>
<ul>
<li class="chapter" data-level="17.1" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html#learning-goals-8"><i class="fa fa-check"></i><b>17.1</b> Learning goals</a></li>
<li class="chapter" data-level="17.2" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html#load-packages-and-set-plotting-theme-10"><i class="fa fa-check"></i><b>17.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="17.3" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html#dependence"><i class="fa fa-check"></i><b>17.3</b> Dependence</a></li>
<li class="chapter" data-level="17.4" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html#additional-resources-14"><i class="fa fa-check"></i><b>17.4</b> Additional resources</a>
<ul>
<li class="chapter" data-level="17.4.1" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html#readings"><i class="fa fa-check"></i><b>17.4.1</b> Readings</a></li>
</ul></li>
<li class="chapter" data-level="17.5" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html#session-info-16"><i class="fa fa-check"></i><b>17.5</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html"><i class="fa fa-check"></i><b>18</b> Linear mixed effects models 2</a>
<ul>
<li class="chapter" data-level="18.1" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#learning-goals-9"><i class="fa fa-check"></i><b>18.1</b> Learning goals</a></li>
<li class="chapter" data-level="18.2" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#load-packages-and-set-plotting-theme-11"><i class="fa fa-check"></i><b>18.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="18.3" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#a-worked-example"><i class="fa fa-check"></i><b>18.3</b> A worked example</a>
<ul>
<li class="chapter" data-level="18.3.1" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#complete-pooling"><i class="fa fa-check"></i><b>18.3.1</b> Complete pooling</a></li>
<li class="chapter" data-level="18.3.2" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#no-pooling"><i class="fa fa-check"></i><b>18.3.2</b> No pooling</a></li>
<li class="chapter" data-level="18.3.3" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#partial-pooling"><i class="fa fa-check"></i><b>18.3.3</b> Partial pooling</a></li>
<li class="chapter" data-level="18.3.4" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#compare-results"><i class="fa fa-check"></i><b>18.3.4</b> Compare results</a></li>
<li class="chapter" data-level="18.3.5" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#getting-p-values"><i class="fa fa-check"></i><b>18.3.5</b> Getting p-values</a></li>
<li class="chapter" data-level="18.3.6" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#reporting-results"><i class="fa fa-check"></i><b>18.3.6</b> Reporting results</a></li>
</ul></li>
<li class="chapter" data-level="18.4" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#simulating-a-linear-mixed-effects-model"><i class="fa fa-check"></i><b>18.4</b> Simulating a linear mixed effects model</a>
<ul>
<li class="chapter" data-level="18.4.1" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#the-effect-of-outliers"><i class="fa fa-check"></i><b>18.4.1</b> The effect of outliers</a></li>
<li class="chapter" data-level="18.4.2" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#different-slopes"><i class="fa fa-check"></i><b>18.4.2</b> Different slopes</a></li>
<li class="chapter" data-level="18.4.3" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#simpsons-paradox"><i class="fa fa-check"></i><b>18.4.3</b> Simpson’s paradox</a></li>
</ul></li>
<li class="chapter" data-level="18.5" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#additional-resources-15"><i class="fa fa-check"></i><b>18.5</b> Additional resources</a>
<ul>
<li class="chapter" data-level="18.5.1" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#readings-1"><i class="fa fa-check"></i><b>18.5.1</b> Readings</a></li>
</ul></li>
<li class="chapter" data-level="18.6" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#session-info-17"><i class="fa fa-check"></i><b>18.6</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html"><i class="fa fa-check"></i><b>19</b> Linear mixed effects models 3</a>
<ul>
<li class="chapter" data-level="19.1" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#learning-goals-10"><i class="fa fa-check"></i><b>19.1</b> Learning goals</a></li>
<li class="chapter" data-level="19.2" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#load-packages-and-set-plotting-theme-12"><i class="fa fa-check"></i><b>19.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="19.3" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#load-data-sets-4"><i class="fa fa-check"></i><b>19.3</b> Load data sets</a>
<ul>
<li class="chapter" data-level="19.3.1" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#sleep-data"><i class="fa fa-check"></i><b>19.3.1</b> Sleep data</a></li>
<li class="chapter" data-level="19.3.2" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#reasoning-data"><i class="fa fa-check"></i><b>19.3.2</b> Reasoning data</a></li>
<li class="chapter" data-level="19.3.3" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#weight-loss-data"><i class="fa fa-check"></i><b>19.3.3</b> Weight loss data</a></li>
<li class="chapter" data-level="19.3.4" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#politness-data"><i class="fa fa-check"></i><b>19.3.4</b> Politness data</a></li>
</ul></li>
<li class="chapter" data-level="19.4" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#understanding-the-lmer-syntax"><i class="fa fa-check"></i><b>19.4</b> Understanding the lmer() syntax</a></li>
<li class="chapter" data-level="19.5" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#anova-vs.-lmer"><i class="fa fa-check"></i><b>19.5</b> ANOVA vs. Lmer</a>
<ul>
<li class="chapter" data-level="19.5.1" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#between-subjects-anova"><i class="fa fa-check"></i><b>19.5.1</b> Between subjects ANOVA</a></li>
<li class="chapter" data-level="19.5.2" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#repeated-measures-anova"><i class="fa fa-check"></i><b>19.5.2</b> Repeated-measures ANOVA</a></li>
<li class="chapter" data-level="19.5.3" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#mixed-anova"><i class="fa fa-check"></i><b>19.5.3</b> Mixed ANOVA</a></li>
</ul></li>
<li class="chapter" data-level="19.6" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#session-info-18"><i class="fa fa-check"></i><b>19.6</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html"><i class="fa fa-check"></i><b>20</b> Linear mixed effects models 4</a>
<ul>
<li class="chapter" data-level="20.1" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#learning-goals-11"><i class="fa fa-check"></i><b>20.1</b> Learning goals</a></li>
<li class="chapter" data-level="20.2" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#load-packages-and-set-plotting-theme-13"><i class="fa fa-check"></i><b>20.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="20.3" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#load-data-sets-5"><i class="fa fa-check"></i><b>20.3</b> Load data sets</a>
<ul>
<li class="chapter" data-level="20.3.1" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#sleep-data-1"><i class="fa fa-check"></i><b>20.3.1</b> Sleep data</a></li>
<li class="chapter" data-level="20.3.2" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#reasoning-data-1"><i class="fa fa-check"></i><b>20.3.2</b> Reasoning data</a></li>
<li class="chapter" data-level="20.3.3" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#weight-loss-data-1"><i class="fa fa-check"></i><b>20.3.3</b> Weight loss data</a></li>
<li class="chapter" data-level="20.3.4" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#politness-data-1"><i class="fa fa-check"></i><b>20.3.4</b> Politness data</a></li>
</ul></li>
<li class="chapter" data-level="20.4" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#follow-up-tests-with-emmeans"><i class="fa fa-check"></i><b>20.4</b> Follow-up tests with emmeans</a>
<ul>
<li class="chapter" data-level="20.4.1" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#sleep-study"><i class="fa fa-check"></i><b>20.4.1</b> Sleep study</a></li>
<li class="chapter" data-level="20.4.2" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#weight-loss-study"><i class="fa fa-check"></i><b>20.4.2</b> Weight loss study</a></li>
<li class="chapter" data-level="20.4.3" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#politeness-study"><i class="fa fa-check"></i><b>20.4.3</b> Politeness study</a></li>
</ul></li>
<li class="chapter" data-level="20.5" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#mixtures-of-participants"><i class="fa fa-check"></i><b>20.5</b> Mixtures of participants</a></li>
<li class="chapter" data-level="20.6" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#bootstrapping"><i class="fa fa-check"></i><b>20.6</b> Bootstrapping</a>
<ul>
<li class="chapter" data-level="20.6.1" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#linear-model"><i class="fa fa-check"></i><b>20.6.1</b> Linear model</a></li>
</ul></li>
<li class="chapter" data-level="20.7" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#session-info-19"><i class="fa fa-check"></i><b>20.7</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html"><i class="fa fa-check"></i><b>21</b> Generalized linear model</a>
<ul>
<li class="chapter" data-level="21.1" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#learning-goals-12"><i class="fa fa-check"></i><b>21.1</b> Learning goals</a></li>
<li class="chapter" data-level="21.2" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#load-packages-and-set-plotting-theme-14"><i class="fa fa-check"></i><b>21.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="21.3" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#load-data-set"><i class="fa fa-check"></i><b>21.3</b> Load data set</a></li>
<li class="chapter" data-level="21.4" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#logistic-regression"><i class="fa fa-check"></i><b>21.4</b> Logistic regression</a>
<ul>
<li class="chapter" data-level="21.4.1" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#interpreting-the-parameters"><i class="fa fa-check"></i><b>21.4.1</b> Interpreting the parameters</a></li>
<li class="chapter" data-level="21.4.2" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#binary-predictor"><i class="fa fa-check"></i><b>21.4.2</b> Binary predictor</a></li>
<li class="chapter" data-level="21.4.3" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#continuous-predictor"><i class="fa fa-check"></i><b>21.4.3</b> Continuous predictor</a></li>
<li class="chapter" data-level="21.4.4" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#several-predictors"><i class="fa fa-check"></i><b>21.4.4</b> Several predictors</a></li>
<li class="chapter" data-level="21.4.5" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#using-the-ggeffects-package"><i class="fa fa-check"></i><b>21.4.5</b> Using the “ggeffects” package</a></li>
</ul></li>
<li class="chapter" data-level="21.5" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#simulate-a-logistic-regression"><i class="fa fa-check"></i><b>21.5</b> Simulate a logistic regression</a></li>
<li class="chapter" data-level="21.6" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#testing-hypotheses"><i class="fa fa-check"></i><b>21.6</b> Testing hypotheses</a></li>
<li class="chapter" data-level="21.7" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#logistic-mixed-effects-model"><i class="fa fa-check"></i><b>21.7</b> Logistic mixed effects model</a></li>
<li class="chapter" data-level="21.8" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#additional-information"><i class="fa fa-check"></i><b>21.8</b> Additional information</a>
<ul>
<li class="chapter" data-level="21.8.1" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#datacamp-7"><i class="fa fa-check"></i><b>21.8.1</b> Datacamp</a></li>
</ul></li>
<li class="chapter" data-level="21.9" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#session-info-20"><i class="fa fa-check"></i><b>21.9</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="bayesian-data-analysis.html"><a href="bayesian-data-analysis.html"><i class="fa fa-check"></i><b>22</b> Bayesian data analysis</a>
<ul>
<li class="chapter" data-level="22.1" data-path="bayesian-data-analysis.html"><a href="bayesian-data-analysis.html#learning-goals-13"><i class="fa fa-check"></i><b>22.1</b> Learning goals</a></li>
<li class="chapter" data-level="22.2" data-path="bayesian-data-analysis.html"><a href="bayesian-data-analysis.html#load-packages-and-set-plotting-theme-15"><i class="fa fa-check"></i><b>22.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="22.3" data-path="bayesian-data-analysis.html"><a href="bayesian-data-analysis.html#doing-bayesian-inference-by-hand"><i class="fa fa-check"></i><b>22.3</b> Doing Bayesian inference “by hand”</a>
<ul>
<li class="chapter" data-level="22.3.1" data-path="bayesian-data-analysis.html"><a href="bayesian-data-analysis.html#sequential-updating-based-on-the-beta-distribution"><i class="fa fa-check"></i><b>22.3.1</b> Sequential updating based on the Beta distribution</a></li>
<li class="chapter" data-level="22.3.2" data-path="bayesian-data-analysis.html"><a href="bayesian-data-analysis.html#coin-flip-example"><i class="fa fa-check"></i><b>22.3.2</b> Coin flip example</a></li>
<li class="chapter" data-level="22.3.3" data-path="bayesian-data-analysis.html"><a href="bayesian-data-analysis.html#bayesian-inference-by-discretization"><i class="fa fa-check"></i><b>22.3.3</b> Bayesian inference by discretization</a></li>
</ul></li>
<li class="chapter" data-level="22.4" data-path="bayesian-data-analysis.html"><a href="bayesian-data-analysis.html#doing-bayesian-inference-with-greta"><i class="fa fa-check"></i><b>22.4</b> Doing Bayesian inference with Greta</a>
<ul>
<li class="chapter" data-level="22.4.1" data-path="bayesian-data-analysis.html"><a href="bayesian-data-analysis.html#attitude-data-set"><i class="fa fa-check"></i><b>22.4.1</b> Attitude data set</a></li>
<li class="chapter" data-level="22.4.2" data-path="bayesian-data-analysis.html"><a href="bayesian-data-analysis.html#frequentist-analysis"><i class="fa fa-check"></i><b>22.4.2</b> Frequentist analysis</a></li>
<li class="chapter" data-level="22.4.3" data-path="bayesian-data-analysis.html"><a href="bayesian-data-analysis.html#bayesian-regression"><i class="fa fa-check"></i><b>22.4.3</b> Bayesian regression</a></li>
</ul></li>
<li class="chapter" data-level="22.5" data-path="bayesian-data-analysis.html"><a href="bayesian-data-analysis.html#session-info-21"><i class="fa fa-check"></i><b>22.5</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html"><i class="fa fa-check"></i><b>23</b> Bayesian data analysis 2</a>
<ul>
<li class="chapter" data-level="23.1" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#learning-goals-14"><i class="fa fa-check"></i><b>23.1</b> Learning goals</a></li>
<li class="chapter" data-level="23.2" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#load-packages-and-set-plotting-theme-16"><i class="fa fa-check"></i><b>23.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="23.3" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#load-data-sets-6"><i class="fa fa-check"></i><b>23.3</b> Load data sets</a></li>
<li class="chapter" data-level="23.4" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#poker"><i class="fa fa-check"></i><b>23.4</b> Poker</a>
<ul>
<li class="chapter" data-level="23.4.1" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#visualize-the-data"><i class="fa fa-check"></i><b>23.4.1</b> 1. Visualize the data</a></li>
<li class="chapter" data-level="23.4.2" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#specify-and-fit-the-model"><i class="fa fa-check"></i><b>23.4.2</b> 2. Specify and fit the model</a></li>
<li class="chapter" data-level="23.4.3" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#model-evaluation"><i class="fa fa-check"></i><b>23.4.3</b> 3. Model evaluation</a></li>
<li class="chapter" data-level="23.4.4" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#interpret-the-model-parameters"><i class="fa fa-check"></i><b>23.4.4</b> 4. Interpret the model parameters</a></li>
<li class="chapter" data-level="23.4.5" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#test-specific-hypotheses"><i class="fa fa-check"></i><b>23.4.5</b> 5. Test specific hypotheses</a></li>
</ul></li>
<li class="chapter" data-level="23.5" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#sleep-study-1"><i class="fa fa-check"></i><b>23.5</b> Sleep study</a>
<ul>
<li class="chapter" data-level="23.5.1" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#visualize-the-data-1"><i class="fa fa-check"></i><b>23.5.1</b> 1. Visualize the data</a></li>
<li class="chapter" data-level="23.5.2" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#specify-and-fit-the-model-1"><i class="fa fa-check"></i><b>23.5.2</b> 2. Specify and fit the model</a></li>
<li class="chapter" data-level="23.5.3" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#model-evaluation-1"><i class="fa fa-check"></i><b>23.5.3</b> 3. Model evaluation</a></li>
<li class="chapter" data-level="23.5.4" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#interpret-the-parameters"><i class="fa fa-check"></i><b>23.5.4</b> 4. Interpret the parameters</a></li>
<li class="chapter" data-level="23.5.5" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#test-specific-hypotheses-1"><i class="fa fa-check"></i><b>23.5.5</b> 5. Test specific hypotheses</a></li>
<li class="chapter" data-level="23.5.6" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#report-results"><i class="fa fa-check"></i><b>23.5.6</b> 6. Report results</a></li>
</ul></li>
<li class="chapter" data-level="23.6" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#titanic-study"><i class="fa fa-check"></i><b>23.6</b> Titanic study</a>
<ul>
<li class="chapter" data-level="23.6.1" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#visualize-that-data"><i class="fa fa-check"></i><b>23.6.1</b> 1. Visualize that data</a></li>
<li class="chapter" data-level="23.6.2" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#specify-and-fit-the-model-2"><i class="fa fa-check"></i><b>23.6.2</b> 2. Specify and fit the model</a></li>
<li class="chapter" data-level="23.6.3" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#model-evaluation-2"><i class="fa fa-check"></i><b>23.6.3</b> 3. Model evaluation</a></li>
<li class="chapter" data-level="23.6.4" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#interpret-the-parameters-1"><i class="fa fa-check"></i><b>23.6.4</b> 4. Interpret the parameters</a></li>
<li class="chapter" data-level="23.6.5" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#test-specific-hypotheses-2"><i class="fa fa-check"></i><b>23.6.5</b> 5. Test specific hypotheses</a></li>
<li class="chapter" data-level="23.6.6" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#report-results-1"><i class="fa fa-check"></i><b>23.6.6</b> 6. Report results</a></li>
</ul></li>
<li class="chapter" data-level="23.7" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#politeness-data"><i class="fa fa-check"></i><b>23.7</b> Politeness data</a>
<ul>
<li class="chapter" data-level="23.7.1" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#visualize-the-data-2"><i class="fa fa-check"></i><b>23.7.1</b> 1. Visualize the data</a></li>
<li class="chapter" data-level="23.7.2" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#specify-and-fit-the-model-3"><i class="fa fa-check"></i><b>23.7.2</b> 2. Specify and fit the model</a></li>
<li class="chapter" data-level="23.7.3" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#test-specific-hypotheses-3"><i class="fa fa-check"></i><b>23.7.3</b> 5. Test specific hypotheses</a></li>
</ul></li>
<li class="chapter" data-level="23.8" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#additional-resources-16"><i class="fa fa-check"></i><b>23.8</b> Additional resources</a></li>
<li class="chapter" data-level="23.9" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#session-info-22"><i class="fa fa-check"></i><b>23.9</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html"><i class="fa fa-check"></i><b>24</b> Bayesian data analysis 3</a>
<ul>
<li class="chapter" data-level="24.1" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#learning-goals-15"><i class="fa fa-check"></i><b>24.1</b> Learning goals</a></li>
<li class="chapter" data-level="24.2" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#load-packages-and-set-plotting-theme-17"><i class="fa fa-check"></i><b>24.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="24.3" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#evidence-for-the-null-hypothesis"><i class="fa fa-check"></i><b>24.3</b> Evidence for the null hypothesis</a>
<ul>
<li class="chapter" data-level="24.3.1" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#bayes-factor-1"><i class="fa fa-check"></i><b>24.3.1</b> Bayes factor</a></li>
<li class="chapter" data-level="24.3.2" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#loo"><i class="fa fa-check"></i><b>24.3.2</b> LOO</a></li>
</ul></li>
<li class="chapter" data-level="24.4" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#dealing-with-heteroscedasticity"><i class="fa fa-check"></i><b>24.4</b> Dealing with heteroscedasticity</a>
<ul>
<li class="chapter" data-level="24.4.1" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#visualize-the-data-3"><i class="fa fa-check"></i><b>24.4.1</b> Visualize the data</a></li>
<li class="chapter" data-level="24.4.2" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#frequentist-analysis-4"><i class="fa fa-check"></i><b>24.4.2</b> Frequentist analysis</a></li>
<li class="chapter" data-level="24.4.3" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#bayesian-analysis-3"><i class="fa fa-check"></i><b>24.4.3</b> Bayesian analysis</a></li>
</ul></li>
<li class="chapter" data-level="24.5" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#zero-one-inflated-beta-binomial-model"><i class="fa fa-check"></i><b>24.5</b> Zero-one inflated beta binomial model</a></li>
<li class="chapter" data-level="24.6" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#ordinal-regression"><i class="fa fa-check"></i><b>24.6</b> Ordinal regression</a>
<ul>
<li class="chapter" data-level="24.6.1" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#ordinal-regression-assuming-equal-variance"><i class="fa fa-check"></i><b>24.6.1</b> Ordinal regression (assuming equal variance)</a></li>
<li class="chapter" data-level="24.6.2" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#gaussian-regression-assuming-equal-variance"><i class="fa fa-check"></i><b>24.6.2</b> Gaussian regression (assuming equal variance)</a></li>
<li class="chapter" data-level="24.6.3" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#oridnal-regression-unequal-variance"><i class="fa fa-check"></i><b>24.6.3</b> Oridnal regression (unequal variance)</a></li>
<li class="chapter" data-level="24.6.4" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#gaussian-regression-unequal-variance"><i class="fa fa-check"></i><b>24.6.4</b> Gaussian regression (unequal variance)</a></li>
<li class="chapter" data-level="24.6.5" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#model-comparison-2"><i class="fa fa-check"></i><b>24.6.5</b> Model comparison</a></li>
</ul></li>
<li class="chapter" data-level="24.7" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#additional-resources-17"><i class="fa fa-check"></i><b>24.7</b> Additional resources</a></li>
<li class="chapter" data-level="24.8" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#session-info-23"><i class="fa fa-check"></i><b>24.8</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="25" data-path="model-assumptions.html"><a href="model-assumptions.html"><i class="fa fa-check"></i><b>25</b> Model assumptions</a>
<ul>
<li class="chapter" data-level="25.1" data-path="model-assumptions.html"><a href="model-assumptions.html#learning-goals-16"><i class="fa fa-check"></i><b>25.1</b> Learning goals</a></li>
<li class="chapter" data-level="25.2" data-path="model-assumptions.html"><a href="model-assumptions.html#load-packages-and-set-plotting-theme-18"><i class="fa fa-check"></i><b>25.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="25.3" data-path="model-assumptions.html"><a href="model-assumptions.html#model-assumptions-and-what-to-do-if-they-are-violated"><i class="fa fa-check"></i><b>25.3</b> Model assumptions and what to do if they are violated</a>
<ul>
<li class="chapter" data-level="25.3.1" data-path="model-assumptions.html"><a href="model-assumptions.html#influential-data-points"><i class="fa fa-check"></i><b>25.3.1</b> Influential data points</a></li>
<li class="chapter" data-level="25.3.2" data-path="model-assumptions.html"><a href="model-assumptions.html#linear-and-additive"><i class="fa fa-check"></i><b>25.3.2</b> Linear and additive</a></li>
<li class="chapter" data-level="25.3.3" data-path="model-assumptions.html"><a href="model-assumptions.html#normally-distributed-residuals"><i class="fa fa-check"></i><b>25.3.3</b> Normally distributed residuals</a></li>
<li class="chapter" data-level="25.3.4" data-path="model-assumptions.html"><a href="model-assumptions.html#non-parametric-tests"><i class="fa fa-check"></i><b>25.3.4</b> Non-parametric tests</a></li>
<li class="chapter" data-level="25.3.5" data-path="model-assumptions.html"><a href="model-assumptions.html#bootstrapping-regressions"><i class="fa fa-check"></i><b>25.3.5</b> Bootstrapping regressions</a></li>
</ul></li>
<li class="chapter" data-level="25.4" data-path="model-assumptions.html"><a href="model-assumptions.html#additional-resources-18"><i class="fa fa-check"></i><b>25.4</b> Additional resources</a></li>
<li class="chapter" data-level="25.5" data-path="model-assumptions.html"><a href="model-assumptions.html#session-info-24"><i class="fa fa-check"></i><b>25.5</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="26" data-path="reporting-statistics.html"><a href="reporting-statistics.html"><i class="fa fa-check"></i><b>26</b> Reporting statistics</a>
<ul>
<li class="chapter" data-level="26.1" data-path="reporting-statistics.html"><a href="reporting-statistics.html#general-advice"><i class="fa fa-check"></i><b>26.1</b> General advice</a>
<ul>
<li class="chapter" data-level="26.1.1" data-path="reporting-statistics.html"><a href="reporting-statistics.html#make-good-figures"><i class="fa fa-check"></i><b>26.1.1</b> Make good figures!</a></li>
<li class="chapter" data-level="26.1.2" data-path="reporting-statistics.html"><a href="reporting-statistics.html#use-statistical-models-to-answer-concrete-research-questions."><i class="fa fa-check"></i><b>26.1.2</b> Use statistical models to answer concrete research questions.</a></li>
<li class="chapter" data-level="26.1.3" data-path="reporting-statistics.html"><a href="reporting-statistics.html#illustrate-the-uncertainty-in-your-statistical-inferences."><i class="fa fa-check"></i><b>26.1.3</b> Illustrate the uncertainty in your statistical inferences.</a></li>
<li class="chapter" data-level="26.1.4" data-path="reporting-statistics.html"><a href="reporting-statistics.html#report-effect-sizes."><i class="fa fa-check"></i><b>26.1.4</b> Report effect sizes.</a></li>
<li class="chapter" data-level="26.1.5" data-path="reporting-statistics.html"><a href="reporting-statistics.html#reporting-statistical-results-using-rmarkdown"><i class="fa fa-check"></i><b>26.1.5</b> Reporting statistical results using RMarkdown</a></li>
</ul></li>
<li class="chapter" data-level="26.2" data-path="reporting-statistics.html"><a href="reporting-statistics.html#some-concrete-example"><i class="fa fa-check"></i><b>26.2</b> Some concrete example</a>
<ul>
<li class="chapter" data-level="26.2.1" data-path="reporting-statistics.html"><a href="reporting-statistics.html#frequentist-statistics"><i class="fa fa-check"></i><b>26.2.1</b> Frequentist statistics</a></li>
</ul></li>
<li class="chapter" data-level="26.3" data-path="reporting-statistics.html"><a href="reporting-statistics.html#session-info-25"><i class="fa fa-check"></i><b>26.3</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="27" data-path="cheatsheets-6.html"><a href="cheatsheets-6.html"><i class="fa fa-check"></i><b>27</b> Cheatsheets</a>
<ul>
<li class="chapter" data-level="27.1" data-path="cheatsheets-6.html"><a href="cheatsheets-6.html#statistics"><i class="fa fa-check"></i><b>27.1</b> Statistics</a></li>
<li class="chapter" data-level="27.2" data-path="cheatsheets-6.html"><a href="cheatsheets-6.html#r"><i class="fa fa-check"></i><b>27.2</b> R</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references-1.html"><a href="references-1.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Psych 252: Statistical Methods for Behavioral and Social Sciences</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="simulation-1" class="section level1 hasAnchor" number="7">
<h1><span class="header-section-number">Chapter 7</span> Simulation 1<a href="simulation-1.html#simulation-1" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="load-packages-and-set-plotting-theme" class="section level2 hasAnchor" number="7.1">
<h2><span class="header-section-number">7.1</span> Load packages and set plotting theme<a href="simulation-1.html#load-packages-and-set-plotting-theme" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb385"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb385-1"><a href="simulation-1.html#cb385-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;knitr&quot;</span>)</span>
<span id="cb385-2"><a href="simulation-1.html#cb385-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;kableExtra&quot;</span>)</span>
<span id="cb385-3"><a href="simulation-1.html#cb385-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;MASS&quot;</span>)</span>
<span id="cb385-4"><a href="simulation-1.html#cb385-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;patchwork&quot;</span>)</span>
<span id="cb385-5"><a href="simulation-1.html#cb385-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;tidyverse&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb386"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb386-1"><a href="simulation-1.html#cb386-1" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_classic</span>() <span class="sc">+</span> <span class="co">#set the theme </span></span>
<span id="cb386-2"><a href="simulation-1.html#cb386-2" aria-hidden="true" tabindex="-1"></a>            <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>))) <span class="co">#set the default text size</span></span>
<span id="cb386-3"><a href="simulation-1.html#cb386-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb386-4"><a href="simulation-1.html#cb386-4" aria-hidden="true" tabindex="-1"></a>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">comment =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb386-5"><a href="simulation-1.html#cb386-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">fig.show =</span> <span class="st">&quot;hold&quot;</span>)</span></code></pre></div>
</div>
<div id="sampling" class="section level2 hasAnchor" number="7.2">
<h2><span class="header-section-number">7.2</span> Sampling<a href="simulation-1.html#sampling" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="drawing-numbers-from-a-vector" class="section level3 hasAnchor" number="7.2.1">
<h3><span class="header-section-number">7.2.1</span> Drawing numbers from a vector<a href="simulation-1.html#drawing-numbers-from-a-vector" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb387"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb387-1"><a href="simulation-1.html#cb387-1" aria-hidden="true" tabindex="-1"></a>numbers <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span></span>
<span id="cb387-2"><a href="simulation-1.html#cb387-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb387-3"><a href="simulation-1.html#cb387-3" aria-hidden="true" tabindex="-1"></a>numbers <span class="sc">%&gt;%</span> </span>
<span id="cb387-4"><a href="simulation-1.html#cb387-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sample</span>(<span class="at">size =</span> <span class="dv">10</span>,</span>
<span id="cb387-5"><a href="simulation-1.html#cb387-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">replace =</span> T)</span></code></pre></div>
<pre><code> [1] 2 2 1 1 2 3 3 2 2 1</code></pre>
<p>Use the <code>prob =</code> argument to change the probability with which each number should be drawn.</p>
<div class="sourceCode" id="cb389"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb389-1"><a href="simulation-1.html#cb389-1" aria-hidden="true" tabindex="-1"></a>numbers <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span></span>
<span id="cb389-2"><a href="simulation-1.html#cb389-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb389-3"><a href="simulation-1.html#cb389-3" aria-hidden="true" tabindex="-1"></a>numbers <span class="sc">%&gt;%</span> </span>
<span id="cb389-4"><a href="simulation-1.html#cb389-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sample</span>(<span class="at">size =</span> <span class="dv">10</span>,</span>
<span id="cb389-5"><a href="simulation-1.html#cb389-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">replace =</span> T,</span>
<span id="cb389-6"><a href="simulation-1.html#cb389-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.8</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>))</span></code></pre></div>
<pre><code> [1] 3 1 1 2 1 1 1 1 2 1</code></pre>
<p>Make sure to set the seed in order to make your code reproducible. The code chunk below may give a different outcome each time is run.</p>
<div class="sourceCode" id="cb391"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb391-1"><a href="simulation-1.html#cb391-1" aria-hidden="true" tabindex="-1"></a>numbers <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span></span>
<span id="cb391-2"><a href="simulation-1.html#cb391-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb391-3"><a href="simulation-1.html#cb391-3" aria-hidden="true" tabindex="-1"></a>numbers <span class="sc">%&gt;%</span> </span>
<span id="cb391-4"><a href="simulation-1.html#cb391-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sample</span>(<span class="dv">5</span>)</span></code></pre></div>
<pre><code>[1] 5 2 1 4 3</code></pre>
<p>The chunk below will produce the same outcome every time it’s run.</p>
<div class="sourceCode" id="cb393"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb393-1"><a href="simulation-1.html#cb393-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb393-2"><a href="simulation-1.html#cb393-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb393-3"><a href="simulation-1.html#cb393-3" aria-hidden="true" tabindex="-1"></a>numbers <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span></span>
<span id="cb393-4"><a href="simulation-1.html#cb393-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb393-5"><a href="simulation-1.html#cb393-5" aria-hidden="true" tabindex="-1"></a>numbers <span class="sc">%&gt;%</span> </span>
<span id="cb393-6"><a href="simulation-1.html#cb393-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sample</span>(<span class="dv">5</span>)</span></code></pre></div>
<pre><code>[1] 1 4 3 5 2</code></pre>
</div>
<div id="drawing-rows-from-a-data-frame" class="section level3 hasAnchor" number="7.2.2">
<h3><span class="header-section-number">7.2.2</span> Drawing rows from a data frame<a href="simulation-1.html#drawing-rows-from-a-data-frame" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Generate a data frame.</p>
<div class="sourceCode" id="cb395"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb395-1"><a href="simulation-1.html#cb395-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb395-2"><a href="simulation-1.html#cb395-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">10</span></span>
<span id="cb395-3"><a href="simulation-1.html#cb395-3" aria-hidden="true" tabindex="-1"></a>df.data <span class="ot">=</span> <span class="fu">tibble</span>(<span class="at">trial =</span> <span class="dv">1</span><span class="sc">:</span>n,</span>
<span id="cb395-4"><a href="simulation-1.html#cb395-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">stimulus =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">&quot;flower&quot;</span>, <span class="st">&quot;pet&quot;</span>), <span class="at">size =</span> n, <span class="at">replace =</span> T),</span>
<span id="cb395-5"><a href="simulation-1.html#cb395-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">rating =</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="at">size =</span> n, <span class="at">replace =</span> T))</span></code></pre></div>
<p>Sample a given number of rows.</p>
<div class="sourceCode" id="cb396"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb396-1"><a href="simulation-1.html#cb396-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb396-2"><a href="simulation-1.html#cb396-2" aria-hidden="true" tabindex="-1"></a>df.data <span class="sc">%&gt;%</span> </span>
<span id="cb396-3"><a href="simulation-1.html#cb396-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">6</span>, </span>
<span id="cb396-4"><a href="simulation-1.html#cb396-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">replace =</span> T)</span></code></pre></div>
<pre><code># A tibble: 6 × 3
  trial stimulus rating
  &lt;int&gt; &lt;chr&gt;     &lt;int&gt;
1     9 pet           9
2     4 flower        5
3     7 flower       10
4     1 flower        3
5     2 pet           1
6     7 flower       10</code></pre>
<div class="sourceCode" id="cb398"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb398-1"><a href="simulation-1.html#cb398-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb398-2"><a href="simulation-1.html#cb398-2" aria-hidden="true" tabindex="-1"></a>df.data <span class="sc">%&gt;%</span> </span>
<span id="cb398-3"><a href="simulation-1.html#cb398-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_sample</span>(<span class="at">prop =</span> <span class="fl">0.5</span>)</span></code></pre></div>
<pre><code># A tibble: 5 × 3
  trial stimulus rating
  &lt;int&gt; &lt;chr&gt;     &lt;int&gt;
1     9 pet           9
2     4 flower        5
3     7 flower       10
4     1 flower        3
5     2 pet           1</code></pre>
<p>Note that there is a whole family of <code>slice()</code> functions in dplyr. Take a look at the help file here:</p>
<div class="sourceCode" id="cb400"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb400-1"><a href="simulation-1.html#cb400-1" aria-hidden="true" tabindex="-1"></a><span class="fu">help</span>(slice)</span></code></pre></div>
</div>
</div>
<div id="working-with-distributions" class="section level2 hasAnchor" number="7.3">
<h2><span class="header-section-number">7.3</span> Working with distributions<a href="simulation-1.html#working-with-distributions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Every distribution that R handles has four functions. There is a root name, for example, the root name for the normal distribution is <code>norm</code>. This root is prefixed by one of the letters here:</p>
<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
letter
</th>
<th style="text-align:left;">
description
</th>
<th style="text-align:left;">
example
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
<code>d</code>
</td>
<td style="text-align:left;">
for “<strong>density</strong>”, the density function (probability function (for <em>discrete</em> variables) or probability density function (for <em>continuous</em> variables))
</td>
<td style="text-align:left;">
<code>dnorm()</code>
</td>
</tr>
<tr>
<td style="text-align:left;">
<code>p</code>
</td>
<td style="text-align:left;">
for “<strong>probability</strong>”, the cumulative distribution function
</td>
<td style="text-align:left;">
<code>pnorm()</code>
</td>
</tr>
<tr>
<td style="text-align:left;">
<code>q</code>
</td>
<td style="text-align:left;">
for “<strong>quantile</strong>”, the inverse cumulative distribution function
</td>
<td style="text-align:left;">
<code>qnorm()</code>
</td>
</tr>
<tr>
<td style="text-align:left;">
<code>r</code>
</td>
<td style="text-align:left;">
for “<strong>random</strong>”, a random variable having the specified distribution
</td>
<td style="text-align:left;">
<code>rnorm()</code>
</td>
</tr>
</tbody>
</table>
<p>For the normal distribution, these functions are <code>dnorm</code>, <code>pnorm</code>, <code>qnorm</code>, and <code>rnorm</code>. For the binomial distribution, these functions are <code>dbinom</code>, <code>pbinom</code>, <code>qbinom</code>, and <code>rbinom</code>. And so forth.</p>
<p>You can get more info about the distributions that come with R via running <code>help(Distributions)</code> in your console. If you need a distribution that doesn’t already come with R, then take a look <a href="https://cran.r-project.org/web/views/Distributions.html">here</a> for many more distributions that can be loaded with different R packages.</p>
<div id="plotting-distributions" class="section level3 hasAnchor" number="7.3.1">
<h3><span class="header-section-number">7.3.1</span> Plotting distributions<a href="simulation-1.html#plotting-distributions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Here’s an easy way to plot distributions in <code>ggplot2</code> using the <code>stat_function()</code> function. We take a look at a normal distribution of height (in cm) with <code>mean = 180</code> and <code>sd = 10</code> (as this is the example we run with in class).</p>
<div class="sourceCode" id="cb401"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb401-1"><a href="simulation-1.html#cb401-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">tibble</span>(<span class="at">height =</span> <span class="fu">c</span>(<span class="dv">150</span>, <span class="dv">210</span>)),</span>
<span id="cb401-2"><a href="simulation-1.html#cb401-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> height)) <span class="sc">+</span></span>
<span id="cb401-3"><a href="simulation-1.html#cb401-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> <span class="sc">~</span> <span class="fu">dnorm</span>(., <span class="at">mean =</span> <span class="dv">180</span>, <span class="at">sd =</span> <span class="dv">10</span>))</span></code></pre></div>
<p><img src="07-simulation1_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<p>Note that the data frame I created with <code>tibble()</code> only needs to have the minimum and the maximum value of the x-range that we are interested in. Here, I chose <code>150</code> and <code>210</code> as the minimum and maximum, respectively (which is the mean +/- 3 standard deviations).</p>
<p>The <code>stat_function()</code> is very flexible. We can define our own functions and plot these like here:</p>
<div class="sourceCode" id="cb402"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb402-1"><a href="simulation-1.html#cb402-1" aria-hidden="true" tabindex="-1"></a><span class="co"># define the breakpoint function </span></span>
<span id="cb402-2"><a href="simulation-1.html#cb402-2" aria-hidden="true" tabindex="-1"></a>fun.breakpoint <span class="ot">=</span> <span class="cf">function</span>(x, breakpoint){</span>
<span id="cb402-3"><a href="simulation-1.html#cb402-3" aria-hidden="true" tabindex="-1"></a>  x[x <span class="sc">&lt;</span> breakpoint] <span class="ot">=</span> breakpoint</span>
<span id="cb402-4"><a href="simulation-1.html#cb402-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(x)</span>
<span id="cb402-5"><a href="simulation-1.html#cb402-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb402-6"><a href="simulation-1.html#cb402-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb402-7"><a href="simulation-1.html#cb402-7" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the function</span></span>
<span id="cb402-8"><a href="simulation-1.html#cb402-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">5</span>)),</span>
<span id="cb402-9"><a href="simulation-1.html#cb402-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> x)) <span class="sc">+</span></span>
<span id="cb402-10"><a href="simulation-1.html#cb402-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> <span class="sc">~</span> <span class="fu">fun.breakpoint</span>(., <span class="at">breakpoint =</span> <span class="dv">2</span>))</span></code></pre></div>
<p><img src="07-simulation1_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<p>Here, I defined a breakpoint function. If the value of <code>x</code> is below the breakpoint, <code>y</code> equals the value of the breakpoint. If the value of <code>x</code> is greater than the breakpoint, then <code>y</code> equals <code>x</code>.</p>
</div>
<div id="sampling-from-distributions" class="section level3 hasAnchor" number="7.3.2">
<h3><span class="header-section-number">7.3.2</span> Sampling from distributions<a href="simulation-1.html#sampling-from-distributions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>For each distribution, R provides a way of sampling random number from this distribution. For the normal distribution, we can use the <code>rnorm()</code> function to take random samples.</p>
<p>So let’s take some random samples and plot a histogram.</p>
<div class="sourceCode" id="cb403"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb403-1"><a href="simulation-1.html#cb403-1" aria-hidden="true" tabindex="-1"></a><span class="co"># make this example reproducible </span></span>
<span id="cb403-2"><a href="simulation-1.html#cb403-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb403-3"><a href="simulation-1.html#cb403-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb403-4"><a href="simulation-1.html#cb403-4" aria-hidden="true" tabindex="-1"></a><span class="co"># define how many samples to draw </span></span>
<span id="cb403-5"><a href="simulation-1.html#cb403-5" aria-hidden="true" tabindex="-1"></a>tmp.nsamples <span class="ot">=</span> <span class="dv">100</span></span>
<span id="cb403-6"><a href="simulation-1.html#cb403-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb403-7"><a href="simulation-1.html#cb403-7" aria-hidden="true" tabindex="-1"></a><span class="co"># make a data frame with the samples</span></span>
<span id="cb403-8"><a href="simulation-1.html#cb403-8" aria-hidden="true" tabindex="-1"></a>df.plot <span class="ot">=</span> <span class="fu">tibble</span>(<span class="at">height =</span> <span class="fu">rnorm</span>(<span class="at">n =</span> tmp.nsamples, <span class="at">mean =</span> <span class="dv">180</span>, <span class="at">sd =</span> <span class="dv">10</span>))</span>
<span id="cb403-9"><a href="simulation-1.html#cb403-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb403-10"><a href="simulation-1.html#cb403-10" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the samples using a histogram </span></span>
<span id="cb403-11"><a href="simulation-1.html#cb403-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df.plot,</span>
<span id="cb403-12"><a href="simulation-1.html#cb403-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> height)) <span class="sc">+</span></span>
<span id="cb403-13"><a href="simulation-1.html#cb403-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>,</span>
<span id="cb403-14"><a href="simulation-1.html#cb403-14" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb403-15"><a href="simulation-1.html#cb403-15" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb403-16"><a href="simulation-1.html#cb403-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">160</span>, <span class="dv">180</span>, <span class="dv">200</span>)) <span class="sc">+</span></span>
<span id="cb403-17"><a href="simulation-1.html#cb403-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">150</span>, <span class="dv">210</span>), <span class="at">expand =</span> F)</span>
<span id="cb403-18"><a href="simulation-1.html#cb403-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb403-19"><a href="simulation-1.html#cb403-19" aria-hidden="true" tabindex="-1"></a><span class="co"># remove all variables with tmp in their name </span></span>
<span id="cb403-20"><a href="simulation-1.html#cb403-20" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>() <span class="sc">%&gt;%</span> <span class="fu">str_subset</span>(<span class="at">pattern =</span> <span class="st">&quot;tmp.&quot;</span>))</span></code></pre></div>
<p><img src="07-simulation1_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<p>Let’s see how many samples it takes to closely approximate the shape of the normal distribution with our histogram of samples.</p>
<div class="sourceCode" id="cb404"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb404-1"><a href="simulation-1.html#cb404-1" aria-hidden="true" tabindex="-1"></a><span class="co"># make this example reproducible </span></span>
<span id="cb404-2"><a href="simulation-1.html#cb404-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb404-3"><a href="simulation-1.html#cb404-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb404-4"><a href="simulation-1.html#cb404-4" aria-hidden="true" tabindex="-1"></a><span class="co"># play around with this value</span></span>
<span id="cb404-5"><a href="simulation-1.html#cb404-5" aria-hidden="true" tabindex="-1"></a><span class="co"># tmp.nsamples = 100</span></span>
<span id="cb404-6"><a href="simulation-1.html#cb404-6" aria-hidden="true" tabindex="-1"></a>tmp.nsamples <span class="ot">=</span> <span class="dv">10000</span></span>
<span id="cb404-7"><a href="simulation-1.html#cb404-7" aria-hidden="true" tabindex="-1"></a>tmp.binwidth <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb404-8"><a href="simulation-1.html#cb404-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb404-9"><a href="simulation-1.html#cb404-9" aria-hidden="true" tabindex="-1"></a><span class="co"># make a data frame with the samples</span></span>
<span id="cb404-10"><a href="simulation-1.html#cb404-10" aria-hidden="true" tabindex="-1"></a>df.plot <span class="ot">=</span> <span class="fu">tibble</span>(<span class="at">height =</span> <span class="fu">rnorm</span>(<span class="at">n =</span> tmp.nsamples,</span>
<span id="cb404-11"><a href="simulation-1.html#cb404-11" aria-hidden="true" tabindex="-1"></a>                                <span class="at">mean =</span> <span class="dv">180</span>,</span>
<span id="cb404-12"><a href="simulation-1.html#cb404-12" aria-hidden="true" tabindex="-1"></a>                                <span class="at">sd =</span> <span class="dv">10</span>)) </span>
<span id="cb404-13"><a href="simulation-1.html#cb404-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb404-14"><a href="simulation-1.html#cb404-14" aria-hidden="true" tabindex="-1"></a><span class="co"># adjust the density of the normal distribution based on the samples and binwidth </span></span>
<span id="cb404-15"><a href="simulation-1.html#cb404-15" aria-hidden="true" tabindex="-1"></a>fun.dnorm <span class="ot">=</span> <span class="cf">function</span>(x, mean, sd, n, binwidth){</span>
<span id="cb404-16"><a href="simulation-1.html#cb404-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dnorm</span>(<span class="at">x =</span> x, <span class="at">mean =</span> mean, <span class="at">sd =</span> sd) <span class="sc">*</span> n <span class="sc">*</span> binwidth</span>
<span id="cb404-17"><a href="simulation-1.html#cb404-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb404-18"><a href="simulation-1.html#cb404-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb404-19"><a href="simulation-1.html#cb404-19" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the samples using a histogram </span></span>
<span id="cb404-20"><a href="simulation-1.html#cb404-20" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df.plot,</span>
<span id="cb404-21"><a href="simulation-1.html#cb404-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> height)) <span class="sc">+</span></span>
<span id="cb404-22"><a href="simulation-1.html#cb404-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> tmp.binwidth,</span>
<span id="cb404-23"><a href="simulation-1.html#cb404-23" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb404-24"><a href="simulation-1.html#cb404-24" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb404-25"><a href="simulation-1.html#cb404-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> <span class="sc">~</span> <span class="fu">fun.dnorm</span>(<span class="at">x =</span> .,</span>
<span id="cb404-26"><a href="simulation-1.html#cb404-26" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">mean =</span> <span class="dv">180</span>,</span>
<span id="cb404-27"><a href="simulation-1.html#cb404-27" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">sd =</span> <span class="dv">10</span>,</span>
<span id="cb404-28"><a href="simulation-1.html#cb404-28" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">n =</span> tmp.nsamples,</span>
<span id="cb404-29"><a href="simulation-1.html#cb404-29" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">binwidth =</span> tmp.binwidth),</span>
<span id="cb404-30"><a href="simulation-1.html#cb404-30" aria-hidden="true" tabindex="-1"></a>                <span class="at">xlim =</span> <span class="fu">c</span>(<span class="fu">min</span>(df.plot<span class="sc">$</span>height), <span class="fu">max</span>(df.plot<span class="sc">$</span>height)),</span>
<span id="cb404-31"><a href="simulation-1.html#cb404-31" aria-hidden="true" tabindex="-1"></a>                <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb404-32"><a href="simulation-1.html#cb404-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb404-33"><a href="simulation-1.html#cb404-33" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">str_c</span>(<span class="st">&quot;n = &quot;</span>, tmp.nsamples),</span>
<span id="cb404-34"><a href="simulation-1.html#cb404-34" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="sc">-</span><span class="cn">Inf</span>,</span>
<span id="cb404-35"><a href="simulation-1.html#cb404-35" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> <span class="cn">Inf</span>,</span>
<span id="cb404-36"><a href="simulation-1.html#cb404-36" aria-hidden="true" tabindex="-1"></a>           <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.1</span>,</span>
<span id="cb404-37"><a href="simulation-1.html#cb404-37" aria-hidden="true" tabindex="-1"></a>           <span class="at">vjust =</span> <span class="fl">1.1</span>,</span>
<span id="cb404-38"><a href="simulation-1.html#cb404-38" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">10</span>,</span>
<span id="cb404-39"><a href="simulation-1.html#cb404-39" aria-hidden="true" tabindex="-1"></a>           <span class="at">family =</span> <span class="st">&quot;Courier New&quot;</span>) <span class="sc">+</span></span>
<span id="cb404-40"><a href="simulation-1.html#cb404-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">160</span>, <span class="dv">180</span>, <span class="dv">200</span>)) <span class="sc">+</span></span>
<span id="cb404-41"><a href="simulation-1.html#cb404-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">150</span>, <span class="dv">210</span>), <span class="at">expand =</span> F)</span>
<span id="cb404-42"><a href="simulation-1.html#cb404-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb404-43"><a href="simulation-1.html#cb404-43" aria-hidden="true" tabindex="-1"></a><span class="co"># remove all variables with tmp in their name </span></span>
<span id="cb404-44"><a href="simulation-1.html#cb404-44" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>() <span class="sc">%&gt;%</span> <span class="fu">str_subset</span>(<span class="at">pattern =</span> <span class="st">&quot;tmp.&quot;</span>))</span></code></pre></div>
<p><img src="07-simulation1_files/figure-html/unnamed-chunk-13-1.png" width="672" />
With 10,000 samples, our histogram of samples already closely resembles the theoretical shape of the normal distribution.</p>
<p>To keep my environment clean, I’ve named the parameters <code>tmp.nsamples</code> and <code>tmp.binwidth</code> and then, at the end of the code chunk, I removed all variables from the environment that have “tmp.” in their name using the <code>ls()</code> function (which prints out all variables in the environment as a vector), and the <code>str_subset()</code> function which filters out only those variables that contain the specified pattern.</p>
</div>
<div id="understanding-density" class="section level3 hasAnchor" number="7.3.3">
<h3><span class="header-section-number">7.3.3</span> Understanding <code>density()</code><a href="simulation-1.html#understanding-density" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>First, let’s calculate the density for a set of observations and store them in a data frame.</p>
<div class="sourceCode" id="cb405"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb405-1"><a href="simulation-1.html#cb405-1" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate density</span></span>
<span id="cb405-2"><a href="simulation-1.html#cb405-2" aria-hidden="true" tabindex="-1"></a>observations <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">1.2</span>, <span class="fl">1.5</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb405-3"><a href="simulation-1.html#cb405-3" aria-hidden="true" tabindex="-1"></a>bandwidth <span class="ot">=</span> <span class="fl">0.25</span> <span class="co"># bandwidth (= sd) of the Gaussian distribution </span></span>
<span id="cb405-4"><a href="simulation-1.html#cb405-4" aria-hidden="true" tabindex="-1"></a>tmp.density <span class="ot">=</span> <span class="fu">density</span>(observations,</span>
<span id="cb405-5"><a href="simulation-1.html#cb405-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">kernel =</span> <span class="st">&quot;gaussian&quot;</span>,</span>
<span id="cb405-6"><a href="simulation-1.html#cb405-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">bw =</span> bandwidth,</span>
<span id="cb405-7"><a href="simulation-1.html#cb405-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">n =</span> <span class="dv">512</span>)</span>
<span id="cb405-8"><a href="simulation-1.html#cb405-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb405-9"><a href="simulation-1.html#cb405-9" aria-hidden="true" tabindex="-1"></a><span class="co"># save density as data frame </span></span>
<span id="cb405-10"><a href="simulation-1.html#cb405-10" aria-hidden="true" tabindex="-1"></a>df.density <span class="ot">=</span> <span class="fu">tibble</span>(<span class="at">x =</span> tmp.density<span class="sc">$</span>x,</span>
<span id="cb405-11"><a href="simulation-1.html#cb405-11" aria-hidden="true" tabindex="-1"></a>                    <span class="at">y =</span> tmp.density<span class="sc">$</span>y) </span>
<span id="cb405-12"><a href="simulation-1.html#cb405-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb405-13"><a href="simulation-1.html#cb405-13" aria-hidden="true" tabindex="-1"></a>df.density <span class="sc">%&gt;%</span> </span>
<span id="cb405-14"><a href="simulation-1.html#cb405-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb405-15"><a href="simulation-1.html#cb405-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">digits =</span> <span class="dv">3</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb405-16"><a href="simulation-1.html#cb405-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="st">&quot;striped&quot;</span>,</span>
<span id="cb405-17"><a href="simulation-1.html#cb405-17" aria-hidden="true" tabindex="-1"></a>                <span class="at">full_width =</span> F)</span></code></pre></div>
<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
x
</th>
<th style="text-align:right;">
y
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0.250
</td>
<td style="text-align:right;">
0.004
</td>
</tr>
<tr>
<td style="text-align:right;">
0.257
</td>
<td style="text-align:right;">
0.004
</td>
</tr>
<tr>
<td style="text-align:right;">
0.264
</td>
<td style="text-align:right;">
0.005
</td>
</tr>
<tr>
<td style="text-align:right;">
0.271
</td>
<td style="text-align:right;">
0.005
</td>
</tr>
<tr>
<td style="text-align:right;">
0.277
</td>
<td style="text-align:right;">
0.005
</td>
</tr>
<tr>
<td style="text-align:right;">
0.284
</td>
<td style="text-align:right;">
0.006
</td>
</tr>
</tbody>
</table>
<p>Now, let’s plot the density.</p>
<div class="sourceCode" id="cb406"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb406-1"><a href="simulation-1.html#cb406-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df.density, </span>
<span id="cb406-2"><a href="simulation-1.html#cb406-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb406-3"><a href="simulation-1.html#cb406-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb406-4"><a href="simulation-1.html#cb406-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> <span class="fu">enframe</span>(observations),</span>
<span id="cb406-5"><a href="simulation-1.html#cb406-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> value, <span class="at">y =</span> <span class="dv">0</span>),</span>
<span id="cb406-6"><a href="simulation-1.html#cb406-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="07-simulation1_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<p>This density shows the sum of the densities of normal distributions that are centered at the observations with the specified bandwidth.</p>
<div class="sourceCode" id="cb407"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb407-1"><a href="simulation-1.html#cb407-1" aria-hidden="true" tabindex="-1"></a><span class="co"># add densities for the individual normal distributions</span></span>
<span id="cb407-2"><a href="simulation-1.html#cb407-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(observations)){</span>
<span id="cb407-3"><a href="simulation-1.html#cb407-3" aria-hidden="true" tabindex="-1"></a>  df.density[[<span class="fu">str_c</span>(<span class="st">&quot;observation_&quot;</span>,i)]] <span class="ot">=</span> <span class="fu">dnorm</span>(df.density<span class="sc">$</span>x,</span>
<span id="cb407-4"><a href="simulation-1.html#cb407-4" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">mean =</span> observations[i],</span>
<span id="cb407-5"><a href="simulation-1.html#cb407-5" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">sd =</span> bandwidth)</span>
<span id="cb407-6"><a href="simulation-1.html#cb407-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb407-7"><a href="simulation-1.html#cb407-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb407-8"><a href="simulation-1.html#cb407-8" aria-hidden="true" tabindex="-1"></a><span class="co"># sum densities</span></span>
<span id="cb407-9"><a href="simulation-1.html#cb407-9" aria-hidden="true" tabindex="-1"></a>df.density <span class="ot">=</span> df.density <span class="sc">%&gt;%</span></span>
<span id="cb407-10"><a href="simulation-1.html#cb407-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sum_norm =</span> <span class="fu">rowSums</span>(<span class="fu">select</span>(., <span class="fu">contains</span>(<span class="st">&quot;observation_&quot;</span>))),</span>
<span id="cb407-11"><a href="simulation-1.html#cb407-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> y <span class="sc">*</span> <span class="fu">length</span>(observations))</span>
<span id="cb407-12"><a href="simulation-1.html#cb407-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb407-13"><a href="simulation-1.html#cb407-13" aria-hidden="true" tabindex="-1"></a>df.density <span class="sc">%&gt;%</span> </span>
<span id="cb407-14"><a href="simulation-1.html#cb407-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb407-15"><a href="simulation-1.html#cb407-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">digits =</span> <span class="dv">3</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb407-16"><a href="simulation-1.html#cb407-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="st">&quot;striped&quot;</span>,</span>
<span id="cb407-17"><a href="simulation-1.html#cb407-17" aria-hidden="true" tabindex="-1"></a>                <span class="at">full_width =</span> F)</span></code></pre></div>
<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
x
</th>
<th style="text-align:right;">
y
</th>
<th style="text-align:right;">
observation_1
</th>
<th style="text-align:right;">
observation_2
</th>
<th style="text-align:right;">
observation_3
</th>
<th style="text-align:right;">
observation_4
</th>
<th style="text-align:right;">
observation_5
</th>
<th style="text-align:right;">
sum_norm
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0.250
</td>
<td style="text-align:right;">
0.019
</td>
<td style="text-align:right;">
0.018
</td>
<td style="text-align:right;">
0.001
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.019
</td>
</tr>
<tr>
<td style="text-align:right;">
0.257
</td>
<td style="text-align:right;">
0.021
</td>
<td style="text-align:right;">
0.019
</td>
<td style="text-align:right;">
0.001
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.021
</td>
</tr>
<tr>
<td style="text-align:right;">
0.264
</td>
<td style="text-align:right;">
0.023
</td>
<td style="text-align:right;">
0.021
</td>
<td style="text-align:right;">
0.001
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.022
</td>
</tr>
<tr>
<td style="text-align:right;">
0.271
</td>
<td style="text-align:right;">
0.024
</td>
<td style="text-align:right;">
0.023
</td>
<td style="text-align:right;">
0.002
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.024
</td>
</tr>
<tr>
<td style="text-align:right;">
0.277
</td>
<td style="text-align:right;">
0.027
</td>
<td style="text-align:right;">
0.024
</td>
<td style="text-align:right;">
0.002
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.026
</td>
</tr>
<tr>
<td style="text-align:right;">
0.284
</td>
<td style="text-align:right;">
0.029
</td>
<td style="text-align:right;">
0.026
</td>
<td style="text-align:right;">
0.002
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.028
</td>
</tr>
</tbody>
</table>
<p>Now, let’s plot the individual densities as well as the overall density.</p>
<div class="sourceCode" id="cb408"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb408-1"><a href="simulation-1.html#cb408-1" aria-hidden="true" tabindex="-1"></a><span class="co"># colors of individual Gaussian distributions </span></span>
<span id="cb408-2"><a href="simulation-1.html#cb408-2" aria-hidden="true" tabindex="-1"></a>colors <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;green&quot;</span>, <span class="st">&quot;red&quot;</span>, <span class="st">&quot;purple&quot;</span>, <span class="st">&quot;orange&quot;</span>)</span>
<span id="cb408-3"><a href="simulation-1.html#cb408-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb408-4"><a href="simulation-1.html#cb408-4" aria-hidden="true" tabindex="-1"></a><span class="co"># original density </span></span>
<span id="cb408-5"><a href="simulation-1.html#cb408-5" aria-hidden="true" tabindex="-1"></a>p <span class="ot">=</span> <span class="fu">ggplot</span>(<span class="at">data =</span> df.density, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb408-6"><a href="simulation-1.html#cb408-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">2</span>)</span>
<span id="cb408-7"><a href="simulation-1.html#cb408-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb408-8"><a href="simulation-1.html#cb408-8" aria-hidden="true" tabindex="-1"></a><span class="co"># individual densities </span></span>
<span id="cb408-9"><a href="simulation-1.html#cb408-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(observations)){</span>
<span id="cb408-10"><a href="simulation-1.html#cb408-10" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">=</span> p <span class="sc">+</span> <span class="fu">stat_function</span>(<span class="at">fun =</span> <span class="st">&quot;dnorm&quot;</span>,</span>
<span id="cb408-11"><a href="simulation-1.html#cb408-11" aria-hidden="true" tabindex="-1"></a>                        <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> observations[i], <span class="at">sd =</span> bandwidth),</span>
<span id="cb408-12"><a href="simulation-1.html#cb408-12" aria-hidden="true" tabindex="-1"></a>                        <span class="at">color =</span> colors[i])</span>
<span id="cb408-13"><a href="simulation-1.html#cb408-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb408-14"><a href="simulation-1.html#cb408-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb408-15"><a href="simulation-1.html#cb408-15" aria-hidden="true" tabindex="-1"></a><span class="co"># individual observations </span></span>
<span id="cb408-16"><a href="simulation-1.html#cb408-16" aria-hidden="true" tabindex="-1"></a>p <span class="ot">=</span> p <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">data =</span> <span class="fu">enframe</span>(observations),</span>
<span id="cb408-17"><a href="simulation-1.html#cb408-17" aria-hidden="true" tabindex="-1"></a>             <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> value, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="fu">factor</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)),</span>
<span id="cb408-18"><a href="simulation-1.html#cb408-18" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">3</span>,</span>
<span id="cb408-19"><a href="simulation-1.html#cb408-19" aria-hidden="true" tabindex="-1"></a>             <span class="at">show.legend =</span> F) <span class="sc">+</span></span>
<span id="cb408-20"><a href="simulation-1.html#cb408-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> colors)</span>
<span id="cb408-21"><a href="simulation-1.html#cb408-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb408-22"><a href="simulation-1.html#cb408-22" aria-hidden="true" tabindex="-1"></a><span class="co"># sum of the individual densities</span></span>
<span id="cb408-23"><a href="simulation-1.html#cb408-23" aria-hidden="true" tabindex="-1"></a>p <span class="ot">=</span> p <span class="sc">+</span></span>
<span id="cb408-24"><a href="simulation-1.html#cb408-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> df.density,</span>
<span id="cb408-25"><a href="simulation-1.html#cb408-25" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> sum_norm),</span>
<span id="cb408-26"><a href="simulation-1.html#cb408-26" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">1</span>,</span>
<span id="cb408-27"><a href="simulation-1.html#cb408-27" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb408-28"><a href="simulation-1.html#cb408-28" aria-hidden="true" tabindex="-1"></a>            <span class="at">linetype =</span> <span class="dv">2</span>)</span>
<span id="cb408-29"><a href="simulation-1.html#cb408-29" aria-hidden="true" tabindex="-1"></a>p <span class="co"># print the figure</span></span></code></pre></div>
<p><img src="07-simulation1_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
<p>Here are the same results when specifying a different bandwidth:</p>
<div class="sourceCode" id="cb409"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb409-1"><a href="simulation-1.html#cb409-1" aria-hidden="true" tabindex="-1"></a><span class="co"># colors of individual Gaussian distributions </span></span>
<span id="cb409-2"><a href="simulation-1.html#cb409-2" aria-hidden="true" tabindex="-1"></a>colors <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;green&quot;</span>, <span class="st">&quot;red&quot;</span>, <span class="st">&quot;purple&quot;</span>, <span class="st">&quot;orange&quot;</span>)</span>
<span id="cb409-3"><a href="simulation-1.html#cb409-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb409-4"><a href="simulation-1.html#cb409-4" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate density</span></span>
<span id="cb409-5"><a href="simulation-1.html#cb409-5" aria-hidden="true" tabindex="-1"></a>observations <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">1.2</span>, <span class="fl">1.5</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb409-6"><a href="simulation-1.html#cb409-6" aria-hidden="true" tabindex="-1"></a>bandwidth <span class="ot">=</span> <span class="fl">0.5</span> <span class="co"># bandwidth (= sd) of the Gaussian distribution </span></span>
<span id="cb409-7"><a href="simulation-1.html#cb409-7" aria-hidden="true" tabindex="-1"></a>tmp.density <span class="ot">=</span> <span class="fu">density</span>(observations,</span>
<span id="cb409-8"><a href="simulation-1.html#cb409-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">kernel =</span> <span class="st">&quot;gaussian&quot;</span>,</span>
<span id="cb409-9"><a href="simulation-1.html#cb409-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">bw =</span> bandwidth,</span>
<span id="cb409-10"><a href="simulation-1.html#cb409-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">n =</span> <span class="dv">512</span>)</span>
<span id="cb409-11"><a href="simulation-1.html#cb409-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb409-12"><a href="simulation-1.html#cb409-12" aria-hidden="true" tabindex="-1"></a><span class="co"># save density as data frame </span></span>
<span id="cb409-13"><a href="simulation-1.html#cb409-13" aria-hidden="true" tabindex="-1"></a>df.density <span class="ot">=</span> <span class="fu">tibble</span>(</span>
<span id="cb409-14"><a href="simulation-1.html#cb409-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> tmp.density<span class="sc">$</span>x,</span>
<span id="cb409-15"><a href="simulation-1.html#cb409-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> tmp.density<span class="sc">$</span>y</span>
<span id="cb409-16"><a href="simulation-1.html#cb409-16" aria-hidden="true" tabindex="-1"></a>) </span>
<span id="cb409-17"><a href="simulation-1.html#cb409-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb409-18"><a href="simulation-1.html#cb409-18" aria-hidden="true" tabindex="-1"></a><span class="co"># add densities for the individual normal distributions</span></span>
<span id="cb409-19"><a href="simulation-1.html#cb409-19" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(observations)){</span>
<span id="cb409-20"><a href="simulation-1.html#cb409-20" aria-hidden="true" tabindex="-1"></a>  df.density[[<span class="fu">str_c</span>(<span class="st">&quot;observation_&quot;</span>,i)]] <span class="ot">=</span> <span class="fu">dnorm</span>(df.density<span class="sc">$</span>x,</span>
<span id="cb409-21"><a href="simulation-1.html#cb409-21" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">mean =</span> observations[i],</span>
<span id="cb409-22"><a href="simulation-1.html#cb409-22" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">sd =</span> bandwidth)</span>
<span id="cb409-23"><a href="simulation-1.html#cb409-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb409-24"><a href="simulation-1.html#cb409-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb409-25"><a href="simulation-1.html#cb409-25" aria-hidden="true" tabindex="-1"></a><span class="co"># sum densities</span></span>
<span id="cb409-26"><a href="simulation-1.html#cb409-26" aria-hidden="true" tabindex="-1"></a>df.density <span class="ot">=</span> df.density <span class="sc">%&gt;%</span></span>
<span id="cb409-27"><a href="simulation-1.html#cb409-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sum_norm =</span> <span class="fu">rowSums</span>(<span class="fu">select</span>(., <span class="fu">contains</span>(<span class="st">&quot;observation_&quot;</span>))),</span>
<span id="cb409-28"><a href="simulation-1.html#cb409-28" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> y <span class="sc">*</span> <span class="fu">length</span>(observations))</span>
<span id="cb409-29"><a href="simulation-1.html#cb409-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb409-30"><a href="simulation-1.html#cb409-30" aria-hidden="true" tabindex="-1"></a><span class="co"># original plot </span></span>
<span id="cb409-31"><a href="simulation-1.html#cb409-31" aria-hidden="true" tabindex="-1"></a>p <span class="ot">=</span> <span class="fu">ggplot</span>(<span class="at">data =</span> df.density, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb409-32"><a href="simulation-1.html#cb409-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb409-33"><a href="simulation-1.html#cb409-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> <span class="fu">enframe</span>(observations),</span>
<span id="cb409-34"><a href="simulation-1.html#cb409-34" aria-hidden="true" tabindex="-1"></a>             <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> value,</span>
<span id="cb409-35"><a href="simulation-1.html#cb409-35" aria-hidden="true" tabindex="-1"></a>                           <span class="at">y =</span> <span class="dv">0</span>,</span>
<span id="cb409-36"><a href="simulation-1.html#cb409-36" aria-hidden="true" tabindex="-1"></a>                           <span class="at">color =</span> <span class="fu">factor</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)),</span>
<span id="cb409-37"><a href="simulation-1.html#cb409-37" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">3</span>,</span>
<span id="cb409-38"><a href="simulation-1.html#cb409-38" aria-hidden="true" tabindex="-1"></a>             <span class="at">show.legend =</span> F) <span class="sc">+</span></span>
<span id="cb409-39"><a href="simulation-1.html#cb409-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> colors)</span>
<span id="cb409-40"><a href="simulation-1.html#cb409-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb409-41"><a href="simulation-1.html#cb409-41" aria-hidden="true" tabindex="-1"></a><span class="co"># add individual Gaussians</span></span>
<span id="cb409-42"><a href="simulation-1.html#cb409-42" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(observations)){</span>
<span id="cb409-43"><a href="simulation-1.html#cb409-43" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">=</span> p <span class="sc">+</span> <span class="fu">stat_function</span>(<span class="at">fun =</span> <span class="st">&quot;dnorm&quot;</span>,</span>
<span id="cb409-44"><a href="simulation-1.html#cb409-44" aria-hidden="true" tabindex="-1"></a>                        <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> observations[i], <span class="at">sd =</span> bandwidth),</span>
<span id="cb409-45"><a href="simulation-1.html#cb409-45" aria-hidden="true" tabindex="-1"></a>                        <span class="at">color =</span> colors[i])</span>
<span id="cb409-46"><a href="simulation-1.html#cb409-46" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb409-47"><a href="simulation-1.html#cb409-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb409-48"><a href="simulation-1.html#cb409-48" aria-hidden="true" tabindex="-1"></a><span class="co"># add the sum of Gaussians</span></span>
<span id="cb409-49"><a href="simulation-1.html#cb409-49" aria-hidden="true" tabindex="-1"></a>p <span class="ot">=</span> p <span class="sc">+</span></span>
<span id="cb409-50"><a href="simulation-1.html#cb409-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> df.density,</span>
<span id="cb409-51"><a href="simulation-1.html#cb409-51" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> sum_norm),</span>
<span id="cb409-52"><a href="simulation-1.html#cb409-52" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">1</span>,</span>
<span id="cb409-53"><a href="simulation-1.html#cb409-53" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb409-54"><a href="simulation-1.html#cb409-54" aria-hidden="true" tabindex="-1"></a>            <span class="at">linetype =</span> <span class="dv">2</span>)</span>
<span id="cb409-55"><a href="simulation-1.html#cb409-55" aria-hidden="true" tabindex="-1"></a>p</span></code></pre></div>
<p><img src="07-simulation1_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
</div>
<div id="cumulative-probability-distribution" class="section level3 hasAnchor" number="7.3.4">
<h3><span class="header-section-number">7.3.4</span> Cumulative probability distribution<a href="simulation-1.html#cumulative-probability-distribution" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb410"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb410-1"><a href="simulation-1.html#cb410-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">tibble</span>(<span class="at">height =</span> <span class="fu">c</span>(<span class="dv">150</span>, <span class="dv">210</span>)),</span>
<span id="cb410-2"><a href="simulation-1.html#cb410-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> height)) <span class="sc">+</span></span>
<span id="cb410-3"><a href="simulation-1.html#cb410-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> <span class="sc">~</span> <span class="fu">pnorm</span>(<span class="at">q =</span> ., </span>
<span id="cb410-4"><a href="simulation-1.html#cb410-4" aria-hidden="true" tabindex="-1"></a>                              <span class="at">mean =</span> <span class="dv">180</span>, </span>
<span id="cb410-5"><a href="simulation-1.html#cb410-5" aria-hidden="true" tabindex="-1"></a>                              <span class="at">sd =</span> <span class="dv">10</span>)) <span class="sc">+</span> </span>
<span id="cb410-6"><a href="simulation-1.html#cb410-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;height&quot;</span>, <span class="at">y =</span> <span class="st">&quot;cumulative probability&quot;</span>) <span class="sc">+</span> </span>
<span id="cb410-7"><a href="simulation-1.html#cb410-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">160</span>, <span class="dv">180</span>, <span class="dv">200</span>)) <span class="sc">+</span> </span>
<span id="cb410-8"><a href="simulation-1.html#cb410-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">150</span>, <span class="dv">210</span>),</span>
<span id="cb410-9"><a href="simulation-1.html#cb410-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">1.05</span>),</span>
<span id="cb410-10"><a href="simulation-1.html#cb410-10" aria-hidden="true" tabindex="-1"></a>                  <span class="at">expand =</span> F)</span></code></pre></div>
<p><img src="07-simulation1_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
<p>Let’s find the cumulative probability of a particular value.</p>
<div class="sourceCode" id="cb411"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb411-1"><a href="simulation-1.html#cb411-1" aria-hidden="true" tabindex="-1"></a>tmp.x <span class="ot">=</span> <span class="dv">190</span></span>
<span id="cb411-2"><a href="simulation-1.html#cb411-2" aria-hidden="true" tabindex="-1"></a>tmp.y <span class="ot">=</span> <span class="fu">pnorm</span>(tmp.x, <span class="at">mean =</span> <span class="dv">180</span>, <span class="at">sd =</span> <span class="dv">10</span>)</span>
<span id="cb411-3"><a href="simulation-1.html#cb411-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb411-4"><a href="simulation-1.html#cb411-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(tmp.y <span class="sc">%&gt;%</span> <span class="fu">round</span>(<span class="dv">3</span>))</span></code></pre></div>
<pre><code>[1] 0.841</code></pre>
<div class="sourceCode" id="cb413"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb413-1"><a href="simulation-1.html#cb413-1" aria-hidden="true" tabindex="-1"></a><span class="co"># draw the cumulative probability distribution and show the value</span></span>
<span id="cb413-2"><a href="simulation-1.html#cb413-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">tibble</span>(<span class="at">height =</span> <span class="fu">c</span>(<span class="dv">150</span>, <span class="dv">210</span>)),</span>
<span id="cb413-3"><a href="simulation-1.html#cb413-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> height)) <span class="sc">+</span></span>
<span id="cb413-4"><a href="simulation-1.html#cb413-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> <span class="sc">~</span> <span class="fu">pnorm</span>(<span class="at">q =</span> .,</span>
<span id="cb413-5"><a href="simulation-1.html#cb413-5" aria-hidden="true" tabindex="-1"></a>                              <span class="at">mean =</span> <span class="dv">180</span>, </span>
<span id="cb413-6"><a href="simulation-1.html#cb413-6" aria-hidden="true" tabindex="-1"></a>                              <span class="at">sd =</span> <span class="dv">10</span> )) <span class="sc">+</span></span>
<span id="cb413-7"><a href="simulation-1.html#cb413-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;point&quot;</span>,</span>
<span id="cb413-8"><a href="simulation-1.html#cb413-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> tmp.x, </span>
<span id="cb413-9"><a href="simulation-1.html#cb413-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> tmp.y,</span>
<span id="cb413-10"><a href="simulation-1.html#cb413-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">4</span>,</span>
<span id="cb413-11"><a href="simulation-1.html#cb413-11" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb413-12"><a href="simulation-1.html#cb413-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> tmp.x,</span>
<span id="cb413-13"><a href="simulation-1.html#cb413-13" aria-hidden="true" tabindex="-1"></a>                             <span class="at">xend =</span> tmp.x,</span>
<span id="cb413-14"><a href="simulation-1.html#cb413-14" aria-hidden="true" tabindex="-1"></a>                             <span class="at">y =</span> <span class="dv">0</span>,</span>
<span id="cb413-15"><a href="simulation-1.html#cb413-15" aria-hidden="true" tabindex="-1"></a>                             <span class="at">yend =</span> tmp.y),</span>
<span id="cb413-16"><a href="simulation-1.html#cb413-16" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">1</span>,</span>
<span id="cb413-17"><a href="simulation-1.html#cb413-17" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb413-18"><a href="simulation-1.html#cb413-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="sc">-</span><span class="dv">5</span>,</span>
<span id="cb413-19"><a href="simulation-1.html#cb413-19" aria-hidden="true" tabindex="-1"></a>                             <span class="at">xend =</span> tmp.x,</span>
<span id="cb413-20"><a href="simulation-1.html#cb413-20" aria-hidden="true" tabindex="-1"></a>                             <span class="at">y =</span> tmp.y,</span>
<span id="cb413-21"><a href="simulation-1.html#cb413-21" aria-hidden="true" tabindex="-1"></a>                             <span class="at">yend =</span> tmp.y),</span>
<span id="cb413-22"><a href="simulation-1.html#cb413-22" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">1</span>,</span>
<span id="cb413-23"><a href="simulation-1.html#cb413-23" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb413-24"><a href="simulation-1.html#cb413-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;height&quot;</span>, <span class="at">y =</span> <span class="st">&quot;cumulative probability&quot;</span>) <span class="sc">+</span> </span>
<span id="cb413-25"><a href="simulation-1.html#cb413-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">160</span>, <span class="dv">180</span>, <span class="dv">200</span>)) <span class="sc">+</span> </span>
<span id="cb413-26"><a href="simulation-1.html#cb413-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">150</span>, <span class="dv">210</span>),</span>
<span id="cb413-27"><a href="simulation-1.html#cb413-27" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">1.05</span>),</span>
<span id="cb413-28"><a href="simulation-1.html#cb413-28" aria-hidden="true" tabindex="-1"></a>                  <span class="at">expand =</span> F)</span>
<span id="cb413-29"><a href="simulation-1.html#cb413-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb413-30"><a href="simulation-1.html#cb413-30" aria-hidden="true" tabindex="-1"></a><span class="co"># remove all variables with tmp in their name </span></span>
<span id="cb413-31"><a href="simulation-1.html#cb413-31" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">str_subset</span>(<span class="at">string =</span> <span class="fu">ls</span>(), <span class="at">pattern =</span> <span class="st">&quot;tmp.&quot;</span>))</span></code></pre></div>
<p><img src="07-simulation1_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
<p>Let’s illustrate what this would look like using a normal density plot.</p>
<div class="sourceCode" id="cb414"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb414-1"><a href="simulation-1.html#cb414-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">tibble</span>(<span class="at">height =</span> <span class="fu">c</span>(<span class="dv">150</span>, <span class="dv">210</span>)),</span>
<span id="cb414-2"><a href="simulation-1.html#cb414-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> height)) <span class="sc">+</span> </span>
<span id="cb414-3"><a href="simulation-1.html#cb414-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> <span class="sc">~</span> <span class="fu">dnorm</span>(., <span class="at">mean =</span> <span class="dv">180</span>, <span class="at">sd =</span> <span class="dv">10</span>),</span>
<span id="cb414-4"><a href="simulation-1.html#cb414-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">geom =</span> <span class="st">&quot;area&quot;</span>,</span>
<span id="cb414-5"><a href="simulation-1.html#cb414-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>,</span>
<span id="cb414-6"><a href="simulation-1.html#cb414-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">150</span>, <span class="dv">190</span>)) <span class="sc">+</span></span>
<span id="cb414-7"><a href="simulation-1.html#cb414-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> <span class="sc">~</span> <span class="fu">dnorm</span>(., <span class="at">mean =</span> <span class="dv">180</span>, <span class="at">sd =</span> <span class="dv">10</span>),</span>
<span id="cb414-8"><a href="simulation-1.html#cb414-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb414-9"><a href="simulation-1.html#cb414-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;height&quot;</span>, <span class="at">y =</span> <span class="st">&quot;density&quot;</span>) <span class="sc">+</span> </span>
<span id="cb414-10"><a href="simulation-1.html#cb414-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.1</span>))) <span class="sc">+</span></span>
<span id="cb414-11"><a href="simulation-1.html#cb414-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">160</span>, <span class="dv">180</span>, <span class="dv">200</span>)) <span class="sc">+</span> </span>
<span id="cb414-12"><a href="simulation-1.html#cb414-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">150</span>, <span class="dv">210</span>))</span></code></pre></div>
<p><img src="07-simulation1_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
</div>
<div id="inverse-cumulative-distribution" class="section level3 hasAnchor" number="7.3.5">
<h3><span class="header-section-number">7.3.5</span> Inverse cumulative distribution<a href="simulation-1.html#inverse-cumulative-distribution" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb415"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb415-1"><a href="simulation-1.html#cb415-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">tibble</span>(<span class="at">probability =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)),</span>
<span id="cb415-2"><a href="simulation-1.html#cb415-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> probability)) <span class="sc">+</span></span>
<span id="cb415-3"><a href="simulation-1.html#cb415-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> <span class="sc">~</span> <span class="fu">qnorm</span>(<span class="at">p =</span> ., </span>
<span id="cb415-4"><a href="simulation-1.html#cb415-4" aria-hidden="true" tabindex="-1"></a>                              <span class="at">mean =</span> <span class="dv">180</span>,</span>
<span id="cb415-5"><a href="simulation-1.html#cb415-5" aria-hidden="true" tabindex="-1"></a>                              <span class="at">sd =</span> <span class="dv">10</span>)) <span class="sc">+</span> </span>
<span id="cb415-6"><a href="simulation-1.html#cb415-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;height&quot;</span>, </span>
<span id="cb415-7"><a href="simulation-1.html#cb415-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;cumulative probability&quot;</span>) <span class="sc">+</span> </span>
<span id="cb415-8"><a href="simulation-1.html#cb415-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.1</span>)) <span class="sc">+</span> </span>
<span id="cb415-9"><a href="simulation-1.html#cb415-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">160</span>, <span class="dv">200</span>)) <span class="sc">+</span> </span>
<span id="cb415-10"><a href="simulation-1.html#cb415-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">1.05</span>),</span>
<span id="cb415-11"><a href="simulation-1.html#cb415-11" aria-hidden="true" tabindex="-1"></a>                  <span class="at">expand =</span> F)</span></code></pre></div>
<p><img src="07-simulation1_files/figure-html/unnamed-chunk-22-1.png" width="672" /></p>
<p>And let’s compute the inverse cumulative probability for a particular value.</p>
<div class="sourceCode" id="cb416"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb416-1"><a href="simulation-1.html#cb416-1" aria-hidden="true" tabindex="-1"></a>tmp.x <span class="ot">=</span> <span class="fl">0.3</span></span>
<span id="cb416-2"><a href="simulation-1.html#cb416-2" aria-hidden="true" tabindex="-1"></a>tmp.y <span class="ot">=</span> <span class="fu">qnorm</span>(tmp.x, <span class="at">mean =</span> <span class="dv">180</span>, <span class="at">sd =</span> <span class="dv">10</span>)</span>
<span id="cb416-3"><a href="simulation-1.html#cb416-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb416-4"><a href="simulation-1.html#cb416-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(tmp.y <span class="sc">%&gt;%</span> <span class="fu">round</span>(<span class="dv">3</span>))</span></code></pre></div>
<pre><code>[1] 174.756</code></pre>
<div class="sourceCode" id="cb418"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb418-1"><a href="simulation-1.html#cb418-1" aria-hidden="true" tabindex="-1"></a><span class="co"># draw the cumulative probability distribution and show the value</span></span>
<span id="cb418-2"><a href="simulation-1.html#cb418-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">tibble</span>(<span class="at">probability =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)),</span>
<span id="cb418-3"><a href="simulation-1.html#cb418-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> probability)) <span class="sc">+</span></span>
<span id="cb418-4"><a href="simulation-1.html#cb418-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> <span class="sc">~</span> <span class="fu">qnorm</span>(., <span class="at">mean =</span> <span class="dv">180</span>, <span class="at">sd =</span> <span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb418-5"><a href="simulation-1.html#cb418-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;point&quot;</span>,</span>
<span id="cb418-6"><a href="simulation-1.html#cb418-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> tmp.x, </span>
<span id="cb418-7"><a href="simulation-1.html#cb418-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> tmp.y,</span>
<span id="cb418-8"><a href="simulation-1.html#cb418-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">4</span>,</span>
<span id="cb418-9"><a href="simulation-1.html#cb418-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb418-10"><a href="simulation-1.html#cb418-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> tmp.x,</span>
<span id="cb418-11"><a href="simulation-1.html#cb418-11" aria-hidden="true" tabindex="-1"></a>                             <span class="at">xend =</span> tmp.x,</span>
<span id="cb418-12"><a href="simulation-1.html#cb418-12" aria-hidden="true" tabindex="-1"></a>                             <span class="at">y =</span> <span class="dv">160</span>,</span>
<span id="cb418-13"><a href="simulation-1.html#cb418-13" aria-hidden="true" tabindex="-1"></a>                             <span class="at">yend =</span> tmp.y),</span>
<span id="cb418-14"><a href="simulation-1.html#cb418-14" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">1</span>,</span>
<span id="cb418-15"><a href="simulation-1.html#cb418-15" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb418-16"><a href="simulation-1.html#cb418-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">0</span>,</span>
<span id="cb418-17"><a href="simulation-1.html#cb418-17" aria-hidden="true" tabindex="-1"></a>                             <span class="at">xend =</span> tmp.x,</span>
<span id="cb418-18"><a href="simulation-1.html#cb418-18" aria-hidden="true" tabindex="-1"></a>                             <span class="at">y =</span> tmp.y,</span>
<span id="cb418-19"><a href="simulation-1.html#cb418-19" aria-hidden="true" tabindex="-1"></a>                             <span class="at">yend =</span> tmp.y),</span>
<span id="cb418-20"><a href="simulation-1.html#cb418-20" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">1</span>,</span>
<span id="cb418-21"><a href="simulation-1.html#cb418-21" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb418-22"><a href="simulation-1.html#cb418-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;cumulative probability&quot;</span>,</span>
<span id="cb418-23"><a href="simulation-1.html#cb418-23" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;height&quot;</span>) <span class="sc">+</span> </span>
<span id="cb418-24"><a href="simulation-1.html#cb418-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.1</span>)) <span class="sc">+</span> </span>
<span id="cb418-25"><a href="simulation-1.html#cb418-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">160</span>, <span class="dv">200</span>)) <span class="sc">+</span> </span>
<span id="cb418-26"><a href="simulation-1.html#cb418-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">1.05</span>),</span>
<span id="cb418-27"><a href="simulation-1.html#cb418-27" aria-hidden="true" tabindex="-1"></a>                  <span class="at">expand =</span> F)</span>
<span id="cb418-28"><a href="simulation-1.html#cb418-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb418-29"><a href="simulation-1.html#cb418-29" aria-hidden="true" tabindex="-1"></a><span class="co"># remove all variables with tmp in their name </span></span>
<span id="cb418-30"><a href="simulation-1.html#cb418-30" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">str_subset</span>(<span class="at">string =</span> <span class="fu">ls</span>(), <span class="at">pattern =</span> <span class="st">&quot;tmp.&quot;</span>))</span></code></pre></div>
<p><img src="07-simulation1_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
</div>
<div id="computing-probabilities" class="section level3 hasAnchor" number="7.3.6">
<h3><span class="header-section-number">7.3.6</span> Computing probabilities<a href="simulation-1.html#computing-probabilities" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="via-probability-distributions" class="section level4 hasAnchor" number="7.3.6.1">
<h4><span class="header-section-number">7.3.6.1</span> Via probability distributions<a href="simulation-1.html#via-probability-distributions" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Let’s compute the probability of observing a particular value <span class="math inline">\(x\)</span> in a given range.</p>
<div class="sourceCode" id="cb419"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb419-1"><a href="simulation-1.html#cb419-1" aria-hidden="true" tabindex="-1"></a>tmp.lower <span class="ot">=</span> <span class="dv">170</span></span>
<span id="cb419-2"><a href="simulation-1.html#cb419-2" aria-hidden="true" tabindex="-1"></a>tmp.upper <span class="ot">=</span> <span class="dv">180</span></span>
<span id="cb419-3"><a href="simulation-1.html#cb419-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4"><a href="simulation-1.html#cb419-4" aria-hidden="true" tabindex="-1"></a>tmp.prob <span class="ot">=</span> <span class="fu">pnorm</span>(tmp.upper, <span class="at">mean =</span> <span class="dv">180</span>, <span class="at">sd =</span> <span class="dv">10</span>) <span class="sc">-</span> </span>
<span id="cb419-5"><a href="simulation-1.html#cb419-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pnorm</span>(tmp.lower, <span class="at">mean =</span> <span class="dv">180</span>, <span class="at">sd =</span> <span class="dv">10</span>)</span>
<span id="cb419-6"><a href="simulation-1.html#cb419-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-7"><a href="simulation-1.html#cb419-7" aria-hidden="true" tabindex="-1"></a>tmp.prob</span></code></pre></div>
<pre><code>[1] 0.3413447</code></pre>
<div class="sourceCode" id="cb421"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb421-1"><a href="simulation-1.html#cb421-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">150</span>, <span class="dv">210</span>)),</span>
<span id="cb421-2"><a href="simulation-1.html#cb421-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> x)) <span class="sc">+</span> </span>
<span id="cb421-3"><a href="simulation-1.html#cb421-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> <span class="sc">~</span> <span class="fu">dnorm</span>(., <span class="at">mean =</span> <span class="dv">180</span>, <span class="at">sd =</span> <span class="dv">10</span>),</span>
<span id="cb421-4"><a href="simulation-1.html#cb421-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">geom =</span> <span class="st">&quot;area&quot;</span>,</span>
<span id="cb421-5"><a href="simulation-1.html#cb421-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>,</span>
<span id="cb421-6"><a href="simulation-1.html#cb421-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">xlim =</span> <span class="fu">c</span>(tmp.lower, tmp.upper),</span>
<span id="cb421-7"><a href="simulation-1.html#cb421-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">color =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb421-8"><a href="simulation-1.html#cb421-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb421-9"><a href="simulation-1.html#cb421-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> <span class="sc">~</span> <span class="fu">dnorm</span>(., <span class="at">mean =</span> <span class="dv">180</span>, <span class="at">sd =</span> <span class="dv">10</span>),</span>
<span id="cb421-10"><a href="simulation-1.html#cb421-10" aria-hidden="true" tabindex="-1"></a>                <span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb421-11"><a href="simulation-1.html#cb421-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;height&quot;</span>,</span>
<span id="cb421-12"><a href="simulation-1.html#cb421-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;density&quot;</span>) <span class="sc">+</span> </span>
<span id="cb421-13"><a href="simulation-1.html#cb421-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.1</span>))) <span class="sc">+</span></span>
<span id="cb421-14"><a href="simulation-1.html#cb421-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">160</span>, <span class="dv">180</span>, <span class="dv">200</span>)) <span class="sc">+</span> </span>
<span id="cb421-15"><a href="simulation-1.html#cb421-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">150</span>, <span class="dv">210</span>))</span>
<span id="cb421-16"><a href="simulation-1.html#cb421-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb421-17"><a href="simulation-1.html#cb421-17" aria-hidden="true" tabindex="-1"></a><span class="co"># remove all variables with tmp in their name </span></span>
<span id="cb421-18"><a href="simulation-1.html#cb421-18" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">str_subset</span>(<span class="at">string =</span> <span class="fu">ls</span>(), <span class="at">pattern =</span> <span class="st">&quot;tmp.&quot;</span>))</span></code></pre></div>
<p><img src="07-simulation1_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
<p>We find that ~34% of the heights are between 170 and 180 cm.</p>
</div>
<div id="via-sampling" class="section level4 hasAnchor" number="7.3.6.2">
<h4><span class="header-section-number">7.3.6.2</span> Via sampling<a href="simulation-1.html#via-sampling" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>We can also compute the probability of observing certain events using sampling. We first generate samples from the desired probability distribution, and then use these samples to compute our statistic of interest.</p>
<div class="sourceCode" id="cb422"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb422-1"><a href="simulation-1.html#cb422-1" aria-hidden="true" tabindex="-1"></a><span class="co"># let&#39;s compute the probability of observing a value within a certain range </span></span>
<span id="cb422-2"><a href="simulation-1.html#cb422-2" aria-hidden="true" tabindex="-1"></a>tmp.lower <span class="ot">=</span> <span class="dv">170</span></span>
<span id="cb422-3"><a href="simulation-1.html#cb422-3" aria-hidden="true" tabindex="-1"></a>tmp.upper <span class="ot">=</span> <span class="dv">180</span></span>
<span id="cb422-4"><a href="simulation-1.html#cb422-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb422-5"><a href="simulation-1.html#cb422-5" aria-hidden="true" tabindex="-1"></a><span class="co"># make example reproducible</span></span>
<span id="cb422-6"><a href="simulation-1.html#cb422-6" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb422-7"><a href="simulation-1.html#cb422-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb422-8"><a href="simulation-1.html#cb422-8" aria-hidden="true" tabindex="-1"></a><span class="co"># generate some samples and store them in a data frame </span></span>
<span id="cb422-9"><a href="simulation-1.html#cb422-9" aria-hidden="true" tabindex="-1"></a>tmp.nsamples <span class="ot">=</span> <span class="dv">10000</span></span>
<span id="cb422-10"><a href="simulation-1.html#cb422-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb422-11"><a href="simulation-1.html#cb422-11" aria-hidden="true" tabindex="-1"></a>df.samples <span class="ot">=</span> <span class="fu">tibble</span>(<span class="at">height =</span> <span class="fu">rnorm</span>(<span class="at">n =</span> tmp.nsamples, <span class="at">mean =</span> <span class="dv">180</span>, <span class="at">sd =</span> <span class="dv">10</span>))</span>
<span id="cb422-12"><a href="simulation-1.html#cb422-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb422-13"><a href="simulation-1.html#cb422-13" aria-hidden="true" tabindex="-1"></a><span class="co"># compute the probability that sample lies within the range of interest</span></span>
<span id="cb422-14"><a href="simulation-1.html#cb422-14" aria-hidden="true" tabindex="-1"></a>tmp.prob <span class="ot">=</span> df.samples <span class="sc">%&gt;%</span> </span>
<span id="cb422-15"><a href="simulation-1.html#cb422-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(height <span class="sc">&gt;=</span> tmp.lower,</span>
<span id="cb422-16"><a href="simulation-1.html#cb422-16" aria-hidden="true" tabindex="-1"></a>         height <span class="sc">&lt;=</span> tmp.upper) <span class="sc">%&gt;%</span> </span>
<span id="cb422-17"><a href="simulation-1.html#cb422-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">prob =</span> <span class="fu">n</span>()<span class="sc">/</span>tmp.nsamples)</span>
<span id="cb422-18"><a href="simulation-1.html#cb422-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb422-19"><a href="simulation-1.html#cb422-19" aria-hidden="true" tabindex="-1"></a><span class="co"># illustrate the result using a histogram </span></span>
<span id="cb422-20"><a href="simulation-1.html#cb422-20" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df.samples,</span>
<span id="cb422-21"><a href="simulation-1.html#cb422-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> height)) <span class="sc">+</span> </span>
<span id="cb422-22"><a href="simulation-1.html#cb422-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>,</span>
<span id="cb422-23"><a href="simulation-1.html#cb422-23" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb422-24"><a href="simulation-1.html#cb422-24" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb422-25"><a href="simulation-1.html#cb422-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> tmp.lower,</span>
<span id="cb422-26"><a href="simulation-1.html#cb422-26" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">1</span>, </span>
<span id="cb422-27"><a href="simulation-1.html#cb422-27" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb422-28"><a href="simulation-1.html#cb422-28" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb422-29"><a href="simulation-1.html#cb422-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> tmp.upper,</span>
<span id="cb422-30"><a href="simulation-1.html#cb422-30" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">1</span>, </span>
<span id="cb422-31"><a href="simulation-1.html#cb422-31" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb422-32"><a href="simulation-1.html#cb422-32" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb422-33"><a href="simulation-1.html#cb422-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;label&quot;</span>,</span>
<span id="cb422-34"><a href="simulation-1.html#cb422-34" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">str_c</span>(tmp.prob <span class="sc">%&gt;%</span> <span class="fu">round</span>(<span class="dv">3</span>) <span class="sc">*</span> <span class="dv">100</span>, <span class="st">&quot;%&quot;</span>),</span>
<span id="cb422-35"><a href="simulation-1.html#cb422-35" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="dv">175</span>,</span>
<span id="cb422-36"><a href="simulation-1.html#cb422-36" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> <span class="dv">200</span>,</span>
<span id="cb422-37"><a href="simulation-1.html#cb422-37" aria-hidden="true" tabindex="-1"></a>           <span class="at">hjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb422-38"><a href="simulation-1.html#cb422-38" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">10</span>) <span class="sc">+</span> </span>
<span id="cb422-39"><a href="simulation-1.html#cb422-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.1</span>))) <span class="sc">+</span></span>
<span id="cb422-40"><a href="simulation-1.html#cb422-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;height&quot;</span>)</span>
<span id="cb422-41"><a href="simulation-1.html#cb422-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb422-42"><a href="simulation-1.html#cb422-42" aria-hidden="true" tabindex="-1"></a><span class="co"># remove all variables with tmp in their name </span></span>
<span id="cb422-43"><a href="simulation-1.html#cb422-43" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">str_subset</span>(<span class="at">string =</span> <span class="fu">ls</span>(), <span class="at">pattern =</span> <span class="st">&quot;tmp.&quot;</span>))</span></code></pre></div>
<p><img src="07-simulation1_files/figure-html/unnamed-chunk-25-1.png" width="672" />
## Breakout room exercise</p>
</div>
</div>
<div id="make-the-plot" class="section level3 hasAnchor" number="7.3.7">
<h3><span class="header-section-number">7.3.7</span> Make the plot<a href="simulation-1.html#make-the-plot" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb423"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb423-1"><a href="simulation-1.html#cb423-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">tibble</span>(<span class="at">height =</span> <span class="fu">c</span>(<span class="dv">30</span>, <span class="dv">70</span>)),</span>
<span id="cb423-2"><a href="simulation-1.html#cb423-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> height)) <span class="sc">+</span></span>
<span id="cb423-3"><a href="simulation-1.html#cb423-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> <span class="sc">~</span> <span class="fu">dgamma</span>(., <span class="at">shape =</span> <span class="dv">50</span>, <span class="at">rate =</span> <span class="dv">1</span>))</span></code></pre></div>
<p><img src="07-simulation1_files/figure-html/unnamed-chunk-26-1.png" width="672" /></p>
</div>
<div id="analytic-solutions" class="section level3 hasAnchor" number="7.3.8">
<h3><span class="header-section-number">7.3.8</span> Analytic solutions<a href="simulation-1.html#analytic-solutions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="question-a-60cm-tall-penguin-claims-that-no-more-than-10-are-taller-than-her.-is-she-correct" class="section level4 hasAnchor" number="7.3.8.1">
<h4><span class="header-section-number">7.3.8.1</span> Question: A 60cm tall Penguin claims that no more than 10% are taller than her. Is she correct?<a href="simulation-1.html#question-a-60cm-tall-penguin-claims-that-no-more-than-10-are-taller-than-her.-is-she-correct" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb424"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb424-1"><a href="simulation-1.html#cb424-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">-</span> <span class="fu">pgamma</span>(<span class="dv">60</span>, <span class="at">shape =</span> <span class="dv">50</span>, <span class="at">rate =</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>[1] 0.08440668</code></pre>
<p>Answer: Yes, she is correct. Only ~ 8.4% of Penguins are taller than her.</p>
</div>
<div id="question-are-there-more-penguins-between-50-and-55cm-or-between-55-and-65cm" class="section level4 hasAnchor" number="7.3.8.2">
<h4><span class="header-section-number">7.3.8.2</span> Question: Are there more penguins between 50 and 55cm or between 55 and 65cm?<a href="simulation-1.html#question-are-there-more-penguins-between-50-and-55cm-or-between-55-and-65cm" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb426"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb426-1"><a href="simulation-1.html#cb426-1" aria-hidden="true" tabindex="-1"></a>first_range <span class="ot">=</span> <span class="fu">pgamma</span>(<span class="dv">55</span>, <span class="at">shape =</span> <span class="dv">50</span>, <span class="at">rate =</span> <span class="dv">1</span>) <span class="sc">-</span> <span class="fu">pgamma</span>(<span class="dv">50</span>, <span class="at">shape =</span> <span class="dv">50</span>, <span class="at">rate =</span> <span class="dv">1</span>)</span>
<span id="cb426-2"><a href="simulation-1.html#cb426-2" aria-hidden="true" tabindex="-1"></a>second_range <span class="ot">=</span> <span class="fu">pgamma</span>(<span class="dv">65</span>, <span class="at">shape =</span> <span class="dv">50</span>, <span class="at">rate =</span> <span class="dv">1</span>) <span class="sc">-</span> <span class="fu">pgamma</span>(<span class="dv">55</span>, <span class="at">shape =</span> <span class="dv">50</span>, <span class="at">rate =</span> <span class="dv">1</span>)</span>
<span id="cb426-3"><a href="simulation-1.html#cb426-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb426-4"><a href="simulation-1.html#cb426-4" aria-hidden="true" tabindex="-1"></a>first_range <span class="sc">-</span> second_range</span></code></pre></div>
<pre><code>[1] 0.04029452</code></pre>
<p>Answer: There are 4% more Penguins between 50 and 55cm than between 55 and 65 cm.</p>
</div>
<div id="question-what-size-is-a-penguin-who-is-taller-than-75-of-the-rest" class="section level4 hasAnchor" number="7.3.8.3">
<h4><span class="header-section-number">7.3.8.3</span> Question: What size is a Penguin who is taller than 75% of the rest?<a href="simulation-1.html#question-what-size-is-a-penguin-who-is-taller-than-75-of-the-rest" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb428"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb428-1"><a href="simulation-1.html#cb428-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qgamma</span>(<span class="fl">0.75</span>, <span class="at">shape =</span> <span class="dv">50</span>, <span class="at">rate =</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>[1] 54.57062</code></pre>
<p>Answer: A Penguin who is ~54.6cm tall is taller than 75% of the rest.</p>
</div>
</div>
<div id="sampling-solution" class="section level3 hasAnchor" number="7.3.9">
<h3><span class="header-section-number">7.3.9</span> Sampling solution<a href="simulation-1.html#sampling-solution" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let’s just simulate a bunch of Penguins, yay!</p>
<div class="sourceCode" id="cb430"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb430-1"><a href="simulation-1.html#cb430-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb430-2"><a href="simulation-1.html#cb430-2" aria-hidden="true" tabindex="-1"></a>df.penguins <span class="ot">=</span> <span class="fu">tibble</span>(<span class="at">height =</span> <span class="fu">rgamma</span>(<span class="at">n =</span> <span class="dv">100000</span>, <span class="at">shape =</span> <span class="dv">50</span>, <span class="at">rate =</span> <span class="dv">1</span>))</span></code></pre></div>
<div id="question-a-60cm-tall-penguin-claims-that-no-more-than-10-are-taller-than-her.-is-she-correct-1" class="section level4 hasAnchor" number="7.3.9.1">
<h4><span class="header-section-number">7.3.9.1</span> Question: A 60cm tall Penguin claims that no more than 10% are taller than her. Is she correct?<a href="simulation-1.html#question-a-60cm-tall-penguin-claims-that-no-more-than-10-are-taller-than-her.-is-she-correct-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb431"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb431-1"><a href="simulation-1.html#cb431-1" aria-hidden="true" tabindex="-1"></a>df.penguins <span class="sc">%&gt;%</span> </span>
<span id="cb431-2"><a href="simulation-1.html#cb431-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">probability =</span> <span class="fu">sum</span>(height <span class="sc">&gt;</span> <span class="dv">60</span>) <span class="sc">/</span> <span class="fu">n</span>())</span></code></pre></div>
<pre><code># A tibble: 1 × 1
  probability
        &lt;dbl&gt;
1      0.0835</code></pre>
<p>Answer: Yes, she is correct. Only ~ 8.3% of Penguins are taller than her.</p>
</div>
<div id="question-are-there-more-penguins-between-50-and-55cm-or-between-55-and-65cm-1" class="section level4 hasAnchor" number="7.3.9.2">
<h4><span class="header-section-number">7.3.9.2</span> Question: Are there more penguins between 50 and 55cm or between 55 and 65cm?<a href="simulation-1.html#question-are-there-more-penguins-between-50-and-55cm-or-between-55-and-65cm-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb433"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb433-1"><a href="simulation-1.html#cb433-1" aria-hidden="true" tabindex="-1"></a>df.penguins <span class="sc">%&gt;%</span> </span>
<span id="cb433-2"><a href="simulation-1.html#cb433-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">probability =</span> (<span class="fu">sum</span>(<span class="fu">between</span>(height, <span class="dv">50</span>, <span class="dv">55</span>)) <span class="sc">-</span> <span class="fu">sum</span>(<span class="fu">between</span>(height, <span class="dv">55</span>, <span class="dv">65</span>)))<span class="sc">/</span><span class="fu">n</span>())</span></code></pre></div>
<pre><code># A tibble: 1 × 1
  probability
        &lt;dbl&gt;
1      0.0387</code></pre>
<p>Answer: There are 3.9% more Penguins between 50 and 55cm than between 55 and 65 cm.</p>
</div>
<div id="question-what-size-is-a-penguin-who-is-taller-than-75-of-the-rest-1" class="section level4 hasAnchor" number="7.3.9.3">
<h4><span class="header-section-number">7.3.9.3</span> Question: What size is a Penguin who is taller than 75% of the rest?<a href="simulation-1.html#question-what-size-is-a-penguin-who-is-taller-than-75-of-the-rest-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb435"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb435-1"><a href="simulation-1.html#cb435-1" aria-hidden="true" tabindex="-1"></a>df.penguins <span class="sc">%&gt;%</span> </span>
<span id="cb435-2"><a href="simulation-1.html#cb435-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(height) <span class="sc">%&gt;%</span></span>
<span id="cb435-3"><a href="simulation-1.html#cb435-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">prop =</span> <span class="fl">0.75</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb435-4"><a href="simulation-1.html#cb435-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">height =</span> <span class="fu">max</span>(height))</span></code></pre></div>
<pre><code># A tibble: 1 × 1
  height
   &lt;dbl&gt;
1   54.6</code></pre>
<p>Answer: A Penguin who is ~54.6cm tall is taller than 75% of the rest.</p>
</div>
</div>
</div>
<div id="bayesian-inference-with-the-normal-distribution" class="section level2 hasAnchor" number="7.4">
<h2><span class="header-section-number">7.4</span> Bayesian inference with the normal distribution<a href="simulation-1.html#bayesian-inference-with-the-normal-distribution" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Let’s consider the following scenario. You are helping out at a summer camp. This summer, two different groups of kids go to the same summer camp. The chess kids, and the basketball kids. The chess summer camp is not quite as popular as the basketball summer camp (shocking, I know!). In fact, twice as many children have signed up for the basketball camp.</p>
<p>When signing up for the camp, the children were asked for some demographic information including their height in cm. Unsurprisingly, the basketball players tend to be taller on average than the chess players. In fact, the basketball players’ height is approximately normally distributed with a mean of 180cm and a standard deviation of 10cm. For the chess players, the mean height is 170cm with a standard deviation of 8cm.</p>
<p>At the camp site, a child walks over to you and asks you where their gym is. You gage that the child is around 175cm tall. Where should you direct the child to? To the basketball gym, or to the chess gym?</p>
<div id="analytic-solution" class="section level3 hasAnchor" number="7.4.1">
<h3><span class="header-section-number">7.4.1</span> Analytic solution<a href="simulation-1.html#analytic-solution" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb437"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb437-1"><a href="simulation-1.html#cb437-1" aria-hidden="true" tabindex="-1"></a>height <span class="ot">=</span> <span class="dv">175</span></span>
<span id="cb437-2"><a href="simulation-1.html#cb437-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb437-3"><a href="simulation-1.html#cb437-3" aria-hidden="true" tabindex="-1"></a><span class="co"># priors </span></span>
<span id="cb437-4"><a href="simulation-1.html#cb437-4" aria-hidden="true" tabindex="-1"></a>prior_basketball <span class="ot">=</span> <span class="dv">2</span><span class="sc">/</span><span class="dv">3</span> </span>
<span id="cb437-5"><a href="simulation-1.html#cb437-5" aria-hidden="true" tabindex="-1"></a>prior_chess <span class="ot">=</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span> </span>
<span id="cb437-6"><a href="simulation-1.html#cb437-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb437-7"><a href="simulation-1.html#cb437-7" aria-hidden="true" tabindex="-1"></a><span class="co"># likelihood  </span></span>
<span id="cb437-8"><a href="simulation-1.html#cb437-8" aria-hidden="true" tabindex="-1"></a>mean_basketball <span class="ot">=</span> <span class="dv">180</span></span>
<span id="cb437-9"><a href="simulation-1.html#cb437-9" aria-hidden="true" tabindex="-1"></a>sd_basketball <span class="ot">=</span> <span class="dv">10</span></span>
<span id="cb437-10"><a href="simulation-1.html#cb437-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb437-11"><a href="simulation-1.html#cb437-11" aria-hidden="true" tabindex="-1"></a>mean_chess <span class="ot">=</span> <span class="dv">170</span></span>
<span id="cb437-12"><a href="simulation-1.html#cb437-12" aria-hidden="true" tabindex="-1"></a>sd_chess <span class="ot">=</span> <span class="dv">8</span></span>
<span id="cb437-13"><a href="simulation-1.html#cb437-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb437-14"><a href="simulation-1.html#cb437-14" aria-hidden="true" tabindex="-1"></a>likelihood_basketball <span class="ot">=</span> <span class="fu">dnorm</span>(height, <span class="at">mean =</span> mean_basketball, <span class="at">sd =</span> sd_basketball)</span>
<span id="cb437-15"><a href="simulation-1.html#cb437-15" aria-hidden="true" tabindex="-1"></a>likelihood_chess <span class="ot">=</span> <span class="fu">dnorm</span>(height, <span class="at">mean =</span> mean_chess, <span class="at">sd =</span> sd_chess)</span>
<span id="cb437-16"><a href="simulation-1.html#cb437-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb437-17"><a href="simulation-1.html#cb437-17" aria-hidden="true" tabindex="-1"></a><span class="co"># posterior</span></span>
<span id="cb437-18"><a href="simulation-1.html#cb437-18" aria-hidden="true" tabindex="-1"></a>posterior_basketball <span class="ot">=</span> (likelihood_basketball <span class="sc">*</span> prior_basketball) <span class="sc">/</span> </span>
<span id="cb437-19"><a href="simulation-1.html#cb437-19" aria-hidden="true" tabindex="-1"></a>  ((likelihood_basketball <span class="sc">*</span> prior_basketball) <span class="sc">+</span> (likelihood_chess <span class="sc">*</span> prior_chess))</span>
<span id="cb437-20"><a href="simulation-1.html#cb437-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb437-21"><a href="simulation-1.html#cb437-21" aria-hidden="true" tabindex="-1"></a>posterior_basketball <span class="sc">%&gt;%</span> <span class="fu">print</span>()</span></code></pre></div>
<pre><code>[1] 0.631886</code></pre>
</div>
<div id="solution-via-sampling" class="section level3 hasAnchor" number="7.4.2">
<h3><span class="header-section-number">7.4.2</span> Solution via sampling<a href="simulation-1.html#solution-via-sampling" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let’s do the same thing via sampling.</p>
<div class="sourceCode" id="cb439"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb439-1"><a href="simulation-1.html#cb439-1" aria-hidden="true" tabindex="-1"></a><span class="co"># number of kids </span></span>
<span id="cb439-2"><a href="simulation-1.html#cb439-2" aria-hidden="true" tabindex="-1"></a>tmp.nkids <span class="ot">=</span> <span class="dv">10000</span></span>
<span id="cb439-3"><a href="simulation-1.html#cb439-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb439-4"><a href="simulation-1.html#cb439-4" aria-hidden="true" tabindex="-1"></a><span class="co"># make reproducible </span></span>
<span id="cb439-5"><a href="simulation-1.html#cb439-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb439-6"><a href="simulation-1.html#cb439-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb439-7"><a href="simulation-1.html#cb439-7" aria-hidden="true" tabindex="-1"></a><span class="co"># priors </span></span>
<span id="cb439-8"><a href="simulation-1.html#cb439-8" aria-hidden="true" tabindex="-1"></a>prior_basketball <span class="ot">=</span> <span class="dv">2</span><span class="sc">/</span><span class="dv">3</span> </span>
<span id="cb439-9"><a href="simulation-1.html#cb439-9" aria-hidden="true" tabindex="-1"></a>prior_chess <span class="ot">=</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span> </span>
<span id="cb439-10"><a href="simulation-1.html#cb439-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb439-11"><a href="simulation-1.html#cb439-11" aria-hidden="true" tabindex="-1"></a><span class="co"># likelihood functions </span></span>
<span id="cb439-12"><a href="simulation-1.html#cb439-12" aria-hidden="true" tabindex="-1"></a>mean_basketball <span class="ot">=</span> <span class="dv">180</span></span>
<span id="cb439-13"><a href="simulation-1.html#cb439-13" aria-hidden="true" tabindex="-1"></a>sd_basketball <span class="ot">=</span> <span class="dv">10</span></span>
<span id="cb439-14"><a href="simulation-1.html#cb439-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb439-15"><a href="simulation-1.html#cb439-15" aria-hidden="true" tabindex="-1"></a>mean_chess <span class="ot">=</span> <span class="dv">170</span></span>
<span id="cb439-16"><a href="simulation-1.html#cb439-16" aria-hidden="true" tabindex="-1"></a>sd_chess <span class="ot">=</span> <span class="dv">8</span></span>
<span id="cb439-17"><a href="simulation-1.html#cb439-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb439-18"><a href="simulation-1.html#cb439-18" aria-hidden="true" tabindex="-1"></a><span class="co"># data frame with the kids</span></span>
<span id="cb439-19"><a href="simulation-1.html#cb439-19" aria-hidden="true" tabindex="-1"></a>df.camp <span class="ot">=</span> <span class="fu">tibble</span>(<span class="at">kid =</span> <span class="dv">1</span><span class="sc">:</span>tmp.nkids,</span>
<span id="cb439-20"><a href="simulation-1.html#cb439-20" aria-hidden="true" tabindex="-1"></a>                 <span class="at">sport =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">&quot;chess&quot;</span>, <span class="st">&quot;basketball&quot;</span>),</span>
<span id="cb439-21"><a href="simulation-1.html#cb439-21" aria-hidden="true" tabindex="-1"></a>                                <span class="at">size =</span> tmp.nkids,</span>
<span id="cb439-22"><a href="simulation-1.html#cb439-22" aria-hidden="true" tabindex="-1"></a>                                <span class="at">replace =</span> T,</span>
<span id="cb439-23"><a href="simulation-1.html#cb439-23" aria-hidden="true" tabindex="-1"></a>                                <span class="at">prob =</span> <span class="fu">c</span>(prior_chess, prior_basketball))) <span class="sc">%&gt;%</span> </span>
<span id="cb439-24"><a href="simulation-1.html#cb439-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb439-25"><a href="simulation-1.html#cb439-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">height =</span> <span class="fu">ifelse</span>(<span class="at">test =</span> sport <span class="sc">==</span> <span class="st">&quot;chess&quot;</span>,</span>
<span id="cb439-26"><a href="simulation-1.html#cb439-26" aria-hidden="true" tabindex="-1"></a>                         <span class="at">yes =</span> <span class="fu">rnorm</span>(., <span class="at">mean =</span> mean_chess, <span class="at">sd =</span> sd_chess),</span>
<span id="cb439-27"><a href="simulation-1.html#cb439-27" aria-hidden="true" tabindex="-1"></a>                         <span class="at">no =</span> <span class="fu">rnorm</span>(., <span class="at">mean =</span> mean_basketball, <span class="at">sd =</span> sd_basketball))) <span class="sc">%&gt;%</span> </span>
<span id="cb439-28"><a href="simulation-1.html#cb439-28" aria-hidden="true" tabindex="-1"></a>  ungroup</span>
<span id="cb439-29"><a href="simulation-1.html#cb439-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb439-30"><a href="simulation-1.html#cb439-30" aria-hidden="true" tabindex="-1"></a>df.camp <span class="sc">%&gt;%</span> <span class="fu">print</span>()</span></code></pre></div>
<pre><code># A tibble: 10,000 × 3
     kid sport      height
   &lt;int&gt; &lt;chr&gt;       &lt;dbl&gt;
 1     1 basketball   165.
 2     2 basketball   163.
 3     3 basketball   191.
 4     4 chess        160.
 5     5 basketball   183.
 6     6 chess        164.
 7     7 chess        169.
 8     8 basketball   193.
 9     9 basketball   172.
10    10 basketball   177.
# … with 9,990 more rows</code></pre>
<p>Now we have a data frame with kids whose height was randomly sampled depending on which sport they do. I’ve used the <code>sample()</code> function to assign a sport to each kid first using the <code>prob =</code> argument to make sure that a kid is more likely to be assigned the sport “basketball” than “chess”.</p>
<p>Note that the solution above is not particularly efficient since it uses the <code>rowwise()</code> function to make sure that a different random value for height is drawn for each row. Running this code will get slow for large samples. A more efficient solution would be the following:</p>
<div class="sourceCode" id="cb441"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb441-1"><a href="simulation-1.html#cb441-1" aria-hidden="true" tabindex="-1"></a><span class="co"># number of kids </span></span>
<span id="cb441-2"><a href="simulation-1.html#cb441-2" aria-hidden="true" tabindex="-1"></a>tmp.nkids <span class="ot">=</span> <span class="dv">100000</span></span>
<span id="cb441-3"><a href="simulation-1.html#cb441-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb441-4"><a href="simulation-1.html#cb441-4" aria-hidden="true" tabindex="-1"></a><span class="co"># make reproducible </span></span>
<span id="cb441-5"><a href="simulation-1.html#cb441-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">3</span>)</span>
<span id="cb441-6"><a href="simulation-1.html#cb441-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb441-7"><a href="simulation-1.html#cb441-7" aria-hidden="true" tabindex="-1"></a>df.camp2 <span class="ot">=</span> <span class="fu">tibble</span>(</span>
<span id="cb441-8"><a href="simulation-1.html#cb441-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">kid =</span> <span class="dv">1</span><span class="sc">:</span>tmp.nkids,</span>
<span id="cb441-9"><a href="simulation-1.html#cb441-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">sport =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">&quot;chess&quot;</span>, <span class="st">&quot;basketball&quot;</span>),</span>
<span id="cb441-10"><a href="simulation-1.html#cb441-10" aria-hidden="true" tabindex="-1"></a>                 <span class="at">size =</span> tmp.nkids,</span>
<span id="cb441-11"><a href="simulation-1.html#cb441-11" aria-hidden="true" tabindex="-1"></a>                 <span class="at">replace =</span> T,</span>
<span id="cb441-12"><a href="simulation-1.html#cb441-12" aria-hidden="true" tabindex="-1"></a>                 <span class="at">prob =</span> <span class="fu">c</span>(prior_chess, prior_basketball))) <span class="sc">%&gt;%</span> </span>
<span id="cb441-13"><a href="simulation-1.html#cb441-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(sport) <span class="sc">%&gt;%</span> </span>
<span id="cb441-14"><a href="simulation-1.html#cb441-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">height =</span> <span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="fu">sum</span>(sport <span class="sc">==</span> <span class="st">&quot;basketball&quot;</span>),</span>
<span id="cb441-15"><a href="simulation-1.html#cb441-15" aria-hidden="true" tabindex="-1"></a>                          <span class="at">mean =</span> mean_basketball,</span>
<span id="cb441-16"><a href="simulation-1.html#cb441-16" aria-hidden="true" tabindex="-1"></a>                          <span class="at">sd =</span> sd_basketball),</span>
<span id="cb441-17"><a href="simulation-1.html#cb441-17" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">rnorm</span>(<span class="fu">sum</span>(sport <span class="sc">==</span> <span class="st">&quot;chess&quot;</span>),</span>
<span id="cb441-18"><a href="simulation-1.html#cb441-18" aria-hidden="true" tabindex="-1"></a>                          <span class="at">mean =</span> mean_chess,</span>
<span id="cb441-19"><a href="simulation-1.html#cb441-19" aria-hidden="true" tabindex="-1"></a>                          <span class="at">sd =</span> sd_chess)))</span></code></pre></div>
<p>In this solution, I take advantage of the fact that <code>rnorm()</code> is vectorized. That is, it can produce many random draws in one call. To make this work, I first arrange the data frame, and then draw the correct number of samples from each of the two distributions. This works fast, even if I’m drawing a large number of samples.</p>
<p>How can we now use these samples to answer our question of interest? Let’s see what doesn’t work first:</p>
<div class="sourceCode" id="cb442"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb442-1"><a href="simulation-1.html#cb442-1" aria-hidden="true" tabindex="-1"></a>tmp.height <span class="ot">=</span> <span class="dv">175</span></span>
<span id="cb442-2"><a href="simulation-1.html#cb442-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb442-3"><a href="simulation-1.html#cb442-3" aria-hidden="true" tabindex="-1"></a>df.camp <span class="sc">%&gt;%</span> </span>
<span id="cb442-4"><a href="simulation-1.html#cb442-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(height <span class="sc">==</span> tmp.height) <span class="sc">%&gt;%</span> </span>
<span id="cb442-5"><a href="simulation-1.html#cb442-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(sport) <span class="sc">%&gt;%</span> </span>
<span id="cb442-6"><a href="simulation-1.html#cb442-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> sport, <span class="at">values_from =</span> n) <span class="sc">%&gt;%</span> </span>
<span id="cb442-7"><a href="simulation-1.html#cb442-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">prob_basketball =</span> basketball<span class="sc">/</span>(basketball <span class="sc">+</span> chess))</span></code></pre></div>
<p>The reason this doesn’t work is because none of our kids is exactly 175cm tall. Instead, we need to filter kids that are within a certain height range.</p>
<div class="sourceCode" id="cb443"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb443-1"><a href="simulation-1.html#cb443-1" aria-hidden="true" tabindex="-1"></a>tmp.height <span class="ot">=</span> <span class="dv">175</span></span>
<span id="cb443-2"><a href="simulation-1.html#cb443-2" aria-hidden="true" tabindex="-1"></a>tmp.margin <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb443-3"><a href="simulation-1.html#cb443-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb443-4"><a href="simulation-1.html#cb443-4" aria-hidden="true" tabindex="-1"></a>df.camp <span class="sc">%&gt;%</span> </span>
<span id="cb443-5"><a href="simulation-1.html#cb443-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">between</span>(height,</span>
<span id="cb443-6"><a href="simulation-1.html#cb443-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">left =</span> tmp.height <span class="sc">-</span> tmp.margin,</span>
<span id="cb443-7"><a href="simulation-1.html#cb443-7" aria-hidden="true" tabindex="-1"></a>                 <span class="at">right =</span> tmp.height <span class="sc">+</span> tmp.margin)) <span class="sc">%&gt;%</span> </span>
<span id="cb443-8"><a href="simulation-1.html#cb443-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(sport) <span class="sc">%&gt;%</span> </span>
<span id="cb443-9"><a href="simulation-1.html#cb443-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> sport,</span>
<span id="cb443-10"><a href="simulation-1.html#cb443-10" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_from =</span> n) <span class="sc">%&gt;%</span> </span>
<span id="cb443-11"><a href="simulation-1.html#cb443-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">prob_basketball =</span> basketball<span class="sc">/</span>(basketball <span class="sc">+</span> chess))</span></code></pre></div>
<pre><code># A tibble: 1 × 1
  prob_basketball
            &lt;dbl&gt;
1           0.632</code></pre>
<p>Here, I’ve used the <code>between()</code> function which is a shortcut for otherwise writing <code>x &gt;= left &amp; x &lt;= right</code>. You can play around with the margin to see how the result changes.</p>
</div>
</div>
<div id="additional-resources-5" class="section level2 hasAnchor" number="7.5">
<h2><span class="header-section-number">7.5</span> Additional resources<a href="simulation-1.html#additional-resources-5" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="datacamp" class="section level3 hasAnchor" number="7.5.1">
<h3><span class="header-section-number">7.5.1</span> Datacamp<a href="simulation-1.html#datacamp" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><a href="https://www.datacamp.com/courses/foundations-of-probability-in-r">Foundations of probability in R</a></li>
</ul>
</div>
</div>
<div id="session-info-6" class="section level2 hasAnchor" number="7.6">
<h2><span class="header-section-number">7.6</span> Session info<a href="simulation-1.html#session-info-6" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Information about this R session including which version of R was used, and what packages were loaded.</p>
<div class="sourceCode" id="cb445"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb445-1"><a href="simulation-1.html#cb445-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span></code></pre></div>
<pre><code>R version 4.1.2 (2021-11-01)
Platform: x86_64-apple-darwin17.0 (64-bit)
Running under: macOS Big Sur 10.16

Matrix products: default
BLAS:   /Library/Frameworks/R.framework/Versions/4.1/Resources/lib/libRblas.0.dylib
LAPACK: /Library/Frameworks/R.framework/Versions/4.1/Resources/lib/libRlapack.dylib

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
 [1] forcats_0.5.1    stringr_1.4.0    dplyr_1.0.9      purrr_0.3.4     
 [5] readr_2.1.2      tidyr_1.2.0      tibble_3.1.7     ggplot2_3.3.6   
 [9] tidyverse_1.3.1  patchwork_1.1.1  MASS_7.3-57      kableExtra_1.3.4
[13] knitr_1.39      

loaded via a namespace (and not attached):
 [1] svglite_2.1.0     lubridate_1.8.0   assertthat_0.2.1  digest_0.6.29    
 [5] utf8_1.2.2        R6_2.5.1          cellranger_1.1.0  backports_1.4.1  
 [9] reprex_2.0.1      evaluate_0.15     httr_1.4.3        highr_0.9        
[13] pillar_1.7.0      rlang_1.0.2       readxl_1.4.0      rstudioapi_0.13  
[17] jquerylib_0.1.4   rmarkdown_2.14    labeling_0.4.2    webshot_0.5.3    
[21] munsell_0.5.0     broom_0.8.0       compiler_4.1.2    modelr_0.1.8     
[25] xfun_0.30         pkgconfig_2.0.3   systemfonts_1.0.4 htmltools_0.5.2  
[29] tidyselect_1.1.2  bookdown_0.26     fansi_1.0.3       viridisLite_0.4.0
[33] crayon_1.5.1      tzdb_0.3.0        dbplyr_2.1.1      withr_2.5.0      
[37] grid_4.1.2        jsonlite_1.8.0    gtable_0.3.0      lifecycle_1.0.1  
[41] DBI_1.1.2         magrittr_2.0.3    scales_1.2.0      cli_3.3.0        
[45] stringi_1.7.6     farver_2.1.0      fs_1.5.2          xml2_1.3.3       
[49] bslib_0.3.1       ellipsis_0.3.2    generics_0.1.2    vctrs_0.4.1      
[53] tools_4.1.2       glue_1.6.2        hms_1.1.1         fastmap_1.1.0    
[57] yaml_2.3.5        colorspace_2.0-3  rvest_1.0.2       haven_2.5.0      
[61] sass_0.4.1       </code></pre>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="probability-and-causality.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="simulation-2.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"],
"google": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/psych252/psych252book/edit/master/07-simulation1.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": false,
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"toc_depth": 3
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
