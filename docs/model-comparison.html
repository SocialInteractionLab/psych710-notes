<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 16 Model comparison | Psych 252: Statistical Methods for Behavioral and Social Sciences</title>
  <meta name="description" content="Course notes for Psych 252." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 16 Model comparison | Psych 252: Statistical Methods for Behavioral and Social Sciences" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Course notes for Psych 252." />
  <meta name="github-repo" content="psych252/psych252book" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 16 Model comparison | Psych 252: Statistical Methods for Behavioral and Social Sciences" />
  
  <meta name="twitter:description" content="Course notes for Psych 252." />
  

<meta name="author" content="Tobias Gerstenberg" />


<meta name="date" content="2021-03-11" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="mediation-moderation.html"/>
<link rel="next" href="linear-mixed-effects-models-1.html"/>
<script src="libs/header-attrs-2.6/header-attrs.js"></script>
<script src="libs/jquery-3.5.1/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.17/datatables.js"></script>
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.10.20/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.1/js/crosstalk.min.js"></script>
<script src="libs/viz-1.8.2/viz.js"></script>
<link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="libs/grViz-binding-1.0.6.1/grViz.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Psych 252</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#course-description"><i class="fa fa-check"></i>Course description</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#course-homepage"><i class="fa fa-check"></i>Course homepage</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#thanks"><i class="fa fa-check"></i><b>1.1</b> Thanks</a></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#list-of-r-packages-used-in-this-book"><i class="fa fa-check"></i><b>1.2</b> List of R packages used in this book</a></li>
<li class="chapter" data-level="1.3" data-path="introduction.html"><a href="introduction.html#installing-packages"><i class="fa fa-check"></i><b>1.3</b> Installing packages</a></li>
<li class="chapter" data-level="1.4" data-path="introduction.html"><a href="introduction.html#session-info"><i class="fa fa-check"></i><b>1.4</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="visualization-1.html"><a href="visualization-1.html"><i class="fa fa-check"></i><b>2</b> Visualization 1</a>
<ul>
<li class="chapter" data-level="2.1" data-path="visualization-1.html"><a href="visualization-1.html#learning-goals"><i class="fa fa-check"></i><b>2.1</b> Learning goals</a></li>
<li class="chapter" data-level="2.2" data-path="visualization-1.html"><a href="visualization-1.html#load-packages"><i class="fa fa-check"></i><b>2.2</b> Load packages</a></li>
<li class="chapter" data-level="2.3" data-path="visualization-1.html"><a href="visualization-1.html#why-visualize-data"><i class="fa fa-check"></i><b>2.3</b> Why visualize data?</a></li>
<li class="chapter" data-level="2.4" data-path="visualization-1.html"><a href="visualization-1.html#some-basics"><i class="fa fa-check"></i><b>2.4</b> Some basics</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="visualization-1.html"><a href="visualization-1.html#setting-up-rstudio"><i class="fa fa-check"></i><b>2.4.1</b> Setting up RStudio</a></li>
<li class="chapter" data-level="2.4.2" data-path="visualization-1.html"><a href="visualization-1.html#getting-help"><i class="fa fa-check"></i><b>2.4.2</b> Getting help</a></li>
<li class="chapter" data-level="2.4.3" data-path="visualization-1.html"><a href="visualization-1.html#r-markdown-infos"><i class="fa fa-check"></i><b>2.4.3</b> R Markdown infos</a></li>
<li class="chapter" data-level="2.4.4" data-path="visualization-1.html"><a href="visualization-1.html#helpful-keyboard-shortcuts"><i class="fa fa-check"></i><b>2.4.4</b> Helpful keyboard shortcuts</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="visualization-1.html"><a href="visualization-1.html#data-visualization"><i class="fa fa-check"></i><b>2.5</b> Data visualization</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="visualization-1.html"><a href="visualization-1.html#setting-up-a-plot"><i class="fa fa-check"></i><b>2.5.1</b> Setting up a plot</a></li>
<li class="chapter" data-level="2.5.2" data-path="visualization-1.html"><a href="visualization-1.html#bar-plot"><i class="fa fa-check"></i><b>2.5.2</b> Bar plot</a></li>
<li class="chapter" data-level="2.5.3" data-path="visualization-1.html"><a href="visualization-1.html#setting-the-default-plot-theme"><i class="fa fa-check"></i><b>2.5.3</b> Setting the default plot theme</a></li>
<li class="chapter" data-level="2.5.4" data-path="visualization-1.html"><a href="visualization-1.html#scatter-plot"><i class="fa fa-check"></i><b>2.5.4</b> Scatter plot</a></li>
<li class="chapter" data-level="2.5.5" data-path="visualization-1.html"><a href="visualization-1.html#line-plot"><i class="fa fa-check"></i><b>2.5.5</b> Line plot</a></li>
<li class="chapter" data-level="2.5.6" data-path="visualization-1.html"><a href="visualization-1.html#adding-error-bars"><i class="fa fa-check"></i><b>2.5.6</b> Adding error bars</a></li>
<li class="chapter" data-level="2.5.7" data-path="visualization-1.html"><a href="visualization-1.html#order-matters"><i class="fa fa-check"></i><b>2.5.7</b> Order matters</a></li>
<li class="chapter" data-level="2.5.8" data-path="visualization-1.html"><a href="visualization-1.html#grouping-data"><i class="fa fa-check"></i><b>2.5.8</b> Grouping data</a></li>
<li class="chapter" data-level="2.5.9" data-path="visualization-1.html"><a href="visualization-1.html#making-facets"><i class="fa fa-check"></i><b>2.5.9</b> Making facets</a></li>
<li class="chapter" data-level="2.5.10" data-path="visualization-1.html"><a href="visualization-1.html#global-local-and-setting-aes"><i class="fa fa-check"></i><b>2.5.10</b> Global, local, and setting <code>aes()</code></a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="visualization-1.html"><a href="visualization-1.html#additional-resources"><i class="fa fa-check"></i><b>2.6</b> Additional resources</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="visualization-1.html"><a href="visualization-1.html#cheatsheets"><i class="fa fa-check"></i><b>2.6.1</b> Cheatsheets</a></li>
<li class="chapter" data-level="2.6.2" data-path="visualization-1.html"><a href="visualization-1.html#datacamp-courses"><i class="fa fa-check"></i><b>2.6.2</b> Datacamp courses</a></li>
<li class="chapter" data-level="2.6.3" data-path="visualization-1.html"><a href="visualization-1.html#books-and-chapters"><i class="fa fa-check"></i><b>2.6.3</b> Books and chapters</a></li>
<li class="chapter" data-level="2.6.4" data-path="visualization-1.html"><a href="visualization-1.html#misc"><i class="fa fa-check"></i><b>2.6.4</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="visualization-1.html"><a href="visualization-1.html#session-info-1"><i class="fa fa-check"></i><b>2.7</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="visualization-2.html"><a href="visualization-2.html"><i class="fa fa-check"></i><b>3</b> Visualization 2</a>
<ul>
<li class="chapter" data-level="3.1" data-path="visualization-2.html"><a href="visualization-2.html#learning-objectives"><i class="fa fa-check"></i><b>3.1</b> Learning objectives</a></li>
<li class="chapter" data-level="3.2" data-path="visualization-2.html"><a href="visualization-2.html#install-and-load-packages-load-data-set-theme"><i class="fa fa-check"></i><b>3.2</b> Install and load packages, load data, set theme</a></li>
<li class="chapter" data-level="3.3" data-path="visualization-2.html"><a href="visualization-2.html#overview-of-different-plot-types-for-different-things"><i class="fa fa-check"></i><b>3.3</b> Overview of different plot types for different things</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="visualization-2.html"><a href="visualization-2.html#proportions"><i class="fa fa-check"></i><b>3.3.1</b> Proportions</a></li>
<li class="chapter" data-level="3.3.2" data-path="visualization-2.html"><a href="visualization-2.html#comparisons"><i class="fa fa-check"></i><b>3.3.2</b> Comparisons</a></li>
<li class="chapter" data-level="3.3.3" data-path="visualization-2.html"><a href="visualization-2.html#relationships"><i class="fa fa-check"></i><b>3.3.3</b> Relationships</a></li>
<li class="chapter" data-level="3.3.4" data-path="visualization-2.html"><a href="visualization-2.html#temporal-data"><i class="fa fa-check"></i><b>3.3.4</b> Temporal data</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="visualization-2.html"><a href="visualization-2.html#customizing-plots"><i class="fa fa-check"></i><b>3.4</b> Customizing plots</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="visualization-2.html"><a href="visualization-2.html#anatomy-of-a-ggplot"><i class="fa fa-check"></i><b>3.4.1</b> Anatomy of a <code>ggplot</code></a></li>
<li class="chapter" data-level="3.4.2" data-path="visualization-2.html"><a href="visualization-2.html#changing-the-order-of-things"><i class="fa fa-check"></i><b>3.4.2</b> Changing the order of things</a></li>
<li class="chapter" data-level="3.4.3" data-path="visualization-2.html"><a href="visualization-2.html#dealing-with-legends"><i class="fa fa-check"></i><b>3.4.3</b> Dealing with legends</a></li>
<li class="chapter" data-level="3.4.4" data-path="visualization-2.html"><a href="visualization-2.html#choosing-good-colors"><i class="fa fa-check"></i><b>3.4.4</b> Choosing good colors</a></li>
<li class="chapter" data-level="3.4.5" data-path="visualization-2.html"><a href="visualization-2.html#customizing-themes"><i class="fa fa-check"></i><b>3.4.5</b> Customizing themes</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="visualization-2.html"><a href="visualization-2.html#saving-plots"><i class="fa fa-check"></i><b>3.5</b> Saving plots</a></li>
<li class="chapter" data-level="3.6" data-path="visualization-2.html"><a href="visualization-2.html#creating-figure-panels"><i class="fa fa-check"></i><b>3.6</b> Creating figure panels</a></li>
<li class="chapter" data-level="3.7" data-path="visualization-2.html"><a href="visualization-2.html#peeking-behind-the-scenes"><i class="fa fa-check"></i><b>3.7</b> Peeking behind the scenes</a></li>
<li class="chapter" data-level="3.8" data-path="visualization-2.html"><a href="visualization-2.html#making-animations"><i class="fa fa-check"></i><b>3.8</b> Making animations</a></li>
<li class="chapter" data-level="3.9" data-path="visualization-2.html"><a href="visualization-2.html#shiny-apps"><i class="fa fa-check"></i><b>3.9</b> Shiny apps</a></li>
<li class="chapter" data-level="3.10" data-path="visualization-2.html"><a href="visualization-2.html#defining-snippets"><i class="fa fa-check"></i><b>3.10</b> Defining snippets</a></li>
<li class="chapter" data-level="3.11" data-path="visualization-2.html"><a href="visualization-2.html#additional-resources-1"><i class="fa fa-check"></i><b>3.11</b> Additional resources</a>
<ul>
<li class="chapter" data-level="3.11.1" data-path="visualization-2.html"><a href="visualization-2.html#cheatsheets-1"><i class="fa fa-check"></i><b>3.11.1</b> Cheatsheets</a></li>
<li class="chapter" data-level="3.11.2" data-path="visualization-2.html"><a href="visualization-2.html#data-camp-courses"><i class="fa fa-check"></i><b>3.11.2</b> Data camp courses</a></li>
<li class="chapter" data-level="3.11.3" data-path="visualization-2.html"><a href="visualization-2.html#books-and-chapters-1"><i class="fa fa-check"></i><b>3.11.3</b> Books and chapters</a></li>
<li class="chapter" data-level="3.11.4" data-path="visualization-2.html"><a href="visualization-2.html#misc-1"><i class="fa fa-check"></i><b>3.11.4</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="3.12" data-path="visualization-2.html"><a href="visualization-2.html#session-info-2"><i class="fa fa-check"></i><b>3.12</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html"><i class="fa fa-check"></i><b>4</b> Data wrangling 1</a>
<ul>
<li class="chapter" data-level="4.1" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#learning-goals-1"><i class="fa fa-check"></i><b>4.1</b> Learning goals</a></li>
<li class="chapter" data-level="4.2" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#load-packages-1"><i class="fa fa-check"></i><b>4.2</b> Load packages</a></li>
<li class="chapter" data-level="4.3" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#some-r-basics"><i class="fa fa-check"></i><b>4.3</b> Some R basics</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#modes"><i class="fa fa-check"></i><b>4.3.1</b> Modes</a></li>
<li class="chapter" data-level="4.3.2" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#data-types"><i class="fa fa-check"></i><b>4.3.2</b> Data types</a></li>
<li class="chapter" data-level="4.3.3" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#operators"><i class="fa fa-check"></i><b>4.3.3</b> Operators</a></li>
<li class="chapter" data-level="4.3.4" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#control-flow"><i class="fa fa-check"></i><b>4.3.4</b> Control flow</a></li>
<li class="chapter" data-level="4.3.5" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#functions"><i class="fa fa-check"></i><b>4.3.5</b> Functions</a></li>
<li class="chapter" data-level="4.3.6" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#the-pipe-operator"><i class="fa fa-check"></i><b>4.3.6</b> The pipe operator <code>%&gt;%</code></a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#a-quick-note-on-naming-things"><i class="fa fa-check"></i><b>4.4</b> A quick note on naming things</a></li>
<li class="chapter" data-level="4.5" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#looking-at-data"><i class="fa fa-check"></i><b>4.5</b> Looking at data</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#head"><i class="fa fa-check"></i><b>4.5.1</b> <code>head()</code></a></li>
<li class="chapter" data-level="4.5.2" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#glimpse"><i class="fa fa-check"></i><b>4.5.2</b> <code>glimpse()</code></a></li>
<li class="chapter" data-level="4.5.3" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#distinct"><i class="fa fa-check"></i><b>4.5.3</b> <code>distinct()</code></a></li>
<li class="chapter" data-level="4.5.4" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#count"><i class="fa fa-check"></i><b>4.5.4</b> <code>count()</code></a></li>
<li class="chapter" data-level="4.5.5" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#datatable"><i class="fa fa-check"></i><b>4.5.5</b> <code>datatable()</code></a></li>
<li class="chapter" data-level="4.5.6" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#other-tools-for-taking-a-quick-look-at-data"><i class="fa fa-check"></i><b>4.5.6</b> Other tools for taking a quick look at data</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#wrangling-data"><i class="fa fa-check"></i><b>4.6</b> Wrangling data</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#filter"><i class="fa fa-check"></i><b>4.6.1</b> <code>filter()</code></a></li>
<li class="chapter" data-level="4.6.2" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#arrange"><i class="fa fa-check"></i><b>4.6.2</b> <code>arrange()</code></a></li>
<li class="chapter" data-level="4.6.3" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#rename"><i class="fa fa-check"></i><b>4.6.3</b> <code>rename()</code></a></li>
<li class="chapter" data-level="4.6.4" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#relocate"><i class="fa fa-check"></i><b>4.6.4</b> <code>relocate()</code></a></li>
<li class="chapter" data-level="4.6.5" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#select"><i class="fa fa-check"></i><b>4.6.5</b> <code>select()</code></a></li>
<li class="chapter" data-level="4.6.6" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#practice-2"><i class="fa fa-check"></i><b>4.6.6</b> Practice 2</a></li>
<li class="chapter" data-level="4.6.7" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#mutate"><i class="fa fa-check"></i><b>4.6.7</b> <code>mutate()</code></a></li>
<li class="chapter" data-level="4.6.8" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#practice-3"><i class="fa fa-check"></i><b>4.6.8</b> Practice 3</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#additional-resources-2"><i class="fa fa-check"></i><b>4.7</b> Additional resources</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#cheatsheets-2"><i class="fa fa-check"></i><b>4.7.1</b> Cheatsheets</a></li>
<li class="chapter" data-level="4.7.2" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#data-camp-courses-1"><i class="fa fa-check"></i><b>4.7.2</b> Data camp courses</a></li>
<li class="chapter" data-level="4.7.3" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#books-and-chapters-2"><i class="fa fa-check"></i><b>4.7.3</b> Books and chapters</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#session-info-3"><i class="fa fa-check"></i><b>4.8</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html"><i class="fa fa-check"></i><b>5</b> Data wrangling 2</a>
<ul>
<li class="chapter" data-level="5.1" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#learning-goals-2"><i class="fa fa-check"></i><b>5.1</b> Learning goals</a></li>
<li class="chapter" data-level="5.2" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#load-packages-2"><i class="fa fa-check"></i><b>5.2</b> Load packages</a></li>
<li class="chapter" data-level="5.3" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#settings"><i class="fa fa-check"></i><b>5.3</b> Settings</a></li>
<li class="chapter" data-level="5.4" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#wrangling-data-continued"><i class="fa fa-check"></i><b>5.4</b> Wrangling data (continued)</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#summarizing-data"><i class="fa fa-check"></i><b>5.4.1</b> Summarizing data</a></li>
<li class="chapter" data-level="5.4.2" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#reshaping-data"><i class="fa fa-check"></i><b>5.4.2</b> Reshaping data</a></li>
<li class="chapter" data-level="5.4.3" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#joining-multiple-data-frames"><i class="fa fa-check"></i><b>5.4.3</b> Joining multiple data frames</a></li>
<li class="chapter" data-level="5.4.4" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#dealing-with-missing-data"><i class="fa fa-check"></i><b>5.4.4</b> Dealing with missing data</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#reading-in-data"><i class="fa fa-check"></i><b>5.5</b> Reading in data</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#csv"><i class="fa fa-check"></i><b>5.5.1</b> csv</a></li>
<li class="chapter" data-level="5.5.2" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#rdata"><i class="fa fa-check"></i><b>5.5.2</b> RData</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#saving-data"><i class="fa fa-check"></i><b>5.6</b> Saving data</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#csv-1"><i class="fa fa-check"></i><b>5.6.1</b> csv</a></li>
<li class="chapter" data-level="5.6.2" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#rdata-1"><i class="fa fa-check"></i><b>5.6.2</b> RData</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#additional-resources-3"><i class="fa fa-check"></i><b>5.7</b> Additional resources</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#cheatsheets-3"><i class="fa fa-check"></i><b>5.7.1</b> Cheatsheets</a></li>
<li class="chapter" data-level="5.7.2" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#data-camp-courses-2"><i class="fa fa-check"></i><b>5.7.2</b> Data camp courses</a></li>
<li class="chapter" data-level="5.7.3" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#books-and-chapters-3"><i class="fa fa-check"></i><b>5.7.3</b> Books and chapters</a></li>
<li class="chapter" data-level="5.7.4" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#tutorials"><i class="fa fa-check"></i><b>5.7.4</b> Tutorials</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#session-info-4"><i class="fa fa-check"></i><b>5.8</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="probability-and-causality.html"><a href="probability-and-causality.html"><i class="fa fa-check"></i><b>6</b> Probability and causality</a>
<ul>
<li class="chapter" data-level="6.1" data-path="probability-and-causality.html"><a href="probability-and-causality.html#load-packages-load-data-set-theme"><i class="fa fa-check"></i><b>6.1</b> Load packages, load data, set theme</a></li>
<li class="chapter" data-level="6.2" data-path="probability-and-causality.html"><a href="probability-and-causality.html#counting"><i class="fa fa-check"></i><b>6.2</b> Counting</a></li>
<li class="chapter" data-level="6.3" data-path="probability-and-causality.html"><a href="probability-and-causality.html#the-random-secretary"><i class="fa fa-check"></i><b>6.3</b> The random secretary</a></li>
<li class="chapter" data-level="6.4" data-path="probability-and-causality.html"><a href="probability-and-causality.html#flipping-a-coin-many-times"><i class="fa fa-check"></i><b>6.4</b> Flipping a coin many times</a></li>
<li class="chapter" data-level="6.5" data-path="probability-and-causality.html"><a href="probability-and-causality.html#clue-guide-to-probability"><i class="fa fa-check"></i><b>6.5</b> Clue guide to probability</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="probability-and-causality.html"><a href="probability-and-causality.html#conditional-probability"><i class="fa fa-check"></i><b>6.5.1</b> Conditional probability</a></li>
<li class="chapter" data-level="6.5.2" data-path="probability-and-causality.html"><a href="probability-and-causality.html#law-of-total-probability"><i class="fa fa-check"></i><b>6.5.2</b> Law of total probability</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="probability-and-causality.html"><a href="probability-and-causality.html#probability-operations"><i class="fa fa-check"></i><b>6.6</b> Probability operations</a></li>
<li class="chapter" data-level="6.7" data-path="probability-and-causality.html"><a href="probability-and-causality.html#bayesian-reasoning-example"><i class="fa fa-check"></i><b>6.7</b> Bayesian reasoning example</a></li>
<li class="chapter" data-level="6.8" data-path="probability-and-causality.html"><a href="probability-and-causality.html#bayesian-networks"><i class="fa fa-check"></i><b>6.8</b> Bayesian networks</a>
<ul>
<li class="chapter" data-level="6.8.1" data-path="probability-and-causality.html"><a href="probability-and-causality.html#sprinkler-example"><i class="fa fa-check"></i><b>6.8.1</b> Sprinkler example</a></li>
</ul></li>
<li class="chapter" data-level="6.9" data-path="probability-and-causality.html"><a href="probability-and-causality.html#additional-resources-4"><i class="fa fa-check"></i><b>6.9</b> Additional resources</a>
<ul>
<li class="chapter" data-level="6.9.1" data-path="probability-and-causality.html"><a href="probability-and-causality.html#cheatsheets-4"><i class="fa fa-check"></i><b>6.9.1</b> Cheatsheets</a></li>
<li class="chapter" data-level="6.9.2" data-path="probability-and-causality.html"><a href="probability-and-causality.html#books-and-chapters-4"><i class="fa fa-check"></i><b>6.9.2</b> Books and chapters</a></li>
<li class="chapter" data-level="6.9.3" data-path="probability-and-causality.html"><a href="probability-and-causality.html#misc-2"><i class="fa fa-check"></i><b>6.9.3</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="6.10" data-path="probability-and-causality.html"><a href="probability-and-causality.html#session-info-5"><i class="fa fa-check"></i><b>6.10</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="simulation-1.html"><a href="simulation-1.html"><i class="fa fa-check"></i><b>7</b> Simulation 1</a>
<ul>
<li class="chapter" data-level="7.1" data-path="simulation-1.html"><a href="simulation-1.html#load-packages-and-set-plotting-theme"><i class="fa fa-check"></i><b>7.1</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="7.2" data-path="simulation-1.html"><a href="simulation-1.html#sampling"><i class="fa fa-check"></i><b>7.2</b> Sampling</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="simulation-1.html"><a href="simulation-1.html#drawing-numbers-from-a-vector"><i class="fa fa-check"></i><b>7.2.1</b> Drawing numbers from a vector</a></li>
<li class="chapter" data-level="7.2.2" data-path="simulation-1.html"><a href="simulation-1.html#drawing-rows-from-a-data-frame"><i class="fa fa-check"></i><b>7.2.2</b> Drawing rows from a data frame</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="simulation-1.html"><a href="simulation-1.html#working-with-distributions"><i class="fa fa-check"></i><b>7.3</b> Working with distributions</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="simulation-1.html"><a href="simulation-1.html#plotting-distributions"><i class="fa fa-check"></i><b>7.3.1</b> Plotting distributions</a></li>
<li class="chapter" data-level="7.3.2" data-path="simulation-1.html"><a href="simulation-1.html#sampling-from-distributions"><i class="fa fa-check"></i><b>7.3.2</b> Sampling from distributions</a></li>
<li class="chapter" data-level="7.3.3" data-path="simulation-1.html"><a href="simulation-1.html#understanding-density"><i class="fa fa-check"></i><b>7.3.3</b> Understanding <code>density()</code></a></li>
<li class="chapter" data-level="7.3.4" data-path="simulation-1.html"><a href="simulation-1.html#cumulative-probability-distribution"><i class="fa fa-check"></i><b>7.3.4</b> Cumulative probability distribution</a></li>
<li class="chapter" data-level="7.3.5" data-path="simulation-1.html"><a href="simulation-1.html#inverse-cumulative-distribution"><i class="fa fa-check"></i><b>7.3.5</b> Inverse cumulative distribution</a></li>
<li class="chapter" data-level="7.3.6" data-path="simulation-1.html"><a href="simulation-1.html#computing-probabilities"><i class="fa fa-check"></i><b>7.3.6</b> Computing probabilities</a></li>
<li class="chapter" data-level="7.3.7" data-path="simulation-1.html"><a href="simulation-1.html#make-the-plot"><i class="fa fa-check"></i><b>7.3.7</b> Make the plot</a></li>
<li class="chapter" data-level="7.3.8" data-path="simulation-1.html"><a href="simulation-1.html#analytic-solutions"><i class="fa fa-check"></i><b>7.3.8</b> Analytic solutions</a></li>
<li class="chapter" data-level="7.3.9" data-path="simulation-1.html"><a href="simulation-1.html#sampling-solution"><i class="fa fa-check"></i><b>7.3.9</b> Sampling solution</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="simulation-1.html"><a href="simulation-1.html#bayesian-inference-with-the-normal-distribution"><i class="fa fa-check"></i><b>7.4</b> Bayesian inference with the normal distribution</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="simulation-1.html"><a href="simulation-1.html#analytic-solution"><i class="fa fa-check"></i><b>7.4.1</b> Analytic solution</a></li>
<li class="chapter" data-level="7.4.2" data-path="simulation-1.html"><a href="simulation-1.html#solution-via-sampling"><i class="fa fa-check"></i><b>7.4.2</b> Solution via sampling</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="simulation-1.html"><a href="simulation-1.html#additional-resources-5"><i class="fa fa-check"></i><b>7.5</b> Additional resources</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="simulation-1.html"><a href="simulation-1.html#cheatsheets-5"><i class="fa fa-check"></i><b>7.5.1</b> Cheatsheets</a></li>
<li class="chapter" data-level="7.5.2" data-path="simulation-1.html"><a href="simulation-1.html#datacamp"><i class="fa fa-check"></i><b>7.5.2</b> Datacamp</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="simulation-1.html"><a href="simulation-1.html#session-info-6"><i class="fa fa-check"></i><b>7.6</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="simulation-2.html"><a href="simulation-2.html"><i class="fa fa-check"></i><b>8</b> Simulation 2</a>
<ul>
<li class="chapter" data-level="8.1" data-path="simulation-2.html"><a href="simulation-2.html#load-packages-and-set-plotting-theme-1"><i class="fa fa-check"></i><b>8.1</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="8.2" data-path="simulation-2.html"><a href="simulation-2.html#making-statistical-inferences-frequentist-style"><i class="fa fa-check"></i><b>8.2</b> Making statistical inferences (frequentist style)</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="simulation-2.html"><a href="simulation-2.html#population-distribution"><i class="fa fa-check"></i><b>8.2.1</b> Population distribution</a></li>
<li class="chapter" data-level="8.2.2" data-path="simulation-2.html"><a href="simulation-2.html#distribution-of-a-single-sample"><i class="fa fa-check"></i><b>8.2.2</b> Distribution of a single sample</a></li>
<li class="chapter" data-level="8.2.3" data-path="simulation-2.html"><a href="simulation-2.html#the-sampling-distribution"><i class="fa fa-check"></i><b>8.2.3</b> The sampling distribution</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="simulation-2.html"><a href="simulation-2.html#understanding-p-values"><i class="fa fa-check"></i><b>8.3</b> Understanding p-values</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="simulation-2.html"><a href="simulation-2.html#permutation-test"><i class="fa fa-check"></i><b>8.3.1</b> Permutation test</a></li>
<li class="chapter" data-level="8.3.2" data-path="simulation-2.html"><a href="simulation-2.html#t-test-by-hand"><i class="fa fa-check"></i><b>8.3.2</b> t-test by hand</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="simulation-2.html"><a href="simulation-2.html#confidence-intervals"><i class="fa fa-check"></i><b>8.4</b> Confidence intervals</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="simulation-2.html"><a href="simulation-2.html#mean_cl_boot-explained"><i class="fa fa-check"></i><b>8.4.1</b> <code>mean_cl_boot()</code> explained</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="simulation-2.html"><a href="simulation-2.html#additional-resources-6"><i class="fa fa-check"></i><b>8.5</b> Additional resources</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="simulation-2.html"><a href="simulation-2.html#datacamp-1"><i class="fa fa-check"></i><b>8.5.1</b> Datacamp</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="simulation-2.html"><a href="simulation-2.html#session-info-7"><i class="fa fa-check"></i><b>8.6</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="modeling-data.html"><a href="modeling-data.html"><i class="fa fa-check"></i><b>9</b> Modeling data</a>
<ul>
<li class="chapter" data-level="9.1" data-path="modeling-data.html"><a href="modeling-data.html#load-packages-and-set-plotting-theme-2"><i class="fa fa-check"></i><b>9.1</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="9.2" data-path="modeling-data.html"><a href="modeling-data.html#modeling-data-1"><i class="fa fa-check"></i><b>9.2</b> Modeling data</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="modeling-data.html"><a href="modeling-data.html#simplicity-vs.-accuracy-trade-off"><i class="fa fa-check"></i><b>9.2.1</b> Simplicity vs. accuracy trade-off</a></li>
<li class="chapter" data-level="9.2.2" data-path="modeling-data.html"><a href="modeling-data.html#error-definitions-and-best-estimators"><i class="fa fa-check"></i><b>9.2.2</b> Error definitions and best estimators</a></li>
<li class="chapter" data-level="9.2.3" data-path="modeling-data.html"><a href="modeling-data.html#sampling-distributions-for-median-and-mean"><i class="fa fa-check"></i><b>9.2.3</b> Sampling distributions for median and mean</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="modeling-data.html"><a href="modeling-data.html#hypothesis-testing-one-sample-t-test"><i class="fa fa-check"></i><b>9.3</b> Hypothesis testing: “One-sample t-test”</a></li>
<li class="chapter" data-level="9.4" data-path="modeling-data.html"><a href="modeling-data.html#building-a-sampling-distribution-of-pre"><i class="fa fa-check"></i><b>9.4</b> Building a sampling distribution of PRE</a></li>
<li class="chapter" data-level="9.5" data-path="modeling-data.html"><a href="modeling-data.html#additional-resources-7"><i class="fa fa-check"></i><b>9.5</b> Additional resources</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="modeling-data.html"><a href="modeling-data.html#reading"><i class="fa fa-check"></i><b>9.5.1</b> Reading</a></li>
<li class="chapter" data-level="9.5.2" data-path="modeling-data.html"><a href="modeling-data.html#datacamp-2"><i class="fa fa-check"></i><b>9.5.2</b> Datacamp</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="modeling-data.html"><a href="modeling-data.html#session-info-8"><i class="fa fa-check"></i><b>9.6</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="linear-model-1.html"><a href="linear-model-1.html"><i class="fa fa-check"></i><b>10</b> Linear model 1</a>
<ul>
<li class="chapter" data-level="10.1" data-path="linear-model-1.html"><a href="linear-model-1.html#load-packages-and-set-plotting-theme-3"><i class="fa fa-check"></i><b>10.1</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="10.2" data-path="linear-model-1.html"><a href="linear-model-1.html#correlation"><i class="fa fa-check"></i><b>10.2</b> Correlation</a></li>
<li class="chapter" data-level="10.3" data-path="linear-model-1.html"><a href="linear-model-1.html#regression"><i class="fa fa-check"></i><b>10.3</b> Regression</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="linear-model-1.html"><a href="linear-model-1.html#define-and-fit-the-models"><i class="fa fa-check"></i><b>10.3.1</b> Define and fit the models</a></li>
<li class="chapter" data-level="10.3.2" data-path="linear-model-1.html"><a href="linear-model-1.html#calculate-the-sum-of-squared-errors-of-each-model"><i class="fa fa-check"></i><b>10.3.2</b> Calculate the sum of squared errors of each model</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="linear-model-1.html"><a href="linear-model-1.html#credit-example"><i class="fa fa-check"></i><b>10.4</b> Credit example</a></li>
<li class="chapter" data-level="10.5" data-path="linear-model-1.html"><a href="linear-model-1.html#additional-resources-8"><i class="fa fa-check"></i><b>10.5</b> Additional resources</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="linear-model-1.html"><a href="linear-model-1.html#datacamp-3"><i class="fa fa-check"></i><b>10.5.1</b> Datacamp</a></li>
<li class="chapter" data-level="10.5.2" data-path="linear-model-1.html"><a href="linear-model-1.html#misc-3"><i class="fa fa-check"></i><b>10.5.2</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="linear-model-1.html"><a href="linear-model-1.html#session-info-9"><i class="fa fa-check"></i><b>10.6</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="linear-model-2.html"><a href="linear-model-2.html"><i class="fa fa-check"></i><b>11</b> Linear model 2</a>
<ul>
<li class="chapter" data-level="11.1" data-path="linear-model-2.html"><a href="linear-model-2.html#learning-goals-3"><i class="fa fa-check"></i><b>11.1</b> Learning goals</a></li>
<li class="chapter" data-level="11.2" data-path="linear-model-2.html"><a href="linear-model-2.html#load-packages-and-set-plotting-theme-4"><i class="fa fa-check"></i><b>11.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="11.3" data-path="linear-model-2.html"><a href="linear-model-2.html#load-data-sets"><i class="fa fa-check"></i><b>11.3</b> Load data sets</a></li>
<li class="chapter" data-level="11.4" data-path="linear-model-2.html"><a href="linear-model-2.html#multiple-continuous-variables"><i class="fa fa-check"></i><b>11.4</b> Multiple continuous variables</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="linear-model-2.html"><a href="linear-model-2.html#explore-correlations"><i class="fa fa-check"></i><b>11.4.1</b> Explore correlations</a></li>
<li class="chapter" data-level="11.4.2" data-path="linear-model-2.html"><a href="linear-model-2.html#multipe-regression"><i class="fa fa-check"></i><b>11.4.2</b> Multipe regression</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="linear-model-2.html"><a href="linear-model-2.html#one-categorical-variable"><i class="fa fa-check"></i><b>11.5</b> One categorical variable</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="linear-model-2.html"><a href="linear-model-2.html#visualization-of-the-model-predictions"><i class="fa fa-check"></i><b>11.5.1</b> Visualization of the model predictions</a></li>
<li class="chapter" data-level="11.5.2" data-path="linear-model-2.html"><a href="linear-model-2.html#dummy-coding"><i class="fa fa-check"></i><b>11.5.2</b> Dummy coding</a></li>
<li class="chapter" data-level="11.5.3" data-path="linear-model-2.html"><a href="linear-model-2.html#reporting-the-results"><i class="fa fa-check"></i><b>11.5.3</b> Reporting the results</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="linear-model-2.html"><a href="linear-model-2.html#one-continuous-and-one-categorical-variable"><i class="fa fa-check"></i><b>11.6</b> One continuous and one categorical variable</a>
<ul>
<li class="chapter" data-level="11.6.1" data-path="linear-model-2.html"><a href="linear-model-2.html#visualization-of-the-model-predictions-1"><i class="fa fa-check"></i><b>11.6.1</b> Visualization of the model predictions</a></li>
</ul></li>
<li class="chapter" data-level="11.7" data-path="linear-model-2.html"><a href="linear-model-2.html#interactions"><i class="fa fa-check"></i><b>11.7</b> Interactions</a>
<ul>
<li class="chapter" data-level="11.7.1" data-path="linear-model-2.html"><a href="linear-model-2.html#visualization-3"><i class="fa fa-check"></i><b>11.7.1</b> Visualization</a></li>
<li class="chapter" data-level="11.7.2" data-path="linear-model-2.html"><a href="linear-model-2.html#hypothesis-test"><i class="fa fa-check"></i><b>11.7.2</b> Hypothesis test</a></li>
</ul></li>
<li class="chapter" data-level="11.8" data-path="linear-model-2.html"><a href="linear-model-2.html#additional-resources-9"><i class="fa fa-check"></i><b>11.8</b> Additional resources</a>
<ul>
<li class="chapter" data-level="11.8.1" data-path="linear-model-2.html"><a href="linear-model-2.html#datacamp-4"><i class="fa fa-check"></i><b>11.8.1</b> Datacamp</a></li>
<li class="chapter" data-level="11.8.2" data-path="linear-model-2.html"><a href="linear-model-2.html#misc-4"><i class="fa fa-check"></i><b>11.8.2</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="11.9" data-path="linear-model-2.html"><a href="linear-model-2.html#session-info-10"><i class="fa fa-check"></i><b>11.9</b> Session info</a></li>
<li class="chapter" data-level="11.10" data-path="linear-model-2.html"><a href="linear-model-2.html#references"><i class="fa fa-check"></i><b>11.10</b> References</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="linear-model-3.html"><a href="linear-model-3.html"><i class="fa fa-check"></i><b>12</b> Linear model 3</a>
<ul>
<li class="chapter" data-level="12.1" data-path="linear-model-3.html"><a href="linear-model-3.html#learning-goals-4"><i class="fa fa-check"></i><b>12.1</b> Learning goals</a></li>
<li class="chapter" data-level="12.2" data-path="linear-model-3.html"><a href="linear-model-3.html#load-packages-and-set-plotting-theme-5"><i class="fa fa-check"></i><b>12.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="12.3" data-path="linear-model-3.html"><a href="linear-model-3.html#load-data-sets-1"><i class="fa fa-check"></i><b>12.3</b> Load data sets</a></li>
<li class="chapter" data-level="12.4" data-path="linear-model-3.html"><a href="linear-model-3.html#one-way-anova"><i class="fa fa-check"></i><b>12.4</b> One-way ANOVA</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="linear-model-3.html"><a href="linear-model-3.html#visualization-4"><i class="fa fa-check"></i><b>12.4.1</b> Visualization</a></li>
<li class="chapter" data-level="12.4.2" data-path="linear-model-3.html"><a href="linear-model-3.html#model-fitting"><i class="fa fa-check"></i><b>12.4.2</b> Model fitting</a></li>
<li class="chapter" data-level="12.4.3" data-path="linear-model-3.html"><a href="linear-model-3.html#hypothesis-test-1"><i class="fa fa-check"></i><b>12.4.3</b> Hypothesis test</a></li>
<li class="chapter" data-level="12.4.4" data-path="linear-model-3.html"><a href="linear-model-3.html#visualize-the-models-predictions"><i class="fa fa-check"></i><b>12.4.4</b> Visualize the model’s predictions</a></li>
<li class="chapter" data-level="12.4.5" data-path="linear-model-3.html"><a href="linear-model-3.html#dummy-coding-1"><i class="fa fa-check"></i><b>12.4.5</b> Dummy coding</a></li>
<li class="chapter" data-level="12.4.6" data-path="linear-model-3.html"><a href="linear-model-3.html#follow-up-questions"><i class="fa fa-check"></i><b>12.4.6</b> Follow up questions</a></li>
<li class="chapter" data-level="12.4.7" data-path="linear-model-3.html"><a href="linear-model-3.html#variance-decomposition"><i class="fa fa-check"></i><b>12.4.7</b> Variance decomposition</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="linear-model-3.html"><a href="linear-model-3.html#two-way-anova"><i class="fa fa-check"></i><b>12.5</b> Two-way ANOVA</a>
<ul>
<li class="chapter" data-level="12.5.1" data-path="linear-model-3.html"><a href="linear-model-3.html#visualization-5"><i class="fa fa-check"></i><b>12.5.1</b> Visualization</a></li>
<li class="chapter" data-level="12.5.2" data-path="linear-model-3.html"><a href="linear-model-3.html#model-fitting-1"><i class="fa fa-check"></i><b>12.5.2</b> Model fitting</a></li>
<li class="chapter" data-level="12.5.3" data-path="linear-model-3.html"><a href="linear-model-3.html#interpreting-interactions"><i class="fa fa-check"></i><b>12.5.3</b> Interpreting interactions</a></li>
<li class="chapter" data-level="12.5.4" data-path="linear-model-3.html"><a href="linear-model-3.html#variance-decomposition-1"><i class="fa fa-check"></i><b>12.5.4</b> Variance decomposition</a></li>
</ul></li>
<li class="chapter" data-level="12.6" data-path="linear-model-3.html"><a href="linear-model-3.html#two-way-anova-with-interaction"><i class="fa fa-check"></i><b>12.6</b> Two-way ANOVA (with interaction)</a></li>
<li class="chapter" data-level="12.7" data-path="linear-model-3.html"><a href="linear-model-3.html#anova-with-unbalanced-design"><i class="fa fa-check"></i><b>12.7</b> ANOVA with unbalanced design</a></li>
<li class="chapter" data-level="12.8" data-path="linear-model-3.html"><a href="linear-model-3.html#interpreting-parameters-very-important"><i class="fa fa-check"></i><b>12.8</b> Interpreting parameters (very important!)</a></li>
<li class="chapter" data-level="12.9" data-path="linear-model-3.html"><a href="linear-model-3.html#additional-resources-10"><i class="fa fa-check"></i><b>12.9</b> Additional resources</a>
<ul>
<li class="chapter" data-level="12.9.1" data-path="linear-model-3.html"><a href="linear-model-3.html#datacamp-5"><i class="fa fa-check"></i><b>12.9.1</b> Datacamp</a></li>
<li class="chapter" data-level="12.9.2" data-path="linear-model-3.html"><a href="linear-model-3.html#misc-5"><i class="fa fa-check"></i><b>12.9.2</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="12.10" data-path="linear-model-3.html"><a href="linear-model-3.html#session-info-11"><i class="fa fa-check"></i><b>12.10</b> Session info</a></li>
<li class="chapter" data-level="12.11" data-path="linear-model-3.html"><a href="linear-model-3.html#references-1"><i class="fa fa-check"></i><b>12.11</b> References</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="linear-model-4.html"><a href="linear-model-4.html"><i class="fa fa-check"></i><b>13</b> Linear model 4</a>
<ul>
<li class="chapter" data-level="13.1" data-path="linear-model-4.html"><a href="linear-model-4.html#load-packages-and-set-plotting-theme-6"><i class="fa fa-check"></i><b>13.1</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="13.2" data-path="linear-model-4.html"><a href="linear-model-4.html#load-data-sets-2"><i class="fa fa-check"></i><b>13.2</b> Load data sets</a></li>
<li class="chapter" data-level="13.3" data-path="linear-model-4.html"><a href="linear-model-4.html#linear-contrasts"><i class="fa fa-check"></i><b>13.3</b> Linear contrasts</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="linear-model-4.html"><a href="linear-model-4.html#hypothetical-data"><i class="fa fa-check"></i><b>13.3.1</b> Hypothetical data</a></li>
<li class="chapter" data-level="13.3.2" data-path="linear-model-4.html"><a href="linear-model-4.html#visualization-6"><i class="fa fa-check"></i><b>13.3.2</b> Visualization</a></li>
<li class="chapter" data-level="13.3.3" data-path="linear-model-4.html"><a href="linear-model-4.html#post-hoc-tests"><i class="fa fa-check"></i><b>13.3.3</b> Post-hoc tests</a></li>
<li class="chapter" data-level="13.3.4" data-path="linear-model-4.html"><a href="linear-model-4.html#understanding-dummy-coding"><i class="fa fa-check"></i><b>13.3.4</b> Understanding dummy coding</a></li>
<li class="chapter" data-level="13.3.5" data-path="linear-model-4.html"><a href="linear-model-4.html#understanding-effect-coding"><i class="fa fa-check"></i><b>13.3.5</b> Understanding effect coding</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="linear-model-4.html"><a href="linear-model-4.html#session-info-12"><i class="fa fa-check"></i><b>13.4</b> Session info</a></li>
<li class="chapter" data-level="13.5" data-path="linear-model-4.html"><a href="linear-model-4.html#references-2"><i class="fa fa-check"></i><b>13.5</b> References</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="power-analysis.html"><a href="power-analysis.html"><i class="fa fa-check"></i><b>14</b> Power analysis</a>
<ul>
<li class="chapter" data-level="14.1" data-path="power-analysis.html"><a href="power-analysis.html#learning-goals-5"><i class="fa fa-check"></i><b>14.1</b> Learning goals</a></li>
<li class="chapter" data-level="14.2" data-path="power-analysis.html"><a href="power-analysis.html#load-packages-and-set-plotting-theme-7"><i class="fa fa-check"></i><b>14.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="14.3" data-path="power-analysis.html"><a href="power-analysis.html#load-data-sets-3"><i class="fa fa-check"></i><b>14.3</b> Load data sets</a></li>
<li class="chapter" data-level="14.4" data-path="power-analysis.html"><a href="power-analysis.html#decision-making"><i class="fa fa-check"></i><b>14.4</b> Decision-making</a></li>
<li class="chapter" data-level="14.5" data-path="power-analysis.html"><a href="power-analysis.html#effect-sizes"><i class="fa fa-check"></i><b>14.5</b> Effect sizes</a>
<ul>
<li class="chapter" data-level="14.5.1" data-path="power-analysis.html"><a href="power-analysis.html#cohens-d"><i class="fa fa-check"></i><b>14.5.1</b> Cohen’s d</a></li>
</ul></li>
<li class="chapter" data-level="14.6" data-path="power-analysis.html"><a href="power-analysis.html#determining-sample-size"><i class="fa fa-check"></i><b>14.6</b> Determining sample size</a>
<ul>
<li class="chapter" data-level="14.6.1" data-path="power-analysis.html"><a href="power-analysis.html#pwr-package"><i class="fa fa-check"></i><b>14.6.1</b> <code>pwr</code> package</a></li>
<li class="chapter" data-level="14.6.2" data-path="power-analysis.html"><a href="power-analysis.html#power-analysis-via-simulation"><i class="fa fa-check"></i><b>14.6.2</b> Power analysis via simulation</a></li>
</ul></li>
<li class="chapter" data-level="14.7" data-path="power-analysis.html"><a href="power-analysis.html#additional-resources-11"><i class="fa fa-check"></i><b>14.7</b> Additional resources</a>
<ul>
<li class="chapter" data-level="14.7.1" data-path="power-analysis.html"><a href="power-analysis.html#datacamp-6"><i class="fa fa-check"></i><b>14.7.1</b> Datacamp</a></li>
<li class="chapter" data-level="14.7.2" data-path="power-analysis.html"><a href="power-analysis.html#cheatsheets-6"><i class="fa fa-check"></i><b>14.7.2</b> Cheatsheets</a></li>
<li class="chapter" data-level="14.7.3" data-path="power-analysis.html"><a href="power-analysis.html#misc-6"><i class="fa fa-check"></i><b>14.7.3</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="14.8" data-path="power-analysis.html"><a href="power-analysis.html#session-info-13"><i class="fa fa-check"></i><b>14.8</b> Session info</a></li>
<li class="chapter" data-level="14.9" data-path="power-analysis.html"><a href="power-analysis.html#references-3"><i class="fa fa-check"></i><b>14.9</b> References</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="mediation-moderation.html"><a href="mediation-moderation.html"><i class="fa fa-check"></i><b>15</b> Mediation &amp; Moderation</a>
<ul>
<li class="chapter" data-level="15.1" data-path="mediation-moderation.html"><a href="mediation-moderation.html#learning-goals-6"><i class="fa fa-check"></i><b>15.1</b> Learning goals</a></li>
<li class="chapter" data-level="15.2" data-path="mediation-moderation.html"><a href="mediation-moderation.html#recommended-reading"><i class="fa fa-check"></i><b>15.2</b> Recommended reading</a></li>
<li class="chapter" data-level="15.3" data-path="mediation-moderation.html"><a href="mediation-moderation.html#load-packages-and-set-plotting-theme-8"><i class="fa fa-check"></i><b>15.3</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="15.4" data-path="mediation-moderation.html"><a href="mediation-moderation.html#controlling-for-variables"><i class="fa fa-check"></i><b>15.4</b> Controlling for variables</a>
<ul>
<li class="chapter" data-level="15.4.1" data-path="mediation-moderation.html"><a href="mediation-moderation.html#illustration-of-the-d-separation-algorithm"><i class="fa fa-check"></i><b>15.4.1</b> Illustration of the d-separation algorithm</a></li>
<li class="chapter" data-level="15.4.2" data-path="mediation-moderation.html"><a href="mediation-moderation.html#good-controls"><i class="fa fa-check"></i><b>15.4.2</b> Good controls</a></li>
<li class="chapter" data-level="15.4.3" data-path="mediation-moderation.html"><a href="mediation-moderation.html#bad-controls"><i class="fa fa-check"></i><b>15.4.3</b> Bad controls</a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="mediation-moderation.html"><a href="mediation-moderation.html#mediation"><i class="fa fa-check"></i><b>15.5</b> Mediation</a>
<ul>
<li class="chapter" data-level="15.5.1" data-path="mediation-moderation.html"><a href="mediation-moderation.html#generate-data"><i class="fa fa-check"></i><b>15.5.1</b> Generate data</a></li>
<li class="chapter" data-level="15.5.2" data-path="mediation-moderation.html"><a href="mediation-moderation.html#method-1-baron-kennys-1986-indirect-effect-method"><i class="fa fa-check"></i><b>15.5.2</b> Method 1: Baron &amp; Kenny’s (1986) indirect effect method</a></li>
<li class="chapter" data-level="15.5.3" data-path="mediation-moderation.html"><a href="mediation-moderation.html#method-2-sobel-test"><i class="fa fa-check"></i><b>15.5.3</b> Method 2: Sobel Test</a></li>
<li class="chapter" data-level="15.5.4" data-path="mediation-moderation.html"><a href="mediation-moderation.html#method-3-bootstrapping"><i class="fa fa-check"></i><b>15.5.4</b> Method 3: Bootstrapping</a></li>
</ul></li>
<li class="chapter" data-level="15.6" data-path="mediation-moderation.html"><a href="mediation-moderation.html#moderation"><i class="fa fa-check"></i><b>15.6</b> Moderation</a>
<ul>
<li class="chapter" data-level="15.6.1" data-path="mediation-moderation.html"><a href="mediation-moderation.html#generate-data-1"><i class="fa fa-check"></i><b>15.6.1</b> Generate data</a></li>
<li class="chapter" data-level="15.6.2" data-path="mediation-moderation.html"><a href="mediation-moderation.html#moderation-analysis"><i class="fa fa-check"></i><b>15.6.2</b> Moderation analysis</a></li>
</ul></li>
<li class="chapter" data-level="15.7" data-path="mediation-moderation.html"><a href="mediation-moderation.html#additional-resources-12"><i class="fa fa-check"></i><b>15.7</b> Additional resources</a>
<ul>
<li class="chapter" data-level="15.7.1" data-path="mediation-moderation.html"><a href="mediation-moderation.html#books"><i class="fa fa-check"></i><b>15.7.1</b> Books</a></li>
<li class="chapter" data-level="15.7.2" data-path="mediation-moderation.html"><a href="mediation-moderation.html#tutorials-1"><i class="fa fa-check"></i><b>15.7.2</b> Tutorials</a></li>
<li class="chapter" data-level="15.7.3" data-path="mediation-moderation.html"><a href="mediation-moderation.html#misc-7"><i class="fa fa-check"></i><b>15.7.3</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="15.8" data-path="mediation-moderation.html"><a href="mediation-moderation.html#session-info-14"><i class="fa fa-check"></i><b>15.8</b> Session info</a></li>
<li class="chapter" data-level="15.9" data-path="mediation-moderation.html"><a href="mediation-moderation.html#references-4"><i class="fa fa-check"></i><b>15.9</b> References</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="model-comparison.html"><a href="model-comparison.html"><i class="fa fa-check"></i><b>16</b> Model comparison</a>
<ul>
<li class="chapter" data-level="16.1" data-path="model-comparison.html"><a href="model-comparison.html#learning-goals-7"><i class="fa fa-check"></i><b>16.1</b> Learning goals</a></li>
<li class="chapter" data-level="16.2" data-path="model-comparison.html"><a href="model-comparison.html#load-packages-and-set-plotting-theme-9"><i class="fa fa-check"></i><b>16.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="16.3" data-path="model-comparison.html"><a href="model-comparison.html#model-comparison-1"><i class="fa fa-check"></i><b>16.3</b> Model comparison</a>
<ul>
<li class="chapter" data-level="16.3.1" data-path="model-comparison.html"><a href="model-comparison.html#fitting-vs.-predicting"><i class="fa fa-check"></i><b>16.3.1</b> Fitting vs. predicting</a></li>
<li class="chapter" data-level="16.3.2" data-path="model-comparison.html"><a href="model-comparison.html#f-test"><i class="fa fa-check"></i><b>16.3.2</b> F-test</a></li>
<li class="chapter" data-level="16.3.3" data-path="model-comparison.html"><a href="model-comparison.html#cross-validation"><i class="fa fa-check"></i><b>16.3.3</b> Cross-validation</a></li>
<li class="chapter" data-level="16.3.4" data-path="model-comparison.html"><a href="model-comparison.html#bootstrap"><i class="fa fa-check"></i><b>16.3.4</b> Bootstrap</a></li>
<li class="chapter" data-level="16.3.5" data-path="model-comparison.html"><a href="model-comparison.html#aic-and-bic"><i class="fa fa-check"></i><b>16.3.5</b> AIC and BIC</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="model-comparison.html"><a href="model-comparison.html#additional-resources-13"><i class="fa fa-check"></i><b>16.4</b> Additional resources</a>
<ul>
<li class="chapter" data-level="16.4.1" data-path="model-comparison.html"><a href="model-comparison.html#datacamp-course"><i class="fa fa-check"></i><b>16.4.1</b> Datacamp course</a></li>
<li class="chapter" data-level="16.4.2" data-path="model-comparison.html"><a href="model-comparison.html#reading-1"><i class="fa fa-check"></i><b>16.4.2</b> Reading</a></li>
</ul></li>
<li class="chapter" data-level="16.5" data-path="model-comparison.html"><a href="model-comparison.html#session-info-15"><i class="fa fa-check"></i><b>16.5</b> Session info</a></li>
<li class="chapter" data-level="16.6" data-path="model-comparison.html"><a href="model-comparison.html#references-5"><i class="fa fa-check"></i><b>16.6</b> References</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html"><i class="fa fa-check"></i><b>17</b> Linear mixed effects models 1</a>
<ul>
<li class="chapter" data-level="17.1" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html#learning-goals-8"><i class="fa fa-check"></i><b>17.1</b> Learning goals</a></li>
<li class="chapter" data-level="17.2" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html#load-packages-and-set-plotting-theme-10"><i class="fa fa-check"></i><b>17.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="17.3" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html#dependence"><i class="fa fa-check"></i><b>17.3</b> Dependence</a></li>
<li class="chapter" data-level="17.4" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html#additional-resources-14"><i class="fa fa-check"></i><b>17.4</b> Additional resources</a>
<ul>
<li class="chapter" data-level="17.4.1" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html#readings"><i class="fa fa-check"></i><b>17.4.1</b> Readings</a></li>
</ul></li>
<li class="chapter" data-level="17.5" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html#session-info-16"><i class="fa fa-check"></i><b>17.5</b> Session info</a></li>
<li class="chapter" data-level="17.6" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html#references-6"><i class="fa fa-check"></i><b>17.6</b> References</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html"><i class="fa fa-check"></i><b>18</b> Linear mixed effects models 2</a>
<ul>
<li class="chapter" data-level="18.1" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#learning-goals-9"><i class="fa fa-check"></i><b>18.1</b> Learning goals</a></li>
<li class="chapter" data-level="18.2" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#load-packages-and-set-plotting-theme-11"><i class="fa fa-check"></i><b>18.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="18.3" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#a-worked-example"><i class="fa fa-check"></i><b>18.3</b> A worked example</a>
<ul>
<li class="chapter" data-level="18.3.1" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#complete-pooling"><i class="fa fa-check"></i><b>18.3.1</b> Complete pooling</a></li>
<li class="chapter" data-level="18.3.2" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#no-pooling"><i class="fa fa-check"></i><b>18.3.2</b> No pooling</a></li>
<li class="chapter" data-level="18.3.3" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#partial-pooling"><i class="fa fa-check"></i><b>18.3.3</b> Partial pooling</a></li>
<li class="chapter" data-level="18.3.4" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#compare-results"><i class="fa fa-check"></i><b>18.3.4</b> Compare results</a></li>
<li class="chapter" data-level="18.3.5" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#getting-p-values"><i class="fa fa-check"></i><b>18.3.5</b> Getting p-values</a></li>
<li class="chapter" data-level="18.3.6" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#reporting-results"><i class="fa fa-check"></i><b>18.3.6</b> Reporting results</a></li>
<li class="chapter" data-level="18.3.7" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#the-effect-of-outliers"><i class="fa fa-check"></i><b>18.3.7</b> The effect of outliers</a></li>
<li class="chapter" data-level="18.3.8" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#different-slopes"><i class="fa fa-check"></i><b>18.3.8</b> Different slopes</a></li>
<li class="chapter" data-level="18.3.9" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#simpsons-paradox"><i class="fa fa-check"></i><b>18.3.9</b> Simpson’s paradox</a></li>
</ul></li>
<li class="chapter" data-level="18.4" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#additional-resources-15"><i class="fa fa-check"></i><b>18.4</b> Additional resources</a>
<ul>
<li class="chapter" data-level="18.4.1" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#readings-1"><i class="fa fa-check"></i><b>18.4.1</b> Readings</a></li>
</ul></li>
<li class="chapter" data-level="18.5" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#session-info-17"><i class="fa fa-check"></i><b>18.5</b> Session info</a></li>
<li class="chapter" data-level="18.6" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#references-7"><i class="fa fa-check"></i><b>18.6</b> References</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html"><i class="fa fa-check"></i><b>19</b> Linear mixed effects models 3</a>
<ul>
<li class="chapter" data-level="19.1" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#learning-goals-10"><i class="fa fa-check"></i><b>19.1</b> Learning goals</a></li>
<li class="chapter" data-level="19.2" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#load-packages-and-set-plotting-theme-12"><i class="fa fa-check"></i><b>19.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="19.3" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#load-data-sets-4"><i class="fa fa-check"></i><b>19.3</b> Load data sets</a>
<ul>
<li class="chapter" data-level="19.3.1" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#sleep-data"><i class="fa fa-check"></i><b>19.3.1</b> Sleep data</a></li>
<li class="chapter" data-level="19.3.2" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#reasoning-data"><i class="fa fa-check"></i><b>19.3.2</b> Reasoning data</a></li>
<li class="chapter" data-level="19.3.3" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#weight-loss-data"><i class="fa fa-check"></i><b>19.3.3</b> Weight loss data</a></li>
<li class="chapter" data-level="19.3.4" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#politness-data"><i class="fa fa-check"></i><b>19.3.4</b> Politness data</a></li>
</ul></li>
<li class="chapter" data-level="19.4" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#understanding-the-lmer-syntax"><i class="fa fa-check"></i><b>19.4</b> Understanding the lmer() syntax</a></li>
<li class="chapter" data-level="19.5" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#anova-vs.-lmer"><i class="fa fa-check"></i><b>19.5</b> ANOVA vs. Lmer</a>
<ul>
<li class="chapter" data-level="19.5.1" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#between-subjects-anova"><i class="fa fa-check"></i><b>19.5.1</b> Between subjects ANOVA</a></li>
<li class="chapter" data-level="19.5.2" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#repeated-measures-anova"><i class="fa fa-check"></i><b>19.5.2</b> Repeated-measures ANOVA</a></li>
<li class="chapter" data-level="19.5.3" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#mixed-anova"><i class="fa fa-check"></i><b>19.5.3</b> Mixed ANOVA</a></li>
</ul></li>
<li class="chapter" data-level="19.6" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#follow-up-tests-with-emmeans"><i class="fa fa-check"></i><b>19.6</b> Follow-up tests with emmeans</a>
<ul>
<li class="chapter" data-level="19.6.1" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#sleep-study"><i class="fa fa-check"></i><b>19.6.1</b> Sleep study</a></li>
<li class="chapter" data-level="19.6.2" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#weight-loss-study"><i class="fa fa-check"></i><b>19.6.2</b> Weight loss study</a></li>
<li class="chapter" data-level="19.6.3" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#politeness-study"><i class="fa fa-check"></i><b>19.6.3</b> Politeness study</a></li>
</ul></li>
<li class="chapter" data-level="19.7" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#mixtures-of-participants"><i class="fa fa-check"></i><b>19.7</b> Mixtures of participants</a></li>
<li class="chapter" data-level="19.8" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#bootstrapping"><i class="fa fa-check"></i><b>19.8</b> Bootstrapping</a>
<ul>
<li class="chapter" data-level="19.8.1" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#linear-model"><i class="fa fa-check"></i><b>19.8.1</b> Linear model</a></li>
</ul></li>
<li class="chapter" data-level="19.9" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#session-info-18"><i class="fa fa-check"></i><b>19.9</b> Session info</a></li>
<li class="chapter" data-level="19.10" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#references-8"><i class="fa fa-check"></i><b>19.10</b> References</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html"><i class="fa fa-check"></i><b>20</b> Generalized linear model</a>
<ul>
<li class="chapter" data-level="20.1" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#learning-goals-11"><i class="fa fa-check"></i><b>20.1</b> Learning goals</a></li>
<li class="chapter" data-level="20.2" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#load-packages-and-set-plotting-theme-13"><i class="fa fa-check"></i><b>20.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="20.3" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#load-data-set"><i class="fa fa-check"></i><b>20.3</b> Load data set</a></li>
<li class="chapter" data-level="20.4" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#logistic-regression"><i class="fa fa-check"></i><b>20.4</b> Logistic regression</a>
<ul>
<li class="chapter" data-level="20.4.1" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#interpreting-the-parameters"><i class="fa fa-check"></i><b>20.4.1</b> Interpreting the parameters</a></li>
<li class="chapter" data-level="20.4.2" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#binary-predictor"><i class="fa fa-check"></i><b>20.4.2</b> Binary predictor</a></li>
<li class="chapter" data-level="20.4.3" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#continuous-predictor"><i class="fa fa-check"></i><b>20.4.3</b> Continuous predictor</a></li>
<li class="chapter" data-level="20.4.4" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#several-predictors"><i class="fa fa-check"></i><b>20.4.4</b> Several predictors</a></li>
<li class="chapter" data-level="20.4.5" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#using-the-ggeffects-package"><i class="fa fa-check"></i><b>20.4.5</b> Using the “ggeffects” package</a></li>
</ul></li>
<li class="chapter" data-level="20.5" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#simulate-a-logistic-regression"><i class="fa fa-check"></i><b>20.5</b> Simulate a logistic regression</a></li>
<li class="chapter" data-level="20.6" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#testing-hypotheses"><i class="fa fa-check"></i><b>20.6</b> Testing hypotheses</a></li>
<li class="chapter" data-level="20.7" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#logistic-mixed-effects-model"><i class="fa fa-check"></i><b>20.7</b> Logistic mixed effects model</a></li>
<li class="chapter" data-level="20.8" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#additional-information"><i class="fa fa-check"></i><b>20.8</b> Additional information</a>
<ul>
<li class="chapter" data-level="20.8.1" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#datacamp-7"><i class="fa fa-check"></i><b>20.8.1</b> Datacamp</a></li>
</ul></li>
<li class="chapter" data-level="20.9" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#session-info-19"><i class="fa fa-check"></i><b>20.9</b> Session info</a></li>
<li class="chapter" data-level="20.10" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#references-9"><i class="fa fa-check"></i><b>20.10</b> References</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="bayesian-data-analysis.html"><a href="bayesian-data-analysis.html"><i class="fa fa-check"></i><b>21</b> Bayesian data analysis</a>
<ul>
<li class="chapter" data-level="21.1" data-path="bayesian-data-analysis.html"><a href="bayesian-data-analysis.html#learning-goals-12"><i class="fa fa-check"></i><b>21.1</b> Learning goals</a></li>
<li class="chapter" data-level="21.2" data-path="bayesian-data-analysis.html"><a href="bayesian-data-analysis.html#load-packages-and-set-plotting-theme-14"><i class="fa fa-check"></i><b>21.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="21.3" data-path="bayesian-data-analysis.html"><a href="bayesian-data-analysis.html#doing-bayesian-inference-by-hand"><i class="fa fa-check"></i><b>21.3</b> Doing Bayesian inference “by hand”</a>
<ul>
<li class="chapter" data-level="21.3.1" data-path="bayesian-data-analysis.html"><a href="bayesian-data-analysis.html#sequential-updating-based-on-the-beta-distribution"><i class="fa fa-check"></i><b>21.3.1</b> Sequential updating based on the Beta distribution</a></li>
<li class="chapter" data-level="21.3.2" data-path="bayesian-data-analysis.html"><a href="bayesian-data-analysis.html#coin-flip-example"><i class="fa fa-check"></i><b>21.3.2</b> Coin flip example</a></li>
<li class="chapter" data-level="21.3.3" data-path="bayesian-data-analysis.html"><a href="bayesian-data-analysis.html#bayesian-inference-by-discretization"><i class="fa fa-check"></i><b>21.3.3</b> Bayesian inference by discretization</a></li>
</ul></li>
<li class="chapter" data-level="21.4" data-path="bayesian-data-analysis.html"><a href="bayesian-data-analysis.html#doing-bayesian-inference-with-greta"><i class="fa fa-check"></i><b>21.4</b> Doing Bayesian inference with Greta</a>
<ul>
<li class="chapter" data-level="21.4.1" data-path="bayesian-data-analysis.html"><a href="bayesian-data-analysis.html#attitude-data-set"><i class="fa fa-check"></i><b>21.4.1</b> Attitude data set</a></li>
<li class="chapter" data-level="21.4.2" data-path="bayesian-data-analysis.html"><a href="bayesian-data-analysis.html#frequentist-analysis"><i class="fa fa-check"></i><b>21.4.2</b> Frequentist analysis</a></li>
<li class="chapter" data-level="21.4.3" data-path="bayesian-data-analysis.html"><a href="bayesian-data-analysis.html#bayesian-regression"><i class="fa fa-check"></i><b>21.4.3</b> Bayesian regression</a></li>
</ul></li>
<li class="chapter" data-level="21.5" data-path="bayesian-data-analysis.html"><a href="bayesian-data-analysis.html#session-info-20"><i class="fa fa-check"></i><b>21.5</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html"><i class="fa fa-check"></i><b>22</b> Bayesian data analysis 2</a>
<ul>
<li class="chapter" data-level="22.1" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#learning-goals-13"><i class="fa fa-check"></i><b>22.1</b> Learning goals</a></li>
<li class="chapter" data-level="22.2" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#load-packages-and-set-plotting-theme-15"><i class="fa fa-check"></i><b>22.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="22.3" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#load-data-sets-5"><i class="fa fa-check"></i><b>22.3</b> Load data sets</a></li>
<li class="chapter" data-level="22.4" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#poker"><i class="fa fa-check"></i><b>22.4</b> Poker</a>
<ul>
<li class="chapter" data-level="22.4.1" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#visualize-the-data"><i class="fa fa-check"></i><b>22.4.1</b> 1. Visualize the data</a></li>
<li class="chapter" data-level="22.4.2" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#specify-and-fit-the-model"><i class="fa fa-check"></i><b>22.4.2</b> 2. Specify and fit the model</a></li>
<li class="chapter" data-level="22.4.3" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#model-evaluation"><i class="fa fa-check"></i><b>22.4.3</b> 3. Model evaluation</a></li>
<li class="chapter" data-level="22.4.4" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#interpret-the-model-parameters"><i class="fa fa-check"></i><b>22.4.4</b> 4. Interpret the model parameters</a></li>
<li class="chapter" data-level="22.4.5" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#test-specific-hypotheses"><i class="fa fa-check"></i><b>22.4.5</b> 5. Test specific hypotheses</a></li>
</ul></li>
<li class="chapter" data-level="22.5" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#sleep-study-1"><i class="fa fa-check"></i><b>22.5</b> Sleep study</a>
<ul>
<li class="chapter" data-level="22.5.1" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#visualize-the-data-1"><i class="fa fa-check"></i><b>22.5.1</b> 1. Visualize the data</a></li>
<li class="chapter" data-level="22.5.2" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#specify-and-fit-the-model-1"><i class="fa fa-check"></i><b>22.5.2</b> 2. Specify and fit the model</a></li>
<li class="chapter" data-level="22.5.3" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#model-evaluation-1"><i class="fa fa-check"></i><b>22.5.3</b> 3. Model evaluation</a></li>
<li class="chapter" data-level="22.5.4" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#interpret-the-parameters"><i class="fa fa-check"></i><b>22.5.4</b> 4. Interpret the parameters</a></li>
<li class="chapter" data-level="22.5.5" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#test-specific-hypotheses-1"><i class="fa fa-check"></i><b>22.5.5</b> 5. Test specific hypotheses</a></li>
<li class="chapter" data-level="22.5.6" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#report-results"><i class="fa fa-check"></i><b>22.5.6</b> 6. Report results</a></li>
</ul></li>
<li class="chapter" data-level="22.6" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#titanic-study"><i class="fa fa-check"></i><b>22.6</b> Titanic study</a>
<ul>
<li class="chapter" data-level="22.6.1" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#visualize-that-data"><i class="fa fa-check"></i><b>22.6.1</b> 1. Visualize that data</a></li>
<li class="chapter" data-level="22.6.2" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#specify-and-fit-the-model-2"><i class="fa fa-check"></i><b>22.6.2</b> 2. Specify and fit the model</a></li>
<li class="chapter" data-level="22.6.3" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#model-evaluation-2"><i class="fa fa-check"></i><b>22.6.3</b> 3. Model evaluation</a></li>
<li class="chapter" data-level="22.6.4" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#interpret-the-parameters-1"><i class="fa fa-check"></i><b>22.6.4</b> 4. Interpret the parameters</a></li>
<li class="chapter" data-level="22.6.5" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#test-specific-hypotheses-2"><i class="fa fa-check"></i><b>22.6.5</b> 5. Test specific hypotheses</a></li>
<li class="chapter" data-level="22.6.6" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#report-results-1"><i class="fa fa-check"></i><b>22.6.6</b> 6. Report results</a></li>
</ul></li>
<li class="chapter" data-level="22.7" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#politeness-data"><i class="fa fa-check"></i><b>22.7</b> Politeness data</a>
<ul>
<li class="chapter" data-level="22.7.1" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#visualize-the-data-2"><i class="fa fa-check"></i><b>22.7.1</b> 1. Visualize the data</a></li>
<li class="chapter" data-level="22.7.2" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#test-specific-hypotheses-3"><i class="fa fa-check"></i><b>22.7.2</b> 5. Test specific hypotheses</a></li>
</ul></li>
<li class="chapter" data-level="22.8" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#additional-resources-16"><i class="fa fa-check"></i><b>22.8</b> Additional resources</a></li>
<li class="chapter" data-level="22.9" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#session-info-21"><i class="fa fa-check"></i><b>22.9</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html"><i class="fa fa-check"></i><b>23</b> Bayesian data analysis 3</a>
<ul>
<li class="chapter" data-level="23.1" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#learning-goals-14"><i class="fa fa-check"></i><b>23.1</b> Learning goals</a></li>
<li class="chapter" data-level="23.2" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#load-packages-and-set-plotting-theme-16"><i class="fa fa-check"></i><b>23.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="23.3" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#evidence-for-the-null-hypothesis"><i class="fa fa-check"></i><b>23.3</b> Evidence for the null hypothesis</a>
<ul>
<li class="chapter" data-level="23.3.1" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#bayes-factor-1"><i class="fa fa-check"></i><b>23.3.1</b> Bayes factor</a></li>
<li class="chapter" data-level="23.3.2" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#loo"><i class="fa fa-check"></i><b>23.3.2</b> LOO</a></li>
</ul></li>
<li class="chapter" data-level="23.4" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#dealing-with-heteroscedasticity"><i class="fa fa-check"></i><b>23.4</b> Dealing with heteroscedasticity</a>
<ul>
<li class="chapter" data-level="23.4.1" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#visualize-the-data-3"><i class="fa fa-check"></i><b>23.4.1</b> Visualize the data</a></li>
<li class="chapter" data-level="23.4.2" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#frequentist-analysis-4"><i class="fa fa-check"></i><b>23.4.2</b> Frequentist analysis</a></li>
<li class="chapter" data-level="23.4.3" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#bayesian-analysis-3"><i class="fa fa-check"></i><b>23.4.3</b> Bayesian analysis</a></li>
</ul></li>
<li class="chapter" data-level="23.5" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#zero-one-inflated-beta-binomial-model"><i class="fa fa-check"></i><b>23.5</b> Zero-one inflated beta binomial model</a></li>
<li class="chapter" data-level="23.6" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#ordinal-regression"><i class="fa fa-check"></i><b>23.6</b> Ordinal regression</a>
<ul>
<li class="chapter" data-level="23.6.1" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#ordinal-regression-assuming-equal-variance"><i class="fa fa-check"></i><b>23.6.1</b> Ordinal regression (assuming equal variance)</a></li>
<li class="chapter" data-level="23.6.2" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#gaussian-regression-assuming-equal-variance"><i class="fa fa-check"></i><b>23.6.2</b> Gaussian regression (assuming equal variance)</a></li>
<li class="chapter" data-level="23.6.3" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#oridnal-regression-unequal-variance"><i class="fa fa-check"></i><b>23.6.3</b> Oridnal regression (unequal variance)</a></li>
<li class="chapter" data-level="23.6.4" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#gaussian-regression-unequal-variance"><i class="fa fa-check"></i><b>23.6.4</b> Gaussian regression (unequal variance)</a></li>
<li class="chapter" data-level="23.6.5" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#model-comparison-2"><i class="fa fa-check"></i><b>23.6.5</b> Model comparison</a></li>
</ul></li>
<li class="chapter" data-level="23.7" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#additional-resources-17"><i class="fa fa-check"></i><b>23.7</b> Additional resources</a></li>
<li class="chapter" data-level="23.8" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#session-info-22"><i class="fa fa-check"></i><b>23.8</b> Session info</a></li>
<li class="chapter" data-level="" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#references-10"><i class="fa fa-check"></i>References</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="model-assumptions.html"><a href="model-assumptions.html"><i class="fa fa-check"></i><b>24</b> Model assumptions</a>
<ul>
<li class="chapter" data-level="24.1" data-path="model-assumptions.html"><a href="model-assumptions.html#learning-goals-15"><i class="fa fa-check"></i><b>24.1</b> Learning goals</a></li>
<li class="chapter" data-level="24.2" data-path="model-assumptions.html"><a href="model-assumptions.html#load-packages-and-set-plotting-theme-17"><i class="fa fa-check"></i><b>24.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="24.3" data-path="model-assumptions.html"><a href="model-assumptions.html#model-assumptions-and-what-to-do-if-they-are-violated"><i class="fa fa-check"></i><b>24.3</b> Model assumptions and what to do if they are violated</a>
<ul>
<li class="chapter" data-level="24.3.1" data-path="model-assumptions.html"><a href="model-assumptions.html#influential-data-points"><i class="fa fa-check"></i><b>24.3.1</b> Influential data points</a></li>
<li class="chapter" data-level="24.3.2" data-path="model-assumptions.html"><a href="model-assumptions.html#linear-and-additive"><i class="fa fa-check"></i><b>24.3.2</b> Linear and additive</a></li>
<li class="chapter" data-level="24.3.3" data-path="model-assumptions.html"><a href="model-assumptions.html#normally-distributed-residuals"><i class="fa fa-check"></i><b>24.3.3</b> Normally distributed residuals</a></li>
<li class="chapter" data-level="24.3.4" data-path="model-assumptions.html"><a href="model-assumptions.html#non-parametric-tests"><i class="fa fa-check"></i><b>24.3.4</b> Non-parametric tests</a></li>
<li class="chapter" data-level="24.3.5" data-path="model-assumptions.html"><a href="model-assumptions.html#bootstrapping-regressions"><i class="fa fa-check"></i><b>24.3.5</b> Bootstrapping regressions</a></li>
</ul></li>
<li class="chapter" data-level="24.4" data-path="model-assumptions.html"><a href="model-assumptions.html#additional-resources-18"><i class="fa fa-check"></i><b>24.4</b> Additional resources</a></li>
<li class="chapter" data-level="24.5" data-path="model-assumptions.html"><a href="model-assumptions.html#session-info-23"><i class="fa fa-check"></i><b>24.5</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="25" data-path="reporting-statistics.html"><a href="reporting-statistics.html"><i class="fa fa-check"></i><b>25</b> Reporting statistics</a>
<ul>
<li class="chapter" data-level="25.1" data-path="reporting-statistics.html"><a href="reporting-statistics.html#general-advice"><i class="fa fa-check"></i><b>25.1</b> General advice</a>
<ul>
<li class="chapter" data-level="25.1.1" data-path="reporting-statistics.html"><a href="reporting-statistics.html#make-good-figures"><i class="fa fa-check"></i><b>25.1.1</b> Make good figures!</a></li>
<li class="chapter" data-level="25.1.2" data-path="reporting-statistics.html"><a href="reporting-statistics.html#use-statistical-models-to-answer-concrete-research-questions."><i class="fa fa-check"></i><b>25.1.2</b> Use statistical models to answer concrete research questions.</a></li>
<li class="chapter" data-level="25.1.3" data-path="reporting-statistics.html"><a href="reporting-statistics.html#illustrate-the-uncertainty-in-your-statistical-inferences."><i class="fa fa-check"></i><b>25.1.3</b> Illustrate the uncertainty in your statistical inferences.</a></li>
<li class="chapter" data-level="25.1.4" data-path="reporting-statistics.html"><a href="reporting-statistics.html#report-effect-sizes."><i class="fa fa-check"></i><b>25.1.4</b> Report effect sizes.</a></li>
<li class="chapter" data-level="25.1.5" data-path="reporting-statistics.html"><a href="reporting-statistics.html#reporting-statistical-results-using-rmarkdown"><i class="fa fa-check"></i><b>25.1.5</b> Reporting statistical results using RMarkdown</a></li>
</ul></li>
<li class="chapter" data-level="25.2" data-path="reporting-statistics.html"><a href="reporting-statistics.html#some-concrete-example"><i class="fa fa-check"></i><b>25.2</b> Some concrete example</a>
<ul>
<li class="chapter" data-level="25.2.1" data-path="reporting-statistics.html"><a href="reporting-statistics.html#frequentist-statistics"><i class="fa fa-check"></i><b>25.2.1</b> Frequentist statistics</a></li>
</ul></li>
<li class="chapter" data-level="25.3" data-path="reporting-statistics.html"><a href="reporting-statistics.html#session-info-24"><i class="fa fa-check"></i><b>25.3</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="26" data-path="cheatsheets-7.html"><a href="cheatsheets-7.html"><i class="fa fa-check"></i><b>26</b> Cheatsheets</a>
<ul>
<li class="chapter" data-level="26.1" data-path="cheatsheets-7.html"><a href="cheatsheets-7.html#statistics"><i class="fa fa-check"></i><b>26.1</b> Statistics</a></li>
<li class="chapter" data-level="26.2" data-path="cheatsheets-7.html"><a href="cheatsheets-7.html#r"><i class="fa fa-check"></i><b>26.2</b> R</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references-11.html"><a href="references-11.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Psych 252: Statistical Methods for Behavioral and Social Sciences</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="model-comparison" class="section level1" number="16">
<h1><span class="header-section-number">Chapter 16</span> Model comparison</h1>
<div id="learning-goals-7" class="section level2" number="16.1">
<h2><span class="header-section-number">16.1</span> Learning goals</h2>
<ul>
<li>Model comparison.</li>
<li>Underfitting vs. overfitting.</li>
<li>Cross-validation.
<ul>
<li>Leave-one-out cross-validation.</li>
<li>k-fold cross-validation.</li>
<li>Monte Carlo cross-validation.</li>
</ul></li>
<li>Information criteria: AIC and BIC.</li>
</ul>
</div>
<div id="load-packages-and-set-plotting-theme-9" class="section level2" number="16.2">
<h2><span class="header-section-number">16.2</span> Load packages and set plotting theme</h2>
<div class="sourceCode" id="cb858"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb858-1"><a href="model-comparison.html#cb858-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;knitr&quot;</span>)      <span class="co"># for knitting RMarkdown </span></span>
<span id="cb858-2"><a href="model-comparison.html#cb858-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;kableExtra&quot;</span>) <span class="co"># for making nice tables</span></span>
<span id="cb858-3"><a href="model-comparison.html#cb858-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;janitor&quot;</span>)    <span class="co"># for cleaning column names</span></span>
<span id="cb858-4"><a href="model-comparison.html#cb858-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;broom&quot;</span>)      <span class="co"># for tidying up linear models </span></span>
<span id="cb858-5"><a href="model-comparison.html#cb858-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;patchwork&quot;</span>)  <span class="co"># for figure panels</span></span>
<span id="cb858-6"><a href="model-comparison.html#cb858-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;modelr&quot;</span>)     <span class="co"># for cross-validation</span></span>
<span id="cb858-7"><a href="model-comparison.html#cb858-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;tidyverse&quot;</span>)  <span class="co"># for wrangling, plotting, etc. </span></span></code></pre></div>
<div class="sourceCode" id="cb859"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb859-1"><a href="model-comparison.html#cb859-1" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_classic</span>() <span class="sc">+</span> <span class="co">#set the theme </span></span>
<span id="cb859-2"><a href="model-comparison.html#cb859-2" aria-hidden="true" tabindex="-1"></a>            <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>))) <span class="co">#set the default text size</span></span>
<span id="cb859-3"><a href="model-comparison.html#cb859-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb859-4"><a href="model-comparison.html#cb859-4" aria-hidden="true" tabindex="-1"></a>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">comment =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb859-5"><a href="model-comparison.html#cb859-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">fig.show =</span> <span class="st">&quot;hold&quot;</span>)</span>
<span id="cb859-6"><a href="model-comparison.html#cb859-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb859-7"><a href="model-comparison.html#cb859-7" aria-hidden="true" tabindex="-1"></a><span class="co"># include references for used packages</span></span>
<span id="cb859-8"><a href="model-comparison.html#cb859-8" aria-hidden="true" tabindex="-1"></a><span class="fu">write_bib</span>(<span class="fu">.packages</span>(), <span class="st">&quot;packages.bib&quot;</span>) </span></code></pre></div>
</div>
<div id="model-comparison-1" class="section level2" number="16.3">
<h2><span class="header-section-number">16.3</span> Model comparison</h2>
<p>In general, we want our models to explain the data we observed, and correctly predict future data. Often, there is a trade-off between how well the model fits the data we have (e.g. how much of the variance it explains), and how well the model will predict future data. If our model is too complex, then it will not only capture the systematicity in the data but also fit to the noise in the data. If our mdoel is too simple, however, it will not capture some of the systematicity that’s actually present in the data. The goal, as always in statistical modeling, is to find a model that finds the sweet spot between simplicity and complexity.</p>
<div id="fitting-vs.-predicting" class="section level3" number="16.3.1">
<h3><span class="header-section-number">16.3.1</span> Fitting vs. predicting</h3>
<p>Let’s illustrate the trad-off between complexity and simplicty for fitting vs. prediction. We generate data from a model of the following form:</p>
<p><span class="math display">\[
Y_i = \beta_0 + \beta_1 \cdot X_i + \beta_2 + X_i^2 + \epsilon_i
\]</span>
where</p>
<p><span class="math display">\[
\epsilon_i \sim \mathcal{N}(\text{mean} = 0, ~\text{sd} = 20)
\]</span>
Here, I’ll use the following parameters: <span class="math inline">\(\beta_0 = 10\)</span>, <span class="math inline">\(\beta_1 = 3\)</span>, and <span class="math inline">\(\beta_2 = 2\)</span> to generate the data:</p>
<div class="sourceCode" id="cb860"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb860-1"><a href="model-comparison.html#cb860-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb860-2"><a href="model-comparison.html#cb860-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb860-3"><a href="model-comparison.html#cb860-3" aria-hidden="true" tabindex="-1"></a>n_plots <span class="ot">=</span> <span class="dv">3</span></span>
<span id="cb860-4"><a href="model-comparison.html#cb860-4" aria-hidden="true" tabindex="-1"></a>n_samples <span class="ot">=</span> <span class="dv">20</span> <span class="co"># sample size </span></span>
<span id="cb860-5"><a href="model-comparison.html#cb860-5" aria-hidden="true" tabindex="-1"></a>n_parameters <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="fu">seq</span>(<span class="dv">7</span>, <span class="dv">19</span>, <span class="at">length.out =</span> <span class="dv">5</span>)) <span class="co"># number of parameters in the polynomial regression</span></span>
<span id="cb860-6"><a href="model-comparison.html#cb860-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb860-7"><a href="model-comparison.html#cb860-7" aria-hidden="true" tabindex="-1"></a><span class="co"># generate data </span></span>
<span id="cb860-8"><a href="model-comparison.html#cb860-8" aria-hidden="true" tabindex="-1"></a>df.data <span class="ot">=</span> <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">runif</span>(n_samples, <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="dv">10</span>), </span>
<span id="cb860-9"><a href="model-comparison.html#cb860-9" aria-hidden="true" tabindex="-1"></a>                 <span class="at">y =</span> <span class="dv">10</span> <span class="sc">+</span> <span class="dv">3</span> <span class="sc">*</span> x <span class="sc">+</span> <span class="dv">3</span> <span class="sc">*</span> x<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="fu">rnorm</span>(n_samples, <span class="at">sd =</span> <span class="dv">20</span>))</span>
<span id="cb860-10"><a href="model-comparison.html#cb860-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb860-11"><a href="model-comparison.html#cb860-11" aria-hidden="true" tabindex="-1"></a><span class="co"># plotting function</span></span>
<span id="cb860-12"><a href="model-comparison.html#cb860-12" aria-hidden="true" tabindex="-1"></a>plot_fit <span class="ot">=</span> <span class="cf">function</span>(i){</span>
<span id="cb860-13"><a href="model-comparison.html#cb860-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># calculate RMSE</span></span>
<span id="cb860-14"><a href="model-comparison.html#cb860-14" aria-hidden="true" tabindex="-1"></a>  rmse <span class="ot">=</span> <span class="fu">lm</span>(<span class="at">formula =</span> y <span class="sc">~</span> <span class="fu">poly</span>(x, <span class="at">degree =</span> i, <span class="at">raw =</span> <span class="cn">TRUE</span>),</span>
<span id="cb860-15"><a href="model-comparison.html#cb860-15" aria-hidden="true" tabindex="-1"></a>           <span class="at">data =</span> df.data) <span class="sc">%&gt;%</span> </span>
<span id="cb860-16"><a href="model-comparison.html#cb860-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rmse</span>(<span class="at">data =</span> df.data)</span>
<span id="cb860-17"><a href="model-comparison.html#cb860-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb860-18"><a href="model-comparison.html#cb860-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># make a plot</span></span>
<span id="cb860-19"><a href="model-comparison.html#cb860-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> df.data,</span>
<span id="cb860-20"><a href="model-comparison.html#cb860-20" aria-hidden="true" tabindex="-1"></a>             <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> x,</span>
<span id="cb860-21"><a href="model-comparison.html#cb860-21" aria-hidden="true" tabindex="-1"></a>                           <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb860-22"><a href="model-comparison.html#cb860-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb860-23"><a href="model-comparison.html#cb860-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> F,</span>
<span id="cb860-24"><a href="model-comparison.html#cb860-24" aria-hidden="true" tabindex="-1"></a>                <span class="at">formula =</span> y <span class="sc">~</span> <span class="fu">poly</span>(x, <span class="at">degree =</span> i, <span class="at">raw =</span> <span class="cn">TRUE</span>)) <span class="sc">+</span></span>
<span id="cb860-25"><a href="model-comparison.html#cb860-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb860-26"><a href="model-comparison.html#cb860-26" aria-hidden="true" tabindex="-1"></a>             <span class="at">x =</span> <span class="cn">Inf</span>,</span>
<span id="cb860-27"><a href="model-comparison.html#cb860-27" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> <span class="sc">-</span><span class="cn">Inf</span>,</span>
<span id="cb860-28"><a href="model-comparison.html#cb860-28" aria-hidden="true" tabindex="-1"></a>             <span class="at">label =</span> <span class="fu">str_c</span>(<span class="st">&quot;RMSE = &quot;</span>, <span class="fu">round</span>(rmse, <span class="dv">2</span>)),</span>
<span id="cb860-29"><a href="model-comparison.html#cb860-29" aria-hidden="true" tabindex="-1"></a>             <span class="at">hjust =</span> <span class="fl">1.1</span>,</span>
<span id="cb860-30"><a href="model-comparison.html#cb860-30" aria-hidden="true" tabindex="-1"></a>             <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.3</span>) <span class="sc">+</span> </span>
<span id="cb860-31"><a href="model-comparison.html#cb860-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.ticks =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb860-32"><a href="model-comparison.html#cb860-32" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb860-33"><a href="model-comparison.html#cb860-33" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text =</span> <span class="fu">element_blank</span>())</span>
<span id="cb860-34"><a href="model-comparison.html#cb860-34" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb860-35"><a href="model-comparison.html#cb860-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb860-36"><a href="model-comparison.html#cb860-36" aria-hidden="true" tabindex="-1"></a><span class="co"># save plots in a list</span></span>
<span id="cb860-37"><a href="model-comparison.html#cb860-37" aria-hidden="true" tabindex="-1"></a>l.p <span class="ot">=</span> <span class="fu">map</span>(n_parameters, plot_fit)</span>
<span id="cb860-38"><a href="model-comparison.html#cb860-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb860-39"><a href="model-comparison.html#cb860-39" aria-hidden="true" tabindex="-1"></a><span class="co"># make figure panel </span></span>
<span id="cb860-40"><a href="model-comparison.html#cb860-40" aria-hidden="true" tabindex="-1"></a><span class="fu">wrap_plots</span>(<span class="at">plotlist =</span> l.p, <span class="at">ncol =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="16-model_comparison_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<p>As we can see, RMSE becomes smaller and smaller the more parameters the model has to fit the data. But how does the RMSE look like for new data that is generated from the same underlying ground truth?</p>
<div class="sourceCode" id="cb861"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb861-1"><a href="model-comparison.html#cb861-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb861-2"><a href="model-comparison.html#cb861-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb861-3"><a href="model-comparison.html#cb861-3" aria-hidden="true" tabindex="-1"></a>n_plots <span class="ot">=</span> <span class="dv">3</span></span>
<span id="cb861-4"><a href="model-comparison.html#cb861-4" aria-hidden="true" tabindex="-1"></a>n_samples <span class="ot">=</span> <span class="dv">20</span> <span class="co"># sample size </span></span>
<span id="cb861-5"><a href="model-comparison.html#cb861-5" aria-hidden="true" tabindex="-1"></a>n_parameters <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="fu">seq</span>(<span class="dv">7</span>, <span class="dv">19</span>, <span class="at">length.out =</span> <span class="dv">5</span>)) <span class="co"># number of parameters in the polynomial regression</span></span>
<span id="cb861-6"><a href="model-comparison.html#cb861-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb861-7"><a href="model-comparison.html#cb861-7" aria-hidden="true" tabindex="-1"></a><span class="co"># generate data </span></span>
<span id="cb861-8"><a href="model-comparison.html#cb861-8" aria-hidden="true" tabindex="-1"></a>df.data <span class="ot">=</span> <span class="fu">tibble</span>(</span>
<span id="cb861-9"><a href="model-comparison.html#cb861-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">runif</span>(n_samples, <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="dv">10</span>), </span>
<span id="cb861-10"><a href="model-comparison.html#cb861-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="dv">10</span> <span class="sc">+</span> <span class="dv">3</span> <span class="sc">*</span> x <span class="sc">+</span> <span class="dv">3</span> <span class="sc">*</span> x<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="fu">rnorm</span>(n_samples, <span class="at">sd =</span> <span class="dv">20</span>)</span>
<span id="cb861-11"><a href="model-comparison.html#cb861-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb861-12"><a href="model-comparison.html#cb861-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb861-13"><a href="model-comparison.html#cb861-13" aria-hidden="true" tabindex="-1"></a><span class="co"># generate some more data </span></span>
<span id="cb861-14"><a href="model-comparison.html#cb861-14" aria-hidden="true" tabindex="-1"></a>df.more_data <span class="ot">=</span> <span class="fu">tibble</span>(</span>
<span id="cb861-15"><a href="model-comparison.html#cb861-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">runif</span>(<span class="dv">50</span>, <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="dv">10</span>), </span>
<span id="cb861-16"><a href="model-comparison.html#cb861-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="dv">10</span> <span class="sc">+</span> <span class="dv">3</span> <span class="sc">*</span> x <span class="sc">+</span> <span class="dv">3</span> <span class="sc">*</span> x<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">50</span>, <span class="at">sd =</span> <span class="dv">20</span>)</span>
<span id="cb861-17"><a href="model-comparison.html#cb861-17" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb861-18"><a href="model-comparison.html#cb861-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb861-19"><a href="model-comparison.html#cb861-19" aria-hidden="true" tabindex="-1"></a><span class="co"># list for plots </span></span>
<span id="cb861-20"><a href="model-comparison.html#cb861-20" aria-hidden="true" tabindex="-1"></a>l.p <span class="ot">=</span> <span class="fu">list</span>()</span>
<span id="cb861-21"><a href="model-comparison.html#cb861-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb861-22"><a href="model-comparison.html#cb861-22" aria-hidden="true" tabindex="-1"></a><span class="co"># plotting function</span></span>
<span id="cb861-23"><a href="model-comparison.html#cb861-23" aria-hidden="true" tabindex="-1"></a>plot_fit <span class="ot">=</span> <span class="cf">function</span>(i){</span>
<span id="cb861-24"><a href="model-comparison.html#cb861-24" aria-hidden="true" tabindex="-1"></a>  <span class="co"># calculate RMSE for fitted data </span></span>
<span id="cb861-25"><a href="model-comparison.html#cb861-25" aria-hidden="true" tabindex="-1"></a>  fit <span class="ot">=</span> <span class="fu">lm</span>(<span class="at">formula =</span> y <span class="sc">~</span> <span class="fu">poly</span>(x, <span class="at">degree =</span> i, <span class="at">raw =</span> <span class="cn">TRUE</span>),</span>
<span id="cb861-26"><a href="model-comparison.html#cb861-26" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> df.data)</span>
<span id="cb861-27"><a href="model-comparison.html#cb861-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb861-28"><a href="model-comparison.html#cb861-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># calculate RMSE for training data</span></span>
<span id="cb861-29"><a href="model-comparison.html#cb861-29" aria-hidden="true" tabindex="-1"></a>  rmse <span class="ot">=</span> fit <span class="sc">%&gt;%</span> </span>
<span id="cb861-30"><a href="model-comparison.html#cb861-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rmse</span>(<span class="at">data =</span> df.data)</span>
<span id="cb861-31"><a href="model-comparison.html#cb861-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb861-32"><a href="model-comparison.html#cb861-32" aria-hidden="true" tabindex="-1"></a>  <span class="co"># calculate RMSE for new data </span></span>
<span id="cb861-33"><a href="model-comparison.html#cb861-33" aria-hidden="true" tabindex="-1"></a>  rmse_new <span class="ot">=</span> fit <span class="sc">%&gt;%</span> </span>
<span id="cb861-34"><a href="model-comparison.html#cb861-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rmse</span>(<span class="at">data =</span> df.more_data)</span>
<span id="cb861-35"><a href="model-comparison.html#cb861-35" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb861-36"><a href="model-comparison.html#cb861-36" aria-hidden="true" tabindex="-1"></a>  <span class="co"># make a plot</span></span>
<span id="cb861-37"><a href="model-comparison.html#cb861-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> df.data,</span>
<span id="cb861-38"><a href="model-comparison.html#cb861-38" aria-hidden="true" tabindex="-1"></a>             <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> x,</span>
<span id="cb861-39"><a href="model-comparison.html#cb861-39" aria-hidden="true" tabindex="-1"></a>                           <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb861-40"><a href="model-comparison.html#cb861-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb861-41"><a href="model-comparison.html#cb861-41" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">data =</span> df.more_data,</span>
<span id="cb861-42"><a href="model-comparison.html#cb861-42" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">2</span>, </span>
<span id="cb861-43"><a href="model-comparison.html#cb861-43" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb861-44"><a href="model-comparison.html#cb861-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> F,</span>
<span id="cb861-45"><a href="model-comparison.html#cb861-45" aria-hidden="true" tabindex="-1"></a>                <span class="at">formula =</span> y <span class="sc">~</span> <span class="fu">poly</span>(x, <span class="at">degree =</span> i, <span class="at">raw =</span> <span class="cn">TRUE</span>)) <span class="sc">+</span></span>
<span id="cb861-46"><a href="model-comparison.html#cb861-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb861-47"><a href="model-comparison.html#cb861-47" aria-hidden="true" tabindex="-1"></a>             <span class="at">x =</span> <span class="cn">Inf</span>,</span>
<span id="cb861-48"><a href="model-comparison.html#cb861-48" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> <span class="sc">-</span><span class="cn">Inf</span>,</span>
<span id="cb861-49"><a href="model-comparison.html#cb861-49" aria-hidden="true" tabindex="-1"></a>             <span class="at">label =</span> <span class="fu">str_c</span>(<span class="st">&quot;RMSE = &quot;</span>, <span class="fu">round</span>(rmse, <span class="dv">2</span>)),</span>
<span id="cb861-50"><a href="model-comparison.html#cb861-50" aria-hidden="true" tabindex="-1"></a>             <span class="at">hjust =</span> <span class="fl">1.1</span>,</span>
<span id="cb861-51"><a href="model-comparison.html#cb861-51" aria-hidden="true" tabindex="-1"></a>             <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.3</span>) <span class="sc">+</span> </span>
<span id="cb861-52"><a href="model-comparison.html#cb861-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb861-53"><a href="model-comparison.html#cb861-53" aria-hidden="true" tabindex="-1"></a>             <span class="at">x =</span> <span class="cn">Inf</span>,</span>
<span id="cb861-54"><a href="model-comparison.html#cb861-54" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> <span class="sc">-</span><span class="cn">Inf</span>,</span>
<span id="cb861-55"><a href="model-comparison.html#cb861-55" aria-hidden="true" tabindex="-1"></a>             <span class="at">label =</span> <span class="fu">str_c</span>(<span class="st">&quot;RMSE = &quot;</span>, <span class="fu">round</span>(rmse_new, <span class="dv">2</span>)),</span>
<span id="cb861-56"><a href="model-comparison.html#cb861-56" aria-hidden="true" tabindex="-1"></a>             <span class="at">hjust =</span> <span class="fl">1.1</span>,</span>
<span id="cb861-57"><a href="model-comparison.html#cb861-57" aria-hidden="true" tabindex="-1"></a>             <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">2</span>,</span>
<span id="cb861-58"><a href="model-comparison.html#cb861-58" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span> </span>
<span id="cb861-59"><a href="model-comparison.html#cb861-59" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.ticks =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb861-60"><a href="model-comparison.html#cb861-60" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb861-61"><a href="model-comparison.html#cb861-61" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text =</span> <span class="fu">element_blank</span>())</span>
<span id="cb861-62"><a href="model-comparison.html#cb861-62" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb861-63"><a href="model-comparison.html#cb861-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb861-64"><a href="model-comparison.html#cb861-64" aria-hidden="true" tabindex="-1"></a><span class="co"># map over the parameters</span></span>
<span id="cb861-65"><a href="model-comparison.html#cb861-65" aria-hidden="true" tabindex="-1"></a>l.p <span class="ot">=</span> <span class="fu">map</span>(n_parameters, plot_fit)</span>
<span id="cb861-66"><a href="model-comparison.html#cb861-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb861-67"><a href="model-comparison.html#cb861-67" aria-hidden="true" tabindex="-1"></a><span class="co"># make figure panel </span></span>
<span id="cb861-68"><a href="model-comparison.html#cb861-68" aria-hidden="true" tabindex="-1"></a><span class="fu">wrap_plots</span>(<span class="at">plotlist =</span> l.p, <span class="at">ncol =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="16-model_comparison_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<p>The RMSE in black shows the root mean squared error for the data that the model was fit on. The RMSE in red shows the RMSE on the new data. As you can see, the complex models do really poorly. They overfit the noise in the original data which leads to make poor predictions for new data. The simplest model (with two parameters) doesn’t do particularly well either since it misses out on the quadratic trend in the data. Both the model with the quadratic term (top middle) and a model that includes a cubic term (top right) provide a good balance – their RMSE on the new data is lowest.</p>
<p>Let’s generate another data set:</p>
<div class="sourceCode" id="cb862"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb862-1"><a href="model-comparison.html#cb862-1" aria-hidden="true" tabindex="-1"></a><span class="co"># make example reproducible </span></span>
<span id="cb862-2"><a href="model-comparison.html#cb862-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb862-3"><a href="model-comparison.html#cb862-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb862-4"><a href="model-comparison.html#cb862-4" aria-hidden="true" tabindex="-1"></a><span class="co"># parameters</span></span>
<span id="cb862-5"><a href="model-comparison.html#cb862-5" aria-hidden="true" tabindex="-1"></a>sample_size <span class="ot">=</span> <span class="dv">100</span></span>
<span id="cb862-6"><a href="model-comparison.html#cb862-6" aria-hidden="true" tabindex="-1"></a>b0 <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb862-7"><a href="model-comparison.html#cb862-7" aria-hidden="true" tabindex="-1"></a>b1 <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb862-8"><a href="model-comparison.html#cb862-8" aria-hidden="true" tabindex="-1"></a>b2 <span class="ot">=</span> <span class="dv">3</span></span>
<span id="cb862-9"><a href="model-comparison.html#cb862-9" aria-hidden="true" tabindex="-1"></a>sd <span class="ot">=</span> <span class="fl">0.5</span></span>
<span id="cb862-10"><a href="model-comparison.html#cb862-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb862-11"><a href="model-comparison.html#cb862-11" aria-hidden="true" tabindex="-1"></a><span class="co"># sample</span></span>
<span id="cb862-12"><a href="model-comparison.html#cb862-12" aria-hidden="true" tabindex="-1"></a>df.data <span class="ot">=</span> <span class="fu">tibble</span>(<span class="at">participant =</span> <span class="dv">1</span><span class="sc">:</span>sample_size,</span>
<span id="cb862-13"><a href="model-comparison.html#cb862-13" aria-hidden="true" tabindex="-1"></a>                 <span class="at">x =</span> <span class="fu">runif</span>(sample_size, <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="dv">1</span>),</span>
<span id="cb862-14"><a href="model-comparison.html#cb862-14" aria-hidden="true" tabindex="-1"></a>                 <span class="at">y =</span> b0 <span class="sc">+</span> b1<span class="sc">*</span>x <span class="sc">+</span> b2<span class="sc">*</span>x<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="fu">rnorm</span>(sample_size, <span class="at">sd =</span> sd)) </span></code></pre></div>
<p>And plot it:</p>
<div class="sourceCode" id="cb863"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb863-1"><a href="model-comparison.html#cb863-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df.data,</span>
<span id="cb863-2"><a href="model-comparison.html#cb863-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> x,</span>
<span id="cb863-3"><a href="model-comparison.html#cb863-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">y =</span> y)) <span class="sc">+</span> </span>
<span id="cb863-4"><a href="model-comparison.html#cb863-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>,</span>
<span id="cb863-5"><a href="model-comparison.html#cb863-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">formula =</span> y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb863-6"><a href="model-comparison.html#cb863-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="16-model_comparison_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
</div>
<div id="f-test" class="section level3" number="16.3.2">
<h3><span class="header-section-number">16.3.2</span> F-test</h3>
<p>Let’s fit three models of increasing complexity to the data. The model which fits the way in which the data were generated has the following form:</p>
<p><span class="math display">\[
\widehat Y_i = b_0 + b_1 \cdot X_i + b_2 \cdot X_i^2
\]</span></p>
<div class="sourceCode" id="cb864"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb864-1"><a href="model-comparison.html#cb864-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fit models to the data </span></span>
<span id="cb864-2"><a href="model-comparison.html#cb864-2" aria-hidden="true" tabindex="-1"></a>fit_simple <span class="ot">=</span> <span class="fu">lm</span>(y <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> x, <span class="at">data =</span> df.data)</span>
<span id="cb864-3"><a href="model-comparison.html#cb864-3" aria-hidden="true" tabindex="-1"></a>fit_correct <span class="ot">=</span> <span class="fu">lm</span>(y <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>), <span class="at">data =</span> df.data)</span>
<span id="cb864-4"><a href="model-comparison.html#cb864-4" aria-hidden="true" tabindex="-1"></a>fit_complex <span class="ot">=</span> <span class="fu">lm</span>(y <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">3</span>), <span class="at">data =</span> df.data)</span>
<span id="cb864-5"><a href="model-comparison.html#cb864-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb864-6"><a href="model-comparison.html#cb864-6" aria-hidden="true" tabindex="-1"></a><span class="co"># compare the models using an F-test </span></span>
<span id="cb864-7"><a href="model-comparison.html#cb864-7" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(fit_simple, fit_correct)</span></code></pre></div>
<pre><code>Analysis of Variance Table

Model 1: y ~ 1 + x
Model 2: y ~ 1 + x + I(x^2)
  Res.Df    RSS Df Sum of Sq      F    Pr(&gt;F)    
1     98 25.297                                  
2     97 21.693  1    3.6039 16.115 0.0001175 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb866"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb866-1"><a href="model-comparison.html#cb866-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(fit_correct, fit_complex)</span></code></pre></div>
<pre><code>Analysis of Variance Table

Model 1: y ~ 1 + x + I(x^2)
Model 2: y ~ 1 + x + I(x^2) + I(x^3)
  Res.Df    RSS Df Sum of Sq      F Pr(&gt;F)
1     97 21.693                           
2     96 21.643  1  0.050399 0.2236 0.6374</code></pre>
<p>The F-test tells us that <code>fit_correct</code> explains significantly more variance than <code>fit_simple</code>, whereas <code>fit_complex</code> doesn’t explain significantly more variance than <code>fit_correct</code>.</p>
<p>But, as discussed in class, there are many situations in which we cannot use the F-test to compare models. Namely, whenever we want to compare unnested models where one models does not include all the predictors of the other model. But, we can still use cross-validation in this case.</p>
<p>Let’s take a look.</p>
</div>
<div id="cross-validation" class="section level3" number="16.3.3">
<h3><span class="header-section-number">16.3.3</span> Cross-validation</h3>
<p>Cross-validation is a powerful technique for finding the sweet spot between simplicity and complexity. Moreover, we can use cross-validation to compare models that we cannot compare using the F-test approach that we’ve been using up until now.</p>
<p>There are many different kinds of cross-validation. All have the same idea in common though:</p>
<ul>
<li>we first fit the model to a subset of the data, often called <em>training data</em></li>
<li>and then check how well the model captures the held-out data, often called <em>test data</em></li>
</ul>
<p>Different versions of cross-validation differ in how the training and test data sets are defined. We’ll look at three different cross-validation techniques:</p>
<ol style="list-style-type: decimal">
<li>Leave-on-out cross-validation</li>
<li>k-fold cross-validation</li>
<li>Monte Carlo cross-validation</li>
</ol>
<div id="leave-one-out-cross-validation" class="section level4" number="16.3.3.1">
<h4><span class="header-section-number">16.3.3.1</span> Leave-one-out cross-validation</h4>
<p>I’ve used code similar to this one to illustrate how LOO works in class. Here is a simple data set with 9 data points. We fit 9 models, where for each model, the training set includes one of the data points, and then we look at how well the model captures the held-out data point. We can then characterize the model’s performance by calculating the mean squared error across the 9 runs.</p>
<div class="sourceCode" id="cb868"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb868-1"><a href="model-comparison.html#cb868-1" aria-hidden="true" tabindex="-1"></a><span class="co"># make example reproducible </span></span>
<span id="cb868-2"><a href="model-comparison.html#cb868-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb868-3"><a href="model-comparison.html#cb868-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb868-4"><a href="model-comparison.html#cb868-4" aria-hidden="true" tabindex="-1"></a><span class="co"># sample</span></span>
<span id="cb868-5"><a href="model-comparison.html#cb868-5" aria-hidden="true" tabindex="-1"></a>df.loo <span class="ot">=</span> <span class="fu">tibble</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>,</span>
<span id="cb868-6"><a href="model-comparison.html#cb868-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">10</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">10</span>, <span class="dv">2</span>, <span class="dv">8</span>)) </span>
<span id="cb868-7"><a href="model-comparison.html#cb868-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb868-8"><a href="model-comparison.html#cb868-8" aria-hidden="true" tabindex="-1"></a>df.loo_cross <span class="ot">=</span> df.loo <span class="sc">%&gt;%</span> </span>
<span id="cb868-9"><a href="model-comparison.html#cb868-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">crossv_loo</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb868-10"><a href="model-comparison.html#cb868-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">fit =</span> <span class="fu">map</span>(train, <span class="sc">~</span> <span class="fu">lm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> .)),</span>
<span id="cb868-11"><a href="model-comparison.html#cb868-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">tidy =</span> <span class="fu">map</span>(fit, tidy)) <span class="sc">%&gt;%</span> </span>
<span id="cb868-12"><a href="model-comparison.html#cb868-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(tidy)</span>
<span id="cb868-13"><a href="model-comparison.html#cb868-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb868-14"><a href="model-comparison.html#cb868-14" aria-hidden="true" tabindex="-1"></a><span class="co"># original plot </span></span>
<span id="cb868-15"><a href="model-comparison.html#cb868-15" aria-hidden="true" tabindex="-1"></a>df.plot <span class="ot">=</span> df.loo <span class="sc">%&gt;%</span> </span>
<span id="cb868-16"><a href="model-comparison.html#cb868-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">color =</span> <span class="dv">1</span>)</span>
<span id="cb868-17"><a href="model-comparison.html#cb868-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb868-18"><a href="model-comparison.html#cb868-18" aria-hidden="true" tabindex="-1"></a><span class="co"># fit to all data except one </span></span>
<span id="cb868-19"><a href="model-comparison.html#cb868-19" aria-hidden="true" tabindex="-1"></a>fun.cv_plot <span class="ot">=</span> <span class="cf">function</span>(data_point){</span>
<span id="cb868-20"><a href="model-comparison.html#cb868-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb868-21"><a href="model-comparison.html#cb868-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># determine which point to leave out </span></span>
<span id="cb868-22"><a href="model-comparison.html#cb868-22" aria-hidden="true" tabindex="-1"></a>  df.plot <span class="ot">=</span> df.plot <span class="sc">%&gt;%</span> </span>
<span id="cb868-23"><a href="model-comparison.html#cb868-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">color =</span> <span class="fu">ifelse</span>(<span class="fu">row_number</span>() <span class="sc">==</span> data_point, <span class="dv">2</span>, color))</span>
<span id="cb868-24"><a href="model-comparison.html#cb868-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb868-25"><a href="model-comparison.html#cb868-25" aria-hidden="true" tabindex="-1"></a>  <span class="co"># fit </span></span>
<span id="cb868-26"><a href="model-comparison.html#cb868-26" aria-hidden="true" tabindex="-1"></a>  df.fit <span class="ot">=</span> df.plot <span class="sc">%&gt;%</span> </span>
<span id="cb868-27"><a href="model-comparison.html#cb868-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(color <span class="sc">!=</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb868-28"><a href="model-comparison.html#cb868-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">lm</span>(<span class="at">formula =</span> y <span class="sc">~</span> x, <span class="at">data =</span> .) <span class="sc">%&gt;%</span> </span>
<span id="cb868-29"><a href="model-comparison.html#cb868-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">augment</span>(<span class="at">newdata =</span> df.plot <span class="sc">%&gt;%</span> </span>
<span id="cb868-30"><a href="model-comparison.html#cb868-30" aria-hidden="true" tabindex="-1"></a>              <span class="fu">filter</span>(color <span class="sc">==</span> <span class="dv">2</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb868-31"><a href="model-comparison.html#cb868-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">clean_names</span>()</span>
<span id="cb868-32"><a href="model-comparison.html#cb868-32" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb868-33"><a href="model-comparison.html#cb868-33" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">=</span> <span class="fu">ggplot</span>(df.plot,</span>
<span id="cb868-34"><a href="model-comparison.html#cb868-34" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(x, y, <span class="at">color =</span> <span class="fu">as.factor</span>(color))) <span class="sc">+</span> </span>
<span id="cb868-35"><a href="model-comparison.html#cb868-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">xend =</span> x,</span>
<span id="cb868-36"><a href="model-comparison.html#cb868-36" aria-hidden="true" tabindex="-1"></a>                     <span class="at">yend =</span> fitted),</span>
<span id="cb868-37"><a href="model-comparison.html#cb868-37" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> df.fit,</span>
<span id="cb868-38"><a href="model-comparison.html#cb868-38" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb868-39"><a href="model-comparison.html#cb868-39" aria-hidden="true" tabindex="-1"></a>                 <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb868-40"><a href="model-comparison.html#cb868-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb868-41"><a href="model-comparison.html#cb868-41" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> F, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fullrange =</span> T,</span>
<span id="cb868-42"><a href="model-comparison.html#cb868-42" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> df.plot <span class="sc">%&gt;%</span> <span class="fu">filter</span>(color <span class="sc">!=</span> <span class="dv">2</span>))  <span class="sc">+</span></span>
<span id="cb868-43"><a href="model-comparison.html#cb868-43" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb868-44"><a href="model-comparison.html#cb868-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb868-45"><a href="model-comparison.html#cb868-45" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb868-46"><a href="model-comparison.html#cb868-46" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb868-47"><a href="model-comparison.html#cb868-47" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text =</span> <span class="fu">element_blank</span>())</span>
<span id="cb868-48"><a href="model-comparison.html#cb868-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(p)</span>
<span id="cb868-49"><a href="model-comparison.html#cb868-49" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb868-50"><a href="model-comparison.html#cb868-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb868-51"><a href="model-comparison.html#cb868-51" aria-hidden="true" tabindex="-1"></a><span class="co"># save plots in list </span></span>
<span id="cb868-52"><a href="model-comparison.html#cb868-52" aria-hidden="true" tabindex="-1"></a>l.plots <span class="ot">=</span> <span class="fu">map</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>, fun.cv_plot)</span>
<span id="cb868-53"><a href="model-comparison.html#cb868-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb868-54"><a href="model-comparison.html#cb868-54" aria-hidden="true" tabindex="-1"></a><span class="co"># make figure panel </span></span>
<span id="cb868-55"><a href="model-comparison.html#cb868-55" aria-hidden="true" tabindex="-1"></a><span class="fu">wrap_plots</span>(<span class="at">plotlist =</span> l.plots, <span class="at">ncol =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>`geom_smooth()` using formula &#39;y ~ x&#39;
`geom_smooth()` using formula &#39;y ~ x&#39;
`geom_smooth()` using formula &#39;y ~ x&#39;
`geom_smooth()` using formula &#39;y ~ x&#39;
`geom_smooth()` using formula &#39;y ~ x&#39;
`geom_smooth()` using formula &#39;y ~ x&#39;
`geom_smooth()` using formula &#39;y ~ x&#39;
`geom_smooth()` using formula &#39;y ~ x&#39;
`geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="16-model_comparison_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<p>As you can see, the regression line changes quite a bit depending on which data point is in the test set.</p>
<p>Now, let’s use LOO to evaluate the models on the data set I’ve created above:</p>
<div class="sourceCode" id="cb870"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb870-1"><a href="model-comparison.html#cb870-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fit the models and calculate the RMSE for each model on the test set </span></span>
<span id="cb870-2"><a href="model-comparison.html#cb870-2" aria-hidden="true" tabindex="-1"></a>df.cross <span class="ot">=</span> df.data <span class="sc">%&gt;%</span> </span>
<span id="cb870-3"><a href="model-comparison.html#cb870-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">crossv_loo</span>() <span class="sc">%&gt;%</span> <span class="co"># function which generates training and test data sets </span></span>
<span id="cb870-4"><a href="model-comparison.html#cb870-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">model_simple =</span> <span class="fu">map</span>(train, <span class="sc">~</span> <span class="fu">lm</span>(y <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> x, <span class="at">data =</span> .)),</span>
<span id="cb870-5"><a href="model-comparison.html#cb870-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">model_correct =</span> <span class="fu">map</span>(train, <span class="sc">~</span> <span class="fu">lm</span>(y <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>), <span class="at">data =</span> .)),</span>
<span id="cb870-6"><a href="model-comparison.html#cb870-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">model_complex =</span> <span class="fu">map</span>(train, <span class="sc">~</span> <span class="fu">lm</span>(y <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">3</span>), <span class="at">data =</span> .))) <span class="sc">%&gt;%</span> </span>
<span id="cb870-7"><a href="model-comparison.html#cb870-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">contains</span>(<span class="st">&quot;model&quot;</span>),</span>
<span id="cb870-8"><a href="model-comparison.html#cb870-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&quot;model&quot;</span>,</span>
<span id="cb870-9"><a href="model-comparison.html#cb870-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">&quot;fit&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb870-10"><a href="model-comparison.html#cb870-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rmse =</span> <span class="fu">map2_dbl</span>(<span class="at">.x =</span> fit,</span>
<span id="cb870-11"><a href="model-comparison.html#cb870-11" aria-hidden="true" tabindex="-1"></a>                         <span class="at">.y =</span> test,</span>
<span id="cb870-12"><a href="model-comparison.html#cb870-12" aria-hidden="true" tabindex="-1"></a>                         <span class="at">.f =</span> <span class="sc">~</span> <span class="fu">rmse</span>(.x, .y)))</span>
<span id="cb870-13"><a href="model-comparison.html#cb870-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb870-14"><a href="model-comparison.html#cb870-14" aria-hidden="true" tabindex="-1"></a><span class="co"># show the average RMSE for each model </span></span>
<span id="cb870-15"><a href="model-comparison.html#cb870-15" aria-hidden="true" tabindex="-1"></a>df.cross <span class="sc">%&gt;%</span> </span>
<span id="cb870-16"><a href="model-comparison.html#cb870-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(model) <span class="sc">%&gt;%</span> </span>
<span id="cb870-17"><a href="model-comparison.html#cb870-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean_rmse =</span> <span class="fu">mean</span>(rmse) <span class="sc">%&gt;%</span> <span class="fu">round</span>(<span class="dv">3</span>))</span></code></pre></div>
<pre><code># A tibble: 3 x 2
  model         mean_rmse
* &lt;chr&gt;             &lt;dbl&gt;
1 model_complex     0.382
2 model_correct     0.378
3 model_simple      0.401</code></pre>
<p>As we can see, the <code>model_correct</code> has the lowest average RMSE on the test data.</p>
<p>One downside with LOO is that it becomes unfeasible when the number of data points is very large, as the number of cross validation runs equals the number of data points. The next cross-validation procedures help in this case.</p>
<div class="sourceCode" id="cb872"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb872-1"><a href="model-comparison.html#cb872-1" aria-hidden="true" tabindex="-1"></a>df.cross <span class="ot">=</span> df.data <span class="sc">%&gt;%</span> </span>
<span id="cb872-2"><a href="model-comparison.html#cb872-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">crossv_loo</span>() <span class="sc">%&gt;%</span> <span class="co"># function which generates training and test data sets </span></span>
<span id="cb872-3"><a href="model-comparison.html#cb872-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">model_simple =</span> <span class="fu">map</span>(train, <span class="sc">~</span> <span class="fu">lm</span>(y <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> x, <span class="at">data =</span> .)),</span>
<span id="cb872-4"><a href="model-comparison.html#cb872-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">model_correct =</span> <span class="fu">map</span>(train, <span class="sc">~</span> <span class="fu">lm</span>(y <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>), <span class="at">data =</span> .)),</span>
<span id="cb872-5"><a href="model-comparison.html#cb872-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">model_complex =</span> <span class="fu">map</span>(train, <span class="sc">~</span> <span class="fu">lm</span>(y <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">3</span>), <span class="at">data =</span> .))) <span class="sc">%&gt;%</span> </span>
<span id="cb872-6"><a href="model-comparison.html#cb872-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">contains</span>(<span class="st">&quot;model&quot;</span>),</span>
<span id="cb872-7"><a href="model-comparison.html#cb872-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&quot;model&quot;</span>,</span>
<span id="cb872-8"><a href="model-comparison.html#cb872-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">&quot;fit&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb872-9"><a href="model-comparison.html#cb872-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rmse =</span> <span class="fu">map2_dbl</span>(<span class="at">.x =</span> fit,</span>
<span id="cb872-10"><a href="model-comparison.html#cb872-10" aria-hidden="true" tabindex="-1"></a>                         <span class="at">.y =</span> test,</span>
<span id="cb872-11"><a href="model-comparison.html#cb872-11" aria-hidden="true" tabindex="-1"></a>                         <span class="at">.f =</span> <span class="sc">~</span> <span class="fu">rmse</span>(.x, .y)))</span>
<span id="cb872-12"><a href="model-comparison.html#cb872-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb872-13"><a href="model-comparison.html#cb872-13" aria-hidden="true" tabindex="-1"></a><span class="co"># show the average RMSE for each model </span></span>
<span id="cb872-14"><a href="model-comparison.html#cb872-14" aria-hidden="true" tabindex="-1"></a>df.cross <span class="sc">%&gt;%</span> </span>
<span id="cb872-15"><a href="model-comparison.html#cb872-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(model) <span class="sc">%&gt;%</span> </span>
<span id="cb872-16"><a href="model-comparison.html#cb872-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean_rmse =</span> <span class="fu">mean</span>(rmse) <span class="sc">%&gt;%</span> <span class="fu">round</span>(<span class="dv">3</span>))</span></code></pre></div>
<pre><code># A tibble: 3 x 2
  model         mean_rmse
* &lt;chr&gt;             &lt;dbl&gt;
1 model_complex     0.382
2 model_correct     0.378
3 model_simple      0.401</code></pre>
</div>
<div id="k-fold-cross-validation" class="section level4" number="16.3.3.2">
<h4><span class="header-section-number">16.3.3.2</span> k-fold cross-validation</h4>
<p>For k-fold cross-validation, we split the data set in k folds, and then use k-1 folds as the training set, and the remaining fold as the test set.</p>
<p>The code is almost identical as before. Instead of <code>crossv_loo()</code>, we use the <code>crossv_kfold()</code> function instead and say how many times we want to “fold” the data.</p>
<div class="sourceCode" id="cb874"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb874-1"><a href="model-comparison.html#cb874-1" aria-hidden="true" tabindex="-1"></a><span class="co"># crossvalidation scheme </span></span>
<span id="cb874-2"><a href="model-comparison.html#cb874-2" aria-hidden="true" tabindex="-1"></a>df.cross <span class="ot">=</span> df.data <span class="sc">%&gt;%</span> </span>
<span id="cb874-3"><a href="model-comparison.html#cb874-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">crossv_kfold</span>(<span class="at">k =</span> <span class="dv">10</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb874-4"><a href="model-comparison.html#cb874-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">model_simple =</span> <span class="fu">map</span>(train, <span class="sc">~</span> <span class="fu">lm</span>(y <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> x, <span class="at">data =</span> .)),</span>
<span id="cb874-5"><a href="model-comparison.html#cb874-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">model_correct =</span> <span class="fu">map</span>(train, <span class="sc">~</span> <span class="fu">lm</span>(y <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>), <span class="at">data =</span> .)),</span>
<span id="cb874-6"><a href="model-comparison.html#cb874-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">model_complex =</span> <span class="fu">map</span>(train, <span class="sc">~</span> <span class="fu">lm</span>(y <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">3</span>), <span class="at">data =</span> .))) <span class="sc">%&gt;%</span> </span>
<span id="cb874-7"><a href="model-comparison.html#cb874-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">contains</span>(<span class="st">&quot;model&quot;</span>),</span>
<span id="cb874-8"><a href="model-comparison.html#cb874-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&quot;model&quot;</span>,</span>
<span id="cb874-9"><a href="model-comparison.html#cb874-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">&quot;fit&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb874-10"><a href="model-comparison.html#cb874-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rsquare =</span> <span class="fu">map2_dbl</span>(fit, test, rsquare))</span>
<span id="cb874-11"><a href="model-comparison.html#cb874-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb874-12"><a href="model-comparison.html#cb874-12" aria-hidden="true" tabindex="-1"></a>df.cross <span class="sc">%&gt;%</span> </span>
<span id="cb874-13"><a href="model-comparison.html#cb874-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(model) <span class="sc">%&gt;%</span> </span>
<span id="cb874-14"><a href="model-comparison.html#cb874-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">median_rsquare =</span> <span class="fu">median</span>(rsquare))</span></code></pre></div>
<pre><code># A tibble: 3 x 2
  model         median_rsquare
* &lt;chr&gt;                  &lt;dbl&gt;
1 model_complex          0.884
2 model_correct          0.889
3 model_simple           0.880</code></pre>
<p>Note, for this example, I’ve calculated <span class="math inline">\(R^2\)</span> (the variance explained by each model) instead of RMSE – just to show you that you can do this, too. Often it’s useful to do both: show how well the model correlates, but also show the error.</p>
</div>
<div id="monte-carlo-cross-validation" class="section level4" number="16.3.3.3">
<h4><span class="header-section-number">16.3.3.3</span> Monte Carlo cross-validation</h4>
<p>Finally, let’s consider another very flexible version of cross-validation. For this version of cross-validation, we determine how many random splits into training set and test set we would like to do, and what proportion of the data should be in the test set.</p>
<div class="sourceCode" id="cb876"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb876-1"><a href="model-comparison.html#cb876-1" aria-hidden="true" tabindex="-1"></a><span class="co"># crossvalidation scheme </span></span>
<span id="cb876-2"><a href="model-comparison.html#cb876-2" aria-hidden="true" tabindex="-1"></a>df.cross <span class="ot">=</span> df.data <span class="sc">%&gt;%</span> </span>
<span id="cb876-3"><a href="model-comparison.html#cb876-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">crossv_mc</span>(<span class="at">n =</span> <span class="dv">50</span>, <span class="at">test =</span> <span class="fl">0.5</span>) <span class="sc">%&gt;%</span> <span class="co"># number of samples, and percentage of test </span></span>
<span id="cb876-4"><a href="model-comparison.html#cb876-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">model_simple =</span> <span class="fu">map</span>(train, <span class="sc">~</span> <span class="fu">lm</span>(y <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> x, <span class="at">data =</span> .x)),</span>
<span id="cb876-5"><a href="model-comparison.html#cb876-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">model_correct =</span> <span class="fu">map</span>(train, <span class="sc">~</span> <span class="fu">lm</span>(y <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>), <span class="at">data =</span> .x)),</span>
<span id="cb876-6"><a href="model-comparison.html#cb876-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">model_complex =</span> <span class="fu">map</span>(train, <span class="sc">~</span> <span class="fu">lm</span>(y <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">3</span>), <span class="at">data =</span> .))) <span class="sc">%&gt;%</span> </span>
<span id="cb876-7"><a href="model-comparison.html#cb876-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">contains</span>(<span class="st">&quot;model&quot;</span>),</span>
<span id="cb876-8"><a href="model-comparison.html#cb876-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&quot;model&quot;</span>,</span>
<span id="cb876-9"><a href="model-comparison.html#cb876-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">&quot;fit&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb876-10"><a href="model-comparison.html#cb876-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rmse =</span> <span class="fu">map2_dbl</span>(fit, test, rmse))</span>
<span id="cb876-11"><a href="model-comparison.html#cb876-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb876-12"><a href="model-comparison.html#cb876-12" aria-hidden="true" tabindex="-1"></a>df.cross <span class="sc">%&gt;%</span> </span>
<span id="cb876-13"><a href="model-comparison.html#cb876-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(model) <span class="sc">%&gt;%</span> </span>
<span id="cb876-14"><a href="model-comparison.html#cb876-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean_rmse =</span> <span class="fu">mean</span>(rmse))</span></code></pre></div>
<pre><code># A tibble: 3 x 2
  model         mean_rmse
* &lt;chr&gt;             &lt;dbl&gt;
1 model_complex     0.492
2 model_correct     0.484
3 model_simple      0.515</code></pre>
<p>In this example, I’ve asked for <span class="math inline">\(n = 50\)</span> splits and for each split, half of the data was in the training set, and half of the data in the test set.</p>
</div>
</div>
<div id="bootstrap" class="section level3" number="16.3.4">
<h3><span class="header-section-number">16.3.4</span> Bootstrap</h3>
<p>We can also use the <code>modelr</code> package for bootstrapping. The idea is the same as when we did cross-validation. We create a number of data sets from our original data set. Instead of splitting the data set in a training and test data set, for bootstrapping, we sample values from the original data set with replacement. Doing so, we can, for example, calculate the confidence interval of different statistics of interest.</p>
<p>Here is an example for how to boostrap confidence intervals for a mean.</p>
<div class="sourceCode" id="cb878"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb878-1"><a href="model-comparison.html#cb878-1" aria-hidden="true" tabindex="-1"></a><span class="co"># make example reproducible </span></span>
<span id="cb878-2"><a href="model-comparison.html#cb878-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb878-3"><a href="model-comparison.html#cb878-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb878-4"><a href="model-comparison.html#cb878-4" aria-hidden="true" tabindex="-1"></a>sample_size <span class="ot">=</span> <span class="dv">10</span> </span>
<span id="cb878-5"><a href="model-comparison.html#cb878-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb878-6"><a href="model-comparison.html#cb878-6" aria-hidden="true" tabindex="-1"></a><span class="co"># sample</span></span>
<span id="cb878-7"><a href="model-comparison.html#cb878-7" aria-hidden="true" tabindex="-1"></a>df.data <span class="ot">=</span> <span class="fu">tibble</span>(<span class="at">participant =</span> <span class="dv">1</span><span class="sc">:</span>sample_size,</span>
<span id="cb878-8"><a href="model-comparison.html#cb878-8" aria-hidden="true" tabindex="-1"></a>                 <span class="at">x =</span> <span class="fu">runif</span>(sample_size, <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="dv">1</span>)) </span>
<span id="cb878-9"><a href="model-comparison.html#cb878-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb878-10"><a href="model-comparison.html#cb878-10" aria-hidden="true" tabindex="-1"></a><span class="co"># mean of the actual sample</span></span>
<span id="cb878-11"><a href="model-comparison.html#cb878-11" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(df.data<span class="sc">$</span>x)</span></code></pre></div>
<pre><code>[1] 0.5515139</code></pre>
<div class="sourceCode" id="cb880"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb880-1"><a href="model-comparison.html#cb880-1" aria-hidden="true" tabindex="-1"></a><span class="co"># bootstrap to get confidence intervals around the mean </span></span>
<span id="cb880-2"><a href="model-comparison.html#cb880-2" aria-hidden="true" tabindex="-1"></a>df.data <span class="sc">%&gt;%</span></span>
<span id="cb880-3"><a href="model-comparison.html#cb880-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bootstrap</span>(<span class="at">n =</span> <span class="dv">1000</span>) <span class="sc">%&gt;%</span> <span class="co"># create 1000 bootstrapped samples</span></span>
<span id="cb880-4"><a href="model-comparison.html#cb880-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">estimate =</span> <span class="fu">map_dbl</span>(<span class="at">.x =</span> strap,</span>
<span id="cb880-5"><a href="model-comparison.html#cb880-5" aria-hidden="true" tabindex="-1"></a>                        <span class="at">.f =</span> <span class="sc">~</span> .x <span class="sc">%&gt;%</span> </span>
<span id="cb880-6"><a href="model-comparison.html#cb880-6" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb880-7"><a href="model-comparison.html#cb880-7" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">pull</span>(x) <span class="sc">%&gt;%</span> </span>
<span id="cb880-8"><a href="model-comparison.html#cb880-8" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">mean</span>())) <span class="sc">%&gt;%</span> </span>
<span id="cb880-9"><a href="model-comparison.html#cb880-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean =</span> <span class="fu">mean</span>(estimate),</span>
<span id="cb880-10"><a href="model-comparison.html#cb880-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">low =</span> <span class="fu">quantile</span>(estimate, <span class="fl">0.025</span>), <span class="co"># calculate the 2.5 / 97.5 percentiles</span></span>
<span id="cb880-11"><a href="model-comparison.html#cb880-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">high =</span> <span class="fu">quantile</span>(estimate, <span class="fl">0.975</span>))</span></code></pre></div>
<pre><code># A tibble: 1 x 3
   mean   low  high
  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 0.556 0.378 0.732</code></pre>
</div>
<div id="aic-and-bic" class="section level3" number="16.3.5">
<h3><span class="header-section-number">16.3.5</span> AIC and BIC</h3>
<p>The Akaike Information Criterion (AIC) and the Bayesian Information Criterion (BIC) are defined as follows:</p>
<p><span class="math display">\[
\text{AIC} = 2k-2\ln(\hat L)
\]</span></p>
<p><span class="math display">\[
\text{BIC} = \ln(n)k-2\ln(\hat L)
\]</span></p>
<p>where <span class="math inline">\(k\)</span> is the number of parameters in the model, <span class="math inline">\(n\)</span> is the number of observations, and <span class="math inline">\(\hat L\)</span> is the maximized value of the likelihood function of the model. Both AIC and BIC trade off model fit (as measured by the maximum likelihood of the data <span class="math inline">\(\hat L\)</span>) and the number of parameters in the model.</p>
<p>Calculating AIC and BIC in R is straightforward. We simply need to fit a linear model, and then call the <code>AIC()</code> or <code>BIC()</code> functions on the fitted model like so:</p>
<div class="sourceCode" id="cb882"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb882-1"><a href="model-comparison.html#cb882-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb882-2"><a href="model-comparison.html#cb882-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb882-3"><a href="model-comparison.html#cb882-3" aria-hidden="true" tabindex="-1"></a><span class="co"># let&#39;s generate some data </span></span>
<span id="cb882-4"><a href="model-comparison.html#cb882-4" aria-hidden="true" tabindex="-1"></a>df.example <span class="ot">=</span> <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">runif</span>(<span class="dv">20</span>, <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="dv">1</span>),</span>
<span id="cb882-5"><a href="model-comparison.html#cb882-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">y =</span> <span class="dv">1</span> <span class="sc">+</span> <span class="dv">3</span> <span class="sc">*</span> x <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">20</span>, <span class="at">sd =</span> <span class="dv">2</span>))</span>
<span id="cb882-6"><a href="model-comparison.html#cb882-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb882-7"><a href="model-comparison.html#cb882-7" aria-hidden="true" tabindex="-1"></a><span class="co"># fit a linear model </span></span>
<span id="cb882-8"><a href="model-comparison.html#cb882-8" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">=</span> <span class="fu">lm</span>(<span class="at">formula =</span> y <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> x,</span>
<span id="cb882-9"><a href="model-comparison.html#cb882-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">data =</span> df.example)</span>
<span id="cb882-10"><a href="model-comparison.html#cb882-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb882-11"><a href="model-comparison.html#cb882-11" aria-hidden="true" tabindex="-1"></a><span class="co"># get AIC </span></span>
<span id="cb882-12"><a href="model-comparison.html#cb882-12" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(fit)</span></code></pre></div>
<pre><code>[1] 75.47296</code></pre>
<div class="sourceCode" id="cb884"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb884-1"><a href="model-comparison.html#cb884-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get BIC</span></span>
<span id="cb884-2"><a href="model-comparison.html#cb884-2" aria-hidden="true" tabindex="-1"></a><span class="fu">BIC</span>(fit)</span></code></pre></div>
<pre><code>[1] 78.46016</code></pre>
<p>We can also just use the <code>broom</code> package to get that information:</p>
<div class="sourceCode" id="cb886"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb886-1"><a href="model-comparison.html#cb886-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fit %&gt;% </span></span>
<span id="cb886-2"><a href="model-comparison.html#cb886-2" aria-hidden="true" tabindex="-1"></a><span class="co">#   summary()</span></span>
<span id="cb886-3"><a href="model-comparison.html#cb886-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb886-4"><a href="model-comparison.html#cb886-4" aria-hidden="true" tabindex="-1"></a>fit <span class="sc">%&gt;%</span> </span>
<span id="cb886-5"><a href="model-comparison.html#cb886-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glance</span>()</span></code></pre></div>
<pre><code># A tibble: 1 x 12
  r.squared adj.r.squared sigma statistic p.value    df logLik   AIC   BIC
      &lt;dbl&gt;         &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1     0.255         0.214  1.45      6.16  0.0232     1  -34.7  75.5  78.5
# … with 3 more variables: deviance &lt;dbl&gt;, df.residual &lt;int&gt;, nobs &lt;int&gt;</code></pre>
<p>Both AIC and BIC take the number of parameters and the model’s likelihood into account. BIC additionally considers the number of observations. But how is the likelihood of a linear model determined?</p>
<p>Let’s visualize the data first:</p>
<div class="sourceCode" id="cb888"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb888-1"><a href="model-comparison.html#cb888-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the data with a linear model fit  </span></span>
<span id="cb888-2"><a href="model-comparison.html#cb888-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df.example,</span>
<span id="cb888-3"><a href="model-comparison.html#cb888-3" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(x, y)) <span class="sc">+</span> </span>
<span id="cb888-4"><a href="model-comparison.html#cb888-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb888-5"><a href="model-comparison.html#cb888-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>)</span></code></pre></div>
<p><img src="16-model_comparison_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<p>Now, let’s take a look at the residuals by plotting the fitted values on the x axis, and the residuals on the y axis.</p>
<div class="sourceCode" id="cb889"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb889-1"><a href="model-comparison.html#cb889-1" aria-hidden="true" tabindex="-1"></a><span class="co"># residual plot </span></span>
<span id="cb889-2"><a href="model-comparison.html#cb889-2" aria-hidden="true" tabindex="-1"></a>df.plot <span class="ot">=</span> df.example <span class="sc">%&gt;%</span> </span>
<span id="cb889-3"><a href="model-comparison.html#cb889-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> .) <span class="sc">%&gt;%</span> </span>
<span id="cb889-4"><a href="model-comparison.html#cb889-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">augment</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb889-5"><a href="model-comparison.html#cb889-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>()</span>
<span id="cb889-6"><a href="model-comparison.html#cb889-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb889-7"><a href="model-comparison.html#cb889-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df.plot,</span>
<span id="cb889-8"><a href="model-comparison.html#cb889-8" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(fitted, resid)) <span class="sc">+</span> </span>
<span id="cb889-9"><a href="model-comparison.html#cb889-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="16-model_comparison_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
<p>Remember that the linear model makes the assumption that the residuals are normally distributed with mean 0 (which is always the case if we fit a linear model) and some fitted standard deviation. In fact, the standard deviation of the normal distribution is fitted such that the overall likelihood of the data is maximized.</p>
<p>Let’s make a plot that shows a normal distribution alongside the residuals:</p>
<div class="sourceCode" id="cb890"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb890-1"><a href="model-comparison.html#cb890-1" aria-hidden="true" tabindex="-1"></a><span class="co"># define a normal distribution </span></span>
<span id="cb890-2"><a href="model-comparison.html#cb890-2" aria-hidden="true" tabindex="-1"></a>df.normal <span class="ot">=</span> <span class="fu">tibble</span>(</span>
<span id="cb890-3"><a href="model-comparison.html#cb890-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="fl">0.1</span>),</span>
<span id="cb890-4"><a href="model-comparison.html#cb890-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">dnorm</span>(y, <span class="at">sd =</span> <span class="dv">2</span>) <span class="sc">+</span> <span class="fl">3.75</span></span>
<span id="cb890-5"><a href="model-comparison.html#cb890-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb890-6"><a href="model-comparison.html#cb890-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb890-7"><a href="model-comparison.html#cb890-7" aria-hidden="true" tabindex="-1"></a><span class="co"># show the residual plot together with the normal distribution</span></span>
<span id="cb890-8"><a href="model-comparison.html#cb890-8" aria-hidden="true" tabindex="-1"></a>df.plot <span class="sc">%&gt;%</span> </span>
<span id="cb890-9"><a href="model-comparison.html#cb890-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> fitted, <span class="at">y =</span> resid)) <span class="sc">+</span> </span>
<span id="cb890-10"><a href="model-comparison.html#cb890-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb890-11"><a href="model-comparison.html#cb890-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>(<span class="at">data =</span> df.normal,</span>
<span id="cb890-12"><a href="model-comparison.html#cb890-12" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y),</span>
<span id="cb890-13"><a href="model-comparison.html#cb890-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="16-model_comparison_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<p>To determine the likelihood of the data given the model <span class="math inline">\(\hat L\)</span>, we now calculate the likelihood of each point (with the <code>dnorm()</code> function), and then multiply the likelihood of each data point to get the overall likelihood. We can simply multiply the data points since we also assume that the data points are independent.
Instead of multiplying likelihoods, we often sum the log likelihoods instead. This is because if we multiply many small values, the overall value gets to close to 0 so that computers get confused. By taking logs instead, we avoid these nasty precision errors.</p>
<p>To better understand AIC and BIC, let’s calculate them by hand:</p>
<div class="sourceCode" id="cb891"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb891-1"><a href="model-comparison.html#cb891-1" aria-hidden="true" tabindex="-1"></a><span class="co"># we first get the estimate of the standard deviation of the residuals </span></span>
<span id="cb891-2"><a href="model-comparison.html#cb891-2" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">=</span> fit <span class="sc">%&gt;%</span> </span>
<span id="cb891-3"><a href="model-comparison.html#cb891-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glance</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb891-4"><a href="model-comparison.html#cb891-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(sigma)</span>
<span id="cb891-5"><a href="model-comparison.html#cb891-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb891-6"><a href="model-comparison.html#cb891-6" aria-hidden="true" tabindex="-1"></a><span class="co"># then we calculate the log likelihood of the model </span></span>
<span id="cb891-7"><a href="model-comparison.html#cb891-7" aria-hidden="true" tabindex="-1"></a>log_likelihood <span class="ot">=</span> fit <span class="sc">%&gt;%</span> </span>
<span id="cb891-8"><a href="model-comparison.html#cb891-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">augment</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb891-9"><a href="model-comparison.html#cb891-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">likelihood =</span> <span class="fu">dnorm</span>(.resid, <span class="at">sd =</span> sigma)) <span class="sc">%&gt;%</span> </span>
<span id="cb891-10"><a href="model-comparison.html#cb891-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">logLik =</span> <span class="fu">sum</span>(<span class="fu">log</span>(likelihood))) <span class="sc">%&gt;%</span> </span>
<span id="cb891-11"><a href="model-comparison.html#cb891-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.numeric</span>()</span>
<span id="cb891-12"><a href="model-comparison.html#cb891-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb891-13"><a href="model-comparison.html#cb891-13" aria-hidden="true" tabindex="-1"></a><span class="co"># then we calculate AIC and BIC using the formulas introduced above</span></span>
<span id="cb891-14"><a href="model-comparison.html#cb891-14" aria-hidden="true" tabindex="-1"></a>aic <span class="ot">=</span> <span class="dv">2</span><span class="sc">*</span><span class="dv">3</span> <span class="sc">-</span> <span class="dv">2</span> <span class="sc">*</span> log_likelihood</span>
<span id="cb891-15"><a href="model-comparison.html#cb891-15" aria-hidden="true" tabindex="-1"></a>bic <span class="ot">=</span> <span class="fu">log</span>(<span class="fu">nrow</span>(df.example)) <span class="sc">*</span> <span class="dv">3</span> <span class="sc">-</span> <span class="dv">2</span> <span class="sc">*</span> log_likelihood</span>
<span id="cb891-16"><a href="model-comparison.html#cb891-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb891-17"><a href="model-comparison.html#cb891-17" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(aic)</span></code></pre></div>
<pre><code>[1] 75.58017</code></pre>
<div class="sourceCode" id="cb893"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb893-1"><a href="model-comparison.html#cb893-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(bic)</span></code></pre></div>
<pre><code>[1] 78.56737</code></pre>
<p>Cool! The values are the same as when we use the <code>glance()</code> function like so (except for a small difference due to rounding):</p>
<div class="sourceCode" id="cb895"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb895-1"><a href="model-comparison.html#cb895-1" aria-hidden="true" tabindex="-1"></a>fit <span class="sc">%&gt;%</span> </span>
<span id="cb895-2"><a href="model-comparison.html#cb895-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glance</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb895-3"><a href="model-comparison.html#cb895-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(AIC, BIC)</span></code></pre></div>
<pre><code># A tibble: 1 x 2
    AIC   BIC
  &lt;dbl&gt; &lt;dbl&gt;
1  75.5  78.5</code></pre>
<div id="log-is-your-friend" class="section level4" number="16.3.5.1">
<h4><span class="header-section-number">16.3.5.1</span> log() is your friend</h4>
<div class="sourceCode" id="cb897"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb897-1"><a href="model-comparison.html#cb897-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)),</span>
<span id="cb897-2"><a href="model-comparison.html#cb897-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> x)) <span class="sc">+</span> </span>
<span id="cb897-3"><a href="model-comparison.html#cb897-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> <span class="st">&quot;log&quot;</span>,</span>
<span id="cb897-4"><a href="model-comparison.html#cb897-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb897-5"><a href="model-comparison.html#cb897-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;probability&quot;</span>,</span>
<span id="cb897-6"><a href="model-comparison.html#cb897-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;log(probability)&quot;</span>) <span class="sc">+</span></span>
<span id="cb897-7"><a href="model-comparison.html#cb897-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">24</span>),</span>
<span id="cb897-8"><a href="model-comparison.html#cb897-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">26</span>))</span></code></pre></div>
<p><img src="16-model_comparison_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
</div>
</div>
</div>
<div id="additional-resources-13" class="section level2" number="16.4">
<h2><span class="header-section-number">16.4</span> Additional resources</h2>
<div id="datacamp-course" class="section level3" number="16.4.1">
<h3><span class="header-section-number">16.4.1</span> Datacamp course</h3>
<ul>
<li><a href="https://www.datacamp.com/courses/foundations-of-functional-programming-with-purrr">Foundations of Functional Programming with purrr</a></li>
<li><a href="https://www.datacamp.com/courses/intermediate-functional-programming-with-purrr">Intermediate functional programming with purrr</a></li>
</ul>
</div>
<div id="reading-1" class="section level3" number="16.4.2">
<h3><span class="header-section-number">16.4.2</span> Reading</h3>
<ul>
<li><a href="https://r4ds.had.co.nz/many-models.html">R for Data Science: Chapter 25</a></li>
</ul>
</div>
</div>
<div id="session-info-15" class="section level2" number="16.5">
<h2><span class="header-section-number">16.5</span> Session info</h2>
<p>Information about this R session including which version of R was used, and what packages were loaded.</p>
<div class="sourceCode" id="cb898"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb898-1"><a href="model-comparison.html#cb898-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span></code></pre></div>
<pre><code>R version 4.0.3 (2020-10-10)
Platform: x86_64-apple-darwin17.0 (64-bit)
Running under: macOS Catalina 10.15.7

Matrix products: default
BLAS:   /Library/Frameworks/R.framework/Versions/4.0/Resources/lib/libRblas.dylib
LAPACK: /Library/Frameworks/R.framework/Versions/4.0/Resources/lib/libRlapack.dylib

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
 [1] forcats_0.5.1    stringr_1.4.0    dplyr_1.0.4      purrr_0.3.4     
 [5] readr_1.4.0      tidyr_1.1.2      tibble_3.0.6     ggplot2_3.3.3   
 [9] tidyverse_1.3.0  modelr_0.1.8     patchwork_1.1.1  broom_0.7.3     
[13] janitor_2.1.0    kableExtra_1.3.1 knitr_1.31      

loaded via a namespace (and not attached):
 [1] Rcpp_1.0.6        lubridate_1.7.9.2 lattice_0.20-41   ps_1.6.0         
 [5] utf8_1.1.4        assertthat_0.2.1  digest_0.6.27     R6_2.5.0         
 [9] cellranger_1.1.0  backports_1.2.1   reprex_1.0.0      evaluate_0.14    
[13] highr_0.8         httr_1.4.2        pillar_1.4.7      rlang_0.4.10     
[17] readxl_1.3.1      rstudioapi_0.13   Matrix_1.3-2      rmarkdown_2.6    
[21] labeling_0.4.2    splines_4.0.3     webshot_0.5.2     munsell_0.5.0    
[25] compiler_4.0.3    xfun_0.21         pkgconfig_2.0.3   mgcv_1.8-33      
[29] htmltools_0.5.1.1 tidyselect_1.1.0  bookdown_0.21     fansi_0.4.2      
[33] viridisLite_0.3.0 crayon_1.4.1      dbplyr_2.0.0      withr_2.4.1      
[37] grid_4.0.3        nlme_3.1-151      jsonlite_1.7.2    gtable_0.3.0     
[41] lifecycle_1.0.0   DBI_1.1.1         magrittr_2.0.1    scales_1.1.1     
[45] cli_2.3.0         stringi_1.5.3     farver_2.1.0      fs_1.5.0         
[49] snakecase_0.11.0  xml2_1.3.2        ellipsis_0.3.1    generics_0.1.0   
[53] vctrs_0.3.6       tools_4.0.3       glue_1.4.2        hms_1.0.0        
[57] yaml_2.2.1        colorspace_2.0-0  rvest_0.3.6       haven_2.3.1      </code></pre>
</div>
<div id="references-5" class="section level2" number="16.6">
<h2><span class="header-section-number">16.6</span> References</h2>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="mediation-moderation.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="linear-mixed-effects-models-1.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"],
"google": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/psych252/psych252book/edit/master/16-model_comparison.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"toc_depth": 3,
"search": false
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
