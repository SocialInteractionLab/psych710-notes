<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 12 Linear model 3 | Psych 252: Statistical Methods for Behavioral and Social Sciences</title>
  <meta name="description" content="Course notes for Psych 252." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 12 Linear model 3 | Psych 252: Statistical Methods for Behavioral and Social Sciences" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Course notes for Psych 252." />
  <meta name="github-repo" content="psych252/psych252book" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 12 Linear model 3 | Psych 252: Statistical Methods for Behavioral and Social Sciences" />
  
  <meta name="twitter:description" content="Course notes for Psych 252." />
  

<meta name="author" content="Tobias Gerstenberg" />


<meta name="date" content="2021-03-11" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="linear-model-2.html"/>
<link rel="next" href="linear-model-4.html"/>
<script src="libs/header-attrs-2.6/header-attrs.js"></script>
<script src="libs/jquery-3.5.1/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.17/datatables.js"></script>
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.10.20/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.1/js/crosstalk.min.js"></script>
<script src="libs/viz-1.8.2/viz.js"></script>
<link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="libs/grViz-binding-1.0.6.1/grViz.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Psych 252</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#course-description"><i class="fa fa-check"></i>Course description</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#course-homepage"><i class="fa fa-check"></i>Course homepage</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#thanks"><i class="fa fa-check"></i><b>1.1</b> Thanks</a></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#list-of-r-packages-used-in-this-book"><i class="fa fa-check"></i><b>1.2</b> List of R packages used in this book</a></li>
<li class="chapter" data-level="1.3" data-path="introduction.html"><a href="introduction.html#installing-packages"><i class="fa fa-check"></i><b>1.3</b> Installing packages</a></li>
<li class="chapter" data-level="1.4" data-path="introduction.html"><a href="introduction.html#session-info"><i class="fa fa-check"></i><b>1.4</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="visualization-1.html"><a href="visualization-1.html"><i class="fa fa-check"></i><b>2</b> Visualization 1</a>
<ul>
<li class="chapter" data-level="2.1" data-path="visualization-1.html"><a href="visualization-1.html#learning-goals"><i class="fa fa-check"></i><b>2.1</b> Learning goals</a></li>
<li class="chapter" data-level="2.2" data-path="visualization-1.html"><a href="visualization-1.html#load-packages"><i class="fa fa-check"></i><b>2.2</b> Load packages</a></li>
<li class="chapter" data-level="2.3" data-path="visualization-1.html"><a href="visualization-1.html#why-visualize-data"><i class="fa fa-check"></i><b>2.3</b> Why visualize data?</a></li>
<li class="chapter" data-level="2.4" data-path="visualization-1.html"><a href="visualization-1.html#some-basics"><i class="fa fa-check"></i><b>2.4</b> Some basics</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="visualization-1.html"><a href="visualization-1.html#setting-up-rstudio"><i class="fa fa-check"></i><b>2.4.1</b> Setting up RStudio</a></li>
<li class="chapter" data-level="2.4.2" data-path="visualization-1.html"><a href="visualization-1.html#getting-help"><i class="fa fa-check"></i><b>2.4.2</b> Getting help</a></li>
<li class="chapter" data-level="2.4.3" data-path="visualization-1.html"><a href="visualization-1.html#r-markdown-infos"><i class="fa fa-check"></i><b>2.4.3</b> R Markdown infos</a></li>
<li class="chapter" data-level="2.4.4" data-path="visualization-1.html"><a href="visualization-1.html#helpful-keyboard-shortcuts"><i class="fa fa-check"></i><b>2.4.4</b> Helpful keyboard shortcuts</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="visualization-1.html"><a href="visualization-1.html#data-visualization"><i class="fa fa-check"></i><b>2.5</b> Data visualization</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="visualization-1.html"><a href="visualization-1.html#setting-up-a-plot"><i class="fa fa-check"></i><b>2.5.1</b> Setting up a plot</a></li>
<li class="chapter" data-level="2.5.2" data-path="visualization-1.html"><a href="visualization-1.html#bar-plot"><i class="fa fa-check"></i><b>2.5.2</b> Bar plot</a></li>
<li class="chapter" data-level="2.5.3" data-path="visualization-1.html"><a href="visualization-1.html#setting-the-default-plot-theme"><i class="fa fa-check"></i><b>2.5.3</b> Setting the default plot theme</a></li>
<li class="chapter" data-level="2.5.4" data-path="visualization-1.html"><a href="visualization-1.html#scatter-plot"><i class="fa fa-check"></i><b>2.5.4</b> Scatter plot</a></li>
<li class="chapter" data-level="2.5.5" data-path="visualization-1.html"><a href="visualization-1.html#line-plot"><i class="fa fa-check"></i><b>2.5.5</b> Line plot</a></li>
<li class="chapter" data-level="2.5.6" data-path="visualization-1.html"><a href="visualization-1.html#adding-error-bars"><i class="fa fa-check"></i><b>2.5.6</b> Adding error bars</a></li>
<li class="chapter" data-level="2.5.7" data-path="visualization-1.html"><a href="visualization-1.html#order-matters"><i class="fa fa-check"></i><b>2.5.7</b> Order matters</a></li>
<li class="chapter" data-level="2.5.8" data-path="visualization-1.html"><a href="visualization-1.html#grouping-data"><i class="fa fa-check"></i><b>2.5.8</b> Grouping data</a></li>
<li class="chapter" data-level="2.5.9" data-path="visualization-1.html"><a href="visualization-1.html#making-facets"><i class="fa fa-check"></i><b>2.5.9</b> Making facets</a></li>
<li class="chapter" data-level="2.5.10" data-path="visualization-1.html"><a href="visualization-1.html#global-local-and-setting-aes"><i class="fa fa-check"></i><b>2.5.10</b> Global, local, and setting <code>aes()</code></a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="visualization-1.html"><a href="visualization-1.html#additional-resources"><i class="fa fa-check"></i><b>2.6</b> Additional resources</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="visualization-1.html"><a href="visualization-1.html#cheatsheets"><i class="fa fa-check"></i><b>2.6.1</b> Cheatsheets</a></li>
<li class="chapter" data-level="2.6.2" data-path="visualization-1.html"><a href="visualization-1.html#datacamp-courses"><i class="fa fa-check"></i><b>2.6.2</b> Datacamp courses</a></li>
<li class="chapter" data-level="2.6.3" data-path="visualization-1.html"><a href="visualization-1.html#books-and-chapters"><i class="fa fa-check"></i><b>2.6.3</b> Books and chapters</a></li>
<li class="chapter" data-level="2.6.4" data-path="visualization-1.html"><a href="visualization-1.html#misc"><i class="fa fa-check"></i><b>2.6.4</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="visualization-1.html"><a href="visualization-1.html#session-info-1"><i class="fa fa-check"></i><b>2.7</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="visualization-2.html"><a href="visualization-2.html"><i class="fa fa-check"></i><b>3</b> Visualization 2</a>
<ul>
<li class="chapter" data-level="3.1" data-path="visualization-2.html"><a href="visualization-2.html#learning-objectives"><i class="fa fa-check"></i><b>3.1</b> Learning objectives</a></li>
<li class="chapter" data-level="3.2" data-path="visualization-2.html"><a href="visualization-2.html#install-and-load-packages-load-data-set-theme"><i class="fa fa-check"></i><b>3.2</b> Install and load packages, load data, set theme</a></li>
<li class="chapter" data-level="3.3" data-path="visualization-2.html"><a href="visualization-2.html#overview-of-different-plot-types-for-different-things"><i class="fa fa-check"></i><b>3.3</b> Overview of different plot types for different things</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="visualization-2.html"><a href="visualization-2.html#proportions"><i class="fa fa-check"></i><b>3.3.1</b> Proportions</a></li>
<li class="chapter" data-level="3.3.2" data-path="visualization-2.html"><a href="visualization-2.html#comparisons"><i class="fa fa-check"></i><b>3.3.2</b> Comparisons</a></li>
<li class="chapter" data-level="3.3.3" data-path="visualization-2.html"><a href="visualization-2.html#relationships"><i class="fa fa-check"></i><b>3.3.3</b> Relationships</a></li>
<li class="chapter" data-level="3.3.4" data-path="visualization-2.html"><a href="visualization-2.html#temporal-data"><i class="fa fa-check"></i><b>3.3.4</b> Temporal data</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="visualization-2.html"><a href="visualization-2.html#customizing-plots"><i class="fa fa-check"></i><b>3.4</b> Customizing plots</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="visualization-2.html"><a href="visualization-2.html#anatomy-of-a-ggplot"><i class="fa fa-check"></i><b>3.4.1</b> Anatomy of a <code>ggplot</code></a></li>
<li class="chapter" data-level="3.4.2" data-path="visualization-2.html"><a href="visualization-2.html#changing-the-order-of-things"><i class="fa fa-check"></i><b>3.4.2</b> Changing the order of things</a></li>
<li class="chapter" data-level="3.4.3" data-path="visualization-2.html"><a href="visualization-2.html#dealing-with-legends"><i class="fa fa-check"></i><b>3.4.3</b> Dealing with legends</a></li>
<li class="chapter" data-level="3.4.4" data-path="visualization-2.html"><a href="visualization-2.html#choosing-good-colors"><i class="fa fa-check"></i><b>3.4.4</b> Choosing good colors</a></li>
<li class="chapter" data-level="3.4.5" data-path="visualization-2.html"><a href="visualization-2.html#customizing-themes"><i class="fa fa-check"></i><b>3.4.5</b> Customizing themes</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="visualization-2.html"><a href="visualization-2.html#saving-plots"><i class="fa fa-check"></i><b>3.5</b> Saving plots</a></li>
<li class="chapter" data-level="3.6" data-path="visualization-2.html"><a href="visualization-2.html#creating-figure-panels"><i class="fa fa-check"></i><b>3.6</b> Creating figure panels</a></li>
<li class="chapter" data-level="3.7" data-path="visualization-2.html"><a href="visualization-2.html#peeking-behind-the-scenes"><i class="fa fa-check"></i><b>3.7</b> Peeking behind the scenes</a></li>
<li class="chapter" data-level="3.8" data-path="visualization-2.html"><a href="visualization-2.html#making-animations"><i class="fa fa-check"></i><b>3.8</b> Making animations</a></li>
<li class="chapter" data-level="3.9" data-path="visualization-2.html"><a href="visualization-2.html#shiny-apps"><i class="fa fa-check"></i><b>3.9</b> Shiny apps</a></li>
<li class="chapter" data-level="3.10" data-path="visualization-2.html"><a href="visualization-2.html#defining-snippets"><i class="fa fa-check"></i><b>3.10</b> Defining snippets</a></li>
<li class="chapter" data-level="3.11" data-path="visualization-2.html"><a href="visualization-2.html#additional-resources-1"><i class="fa fa-check"></i><b>3.11</b> Additional resources</a>
<ul>
<li class="chapter" data-level="3.11.1" data-path="visualization-2.html"><a href="visualization-2.html#cheatsheets-1"><i class="fa fa-check"></i><b>3.11.1</b> Cheatsheets</a></li>
<li class="chapter" data-level="3.11.2" data-path="visualization-2.html"><a href="visualization-2.html#data-camp-courses"><i class="fa fa-check"></i><b>3.11.2</b> Data camp courses</a></li>
<li class="chapter" data-level="3.11.3" data-path="visualization-2.html"><a href="visualization-2.html#books-and-chapters-1"><i class="fa fa-check"></i><b>3.11.3</b> Books and chapters</a></li>
<li class="chapter" data-level="3.11.4" data-path="visualization-2.html"><a href="visualization-2.html#misc-1"><i class="fa fa-check"></i><b>3.11.4</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="3.12" data-path="visualization-2.html"><a href="visualization-2.html#session-info-2"><i class="fa fa-check"></i><b>3.12</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html"><i class="fa fa-check"></i><b>4</b> Data wrangling 1</a>
<ul>
<li class="chapter" data-level="4.1" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#learning-goals-1"><i class="fa fa-check"></i><b>4.1</b> Learning goals</a></li>
<li class="chapter" data-level="4.2" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#load-packages-1"><i class="fa fa-check"></i><b>4.2</b> Load packages</a></li>
<li class="chapter" data-level="4.3" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#some-r-basics"><i class="fa fa-check"></i><b>4.3</b> Some R basics</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#modes"><i class="fa fa-check"></i><b>4.3.1</b> Modes</a></li>
<li class="chapter" data-level="4.3.2" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#data-types"><i class="fa fa-check"></i><b>4.3.2</b> Data types</a></li>
<li class="chapter" data-level="4.3.3" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#operators"><i class="fa fa-check"></i><b>4.3.3</b> Operators</a></li>
<li class="chapter" data-level="4.3.4" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#control-flow"><i class="fa fa-check"></i><b>4.3.4</b> Control flow</a></li>
<li class="chapter" data-level="4.3.5" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#functions"><i class="fa fa-check"></i><b>4.3.5</b> Functions</a></li>
<li class="chapter" data-level="4.3.6" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#the-pipe-operator"><i class="fa fa-check"></i><b>4.3.6</b> The pipe operator <code>%&gt;%</code></a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#a-quick-note-on-naming-things"><i class="fa fa-check"></i><b>4.4</b> A quick note on naming things</a></li>
<li class="chapter" data-level="4.5" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#looking-at-data"><i class="fa fa-check"></i><b>4.5</b> Looking at data</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#head"><i class="fa fa-check"></i><b>4.5.1</b> <code>head()</code></a></li>
<li class="chapter" data-level="4.5.2" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#glimpse"><i class="fa fa-check"></i><b>4.5.2</b> <code>glimpse()</code></a></li>
<li class="chapter" data-level="4.5.3" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#distinct"><i class="fa fa-check"></i><b>4.5.3</b> <code>distinct()</code></a></li>
<li class="chapter" data-level="4.5.4" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#count"><i class="fa fa-check"></i><b>4.5.4</b> <code>count()</code></a></li>
<li class="chapter" data-level="4.5.5" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#datatable"><i class="fa fa-check"></i><b>4.5.5</b> <code>datatable()</code></a></li>
<li class="chapter" data-level="4.5.6" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#other-tools-for-taking-a-quick-look-at-data"><i class="fa fa-check"></i><b>4.5.6</b> Other tools for taking a quick look at data</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#wrangling-data"><i class="fa fa-check"></i><b>4.6</b> Wrangling data</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#filter"><i class="fa fa-check"></i><b>4.6.1</b> <code>filter()</code></a></li>
<li class="chapter" data-level="4.6.2" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#arrange"><i class="fa fa-check"></i><b>4.6.2</b> <code>arrange()</code></a></li>
<li class="chapter" data-level="4.6.3" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#rename"><i class="fa fa-check"></i><b>4.6.3</b> <code>rename()</code></a></li>
<li class="chapter" data-level="4.6.4" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#relocate"><i class="fa fa-check"></i><b>4.6.4</b> <code>relocate()</code></a></li>
<li class="chapter" data-level="4.6.5" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#select"><i class="fa fa-check"></i><b>4.6.5</b> <code>select()</code></a></li>
<li class="chapter" data-level="4.6.6" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#practice-2"><i class="fa fa-check"></i><b>4.6.6</b> Practice 2</a></li>
<li class="chapter" data-level="4.6.7" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#mutate"><i class="fa fa-check"></i><b>4.6.7</b> <code>mutate()</code></a></li>
<li class="chapter" data-level="4.6.8" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#practice-3"><i class="fa fa-check"></i><b>4.6.8</b> Practice 3</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#additional-resources-2"><i class="fa fa-check"></i><b>4.7</b> Additional resources</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#cheatsheets-2"><i class="fa fa-check"></i><b>4.7.1</b> Cheatsheets</a></li>
<li class="chapter" data-level="4.7.2" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#data-camp-courses-1"><i class="fa fa-check"></i><b>4.7.2</b> Data camp courses</a></li>
<li class="chapter" data-level="4.7.3" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#books-and-chapters-2"><i class="fa fa-check"></i><b>4.7.3</b> Books and chapters</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#session-info-3"><i class="fa fa-check"></i><b>4.8</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html"><i class="fa fa-check"></i><b>5</b> Data wrangling 2</a>
<ul>
<li class="chapter" data-level="5.1" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#learning-goals-2"><i class="fa fa-check"></i><b>5.1</b> Learning goals</a></li>
<li class="chapter" data-level="5.2" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#load-packages-2"><i class="fa fa-check"></i><b>5.2</b> Load packages</a></li>
<li class="chapter" data-level="5.3" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#settings"><i class="fa fa-check"></i><b>5.3</b> Settings</a></li>
<li class="chapter" data-level="5.4" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#wrangling-data-continued"><i class="fa fa-check"></i><b>5.4</b> Wrangling data (continued)</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#summarizing-data"><i class="fa fa-check"></i><b>5.4.1</b> Summarizing data</a></li>
<li class="chapter" data-level="5.4.2" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#reshaping-data"><i class="fa fa-check"></i><b>5.4.2</b> Reshaping data</a></li>
<li class="chapter" data-level="5.4.3" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#joining-multiple-data-frames"><i class="fa fa-check"></i><b>5.4.3</b> Joining multiple data frames</a></li>
<li class="chapter" data-level="5.4.4" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#dealing-with-missing-data"><i class="fa fa-check"></i><b>5.4.4</b> Dealing with missing data</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#reading-in-data"><i class="fa fa-check"></i><b>5.5</b> Reading in data</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#csv"><i class="fa fa-check"></i><b>5.5.1</b> csv</a></li>
<li class="chapter" data-level="5.5.2" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#rdata"><i class="fa fa-check"></i><b>5.5.2</b> RData</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#saving-data"><i class="fa fa-check"></i><b>5.6</b> Saving data</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#csv-1"><i class="fa fa-check"></i><b>5.6.1</b> csv</a></li>
<li class="chapter" data-level="5.6.2" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#rdata-1"><i class="fa fa-check"></i><b>5.6.2</b> RData</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#additional-resources-3"><i class="fa fa-check"></i><b>5.7</b> Additional resources</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#cheatsheets-3"><i class="fa fa-check"></i><b>5.7.1</b> Cheatsheets</a></li>
<li class="chapter" data-level="5.7.2" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#data-camp-courses-2"><i class="fa fa-check"></i><b>5.7.2</b> Data camp courses</a></li>
<li class="chapter" data-level="5.7.3" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#books-and-chapters-3"><i class="fa fa-check"></i><b>5.7.3</b> Books and chapters</a></li>
<li class="chapter" data-level="5.7.4" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#tutorials"><i class="fa fa-check"></i><b>5.7.4</b> Tutorials</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#session-info-4"><i class="fa fa-check"></i><b>5.8</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="probability-and-causality.html"><a href="probability-and-causality.html"><i class="fa fa-check"></i><b>6</b> Probability and causality</a>
<ul>
<li class="chapter" data-level="6.1" data-path="probability-and-causality.html"><a href="probability-and-causality.html#load-packages-load-data-set-theme"><i class="fa fa-check"></i><b>6.1</b> Load packages, load data, set theme</a></li>
<li class="chapter" data-level="6.2" data-path="probability-and-causality.html"><a href="probability-and-causality.html#counting"><i class="fa fa-check"></i><b>6.2</b> Counting</a></li>
<li class="chapter" data-level="6.3" data-path="probability-and-causality.html"><a href="probability-and-causality.html#the-random-secretary"><i class="fa fa-check"></i><b>6.3</b> The random secretary</a></li>
<li class="chapter" data-level="6.4" data-path="probability-and-causality.html"><a href="probability-and-causality.html#flipping-a-coin-many-times"><i class="fa fa-check"></i><b>6.4</b> Flipping a coin many times</a></li>
<li class="chapter" data-level="6.5" data-path="probability-and-causality.html"><a href="probability-and-causality.html#clue-guide-to-probability"><i class="fa fa-check"></i><b>6.5</b> Clue guide to probability</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="probability-and-causality.html"><a href="probability-and-causality.html#conditional-probability"><i class="fa fa-check"></i><b>6.5.1</b> Conditional probability</a></li>
<li class="chapter" data-level="6.5.2" data-path="probability-and-causality.html"><a href="probability-and-causality.html#law-of-total-probability"><i class="fa fa-check"></i><b>6.5.2</b> Law of total probability</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="probability-and-causality.html"><a href="probability-and-causality.html#probability-operations"><i class="fa fa-check"></i><b>6.6</b> Probability operations</a></li>
<li class="chapter" data-level="6.7" data-path="probability-and-causality.html"><a href="probability-and-causality.html#bayesian-reasoning-example"><i class="fa fa-check"></i><b>6.7</b> Bayesian reasoning example</a></li>
<li class="chapter" data-level="6.8" data-path="probability-and-causality.html"><a href="probability-and-causality.html#bayesian-networks"><i class="fa fa-check"></i><b>6.8</b> Bayesian networks</a>
<ul>
<li class="chapter" data-level="6.8.1" data-path="probability-and-causality.html"><a href="probability-and-causality.html#sprinkler-example"><i class="fa fa-check"></i><b>6.8.1</b> Sprinkler example</a></li>
</ul></li>
<li class="chapter" data-level="6.9" data-path="probability-and-causality.html"><a href="probability-and-causality.html#additional-resources-4"><i class="fa fa-check"></i><b>6.9</b> Additional resources</a>
<ul>
<li class="chapter" data-level="6.9.1" data-path="probability-and-causality.html"><a href="probability-and-causality.html#cheatsheets-4"><i class="fa fa-check"></i><b>6.9.1</b> Cheatsheets</a></li>
<li class="chapter" data-level="6.9.2" data-path="probability-and-causality.html"><a href="probability-and-causality.html#books-and-chapters-4"><i class="fa fa-check"></i><b>6.9.2</b> Books and chapters</a></li>
<li class="chapter" data-level="6.9.3" data-path="probability-and-causality.html"><a href="probability-and-causality.html#misc-2"><i class="fa fa-check"></i><b>6.9.3</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="6.10" data-path="probability-and-causality.html"><a href="probability-and-causality.html#session-info-5"><i class="fa fa-check"></i><b>6.10</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="simulation-1.html"><a href="simulation-1.html"><i class="fa fa-check"></i><b>7</b> Simulation 1</a>
<ul>
<li class="chapter" data-level="7.1" data-path="simulation-1.html"><a href="simulation-1.html#load-packages-and-set-plotting-theme"><i class="fa fa-check"></i><b>7.1</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="7.2" data-path="simulation-1.html"><a href="simulation-1.html#sampling"><i class="fa fa-check"></i><b>7.2</b> Sampling</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="simulation-1.html"><a href="simulation-1.html#drawing-numbers-from-a-vector"><i class="fa fa-check"></i><b>7.2.1</b> Drawing numbers from a vector</a></li>
<li class="chapter" data-level="7.2.2" data-path="simulation-1.html"><a href="simulation-1.html#drawing-rows-from-a-data-frame"><i class="fa fa-check"></i><b>7.2.2</b> Drawing rows from a data frame</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="simulation-1.html"><a href="simulation-1.html#working-with-distributions"><i class="fa fa-check"></i><b>7.3</b> Working with distributions</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="simulation-1.html"><a href="simulation-1.html#plotting-distributions"><i class="fa fa-check"></i><b>7.3.1</b> Plotting distributions</a></li>
<li class="chapter" data-level="7.3.2" data-path="simulation-1.html"><a href="simulation-1.html#sampling-from-distributions"><i class="fa fa-check"></i><b>7.3.2</b> Sampling from distributions</a></li>
<li class="chapter" data-level="7.3.3" data-path="simulation-1.html"><a href="simulation-1.html#understanding-density"><i class="fa fa-check"></i><b>7.3.3</b> Understanding <code>density()</code></a></li>
<li class="chapter" data-level="7.3.4" data-path="simulation-1.html"><a href="simulation-1.html#cumulative-probability-distribution"><i class="fa fa-check"></i><b>7.3.4</b> Cumulative probability distribution</a></li>
<li class="chapter" data-level="7.3.5" data-path="simulation-1.html"><a href="simulation-1.html#inverse-cumulative-distribution"><i class="fa fa-check"></i><b>7.3.5</b> Inverse cumulative distribution</a></li>
<li class="chapter" data-level="7.3.6" data-path="simulation-1.html"><a href="simulation-1.html#computing-probabilities"><i class="fa fa-check"></i><b>7.3.6</b> Computing probabilities</a></li>
<li class="chapter" data-level="7.3.7" data-path="simulation-1.html"><a href="simulation-1.html#make-the-plot"><i class="fa fa-check"></i><b>7.3.7</b> Make the plot</a></li>
<li class="chapter" data-level="7.3.8" data-path="simulation-1.html"><a href="simulation-1.html#analytic-solutions"><i class="fa fa-check"></i><b>7.3.8</b> Analytic solutions</a></li>
<li class="chapter" data-level="7.3.9" data-path="simulation-1.html"><a href="simulation-1.html#sampling-solution"><i class="fa fa-check"></i><b>7.3.9</b> Sampling solution</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="simulation-1.html"><a href="simulation-1.html#bayesian-inference-with-the-normal-distribution"><i class="fa fa-check"></i><b>7.4</b> Bayesian inference with the normal distribution</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="simulation-1.html"><a href="simulation-1.html#analytic-solution"><i class="fa fa-check"></i><b>7.4.1</b> Analytic solution</a></li>
<li class="chapter" data-level="7.4.2" data-path="simulation-1.html"><a href="simulation-1.html#solution-via-sampling"><i class="fa fa-check"></i><b>7.4.2</b> Solution via sampling</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="simulation-1.html"><a href="simulation-1.html#additional-resources-5"><i class="fa fa-check"></i><b>7.5</b> Additional resources</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="simulation-1.html"><a href="simulation-1.html#cheatsheets-5"><i class="fa fa-check"></i><b>7.5.1</b> Cheatsheets</a></li>
<li class="chapter" data-level="7.5.2" data-path="simulation-1.html"><a href="simulation-1.html#datacamp"><i class="fa fa-check"></i><b>7.5.2</b> Datacamp</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="simulation-1.html"><a href="simulation-1.html#session-info-6"><i class="fa fa-check"></i><b>7.6</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="simulation-2.html"><a href="simulation-2.html"><i class="fa fa-check"></i><b>8</b> Simulation 2</a>
<ul>
<li class="chapter" data-level="8.1" data-path="simulation-2.html"><a href="simulation-2.html#load-packages-and-set-plotting-theme-1"><i class="fa fa-check"></i><b>8.1</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="8.2" data-path="simulation-2.html"><a href="simulation-2.html#making-statistical-inferences-frequentist-style"><i class="fa fa-check"></i><b>8.2</b> Making statistical inferences (frequentist style)</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="simulation-2.html"><a href="simulation-2.html#population-distribution"><i class="fa fa-check"></i><b>8.2.1</b> Population distribution</a></li>
<li class="chapter" data-level="8.2.2" data-path="simulation-2.html"><a href="simulation-2.html#distribution-of-a-single-sample"><i class="fa fa-check"></i><b>8.2.2</b> Distribution of a single sample</a></li>
<li class="chapter" data-level="8.2.3" data-path="simulation-2.html"><a href="simulation-2.html#the-sampling-distribution"><i class="fa fa-check"></i><b>8.2.3</b> The sampling distribution</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="simulation-2.html"><a href="simulation-2.html#understanding-p-values"><i class="fa fa-check"></i><b>8.3</b> Understanding p-values</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="simulation-2.html"><a href="simulation-2.html#permutation-test"><i class="fa fa-check"></i><b>8.3.1</b> Permutation test</a></li>
<li class="chapter" data-level="8.3.2" data-path="simulation-2.html"><a href="simulation-2.html#t-test-by-hand"><i class="fa fa-check"></i><b>8.3.2</b> t-test by hand</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="simulation-2.html"><a href="simulation-2.html#confidence-intervals"><i class="fa fa-check"></i><b>8.4</b> Confidence intervals</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="simulation-2.html"><a href="simulation-2.html#mean_cl_boot-explained"><i class="fa fa-check"></i><b>8.4.1</b> <code>mean_cl_boot()</code> explained</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="simulation-2.html"><a href="simulation-2.html#additional-resources-6"><i class="fa fa-check"></i><b>8.5</b> Additional resources</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="simulation-2.html"><a href="simulation-2.html#datacamp-1"><i class="fa fa-check"></i><b>8.5.1</b> Datacamp</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="simulation-2.html"><a href="simulation-2.html#session-info-7"><i class="fa fa-check"></i><b>8.6</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="modeling-data.html"><a href="modeling-data.html"><i class="fa fa-check"></i><b>9</b> Modeling data</a>
<ul>
<li class="chapter" data-level="9.1" data-path="modeling-data.html"><a href="modeling-data.html#load-packages-and-set-plotting-theme-2"><i class="fa fa-check"></i><b>9.1</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="9.2" data-path="modeling-data.html"><a href="modeling-data.html#modeling-data-1"><i class="fa fa-check"></i><b>9.2</b> Modeling data</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="modeling-data.html"><a href="modeling-data.html#simplicity-vs.-accuracy-trade-off"><i class="fa fa-check"></i><b>9.2.1</b> Simplicity vs. accuracy trade-off</a></li>
<li class="chapter" data-level="9.2.2" data-path="modeling-data.html"><a href="modeling-data.html#error-definitions-and-best-estimators"><i class="fa fa-check"></i><b>9.2.2</b> Error definitions and best estimators</a></li>
<li class="chapter" data-level="9.2.3" data-path="modeling-data.html"><a href="modeling-data.html#sampling-distributions-for-median-and-mean"><i class="fa fa-check"></i><b>9.2.3</b> Sampling distributions for median and mean</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="modeling-data.html"><a href="modeling-data.html#hypothesis-testing-one-sample-t-test"><i class="fa fa-check"></i><b>9.3</b> Hypothesis testing: “One-sample t-test”</a></li>
<li class="chapter" data-level="9.4" data-path="modeling-data.html"><a href="modeling-data.html#building-a-sampling-distribution-of-pre"><i class="fa fa-check"></i><b>9.4</b> Building a sampling distribution of PRE</a></li>
<li class="chapter" data-level="9.5" data-path="modeling-data.html"><a href="modeling-data.html#additional-resources-7"><i class="fa fa-check"></i><b>9.5</b> Additional resources</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="modeling-data.html"><a href="modeling-data.html#reading"><i class="fa fa-check"></i><b>9.5.1</b> Reading</a></li>
<li class="chapter" data-level="9.5.2" data-path="modeling-data.html"><a href="modeling-data.html#datacamp-2"><i class="fa fa-check"></i><b>9.5.2</b> Datacamp</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="modeling-data.html"><a href="modeling-data.html#session-info-8"><i class="fa fa-check"></i><b>9.6</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="linear-model-1.html"><a href="linear-model-1.html"><i class="fa fa-check"></i><b>10</b> Linear model 1</a>
<ul>
<li class="chapter" data-level="10.1" data-path="linear-model-1.html"><a href="linear-model-1.html#load-packages-and-set-plotting-theme-3"><i class="fa fa-check"></i><b>10.1</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="10.2" data-path="linear-model-1.html"><a href="linear-model-1.html#correlation"><i class="fa fa-check"></i><b>10.2</b> Correlation</a></li>
<li class="chapter" data-level="10.3" data-path="linear-model-1.html"><a href="linear-model-1.html#regression"><i class="fa fa-check"></i><b>10.3</b> Regression</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="linear-model-1.html"><a href="linear-model-1.html#define-and-fit-the-models"><i class="fa fa-check"></i><b>10.3.1</b> Define and fit the models</a></li>
<li class="chapter" data-level="10.3.2" data-path="linear-model-1.html"><a href="linear-model-1.html#calculate-the-sum-of-squared-errors-of-each-model"><i class="fa fa-check"></i><b>10.3.2</b> Calculate the sum of squared errors of each model</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="linear-model-1.html"><a href="linear-model-1.html#credit-example"><i class="fa fa-check"></i><b>10.4</b> Credit example</a></li>
<li class="chapter" data-level="10.5" data-path="linear-model-1.html"><a href="linear-model-1.html#additional-resources-8"><i class="fa fa-check"></i><b>10.5</b> Additional resources</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="linear-model-1.html"><a href="linear-model-1.html#datacamp-3"><i class="fa fa-check"></i><b>10.5.1</b> Datacamp</a></li>
<li class="chapter" data-level="10.5.2" data-path="linear-model-1.html"><a href="linear-model-1.html#misc-3"><i class="fa fa-check"></i><b>10.5.2</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="linear-model-1.html"><a href="linear-model-1.html#session-info-9"><i class="fa fa-check"></i><b>10.6</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="linear-model-2.html"><a href="linear-model-2.html"><i class="fa fa-check"></i><b>11</b> Linear model 2</a>
<ul>
<li class="chapter" data-level="11.1" data-path="linear-model-2.html"><a href="linear-model-2.html#learning-goals-3"><i class="fa fa-check"></i><b>11.1</b> Learning goals</a></li>
<li class="chapter" data-level="11.2" data-path="linear-model-2.html"><a href="linear-model-2.html#load-packages-and-set-plotting-theme-4"><i class="fa fa-check"></i><b>11.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="11.3" data-path="linear-model-2.html"><a href="linear-model-2.html#load-data-sets"><i class="fa fa-check"></i><b>11.3</b> Load data sets</a></li>
<li class="chapter" data-level="11.4" data-path="linear-model-2.html"><a href="linear-model-2.html#multiple-continuous-variables"><i class="fa fa-check"></i><b>11.4</b> Multiple continuous variables</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="linear-model-2.html"><a href="linear-model-2.html#explore-correlations"><i class="fa fa-check"></i><b>11.4.1</b> Explore correlations</a></li>
<li class="chapter" data-level="11.4.2" data-path="linear-model-2.html"><a href="linear-model-2.html#multipe-regression"><i class="fa fa-check"></i><b>11.4.2</b> Multipe regression</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="linear-model-2.html"><a href="linear-model-2.html#one-categorical-variable"><i class="fa fa-check"></i><b>11.5</b> One categorical variable</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="linear-model-2.html"><a href="linear-model-2.html#visualization-of-the-model-predictions"><i class="fa fa-check"></i><b>11.5.1</b> Visualization of the model predictions</a></li>
<li class="chapter" data-level="11.5.2" data-path="linear-model-2.html"><a href="linear-model-2.html#dummy-coding"><i class="fa fa-check"></i><b>11.5.2</b> Dummy coding</a></li>
<li class="chapter" data-level="11.5.3" data-path="linear-model-2.html"><a href="linear-model-2.html#reporting-the-results"><i class="fa fa-check"></i><b>11.5.3</b> Reporting the results</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="linear-model-2.html"><a href="linear-model-2.html#one-continuous-and-one-categorical-variable"><i class="fa fa-check"></i><b>11.6</b> One continuous and one categorical variable</a>
<ul>
<li class="chapter" data-level="11.6.1" data-path="linear-model-2.html"><a href="linear-model-2.html#visualization-of-the-model-predictions-1"><i class="fa fa-check"></i><b>11.6.1</b> Visualization of the model predictions</a></li>
</ul></li>
<li class="chapter" data-level="11.7" data-path="linear-model-2.html"><a href="linear-model-2.html#interactions"><i class="fa fa-check"></i><b>11.7</b> Interactions</a>
<ul>
<li class="chapter" data-level="11.7.1" data-path="linear-model-2.html"><a href="linear-model-2.html#visualization-3"><i class="fa fa-check"></i><b>11.7.1</b> Visualization</a></li>
<li class="chapter" data-level="11.7.2" data-path="linear-model-2.html"><a href="linear-model-2.html#hypothesis-test"><i class="fa fa-check"></i><b>11.7.2</b> Hypothesis test</a></li>
</ul></li>
<li class="chapter" data-level="11.8" data-path="linear-model-2.html"><a href="linear-model-2.html#additional-resources-9"><i class="fa fa-check"></i><b>11.8</b> Additional resources</a>
<ul>
<li class="chapter" data-level="11.8.1" data-path="linear-model-2.html"><a href="linear-model-2.html#datacamp-4"><i class="fa fa-check"></i><b>11.8.1</b> Datacamp</a></li>
<li class="chapter" data-level="11.8.2" data-path="linear-model-2.html"><a href="linear-model-2.html#misc-4"><i class="fa fa-check"></i><b>11.8.2</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="11.9" data-path="linear-model-2.html"><a href="linear-model-2.html#session-info-10"><i class="fa fa-check"></i><b>11.9</b> Session info</a></li>
<li class="chapter" data-level="11.10" data-path="linear-model-2.html"><a href="linear-model-2.html#references"><i class="fa fa-check"></i><b>11.10</b> References</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="linear-model-3.html"><a href="linear-model-3.html"><i class="fa fa-check"></i><b>12</b> Linear model 3</a>
<ul>
<li class="chapter" data-level="12.1" data-path="linear-model-3.html"><a href="linear-model-3.html#learning-goals-4"><i class="fa fa-check"></i><b>12.1</b> Learning goals</a></li>
<li class="chapter" data-level="12.2" data-path="linear-model-3.html"><a href="linear-model-3.html#load-packages-and-set-plotting-theme-5"><i class="fa fa-check"></i><b>12.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="12.3" data-path="linear-model-3.html"><a href="linear-model-3.html#load-data-sets-1"><i class="fa fa-check"></i><b>12.3</b> Load data sets</a></li>
<li class="chapter" data-level="12.4" data-path="linear-model-3.html"><a href="linear-model-3.html#one-way-anova"><i class="fa fa-check"></i><b>12.4</b> One-way ANOVA</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="linear-model-3.html"><a href="linear-model-3.html#visualization-4"><i class="fa fa-check"></i><b>12.4.1</b> Visualization</a></li>
<li class="chapter" data-level="12.4.2" data-path="linear-model-3.html"><a href="linear-model-3.html#model-fitting"><i class="fa fa-check"></i><b>12.4.2</b> Model fitting</a></li>
<li class="chapter" data-level="12.4.3" data-path="linear-model-3.html"><a href="linear-model-3.html#hypothesis-test-1"><i class="fa fa-check"></i><b>12.4.3</b> Hypothesis test</a></li>
<li class="chapter" data-level="12.4.4" data-path="linear-model-3.html"><a href="linear-model-3.html#visualize-the-models-predictions"><i class="fa fa-check"></i><b>12.4.4</b> Visualize the model’s predictions</a></li>
<li class="chapter" data-level="12.4.5" data-path="linear-model-3.html"><a href="linear-model-3.html#dummy-coding-1"><i class="fa fa-check"></i><b>12.4.5</b> Dummy coding</a></li>
<li class="chapter" data-level="12.4.6" data-path="linear-model-3.html"><a href="linear-model-3.html#follow-up-questions"><i class="fa fa-check"></i><b>12.4.6</b> Follow up questions</a></li>
<li class="chapter" data-level="12.4.7" data-path="linear-model-3.html"><a href="linear-model-3.html#variance-decomposition"><i class="fa fa-check"></i><b>12.4.7</b> Variance decomposition</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="linear-model-3.html"><a href="linear-model-3.html#two-way-anova"><i class="fa fa-check"></i><b>12.5</b> Two-way ANOVA</a>
<ul>
<li class="chapter" data-level="12.5.1" data-path="linear-model-3.html"><a href="linear-model-3.html#visualization-5"><i class="fa fa-check"></i><b>12.5.1</b> Visualization</a></li>
<li class="chapter" data-level="12.5.2" data-path="linear-model-3.html"><a href="linear-model-3.html#model-fitting-1"><i class="fa fa-check"></i><b>12.5.2</b> Model fitting</a></li>
<li class="chapter" data-level="12.5.3" data-path="linear-model-3.html"><a href="linear-model-3.html#interpreting-interactions"><i class="fa fa-check"></i><b>12.5.3</b> Interpreting interactions</a></li>
<li class="chapter" data-level="12.5.4" data-path="linear-model-3.html"><a href="linear-model-3.html#variance-decomposition-1"><i class="fa fa-check"></i><b>12.5.4</b> Variance decomposition</a></li>
</ul></li>
<li class="chapter" data-level="12.6" data-path="linear-model-3.html"><a href="linear-model-3.html#two-way-anova-with-interaction"><i class="fa fa-check"></i><b>12.6</b> Two-way ANOVA (with interaction)</a></li>
<li class="chapter" data-level="12.7" data-path="linear-model-3.html"><a href="linear-model-3.html#anova-with-unbalanced-design"><i class="fa fa-check"></i><b>12.7</b> ANOVA with unbalanced design</a></li>
<li class="chapter" data-level="12.8" data-path="linear-model-3.html"><a href="linear-model-3.html#interpreting-parameters-very-important"><i class="fa fa-check"></i><b>12.8</b> Interpreting parameters (very important!)</a></li>
<li class="chapter" data-level="12.9" data-path="linear-model-3.html"><a href="linear-model-3.html#additional-resources-10"><i class="fa fa-check"></i><b>12.9</b> Additional resources</a>
<ul>
<li class="chapter" data-level="12.9.1" data-path="linear-model-3.html"><a href="linear-model-3.html#datacamp-5"><i class="fa fa-check"></i><b>12.9.1</b> Datacamp</a></li>
<li class="chapter" data-level="12.9.2" data-path="linear-model-3.html"><a href="linear-model-3.html#misc-5"><i class="fa fa-check"></i><b>12.9.2</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="12.10" data-path="linear-model-3.html"><a href="linear-model-3.html#session-info-11"><i class="fa fa-check"></i><b>12.10</b> Session info</a></li>
<li class="chapter" data-level="12.11" data-path="linear-model-3.html"><a href="linear-model-3.html#references-1"><i class="fa fa-check"></i><b>12.11</b> References</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="linear-model-4.html"><a href="linear-model-4.html"><i class="fa fa-check"></i><b>13</b> Linear model 4</a>
<ul>
<li class="chapter" data-level="13.1" data-path="linear-model-4.html"><a href="linear-model-4.html#load-packages-and-set-plotting-theme-6"><i class="fa fa-check"></i><b>13.1</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="13.2" data-path="linear-model-4.html"><a href="linear-model-4.html#load-data-sets-2"><i class="fa fa-check"></i><b>13.2</b> Load data sets</a></li>
<li class="chapter" data-level="13.3" data-path="linear-model-4.html"><a href="linear-model-4.html#linear-contrasts"><i class="fa fa-check"></i><b>13.3</b> Linear contrasts</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="linear-model-4.html"><a href="linear-model-4.html#hypothetical-data"><i class="fa fa-check"></i><b>13.3.1</b> Hypothetical data</a></li>
<li class="chapter" data-level="13.3.2" data-path="linear-model-4.html"><a href="linear-model-4.html#visualization-6"><i class="fa fa-check"></i><b>13.3.2</b> Visualization</a></li>
<li class="chapter" data-level="13.3.3" data-path="linear-model-4.html"><a href="linear-model-4.html#post-hoc-tests"><i class="fa fa-check"></i><b>13.3.3</b> Post-hoc tests</a></li>
<li class="chapter" data-level="13.3.4" data-path="linear-model-4.html"><a href="linear-model-4.html#understanding-dummy-coding"><i class="fa fa-check"></i><b>13.3.4</b> Understanding dummy coding</a></li>
<li class="chapter" data-level="13.3.5" data-path="linear-model-4.html"><a href="linear-model-4.html#understanding-effect-coding"><i class="fa fa-check"></i><b>13.3.5</b> Understanding effect coding</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="linear-model-4.html"><a href="linear-model-4.html#session-info-12"><i class="fa fa-check"></i><b>13.4</b> Session info</a></li>
<li class="chapter" data-level="13.5" data-path="linear-model-4.html"><a href="linear-model-4.html#references-2"><i class="fa fa-check"></i><b>13.5</b> References</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="power-analysis.html"><a href="power-analysis.html"><i class="fa fa-check"></i><b>14</b> Power analysis</a>
<ul>
<li class="chapter" data-level="14.1" data-path="power-analysis.html"><a href="power-analysis.html#learning-goals-5"><i class="fa fa-check"></i><b>14.1</b> Learning goals</a></li>
<li class="chapter" data-level="14.2" data-path="power-analysis.html"><a href="power-analysis.html#load-packages-and-set-plotting-theme-7"><i class="fa fa-check"></i><b>14.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="14.3" data-path="power-analysis.html"><a href="power-analysis.html#load-data-sets-3"><i class="fa fa-check"></i><b>14.3</b> Load data sets</a></li>
<li class="chapter" data-level="14.4" data-path="power-analysis.html"><a href="power-analysis.html#decision-making"><i class="fa fa-check"></i><b>14.4</b> Decision-making</a></li>
<li class="chapter" data-level="14.5" data-path="power-analysis.html"><a href="power-analysis.html#effect-sizes"><i class="fa fa-check"></i><b>14.5</b> Effect sizes</a>
<ul>
<li class="chapter" data-level="14.5.1" data-path="power-analysis.html"><a href="power-analysis.html#cohens-d"><i class="fa fa-check"></i><b>14.5.1</b> Cohen’s d</a></li>
</ul></li>
<li class="chapter" data-level="14.6" data-path="power-analysis.html"><a href="power-analysis.html#determining-sample-size"><i class="fa fa-check"></i><b>14.6</b> Determining sample size</a>
<ul>
<li class="chapter" data-level="14.6.1" data-path="power-analysis.html"><a href="power-analysis.html#pwr-package"><i class="fa fa-check"></i><b>14.6.1</b> <code>pwr</code> package</a></li>
<li class="chapter" data-level="14.6.2" data-path="power-analysis.html"><a href="power-analysis.html#power-analysis-via-simulation"><i class="fa fa-check"></i><b>14.6.2</b> Power analysis via simulation</a></li>
</ul></li>
<li class="chapter" data-level="14.7" data-path="power-analysis.html"><a href="power-analysis.html#additional-resources-11"><i class="fa fa-check"></i><b>14.7</b> Additional resources</a>
<ul>
<li class="chapter" data-level="14.7.1" data-path="power-analysis.html"><a href="power-analysis.html#datacamp-6"><i class="fa fa-check"></i><b>14.7.1</b> Datacamp</a></li>
<li class="chapter" data-level="14.7.2" data-path="power-analysis.html"><a href="power-analysis.html#cheatsheets-6"><i class="fa fa-check"></i><b>14.7.2</b> Cheatsheets</a></li>
<li class="chapter" data-level="14.7.3" data-path="power-analysis.html"><a href="power-analysis.html#misc-6"><i class="fa fa-check"></i><b>14.7.3</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="14.8" data-path="power-analysis.html"><a href="power-analysis.html#session-info-13"><i class="fa fa-check"></i><b>14.8</b> Session info</a></li>
<li class="chapter" data-level="14.9" data-path="power-analysis.html"><a href="power-analysis.html#references-3"><i class="fa fa-check"></i><b>14.9</b> References</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="mediation-moderation.html"><a href="mediation-moderation.html"><i class="fa fa-check"></i><b>15</b> Mediation &amp; Moderation</a>
<ul>
<li class="chapter" data-level="15.1" data-path="mediation-moderation.html"><a href="mediation-moderation.html#learning-goals-6"><i class="fa fa-check"></i><b>15.1</b> Learning goals</a></li>
<li class="chapter" data-level="15.2" data-path="mediation-moderation.html"><a href="mediation-moderation.html#recommended-reading"><i class="fa fa-check"></i><b>15.2</b> Recommended reading</a></li>
<li class="chapter" data-level="15.3" data-path="mediation-moderation.html"><a href="mediation-moderation.html#load-packages-and-set-plotting-theme-8"><i class="fa fa-check"></i><b>15.3</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="15.4" data-path="mediation-moderation.html"><a href="mediation-moderation.html#controlling-for-variables"><i class="fa fa-check"></i><b>15.4</b> Controlling for variables</a>
<ul>
<li class="chapter" data-level="15.4.1" data-path="mediation-moderation.html"><a href="mediation-moderation.html#illustration-of-the-d-separation-algorithm"><i class="fa fa-check"></i><b>15.4.1</b> Illustration of the d-separation algorithm</a></li>
<li class="chapter" data-level="15.4.2" data-path="mediation-moderation.html"><a href="mediation-moderation.html#good-controls"><i class="fa fa-check"></i><b>15.4.2</b> Good controls</a></li>
<li class="chapter" data-level="15.4.3" data-path="mediation-moderation.html"><a href="mediation-moderation.html#bad-controls"><i class="fa fa-check"></i><b>15.4.3</b> Bad controls</a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="mediation-moderation.html"><a href="mediation-moderation.html#mediation"><i class="fa fa-check"></i><b>15.5</b> Mediation</a>
<ul>
<li class="chapter" data-level="15.5.1" data-path="mediation-moderation.html"><a href="mediation-moderation.html#generate-data"><i class="fa fa-check"></i><b>15.5.1</b> Generate data</a></li>
<li class="chapter" data-level="15.5.2" data-path="mediation-moderation.html"><a href="mediation-moderation.html#method-1-baron-kennys-1986-indirect-effect-method"><i class="fa fa-check"></i><b>15.5.2</b> Method 1: Baron &amp; Kenny’s (1986) indirect effect method</a></li>
<li class="chapter" data-level="15.5.3" data-path="mediation-moderation.html"><a href="mediation-moderation.html#method-2-sobel-test"><i class="fa fa-check"></i><b>15.5.3</b> Method 2: Sobel Test</a></li>
<li class="chapter" data-level="15.5.4" data-path="mediation-moderation.html"><a href="mediation-moderation.html#method-3-bootstrapping"><i class="fa fa-check"></i><b>15.5.4</b> Method 3: Bootstrapping</a></li>
</ul></li>
<li class="chapter" data-level="15.6" data-path="mediation-moderation.html"><a href="mediation-moderation.html#moderation"><i class="fa fa-check"></i><b>15.6</b> Moderation</a>
<ul>
<li class="chapter" data-level="15.6.1" data-path="mediation-moderation.html"><a href="mediation-moderation.html#generate-data-1"><i class="fa fa-check"></i><b>15.6.1</b> Generate data</a></li>
<li class="chapter" data-level="15.6.2" data-path="mediation-moderation.html"><a href="mediation-moderation.html#moderation-analysis"><i class="fa fa-check"></i><b>15.6.2</b> Moderation analysis</a></li>
</ul></li>
<li class="chapter" data-level="15.7" data-path="mediation-moderation.html"><a href="mediation-moderation.html#additional-resources-12"><i class="fa fa-check"></i><b>15.7</b> Additional resources</a>
<ul>
<li class="chapter" data-level="15.7.1" data-path="mediation-moderation.html"><a href="mediation-moderation.html#books"><i class="fa fa-check"></i><b>15.7.1</b> Books</a></li>
<li class="chapter" data-level="15.7.2" data-path="mediation-moderation.html"><a href="mediation-moderation.html#tutorials-1"><i class="fa fa-check"></i><b>15.7.2</b> Tutorials</a></li>
<li class="chapter" data-level="15.7.3" data-path="mediation-moderation.html"><a href="mediation-moderation.html#misc-7"><i class="fa fa-check"></i><b>15.7.3</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="15.8" data-path="mediation-moderation.html"><a href="mediation-moderation.html#session-info-14"><i class="fa fa-check"></i><b>15.8</b> Session info</a></li>
<li class="chapter" data-level="15.9" data-path="mediation-moderation.html"><a href="mediation-moderation.html#references-4"><i class="fa fa-check"></i><b>15.9</b> References</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="model-comparison.html"><a href="model-comparison.html"><i class="fa fa-check"></i><b>16</b> Model comparison</a>
<ul>
<li class="chapter" data-level="16.1" data-path="model-comparison.html"><a href="model-comparison.html#learning-goals-7"><i class="fa fa-check"></i><b>16.1</b> Learning goals</a></li>
<li class="chapter" data-level="16.2" data-path="model-comparison.html"><a href="model-comparison.html#load-packages-and-set-plotting-theme-9"><i class="fa fa-check"></i><b>16.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="16.3" data-path="model-comparison.html"><a href="model-comparison.html#model-comparison-1"><i class="fa fa-check"></i><b>16.3</b> Model comparison</a>
<ul>
<li class="chapter" data-level="16.3.1" data-path="model-comparison.html"><a href="model-comparison.html#fitting-vs.-predicting"><i class="fa fa-check"></i><b>16.3.1</b> Fitting vs. predicting</a></li>
<li class="chapter" data-level="16.3.2" data-path="model-comparison.html"><a href="model-comparison.html#f-test"><i class="fa fa-check"></i><b>16.3.2</b> F-test</a></li>
<li class="chapter" data-level="16.3.3" data-path="model-comparison.html"><a href="model-comparison.html#cross-validation"><i class="fa fa-check"></i><b>16.3.3</b> Cross-validation</a></li>
<li class="chapter" data-level="16.3.4" data-path="model-comparison.html"><a href="model-comparison.html#bootstrap"><i class="fa fa-check"></i><b>16.3.4</b> Bootstrap</a></li>
<li class="chapter" data-level="16.3.5" data-path="model-comparison.html"><a href="model-comparison.html#aic-and-bic"><i class="fa fa-check"></i><b>16.3.5</b> AIC and BIC</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="model-comparison.html"><a href="model-comparison.html#additional-resources-13"><i class="fa fa-check"></i><b>16.4</b> Additional resources</a>
<ul>
<li class="chapter" data-level="16.4.1" data-path="model-comparison.html"><a href="model-comparison.html#datacamp-course"><i class="fa fa-check"></i><b>16.4.1</b> Datacamp course</a></li>
<li class="chapter" data-level="16.4.2" data-path="model-comparison.html"><a href="model-comparison.html#reading-1"><i class="fa fa-check"></i><b>16.4.2</b> Reading</a></li>
</ul></li>
<li class="chapter" data-level="16.5" data-path="model-comparison.html"><a href="model-comparison.html#session-info-15"><i class="fa fa-check"></i><b>16.5</b> Session info</a></li>
<li class="chapter" data-level="16.6" data-path="model-comparison.html"><a href="model-comparison.html#references-5"><i class="fa fa-check"></i><b>16.6</b> References</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html"><i class="fa fa-check"></i><b>17</b> Linear mixed effects models 1</a>
<ul>
<li class="chapter" data-level="17.1" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html#learning-goals-8"><i class="fa fa-check"></i><b>17.1</b> Learning goals</a></li>
<li class="chapter" data-level="17.2" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html#load-packages-and-set-plotting-theme-10"><i class="fa fa-check"></i><b>17.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="17.3" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html#dependence"><i class="fa fa-check"></i><b>17.3</b> Dependence</a></li>
<li class="chapter" data-level="17.4" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html#additional-resources-14"><i class="fa fa-check"></i><b>17.4</b> Additional resources</a>
<ul>
<li class="chapter" data-level="17.4.1" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html#readings"><i class="fa fa-check"></i><b>17.4.1</b> Readings</a></li>
</ul></li>
<li class="chapter" data-level="17.5" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html#session-info-16"><i class="fa fa-check"></i><b>17.5</b> Session info</a></li>
<li class="chapter" data-level="17.6" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html#references-6"><i class="fa fa-check"></i><b>17.6</b> References</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html"><i class="fa fa-check"></i><b>18</b> Linear mixed effects models 2</a>
<ul>
<li class="chapter" data-level="18.1" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#learning-goals-9"><i class="fa fa-check"></i><b>18.1</b> Learning goals</a></li>
<li class="chapter" data-level="18.2" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#load-packages-and-set-plotting-theme-11"><i class="fa fa-check"></i><b>18.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="18.3" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#a-worked-example"><i class="fa fa-check"></i><b>18.3</b> A worked example</a>
<ul>
<li class="chapter" data-level="18.3.1" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#complete-pooling"><i class="fa fa-check"></i><b>18.3.1</b> Complete pooling</a></li>
<li class="chapter" data-level="18.3.2" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#no-pooling"><i class="fa fa-check"></i><b>18.3.2</b> No pooling</a></li>
<li class="chapter" data-level="18.3.3" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#partial-pooling"><i class="fa fa-check"></i><b>18.3.3</b> Partial pooling</a></li>
<li class="chapter" data-level="18.3.4" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#compare-results"><i class="fa fa-check"></i><b>18.3.4</b> Compare results</a></li>
<li class="chapter" data-level="18.3.5" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#getting-p-values"><i class="fa fa-check"></i><b>18.3.5</b> Getting p-values</a></li>
<li class="chapter" data-level="18.3.6" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#reporting-results"><i class="fa fa-check"></i><b>18.3.6</b> Reporting results</a></li>
<li class="chapter" data-level="18.3.7" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#the-effect-of-outliers"><i class="fa fa-check"></i><b>18.3.7</b> The effect of outliers</a></li>
<li class="chapter" data-level="18.3.8" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#different-slopes"><i class="fa fa-check"></i><b>18.3.8</b> Different slopes</a></li>
<li class="chapter" data-level="18.3.9" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#simpsons-paradox"><i class="fa fa-check"></i><b>18.3.9</b> Simpson’s paradox</a></li>
</ul></li>
<li class="chapter" data-level="18.4" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#additional-resources-15"><i class="fa fa-check"></i><b>18.4</b> Additional resources</a>
<ul>
<li class="chapter" data-level="18.4.1" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#readings-1"><i class="fa fa-check"></i><b>18.4.1</b> Readings</a></li>
</ul></li>
<li class="chapter" data-level="18.5" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#session-info-17"><i class="fa fa-check"></i><b>18.5</b> Session info</a></li>
<li class="chapter" data-level="18.6" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#references-7"><i class="fa fa-check"></i><b>18.6</b> References</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html"><i class="fa fa-check"></i><b>19</b> Linear mixed effects models 3</a>
<ul>
<li class="chapter" data-level="19.1" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#learning-goals-10"><i class="fa fa-check"></i><b>19.1</b> Learning goals</a></li>
<li class="chapter" data-level="19.2" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#load-packages-and-set-plotting-theme-12"><i class="fa fa-check"></i><b>19.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="19.3" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#load-data-sets-4"><i class="fa fa-check"></i><b>19.3</b> Load data sets</a>
<ul>
<li class="chapter" data-level="19.3.1" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#sleep-data"><i class="fa fa-check"></i><b>19.3.1</b> Sleep data</a></li>
<li class="chapter" data-level="19.3.2" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#reasoning-data"><i class="fa fa-check"></i><b>19.3.2</b> Reasoning data</a></li>
<li class="chapter" data-level="19.3.3" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#weight-loss-data"><i class="fa fa-check"></i><b>19.3.3</b> Weight loss data</a></li>
<li class="chapter" data-level="19.3.4" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#politness-data"><i class="fa fa-check"></i><b>19.3.4</b> Politness data</a></li>
</ul></li>
<li class="chapter" data-level="19.4" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#understanding-the-lmer-syntax"><i class="fa fa-check"></i><b>19.4</b> Understanding the lmer() syntax</a></li>
<li class="chapter" data-level="19.5" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#anova-vs.-lmer"><i class="fa fa-check"></i><b>19.5</b> ANOVA vs. Lmer</a>
<ul>
<li class="chapter" data-level="19.5.1" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#between-subjects-anova"><i class="fa fa-check"></i><b>19.5.1</b> Between subjects ANOVA</a></li>
<li class="chapter" data-level="19.5.2" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#repeated-measures-anova"><i class="fa fa-check"></i><b>19.5.2</b> Repeated-measures ANOVA</a></li>
<li class="chapter" data-level="19.5.3" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#mixed-anova"><i class="fa fa-check"></i><b>19.5.3</b> Mixed ANOVA</a></li>
</ul></li>
<li class="chapter" data-level="19.6" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#follow-up-tests-with-emmeans"><i class="fa fa-check"></i><b>19.6</b> Follow-up tests with emmeans</a>
<ul>
<li class="chapter" data-level="19.6.1" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#sleep-study"><i class="fa fa-check"></i><b>19.6.1</b> Sleep study</a></li>
<li class="chapter" data-level="19.6.2" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#weight-loss-study"><i class="fa fa-check"></i><b>19.6.2</b> Weight loss study</a></li>
<li class="chapter" data-level="19.6.3" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#politeness-study"><i class="fa fa-check"></i><b>19.6.3</b> Politeness study</a></li>
</ul></li>
<li class="chapter" data-level="19.7" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#mixtures-of-participants"><i class="fa fa-check"></i><b>19.7</b> Mixtures of participants</a></li>
<li class="chapter" data-level="19.8" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#bootstrapping"><i class="fa fa-check"></i><b>19.8</b> Bootstrapping</a>
<ul>
<li class="chapter" data-level="19.8.1" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#linear-model"><i class="fa fa-check"></i><b>19.8.1</b> Linear model</a></li>
</ul></li>
<li class="chapter" data-level="19.9" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#session-info-18"><i class="fa fa-check"></i><b>19.9</b> Session info</a></li>
<li class="chapter" data-level="19.10" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#references-8"><i class="fa fa-check"></i><b>19.10</b> References</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html"><i class="fa fa-check"></i><b>20</b> Generalized linear model</a>
<ul>
<li class="chapter" data-level="20.1" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#learning-goals-11"><i class="fa fa-check"></i><b>20.1</b> Learning goals</a></li>
<li class="chapter" data-level="20.2" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#load-packages-and-set-plotting-theme-13"><i class="fa fa-check"></i><b>20.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="20.3" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#load-data-set"><i class="fa fa-check"></i><b>20.3</b> Load data set</a></li>
<li class="chapter" data-level="20.4" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#logistic-regression"><i class="fa fa-check"></i><b>20.4</b> Logistic regression</a>
<ul>
<li class="chapter" data-level="20.4.1" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#interpreting-the-parameters"><i class="fa fa-check"></i><b>20.4.1</b> Interpreting the parameters</a></li>
<li class="chapter" data-level="20.4.2" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#binary-predictor"><i class="fa fa-check"></i><b>20.4.2</b> Binary predictor</a></li>
<li class="chapter" data-level="20.4.3" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#continuous-predictor"><i class="fa fa-check"></i><b>20.4.3</b> Continuous predictor</a></li>
<li class="chapter" data-level="20.4.4" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#several-predictors"><i class="fa fa-check"></i><b>20.4.4</b> Several predictors</a></li>
<li class="chapter" data-level="20.4.5" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#using-the-ggeffects-package"><i class="fa fa-check"></i><b>20.4.5</b> Using the “ggeffects” package</a></li>
</ul></li>
<li class="chapter" data-level="20.5" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#simulate-a-logistic-regression"><i class="fa fa-check"></i><b>20.5</b> Simulate a logistic regression</a></li>
<li class="chapter" data-level="20.6" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#testing-hypotheses"><i class="fa fa-check"></i><b>20.6</b> Testing hypotheses</a></li>
<li class="chapter" data-level="20.7" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#logistic-mixed-effects-model"><i class="fa fa-check"></i><b>20.7</b> Logistic mixed effects model</a></li>
<li class="chapter" data-level="20.8" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#additional-information"><i class="fa fa-check"></i><b>20.8</b> Additional information</a>
<ul>
<li class="chapter" data-level="20.8.1" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#datacamp-7"><i class="fa fa-check"></i><b>20.8.1</b> Datacamp</a></li>
</ul></li>
<li class="chapter" data-level="20.9" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#session-info-19"><i class="fa fa-check"></i><b>20.9</b> Session info</a></li>
<li class="chapter" data-level="20.10" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#references-9"><i class="fa fa-check"></i><b>20.10</b> References</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="bayesian-data-analysis.html"><a href="bayesian-data-analysis.html"><i class="fa fa-check"></i><b>21</b> Bayesian data analysis</a>
<ul>
<li class="chapter" data-level="21.1" data-path="bayesian-data-analysis.html"><a href="bayesian-data-analysis.html#learning-goals-12"><i class="fa fa-check"></i><b>21.1</b> Learning goals</a></li>
<li class="chapter" data-level="21.2" data-path="bayesian-data-analysis.html"><a href="bayesian-data-analysis.html#load-packages-and-set-plotting-theme-14"><i class="fa fa-check"></i><b>21.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="21.3" data-path="bayesian-data-analysis.html"><a href="bayesian-data-analysis.html#doing-bayesian-inference-by-hand"><i class="fa fa-check"></i><b>21.3</b> Doing Bayesian inference “by hand”</a>
<ul>
<li class="chapter" data-level="21.3.1" data-path="bayesian-data-analysis.html"><a href="bayesian-data-analysis.html#sequential-updating-based-on-the-beta-distribution"><i class="fa fa-check"></i><b>21.3.1</b> Sequential updating based on the Beta distribution</a></li>
<li class="chapter" data-level="21.3.2" data-path="bayesian-data-analysis.html"><a href="bayesian-data-analysis.html#coin-flip-example"><i class="fa fa-check"></i><b>21.3.2</b> Coin flip example</a></li>
<li class="chapter" data-level="21.3.3" data-path="bayesian-data-analysis.html"><a href="bayesian-data-analysis.html#bayesian-inference-by-discretization"><i class="fa fa-check"></i><b>21.3.3</b> Bayesian inference by discretization</a></li>
</ul></li>
<li class="chapter" data-level="21.4" data-path="bayesian-data-analysis.html"><a href="bayesian-data-analysis.html#doing-bayesian-inference-with-greta"><i class="fa fa-check"></i><b>21.4</b> Doing Bayesian inference with Greta</a>
<ul>
<li class="chapter" data-level="21.4.1" data-path="bayesian-data-analysis.html"><a href="bayesian-data-analysis.html#attitude-data-set"><i class="fa fa-check"></i><b>21.4.1</b> Attitude data set</a></li>
<li class="chapter" data-level="21.4.2" data-path="bayesian-data-analysis.html"><a href="bayesian-data-analysis.html#frequentist-analysis"><i class="fa fa-check"></i><b>21.4.2</b> Frequentist analysis</a></li>
<li class="chapter" data-level="21.4.3" data-path="bayesian-data-analysis.html"><a href="bayesian-data-analysis.html#bayesian-regression"><i class="fa fa-check"></i><b>21.4.3</b> Bayesian regression</a></li>
</ul></li>
<li class="chapter" data-level="21.5" data-path="bayesian-data-analysis.html"><a href="bayesian-data-analysis.html#session-info-20"><i class="fa fa-check"></i><b>21.5</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html"><i class="fa fa-check"></i><b>22</b> Bayesian data analysis 2</a>
<ul>
<li class="chapter" data-level="22.1" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#learning-goals-13"><i class="fa fa-check"></i><b>22.1</b> Learning goals</a></li>
<li class="chapter" data-level="22.2" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#load-packages-and-set-plotting-theme-15"><i class="fa fa-check"></i><b>22.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="22.3" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#load-data-sets-5"><i class="fa fa-check"></i><b>22.3</b> Load data sets</a></li>
<li class="chapter" data-level="22.4" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#poker"><i class="fa fa-check"></i><b>22.4</b> Poker</a>
<ul>
<li class="chapter" data-level="22.4.1" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#visualize-the-data"><i class="fa fa-check"></i><b>22.4.1</b> 1. Visualize the data</a></li>
<li class="chapter" data-level="22.4.2" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#specify-and-fit-the-model"><i class="fa fa-check"></i><b>22.4.2</b> 2. Specify and fit the model</a></li>
<li class="chapter" data-level="22.4.3" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#model-evaluation"><i class="fa fa-check"></i><b>22.4.3</b> 3. Model evaluation</a></li>
<li class="chapter" data-level="22.4.4" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#interpret-the-model-parameters"><i class="fa fa-check"></i><b>22.4.4</b> 4. Interpret the model parameters</a></li>
<li class="chapter" data-level="22.4.5" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#test-specific-hypotheses"><i class="fa fa-check"></i><b>22.4.5</b> 5. Test specific hypotheses</a></li>
</ul></li>
<li class="chapter" data-level="22.5" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#sleep-study-1"><i class="fa fa-check"></i><b>22.5</b> Sleep study</a>
<ul>
<li class="chapter" data-level="22.5.1" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#visualize-the-data-1"><i class="fa fa-check"></i><b>22.5.1</b> 1. Visualize the data</a></li>
<li class="chapter" data-level="22.5.2" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#specify-and-fit-the-model-1"><i class="fa fa-check"></i><b>22.5.2</b> 2. Specify and fit the model</a></li>
<li class="chapter" data-level="22.5.3" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#model-evaluation-1"><i class="fa fa-check"></i><b>22.5.3</b> 3. Model evaluation</a></li>
<li class="chapter" data-level="22.5.4" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#interpret-the-parameters"><i class="fa fa-check"></i><b>22.5.4</b> 4. Interpret the parameters</a></li>
<li class="chapter" data-level="22.5.5" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#test-specific-hypotheses-1"><i class="fa fa-check"></i><b>22.5.5</b> 5. Test specific hypotheses</a></li>
<li class="chapter" data-level="22.5.6" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#report-results"><i class="fa fa-check"></i><b>22.5.6</b> 6. Report results</a></li>
</ul></li>
<li class="chapter" data-level="22.6" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#titanic-study"><i class="fa fa-check"></i><b>22.6</b> Titanic study</a>
<ul>
<li class="chapter" data-level="22.6.1" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#visualize-that-data"><i class="fa fa-check"></i><b>22.6.1</b> 1. Visualize that data</a></li>
<li class="chapter" data-level="22.6.2" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#specify-and-fit-the-model-2"><i class="fa fa-check"></i><b>22.6.2</b> 2. Specify and fit the model</a></li>
<li class="chapter" data-level="22.6.3" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#model-evaluation-2"><i class="fa fa-check"></i><b>22.6.3</b> 3. Model evaluation</a></li>
<li class="chapter" data-level="22.6.4" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#interpret-the-parameters-1"><i class="fa fa-check"></i><b>22.6.4</b> 4. Interpret the parameters</a></li>
<li class="chapter" data-level="22.6.5" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#test-specific-hypotheses-2"><i class="fa fa-check"></i><b>22.6.5</b> 5. Test specific hypotheses</a></li>
<li class="chapter" data-level="22.6.6" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#report-results-1"><i class="fa fa-check"></i><b>22.6.6</b> 6. Report results</a></li>
</ul></li>
<li class="chapter" data-level="22.7" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#politeness-data"><i class="fa fa-check"></i><b>22.7</b> Politeness data</a>
<ul>
<li class="chapter" data-level="22.7.1" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#visualize-the-data-2"><i class="fa fa-check"></i><b>22.7.1</b> 1. Visualize the data</a></li>
<li class="chapter" data-level="22.7.2" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#test-specific-hypotheses-3"><i class="fa fa-check"></i><b>22.7.2</b> 5. Test specific hypotheses</a></li>
</ul></li>
<li class="chapter" data-level="22.8" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#additional-resources-16"><i class="fa fa-check"></i><b>22.8</b> Additional resources</a></li>
<li class="chapter" data-level="22.9" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#session-info-21"><i class="fa fa-check"></i><b>22.9</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html"><i class="fa fa-check"></i><b>23</b> Bayesian data analysis 3</a>
<ul>
<li class="chapter" data-level="23.1" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#learning-goals-14"><i class="fa fa-check"></i><b>23.1</b> Learning goals</a></li>
<li class="chapter" data-level="23.2" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#load-packages-and-set-plotting-theme-16"><i class="fa fa-check"></i><b>23.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="23.3" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#evidence-for-the-null-hypothesis"><i class="fa fa-check"></i><b>23.3</b> Evidence for the null hypothesis</a>
<ul>
<li class="chapter" data-level="23.3.1" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#bayes-factor-1"><i class="fa fa-check"></i><b>23.3.1</b> Bayes factor</a></li>
<li class="chapter" data-level="23.3.2" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#loo"><i class="fa fa-check"></i><b>23.3.2</b> LOO</a></li>
</ul></li>
<li class="chapter" data-level="23.4" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#dealing-with-heteroscedasticity"><i class="fa fa-check"></i><b>23.4</b> Dealing with heteroscedasticity</a>
<ul>
<li class="chapter" data-level="23.4.1" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#visualize-the-data-3"><i class="fa fa-check"></i><b>23.4.1</b> Visualize the data</a></li>
<li class="chapter" data-level="23.4.2" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#frequentist-analysis-4"><i class="fa fa-check"></i><b>23.4.2</b> Frequentist analysis</a></li>
<li class="chapter" data-level="23.4.3" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#bayesian-analysis-3"><i class="fa fa-check"></i><b>23.4.3</b> Bayesian analysis</a></li>
</ul></li>
<li class="chapter" data-level="23.5" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#zero-one-inflated-beta-binomial-model"><i class="fa fa-check"></i><b>23.5</b> Zero-one inflated beta binomial model</a></li>
<li class="chapter" data-level="23.6" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#ordinal-regression"><i class="fa fa-check"></i><b>23.6</b> Ordinal regression</a>
<ul>
<li class="chapter" data-level="23.6.1" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#ordinal-regression-assuming-equal-variance"><i class="fa fa-check"></i><b>23.6.1</b> Ordinal regression (assuming equal variance)</a></li>
<li class="chapter" data-level="23.6.2" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#gaussian-regression-assuming-equal-variance"><i class="fa fa-check"></i><b>23.6.2</b> Gaussian regression (assuming equal variance)</a></li>
<li class="chapter" data-level="23.6.3" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#oridnal-regression-unequal-variance"><i class="fa fa-check"></i><b>23.6.3</b> Oridnal regression (unequal variance)</a></li>
<li class="chapter" data-level="23.6.4" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#gaussian-regression-unequal-variance"><i class="fa fa-check"></i><b>23.6.4</b> Gaussian regression (unequal variance)</a></li>
<li class="chapter" data-level="23.6.5" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#model-comparison-2"><i class="fa fa-check"></i><b>23.6.5</b> Model comparison</a></li>
</ul></li>
<li class="chapter" data-level="23.7" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#additional-resources-17"><i class="fa fa-check"></i><b>23.7</b> Additional resources</a></li>
<li class="chapter" data-level="23.8" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#session-info-22"><i class="fa fa-check"></i><b>23.8</b> Session info</a></li>
<li class="chapter" data-level="" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#references-10"><i class="fa fa-check"></i>References</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="model-assumptions.html"><a href="model-assumptions.html"><i class="fa fa-check"></i><b>24</b> Model assumptions</a>
<ul>
<li class="chapter" data-level="24.1" data-path="model-assumptions.html"><a href="model-assumptions.html#learning-goals-15"><i class="fa fa-check"></i><b>24.1</b> Learning goals</a></li>
<li class="chapter" data-level="24.2" data-path="model-assumptions.html"><a href="model-assumptions.html#load-packages-and-set-plotting-theme-17"><i class="fa fa-check"></i><b>24.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="24.3" data-path="model-assumptions.html"><a href="model-assumptions.html#model-assumptions-and-what-to-do-if-they-are-violated"><i class="fa fa-check"></i><b>24.3</b> Model assumptions and what to do if they are violated</a>
<ul>
<li class="chapter" data-level="24.3.1" data-path="model-assumptions.html"><a href="model-assumptions.html#influential-data-points"><i class="fa fa-check"></i><b>24.3.1</b> Influential data points</a></li>
<li class="chapter" data-level="24.3.2" data-path="model-assumptions.html"><a href="model-assumptions.html#linear-and-additive"><i class="fa fa-check"></i><b>24.3.2</b> Linear and additive</a></li>
<li class="chapter" data-level="24.3.3" data-path="model-assumptions.html"><a href="model-assumptions.html#normally-distributed-residuals"><i class="fa fa-check"></i><b>24.3.3</b> Normally distributed residuals</a></li>
<li class="chapter" data-level="24.3.4" data-path="model-assumptions.html"><a href="model-assumptions.html#non-parametric-tests"><i class="fa fa-check"></i><b>24.3.4</b> Non-parametric tests</a></li>
<li class="chapter" data-level="24.3.5" data-path="model-assumptions.html"><a href="model-assumptions.html#bootstrapping-regressions"><i class="fa fa-check"></i><b>24.3.5</b> Bootstrapping regressions</a></li>
</ul></li>
<li class="chapter" data-level="24.4" data-path="model-assumptions.html"><a href="model-assumptions.html#additional-resources-18"><i class="fa fa-check"></i><b>24.4</b> Additional resources</a></li>
<li class="chapter" data-level="24.5" data-path="model-assumptions.html"><a href="model-assumptions.html#session-info-23"><i class="fa fa-check"></i><b>24.5</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="25" data-path="reporting-statistics.html"><a href="reporting-statistics.html"><i class="fa fa-check"></i><b>25</b> Reporting statistics</a>
<ul>
<li class="chapter" data-level="25.1" data-path="reporting-statistics.html"><a href="reporting-statistics.html#general-advice"><i class="fa fa-check"></i><b>25.1</b> General advice</a>
<ul>
<li class="chapter" data-level="25.1.1" data-path="reporting-statistics.html"><a href="reporting-statistics.html#make-good-figures"><i class="fa fa-check"></i><b>25.1.1</b> Make good figures!</a></li>
<li class="chapter" data-level="25.1.2" data-path="reporting-statistics.html"><a href="reporting-statistics.html#use-statistical-models-to-answer-concrete-research-questions."><i class="fa fa-check"></i><b>25.1.2</b> Use statistical models to answer concrete research questions.</a></li>
<li class="chapter" data-level="25.1.3" data-path="reporting-statistics.html"><a href="reporting-statistics.html#illustrate-the-uncertainty-in-your-statistical-inferences."><i class="fa fa-check"></i><b>25.1.3</b> Illustrate the uncertainty in your statistical inferences.</a></li>
<li class="chapter" data-level="25.1.4" data-path="reporting-statistics.html"><a href="reporting-statistics.html#report-effect-sizes."><i class="fa fa-check"></i><b>25.1.4</b> Report effect sizes.</a></li>
<li class="chapter" data-level="25.1.5" data-path="reporting-statistics.html"><a href="reporting-statistics.html#reporting-statistical-results-using-rmarkdown"><i class="fa fa-check"></i><b>25.1.5</b> Reporting statistical results using RMarkdown</a></li>
</ul></li>
<li class="chapter" data-level="25.2" data-path="reporting-statistics.html"><a href="reporting-statistics.html#some-concrete-example"><i class="fa fa-check"></i><b>25.2</b> Some concrete example</a>
<ul>
<li class="chapter" data-level="25.2.1" data-path="reporting-statistics.html"><a href="reporting-statistics.html#frequentist-statistics"><i class="fa fa-check"></i><b>25.2.1</b> Frequentist statistics</a></li>
</ul></li>
<li class="chapter" data-level="25.3" data-path="reporting-statistics.html"><a href="reporting-statistics.html#session-info-24"><i class="fa fa-check"></i><b>25.3</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="26" data-path="cheatsheets-7.html"><a href="cheatsheets-7.html"><i class="fa fa-check"></i><b>26</b> Cheatsheets</a>
<ul>
<li class="chapter" data-level="26.1" data-path="cheatsheets-7.html"><a href="cheatsheets-7.html#statistics"><i class="fa fa-check"></i><b>26.1</b> Statistics</a></li>
<li class="chapter" data-level="26.2" data-path="cheatsheets-7.html"><a href="cheatsheets-7.html#r"><i class="fa fa-check"></i><b>26.2</b> R</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references-11.html"><a href="references-11.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Psych 252: Statistical Methods for Behavioral and Social Sciences</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="linear-model-3" class="section level1" number="12">
<h1><span class="header-section-number">Chapter 12</span> Linear model 3</h1>
<div id="learning-goals-4" class="section level2" number="12.1">
<h2><span class="header-section-number">12.1</span> Learning goals</h2>
<ul>
<li>Linear model with one multi-level categorical predictor (One-way ANOVA).</li>
<li>Linear model with multiple categorical predictors (N-way ANOVA).
<ul>
<li>dummy-coding vs. effect-coding</li>
<li>planned contrasts</li>
</ul></li>
<li>ANOVA with unbalanced designs</li>
</ul>
</div>
<div id="load-packages-and-set-plotting-theme-5" class="section level2" number="12.2">
<h2><span class="header-section-number">12.2</span> Load packages and set plotting theme</h2>
<div class="sourceCode" id="cb601"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb601-1"><a href="linear-model-3.html#cb601-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;knitr&quot;</span>)      <span class="co"># for knitting RMarkdown </span></span>
<span id="cb601-2"><a href="linear-model-3.html#cb601-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;kableExtra&quot;</span>) <span class="co"># for making nice tables</span></span>
<span id="cb601-3"><a href="linear-model-3.html#cb601-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;janitor&quot;</span>)    <span class="co"># for cleaning column names</span></span>
<span id="cb601-4"><a href="linear-model-3.html#cb601-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;broom&quot;</span>)      <span class="co"># for tidying up linear models </span></span>
<span id="cb601-5"><a href="linear-model-3.html#cb601-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;car&quot;</span>)        <span class="co"># for running ANOVAs</span></span>
<span id="cb601-6"><a href="linear-model-3.html#cb601-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;afex&quot;</span>)       <span class="co"># also for running ANOVAs</span></span>
<span id="cb601-7"><a href="linear-model-3.html#cb601-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;emmeans&quot;</span>)    <span class="co"># for calculating constrasts</span></span>
<span id="cb601-8"><a href="linear-model-3.html#cb601-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;tidyverse&quot;</span>)  <span class="co"># for wrangling, plotting, etc. </span></span></code></pre></div>
<div class="sourceCode" id="cb602"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb602-1"><a href="linear-model-3.html#cb602-1" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_classic</span>() <span class="sc">+</span> <span class="co">#set the theme </span></span>
<span id="cb602-2"><a href="linear-model-3.html#cb602-2" aria-hidden="true" tabindex="-1"></a>            <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>))) <span class="co">#set the default text size</span></span>
<span id="cb602-3"><a href="linear-model-3.html#cb602-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb602-4"><a href="linear-model-3.html#cb602-4" aria-hidden="true" tabindex="-1"></a><span class="co"># these options here change the formatting of how comments are rendered</span></span>
<span id="cb602-5"><a href="linear-model-3.html#cb602-5" aria-hidden="true" tabindex="-1"></a>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">comment =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb602-6"><a href="linear-model-3.html#cb602-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">fig.show =</span> <span class="st">&quot;hold&quot;</span>)</span>
<span id="cb602-7"><a href="linear-model-3.html#cb602-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb602-8"><a href="linear-model-3.html#cb602-8" aria-hidden="true" tabindex="-1"></a><span class="co"># include references for used packages</span></span>
<span id="cb602-9"><a href="linear-model-3.html#cb602-9" aria-hidden="true" tabindex="-1"></a><span class="fu">write_bib</span>(<span class="fu">.packages</span>(), <span class="st">&quot;packages.bib&quot;</span>)</span>
<span id="cb602-10"><a href="linear-model-3.html#cb602-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb602-11"><a href="linear-model-3.html#cb602-11" aria-hidden="true" tabindex="-1"></a><span class="co"># suppress grouping warnings </span></span>
<span id="cb602-12"><a href="linear-model-3.html#cb602-12" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">dplyr.summarise.inform =</span> F)</span></code></pre></div>
</div>
<div id="load-data-sets-1" class="section level2" number="12.3">
<h2><span class="header-section-number">12.3</span> Load data sets</h2>
<div class="sourceCode" id="cb603"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb603-1"><a href="linear-model-3.html#cb603-1" aria-hidden="true" tabindex="-1"></a>df.poker <span class="ot">=</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/poker.csv&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb603-2"><a href="linear-model-3.html#cb603-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">skill =</span> <span class="fu">factor</span>(skill,</span>
<span id="cb603-3"><a href="linear-model-3.html#cb603-3" aria-hidden="true" tabindex="-1"></a>                        <span class="at">levels =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,</span>
<span id="cb603-4"><a href="linear-model-3.html#cb603-4" aria-hidden="true" tabindex="-1"></a>                        <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;expert&quot;</span>, <span class="st">&quot;average&quot;</span>)),</span>
<span id="cb603-5"><a href="linear-model-3.html#cb603-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">skill =</span> <span class="fu">fct_relevel</span>(skill, <span class="st">&quot;average&quot;</span>, <span class="st">&quot;expert&quot;</span>),</span>
<span id="cb603-6"><a href="linear-model-3.html#cb603-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">hand =</span> <span class="fu">factor</span>(hand,</span>
<span id="cb603-7"><a href="linear-model-3.html#cb603-7" aria-hidden="true" tabindex="-1"></a>                       <span class="at">levels =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,</span>
<span id="cb603-8"><a href="linear-model-3.html#cb603-8" aria-hidden="true" tabindex="-1"></a>                       <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;bad&quot;</span>, <span class="st">&quot;neutral&quot;</span>, <span class="st">&quot;good&quot;</span>)),</span>
<span id="cb603-9"><a href="linear-model-3.html#cb603-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">limit =</span> <span class="fu">factor</span>(limit,</span>
<span id="cb603-10"><a href="linear-model-3.html#cb603-10" aria-hidden="true" tabindex="-1"></a>                        <span class="at">levels =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,</span>
<span id="cb603-11"><a href="linear-model-3.html#cb603-11" aria-hidden="true" tabindex="-1"></a>                        <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;fixed&quot;</span>, <span class="st">&quot;none&quot;</span>)),</span>
<span id="cb603-12"><a href="linear-model-3.html#cb603-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">participant =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb603-13"><a href="linear-model-3.html#cb603-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(participant, <span class="fu">everything</span>())</span>
<span id="cb603-14"><a href="linear-model-3.html#cb603-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb603-15"><a href="linear-model-3.html#cb603-15" aria-hidden="true" tabindex="-1"></a>df.poker.unbalanced <span class="ot">=</span> df.poker <span class="sc">%&gt;%</span> </span>
<span id="cb603-16"><a href="linear-model-3.html#cb603-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>participant <span class="sc">%in%</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)</span></code></pre></div>
<p>Selection of the data:</p>
<div class="sourceCode" id="cb604"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb604-1"><a href="linear-model-3.html#cb604-1" aria-hidden="true" tabindex="-1"></a>df.poker <span class="sc">%&gt;%</span> </span>
<span id="cb604-2"><a href="linear-model-3.html#cb604-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(skill, hand, limit) <span class="sc">%&gt;%</span> </span>
<span id="cb604-3"><a href="linear-model-3.html#cb604-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">row_number</span>() <span class="sc">&lt;</span> <span class="dv">3</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb604-4"><a href="linear-model-3.html#cb604-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">10</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb604-5"><a href="linear-model-3.html#cb604-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">digits =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb604-6"><a href="linear-model-3.html#cb604-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="st">&quot;striped&quot;</span>,</span>
<span id="cb604-7"><a href="linear-model-3.html#cb604-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">full_width =</span> F)</span></code></pre></div>
<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
participant
</th>
<th style="text-align:left;">
skill
</th>
<th style="text-align:left;">
hand
</th>
<th style="text-align:left;">
limit
</th>
<th style="text-align:right;">
balance
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
expert
</td>
<td style="text-align:left;">
bad
</td>
<td style="text-align:left;">
fixed
</td>
<td style="text-align:right;">
4.00
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
expert
</td>
<td style="text-align:left;">
bad
</td>
<td style="text-align:left;">
fixed
</td>
<td style="text-align:right;">
5.55
</td>
</tr>
<tr>
<td style="text-align:right;">
26
</td>
<td style="text-align:left;">
expert
</td>
<td style="text-align:left;">
bad
</td>
<td style="text-align:left;">
none
</td>
<td style="text-align:right;">
5.52
</td>
</tr>
<tr>
<td style="text-align:right;">
27
</td>
<td style="text-align:left;">
expert
</td>
<td style="text-align:left;">
bad
</td>
<td style="text-align:left;">
none
</td>
<td style="text-align:right;">
8.28
</td>
</tr>
<tr>
<td style="text-align:right;">
51
</td>
<td style="text-align:left;">
expert
</td>
<td style="text-align:left;">
neutral
</td>
<td style="text-align:left;">
fixed
</td>
<td style="text-align:right;">
11.74
</td>
</tr>
<tr>
<td style="text-align:right;">
52
</td>
<td style="text-align:left;">
expert
</td>
<td style="text-align:left;">
neutral
</td>
<td style="text-align:left;">
fixed
</td>
<td style="text-align:right;">
10.04
</td>
</tr>
<tr>
<td style="text-align:right;">
76
</td>
<td style="text-align:left;">
expert
</td>
<td style="text-align:left;">
neutral
</td>
<td style="text-align:left;">
none
</td>
<td style="text-align:right;">
21.55
</td>
</tr>
<tr>
<td style="text-align:right;">
77
</td>
<td style="text-align:left;">
expert
</td>
<td style="text-align:left;">
neutral
</td>
<td style="text-align:left;">
none
</td>
<td style="text-align:right;">
3.12
</td>
</tr>
<tr>
<td style="text-align:right;">
101
</td>
<td style="text-align:left;">
expert
</td>
<td style="text-align:left;">
good
</td>
<td style="text-align:left;">
fixed
</td>
<td style="text-align:right;">
10.86
</td>
</tr>
<tr>
<td style="text-align:right;">
102
</td>
<td style="text-align:left;">
expert
</td>
<td style="text-align:left;">
good
</td>
<td style="text-align:left;">
fixed
</td>
<td style="text-align:right;">
8.68
</td>
</tr>
</tbody>
</table>
</div>
<div id="one-way-anova" class="section level2" number="12.4">
<h2><span class="header-section-number">12.4</span> One-way ANOVA</h2>
<div id="visualization-4" class="section level3" number="12.4.1">
<h3><span class="header-section-number">12.4.1</span> Visualization</h3>
<div class="sourceCode" id="cb605"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb605-1"><a href="linear-model-3.html#cb605-1" aria-hidden="true" tabindex="-1"></a>df.poker <span class="sc">%&gt;%</span> </span>
<span id="cb605-2"><a href="linear-model-3.html#cb605-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> hand,</span>
<span id="cb605-3"><a href="linear-model-3.html#cb605-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">y =</span> balance,</span>
<span id="cb605-4"><a href="linear-model-3.html#cb605-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">fill =</span> hand)) <span class="sc">+</span> </span>
<span id="cb605-5"><a href="linear-model-3.html#cb605-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>,</span>
<span id="cb605-6"><a href="linear-model-3.html#cb605-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="at">height =</span> <span class="dv">0</span>, <span class="at">width =</span> <span class="fl">0.1</span>)) <span class="sc">+</span> </span>
<span id="cb605-7"><a href="linear-model-3.html#cb605-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> <span class="st">&quot;mean_cl_boot&quot;</span>,</span>
<span id="cb605-8"><a href="linear-model-3.html#cb605-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">geom =</span> <span class="st">&quot;linerange&quot;</span>,</span>
<span id="cb605-9"><a href="linear-model-3.html#cb605-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb605-10"><a href="linear-model-3.html#cb605-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> <span class="st">&quot;mean&quot;</span>,</span>
<span id="cb605-11"><a href="linear-model-3.html#cb605-11" aria-hidden="true" tabindex="-1"></a>               <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>,</span>
<span id="cb605-12"><a href="linear-model-3.html#cb605-12" aria-hidden="true" tabindex="-1"></a>               <span class="at">shape =</span> <span class="dv">21</span>,</span>
<span id="cb605-13"><a href="linear-model-3.html#cb605-13" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb605-14"><a href="linear-model-3.html#cb605-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;final balance (in Euros)&quot;</span>) <span class="sc">+</span> </span>
<span id="cb605-15"><a href="linear-model-3.html#cb605-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;orange&quot;</span>, <span class="st">&quot;green&quot;</span>)) <span class="sc">+</span></span>
<span id="cb605-16"><a href="linear-model-3.html#cb605-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="12-linear_model3_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
</div>
<div id="model-fitting" class="section level3" number="12.4.2">
<h3><span class="header-section-number">12.4.2</span> Model fitting</h3>
<p>We pass the result of the <code>lm()</code> function to <code>anova()</code> to calculate an analysis of variance like so:</p>
<div class="sourceCode" id="cb606"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb606-1"><a href="linear-model-3.html#cb606-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(<span class="at">formula =</span> balance <span class="sc">~</span> hand, </span>
<span id="cb606-2"><a href="linear-model-3.html#cb606-2" aria-hidden="true" tabindex="-1"></a>   <span class="at">data =</span> df.poker) <span class="sc">%&gt;%</span> </span>
<span id="cb606-3"><a href="linear-model-3.html#cb606-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">anova</span>()</span></code></pre></div>
<pre><code>Analysis of Variance Table

Response: balance
           Df Sum Sq Mean Sq F value    Pr(&gt;F)    
hand        2 2559.4  1279.7  75.703 &lt; 2.2e-16 ***
Residuals 297 5020.6    16.9                      
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<div id="hypothesis-test-1" class="section level3" number="12.4.3">
<h3><span class="header-section-number">12.4.3</span> Hypothesis test</h3>
<p>The F-test reported by the ANOVA compares the fitted model with a compact model that only predicts the grand mean:</p>
<div class="sourceCode" id="cb608"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb608-1"><a href="linear-model-3.html#cb608-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fit the models </span></span>
<span id="cb608-2"><a href="linear-model-3.html#cb608-2" aria-hidden="true" tabindex="-1"></a>fit_c <span class="ot">=</span> <span class="fu">lm</span>(<span class="at">formula =</span> balance <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> df.poker)</span>
<span id="cb608-3"><a href="linear-model-3.html#cb608-3" aria-hidden="true" tabindex="-1"></a>fit_a <span class="ot">=</span> <span class="fu">lm</span>(<span class="at">formula =</span> balance <span class="sc">~</span> hand, <span class="at">data =</span> df.poker)</span>
<span id="cb608-4"><a href="linear-model-3.html#cb608-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb608-5"><a href="linear-model-3.html#cb608-5" aria-hidden="true" tabindex="-1"></a><span class="co"># compare via F-test</span></span>
<span id="cb608-6"><a href="linear-model-3.html#cb608-6" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(fit_c, fit_a)</span></code></pre></div>
<pre><code>Analysis of Variance Table

Model 1: balance ~ 1
Model 2: balance ~ hand
  Res.Df    RSS Df Sum of Sq      F    Pr(&gt;F)    
1    299 7580.0                                  
2    297 5020.6  2    2559.4 75.703 &lt; 2.2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<div id="visualize-the-models-predictions" class="section level3" number="12.4.4">
<h3><span class="header-section-number">12.4.4</span> Visualize the model’s predictions</h3>
<p>Here is the model prediction of the compact model:</p>
<div class="sourceCode" id="cb610"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb610-1"><a href="linear-model-3.html#cb610-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb610-2"><a href="linear-model-3.html#cb610-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb610-3"><a href="linear-model-3.html#cb610-3" aria-hidden="true" tabindex="-1"></a>df.plot <span class="ot">=</span> df.poker <span class="sc">%&gt;%</span> </span>
<span id="cb610-4"><a href="linear-model-3.html#cb610-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">hand_jitter =</span> <span class="dv">1</span> <span class="sc">+</span> <span class="fu">runif</span>(<span class="fu">n</span>(), <span class="at">min =</span> <span class="sc">-</span><span class="fl">0.25</span>, <span class="at">max =</span> <span class="fl">0.25</span>))</span>
<span id="cb610-5"><a href="linear-model-3.html#cb610-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb610-6"><a href="linear-model-3.html#cb610-6" aria-hidden="true" tabindex="-1"></a>df.augment <span class="ot">=</span> fit_c <span class="sc">%&gt;%</span> </span>
<span id="cb610-7"><a href="linear-model-3.html#cb610-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">augment</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb610-8"><a href="linear-model-3.html#cb610-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb610-9"><a href="linear-model-3.html#cb610-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(df.plot <span class="sc">%&gt;%</span> </span>
<span id="cb610-10"><a href="linear-model-3.html#cb610-10" aria-hidden="true" tabindex="-1"></a>              <span class="fu">select</span>(hand, hand_jitter))</span>
<span id="cb610-11"><a href="linear-model-3.html#cb610-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb610-12"><a href="linear-model-3.html#cb610-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df.plot, </span>
<span id="cb610-13"><a href="linear-model-3.html#cb610-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> hand_jitter,</span>
<span id="cb610-14"><a href="linear-model-3.html#cb610-14" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> balance,</span>
<span id="cb610-15"><a href="linear-model-3.html#cb610-15" aria-hidden="true" tabindex="-1"></a>                     <span class="at">fill =</span> hand)) <span class="sc">+</span> </span>
<span id="cb610-16"><a href="linear-model-3.html#cb610-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">mean</span>(df.poker<span class="sc">$</span>balance)) <span class="sc">+</span></span>
<span id="cb610-17"><a href="linear-model-3.html#cb610-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb610-18"><a href="linear-model-3.html#cb610-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> df.augment,</span>
<span id="cb610-19"><a href="linear-model-3.html#cb610-19" aria-hidden="true" tabindex="-1"></a>               <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">xend =</span> hand_jitter,</span>
<span id="cb610-20"><a href="linear-model-3.html#cb610-20" aria-hidden="true" tabindex="-1"></a>                             <span class="at">yend =</span> fitted),</span>
<span id="cb610-21"><a href="linear-model-3.html#cb610-21" aria-hidden="true" tabindex="-1"></a>               <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb610-22"><a href="linear-model-3.html#cb610-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;balance&quot;</span>) <span class="sc">+</span> </span>
<span id="cb610-23"><a href="linear-model-3.html#cb610-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb610-24"><a href="linear-model-3.html#cb610-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb610-25"><a href="linear-model-3.html#cb610-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="12-linear_model3_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<blockquote>
<p>Note that since we have a categorical variable here, we don’t really have a continuous x-axis. I’ve just jittered the values so it’s easier to show the residuals.</p>
</blockquote>
<p>And here is the prediction of the augmented model (which predicts different means for each group).</p>
<div class="sourceCode" id="cb611"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb611-1"><a href="linear-model-3.html#cb611-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb611-2"><a href="linear-model-3.html#cb611-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb611-3"><a href="linear-model-3.html#cb611-3" aria-hidden="true" tabindex="-1"></a>df.plot <span class="ot">=</span> df.poker <span class="sc">%&gt;%</span> </span>
<span id="cb611-4"><a href="linear-model-3.html#cb611-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">hand_jitter =</span> hand <span class="sc">%&gt;%</span> <span class="fu">as.numeric</span>(),</span>
<span id="cb611-5"><a href="linear-model-3.html#cb611-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">hand_jitter =</span> hand_jitter <span class="sc">+</span> <span class="fu">runif</span>(<span class="fu">n</span>(), <span class="at">min =</span> <span class="sc">-</span><span class="fl">0.4</span>, <span class="at">max =</span> <span class="fl">0.4</span>))</span>
<span id="cb611-6"><a href="linear-model-3.html#cb611-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb611-7"><a href="linear-model-3.html#cb611-7" aria-hidden="true" tabindex="-1"></a>df.tidy <span class="ot">=</span> fit_a <span class="sc">%&gt;%</span> </span>
<span id="cb611-8"><a href="linear-model-3.html#cb611-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb611-9"><a href="linear-model-3.html#cb611-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">where</span>(is.numeric)) <span class="sc">%&gt;%</span> </span>
<span id="cb611-10"><a href="linear-model-3.html#cb611-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="at">.fns =</span> <span class="sc">~</span> <span class="fu">round</span>(., <span class="at">digits =</span> <span class="dv">2</span>)))</span>
<span id="cb611-11"><a href="linear-model-3.html#cb611-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb611-12"><a href="linear-model-3.html#cb611-12" aria-hidden="true" tabindex="-1"></a>df.augment <span class="ot">=</span> fit_a <span class="sc">%&gt;%</span> </span>
<span id="cb611-13"><a href="linear-model-3.html#cb611-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">augment</span>() <span class="sc">%&gt;%</span></span>
<span id="cb611-14"><a href="linear-model-3.html#cb611-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb611-15"><a href="linear-model-3.html#cb611-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(df.plot <span class="sc">%&gt;%</span> </span>
<span id="cb611-16"><a href="linear-model-3.html#cb611-16" aria-hidden="true" tabindex="-1"></a>              <span class="fu">select</span>(hand_jitter))</span>
<span id="cb611-17"><a href="linear-model-3.html#cb611-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb611-18"><a href="linear-model-3.html#cb611-18" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df.plot,</span>
<span id="cb611-19"><a href="linear-model-3.html#cb611-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> hand_jitter,</span>
<span id="cb611-20"><a href="linear-model-3.html#cb611-20" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> balance,</span>
<span id="cb611-21"><a href="linear-model-3.html#cb611-21" aria-hidden="true" tabindex="-1"></a>                     <span class="at">color =</span> hand)) <span class="sc">+</span> </span>
<span id="cb611-22"><a href="linear-model-3.html#cb611-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb611-23"><a href="linear-model-3.html#cb611-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> <span class="cn">NULL</span>,</span>
<span id="cb611-24"><a href="linear-model-3.html#cb611-24" aria-hidden="true" tabindex="-1"></a>               <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="fl">0.6</span>,</span>
<span id="cb611-25"><a href="linear-model-3.html#cb611-25" aria-hidden="true" tabindex="-1"></a>                             <span class="at">xend =</span> <span class="fl">1.4</span>,</span>
<span id="cb611-26"><a href="linear-model-3.html#cb611-26" aria-hidden="true" tabindex="-1"></a>                             <span class="at">y =</span> df.tidy<span class="sc">$</span>estimate[<span class="dv">1</span>],</span>
<span id="cb611-27"><a href="linear-model-3.html#cb611-27" aria-hidden="true" tabindex="-1"></a>                             <span class="at">yend =</span> df.tidy<span class="sc">$</span>estimate[<span class="dv">1</span>]),</span>
<span id="cb611-28"><a href="linear-model-3.html#cb611-28" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb611-29"><a href="linear-model-3.html#cb611-29" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb611-30"><a href="linear-model-3.html#cb611-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> <span class="cn">NULL</span>,</span>
<span id="cb611-31"><a href="linear-model-3.html#cb611-31" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">x =</span> <span class="fl">1.6</span>,</span>
<span id="cb611-32"><a href="linear-model-3.html#cb611-32" aria-hidden="true" tabindex="-1"></a>                   <span class="at">xend =</span> <span class="fl">2.4</span>,</span>
<span id="cb611-33"><a href="linear-model-3.html#cb611-33" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> df.tidy<span class="sc">$</span>estimate[<span class="dv">1</span>] <span class="sc">+</span> df.tidy<span class="sc">$</span>estimate[<span class="dv">2</span>],</span>
<span id="cb611-34"><a href="linear-model-3.html#cb611-34" aria-hidden="true" tabindex="-1"></a>                   <span class="at">yend =</span> df.tidy<span class="sc">$</span>estimate[<span class="dv">1</span>] <span class="sc">+</span> df.tidy<span class="sc">$</span>estimate[<span class="dv">2</span>]),</span>
<span id="cb611-35"><a href="linear-model-3.html#cb611-35" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">&quot;orange&quot;</span>,</span>
<span id="cb611-36"><a href="linear-model-3.html#cb611-36" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb611-37"><a href="linear-model-3.html#cb611-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> <span class="cn">NULL</span>,</span>
<span id="cb611-38"><a href="linear-model-3.html#cb611-38" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">x =</span> <span class="fl">2.6</span>,</span>
<span id="cb611-39"><a href="linear-model-3.html#cb611-39" aria-hidden="true" tabindex="-1"></a>                   <span class="at">xend =</span> <span class="fl">3.4</span>,</span>
<span id="cb611-40"><a href="linear-model-3.html#cb611-40" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> df.tidy<span class="sc">$</span>estimate[<span class="dv">1</span>] <span class="sc">+</span> df.tidy<span class="sc">$</span>estimate[<span class="dv">3</span>],</span>
<span id="cb611-41"><a href="linear-model-3.html#cb611-41" aria-hidden="true" tabindex="-1"></a>                   <span class="at">yend =</span> df.tidy<span class="sc">$</span>estimate[<span class="dv">1</span>] <span class="sc">+</span> df.tidy<span class="sc">$</span>estimate[<span class="dv">3</span>]),</span>
<span id="cb611-42"><a href="linear-model-3.html#cb611-42" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">&quot;green&quot;</span>,</span>
<span id="cb611-43"><a href="linear-model-3.html#cb611-43" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb611-44"><a href="linear-model-3.html#cb611-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> df.augment,</span>
<span id="cb611-45"><a href="linear-model-3.html#cb611-45" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">xend =</span> hand_jitter,</span>
<span id="cb611-46"><a href="linear-model-3.html#cb611-46" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> balance,</span>
<span id="cb611-47"><a href="linear-model-3.html#cb611-47" aria-hidden="true" tabindex="-1"></a>                   <span class="at">yend =</span> fitted),</span>
<span id="cb611-48"><a href="linear-model-3.html#cb611-48" aria-hidden="true" tabindex="-1"></a>               <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb611-49"><a href="linear-model-3.html#cb611-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;balance&quot;</span>) <span class="sc">+</span> </span>
<span id="cb611-50"><a href="linear-model-3.html#cb611-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;orange&quot;</span>, <span class="st">&quot;green&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb611-51"><a href="linear-model-3.html#cb611-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;bad&quot;</span>, <span class="st">&quot;neutral&quot;</span>, <span class="st">&quot;good&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb611-52"><a href="linear-model-3.html#cb611-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb611-53"><a href="linear-model-3.html#cb611-53" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="12-linear_model3_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<p>The vertical lines illustrate the residual sum of squares.</p>
<p>We can illustrate the model sum of squares like so:</p>
<div class="sourceCode" id="cb612"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb612-1"><a href="linear-model-3.html#cb612-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb612-2"><a href="linear-model-3.html#cb612-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb612-3"><a href="linear-model-3.html#cb612-3" aria-hidden="true" tabindex="-1"></a>df.plot <span class="ot">=</span> df.poker <span class="sc">%&gt;%</span> </span>
<span id="cb612-4"><a href="linear-model-3.html#cb612-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">hand_jitter =</span> hand <span class="sc">%&gt;%</span> <span class="fu">as.numeric</span>(),</span>
<span id="cb612-5"><a href="linear-model-3.html#cb612-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">hand_jitter =</span> hand_jitter <span class="sc">+</span> <span class="fu">runif</span>(<span class="fu">n</span>(), <span class="at">min =</span> <span class="sc">-</span><span class="fl">0.4</span>, <span class="at">max =</span> <span class="fl">0.4</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb612-6"><a href="linear-model-3.html#cb612-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(hand) <span class="sc">%&gt;%</span> </span>
<span id="cb612-7"><a href="linear-model-3.html#cb612-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">mean_group =</span> <span class="fu">mean</span>(balance)) <span class="sc">%&gt;%</span> </span>
<span id="cb612-8"><a href="linear-model-3.html#cb612-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb612-9"><a href="linear-model-3.html#cb612-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">mean_grand =</span> <span class="fu">mean</span>(balance))</span>
<span id="cb612-10"><a href="linear-model-3.html#cb612-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb612-11"><a href="linear-model-3.html#cb612-11" aria-hidden="true" tabindex="-1"></a>df.means <span class="ot">=</span> df.poker <span class="sc">%&gt;%</span> </span>
<span id="cb612-12"><a href="linear-model-3.html#cb612-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(hand) <span class="sc">%&gt;%</span> </span>
<span id="cb612-13"><a href="linear-model-3.html#cb612-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean =</span> <span class="fu">mean</span>(balance)) <span class="sc">%&gt;%</span> </span>
<span id="cb612-14"><a href="linear-model-3.html#cb612-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> hand, </span>
<span id="cb612-15"><a href="linear-model-3.html#cb612-15" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_from =</span> mean)</span>
<span id="cb612-16"><a href="linear-model-3.html#cb612-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb612-17"><a href="linear-model-3.html#cb612-17" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df.plot,</span>
<span id="cb612-18"><a href="linear-model-3.html#cb612-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> hand_jitter,</span>
<span id="cb612-19"><a href="linear-model-3.html#cb612-19" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> mean_group,</span>
<span id="cb612-20"><a href="linear-model-3.html#cb612-20" aria-hidden="true" tabindex="-1"></a>                     <span class="at">color =</span> hand)) <span class="sc">+</span> </span>
<span id="cb612-21"><a href="linear-model-3.html#cb612-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb612-22"><a href="linear-model-3.html#cb612-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> <span class="cn">NULL</span>,</span>
<span id="cb612-23"><a href="linear-model-3.html#cb612-23" aria-hidden="true" tabindex="-1"></a>               <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="fl">0.6</span>,</span>
<span id="cb612-24"><a href="linear-model-3.html#cb612-24" aria-hidden="true" tabindex="-1"></a>                             <span class="at">xend =</span> <span class="fl">1.4</span>,</span>
<span id="cb612-25"><a href="linear-model-3.html#cb612-25" aria-hidden="true" tabindex="-1"></a>                             <span class="at">y =</span> df.means<span class="sc">$</span>bad,</span>
<span id="cb612-26"><a href="linear-model-3.html#cb612-26" aria-hidden="true" tabindex="-1"></a>                             <span class="at">yend =</span> df.means<span class="sc">$</span>bad),</span>
<span id="cb612-27"><a href="linear-model-3.html#cb612-27" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb612-28"><a href="linear-model-3.html#cb612-28" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb612-29"><a href="linear-model-3.html#cb612-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> <span class="cn">NULL</span>,</span>
<span id="cb612-30"><a href="linear-model-3.html#cb612-30" aria-hidden="true" tabindex="-1"></a>               <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="fl">1.6</span>,</span>
<span id="cb612-31"><a href="linear-model-3.html#cb612-31" aria-hidden="true" tabindex="-1"></a>                             <span class="at">xend =</span> <span class="fl">2.4</span>,</span>
<span id="cb612-32"><a href="linear-model-3.html#cb612-32" aria-hidden="true" tabindex="-1"></a>                             <span class="at">y =</span> df.means<span class="sc">$</span>neutral,</span>
<span id="cb612-33"><a href="linear-model-3.html#cb612-33" aria-hidden="true" tabindex="-1"></a>                             <span class="at">yend =</span> df.means<span class="sc">$</span>neutral),</span>
<span id="cb612-34"><a href="linear-model-3.html#cb612-34" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">&quot;orange&quot;</span>,</span>
<span id="cb612-35"><a href="linear-model-3.html#cb612-35" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb612-36"><a href="linear-model-3.html#cb612-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> <span class="cn">NULL</span>,</span>
<span id="cb612-37"><a href="linear-model-3.html#cb612-37" aria-hidden="true" tabindex="-1"></a>               <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="fl">2.6</span>,</span>
<span id="cb612-38"><a href="linear-model-3.html#cb612-38" aria-hidden="true" tabindex="-1"></a>                             <span class="at">xend =</span> <span class="fl">3.4</span>,</span>
<span id="cb612-39"><a href="linear-model-3.html#cb612-39" aria-hidden="true" tabindex="-1"></a>                             <span class="at">y =</span> df.means<span class="sc">$</span>good,</span>
<span id="cb612-40"><a href="linear-model-3.html#cb612-40" aria-hidden="true" tabindex="-1"></a>                             <span class="at">yend =</span> df.means<span class="sc">$</span>good),</span>
<span id="cb612-41"><a href="linear-model-3.html#cb612-41" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">&quot;green&quot;</span>,</span>
<span id="cb612-42"><a href="linear-model-3.html#cb612-42" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb612-43"><a href="linear-model-3.html#cb612-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">xend =</span> hand_jitter,</span>
<span id="cb612-44"><a href="linear-model-3.html#cb612-44" aria-hidden="true" tabindex="-1"></a>                             <span class="at">y =</span> mean_group,</span>
<span id="cb612-45"><a href="linear-model-3.html#cb612-45" aria-hidden="true" tabindex="-1"></a>                             <span class="at">yend =</span> mean_grand),</span>
<span id="cb612-46"><a href="linear-model-3.html#cb612-46" aria-hidden="true" tabindex="-1"></a>               <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb612-47"><a href="linear-model-3.html#cb612-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">mean</span>(df.poker<span class="sc">$</span>balance),</span>
<span id="cb612-48"><a href="linear-model-3.html#cb612-48" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb612-49"><a href="linear-model-3.html#cb612-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;balance&quot;</span>) <span class="sc">+</span> </span>
<span id="cb612-50"><a href="linear-model-3.html#cb612-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;orange&quot;</span>, <span class="st">&quot;green&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb612-51"><a href="linear-model-3.html#cb612-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;bad&quot;</span>, <span class="st">&quot;neutral&quot;</span>, <span class="st">&quot;good&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb612-52"><a href="linear-model-3.html#cb612-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">20</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">20</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">25</span>)) <span class="sc">+</span> </span>
<span id="cb612-53"><a href="linear-model-3.html#cb612-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb612-54"><a href="linear-model-3.html#cb612-54" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="12-linear_model3_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<p>This captures the variance in the data that is accounted for by the <code>hand</code> variable.</p>
<p>Just for kicks, let’s calculate our cherished proportion of reduction in error PRE:</p>
<div class="sourceCode" id="cb613"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb613-1"><a href="linear-model-3.html#cb613-1" aria-hidden="true" tabindex="-1"></a>df.c <span class="ot">=</span> fit_c <span class="sc">%&gt;%</span> </span>
<span id="cb613-2"><a href="linear-model-3.html#cb613-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">augment</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb613-3"><a href="linear-model-3.html#cb613-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb613-4"><a href="linear-model-3.html#cb613-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">sse =</span> <span class="fu">sum</span>(resid<span class="sc">^</span><span class="dv">2</span>) <span class="sc">%&gt;%</span> round)</span>
<span id="cb613-5"><a href="linear-model-3.html#cb613-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb613-6"><a href="linear-model-3.html#cb613-6" aria-hidden="true" tabindex="-1"></a>df.a <span class="ot">=</span> fit_a <span class="sc">%&gt;%</span> </span>
<span id="cb613-7"><a href="linear-model-3.html#cb613-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">augment</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb613-8"><a href="linear-model-3.html#cb613-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb613-9"><a href="linear-model-3.html#cb613-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">sse =</span> <span class="fu">sum</span>(resid<span class="sc">^</span><span class="dv">2</span>) <span class="sc">%&gt;%</span> round)</span>
<span id="cb613-10"><a href="linear-model-3.html#cb613-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb613-11"><a href="linear-model-3.html#cb613-11" aria-hidden="true" tabindex="-1"></a>pre <span class="ot">=</span> <span class="dv">1</span> <span class="sc">-</span> df.a<span class="sc">$</span>sse<span class="sc">/</span>df.c<span class="sc">$</span>sse</span>
<span id="cb613-12"><a href="linear-model-3.html#cb613-12" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(pre <span class="sc">%&gt;%</span> <span class="fu">round</span>(<span class="dv">2</span>))</span></code></pre></div>
<pre><code>[1] 0.34</code></pre>
<p>Note that this is the same as the <span class="math inline">\(R^2\)</span> for the augmented model:</p>
<div class="sourceCode" id="cb615"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb615-1"><a href="linear-model-3.html#cb615-1" aria-hidden="true" tabindex="-1"></a>fit_a <span class="sc">%&gt;%</span> </span>
<span id="cb615-2"><a href="linear-model-3.html#cb615-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code></pre></div>
<pre><code>
Call:
lm(formula = balance ~ hand, data = df.poker)

Residuals:
     Min       1Q   Median       3Q      Max 
-12.9264  -2.5902  -0.0115   2.6573  15.2834 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   5.9415     0.4111  14.451  &lt; 2e-16 ***
handneutral   4.4051     0.5815   7.576 4.55e-13 ***
handgood      7.0849     0.5815  12.185  &lt; 2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 4.111 on 297 degrees of freedom
Multiple R-squared:  0.3377,    Adjusted R-squared:  0.3332 
F-statistic:  75.7 on 2 and 297 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div id="dummy-coding-1" class="section level3" number="12.4.5">
<h3><span class="header-section-number">12.4.5</span> Dummy coding</h3>
<p>Let’s check that we understand how dummy-coding works for a variable with more than 2 levels:</p>
<div class="sourceCode" id="cb617"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb617-1"><a href="linear-model-3.html#cb617-1" aria-hidden="true" tabindex="-1"></a><span class="co"># dummy code the hand variable</span></span>
<span id="cb617-2"><a href="linear-model-3.html#cb617-2" aria-hidden="true" tabindex="-1"></a>df.poker <span class="ot">=</span> df.poker <span class="sc">%&gt;%</span> </span>
<span id="cb617-3"><a href="linear-model-3.html#cb617-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">hand_neutral =</span> <span class="fu">ifelse</span>(hand <span class="sc">==</span> <span class="st">&quot;neutral&quot;</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb617-4"><a href="linear-model-3.html#cb617-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">hand_good =</span> <span class="fu">ifelse</span>(hand <span class="sc">==</span> <span class="st">&quot;good&quot;</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb617-5"><a href="linear-model-3.html#cb617-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb617-6"><a href="linear-model-3.html#cb617-6" aria-hidden="true" tabindex="-1"></a><span class="co"># show the dummy coded variables </span></span>
<span id="cb617-7"><a href="linear-model-3.html#cb617-7" aria-hidden="true" tabindex="-1"></a>df.poker <span class="sc">%&gt;%</span> </span>
<span id="cb617-8"><a href="linear-model-3.html#cb617-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(participant, <span class="fu">contains</span>(<span class="st">&quot;hand&quot;</span>), balance) <span class="sc">%&gt;%</span> </span>
<span id="cb617-9"><a href="linear-model-3.html#cb617-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(hand) <span class="sc">%&gt;%</span> </span>
<span id="cb617-10"><a href="linear-model-3.html#cb617-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">top_n</span>(<span class="dv">3</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb617-11"><a href="linear-model-3.html#cb617-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">10</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb617-12"><a href="linear-model-3.html#cb617-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">digits =</span> <span class="dv">3</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb617-13"><a href="linear-model-3.html#cb617-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="st">&quot;striped&quot;</span>,</span>
<span id="cb617-14"><a href="linear-model-3.html#cb617-14" aria-hidden="true" tabindex="-1"></a>              <span class="at">full_width =</span> F)</span></code></pre></div>
<pre><code>Selecting by balance</code></pre>
<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
participant
</th>
<th style="text-align:left;">
hand
</th>
<th style="text-align:right;">
hand_neutral
</th>
<th style="text-align:right;">
hand_good
</th>
<th style="text-align:right;">
balance
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
31
</td>
<td style="text-align:left;">
bad
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
12.22
</td>
</tr>
<tr>
<td style="text-align:right;">
46
</td>
<td style="text-align:left;">
bad
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
12.06
</td>
</tr>
<tr>
<td style="text-align:right;">
50
</td>
<td style="text-align:left;">
bad
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
16.68
</td>
</tr>
<tr>
<td style="text-align:right;">
76
</td>
<td style="text-align:left;">
neutral
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
21.55
</td>
</tr>
<tr>
<td style="text-align:right;">
87
</td>
<td style="text-align:left;">
neutral
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
20.89
</td>
</tr>
<tr>
<td style="text-align:right;">
89
</td>
<td style="text-align:left;">
neutral
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
25.63
</td>
</tr>
<tr>
<td style="text-align:right;">
127
</td>
<td style="text-align:left;">
good
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
26.99
</td>
</tr>
<tr>
<td style="text-align:right;">
129
</td>
<td style="text-align:left;">
good
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
21.36
</td>
</tr>
<tr>
<td style="text-align:right;">
283
</td>
<td style="text-align:left;">
good
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
22.48
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb619"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb619-1"><a href="linear-model-3.html#cb619-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fit the model</span></span>
<span id="cb619-2"><a href="linear-model-3.html#cb619-2" aria-hidden="true" tabindex="-1"></a>fit.tmp <span class="ot">=</span> <span class="fu">lm</span>(balance <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> hand_neutral <span class="sc">+</span> hand_good, df.poker)</span>
<span id="cb619-3"><a href="linear-model-3.html#cb619-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb619-4"><a href="linear-model-3.html#cb619-4" aria-hidden="true" tabindex="-1"></a><span class="co"># show the model summary </span></span>
<span id="cb619-5"><a href="linear-model-3.html#cb619-5" aria-hidden="true" tabindex="-1"></a>fit.tmp <span class="sc">%&gt;%</span> </span>
<span id="cb619-6"><a href="linear-model-3.html#cb619-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code></pre></div>
<pre><code>
Call:
lm(formula = balance ~ 1 + hand_neutral + hand_good, data = df.poker)

Residuals:
     Min       1Q   Median       3Q      Max 
-12.9264  -2.5902  -0.0115   2.6573  15.2834 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)    5.9415     0.4111  14.451  &lt; 2e-16 ***
hand_neutral   4.4051     0.5815   7.576 4.55e-13 ***
hand_good      7.0849     0.5815  12.185  &lt; 2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 4.111 on 297 degrees of freedom
Multiple R-squared:  0.3377,    Adjusted R-squared:  0.3332 
F-statistic:  75.7 on 2 and 297 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>Here, I’ve directly put the dummy-coded variables as predictors into the <code>lm()</code>. We get the same model as if we used the <code>hand</code> variable instead.</p>
</div>
<div id="follow-up-questions" class="section level3" number="12.4.6">
<h3><span class="header-section-number">12.4.6</span> Follow up questions</h3>
<p>Here are some follow up questions we may ask about the data.</p>
<p>Are bad hands different from neutral hands?</p>
<div class="sourceCode" id="cb621"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb621-1"><a href="linear-model-3.html#cb621-1" aria-hidden="true" tabindex="-1"></a>df.poker <span class="sc">%&gt;%</span> </span>
<span id="cb621-2"><a href="linear-model-3.html#cb621-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(hand <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;bad&quot;</span>, <span class="st">&quot;neutral&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb621-3"><a href="linear-model-3.html#cb621-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lm</span>(<span class="at">formula =</span> balance <span class="sc">~</span> hand, </span>
<span id="cb621-4"><a href="linear-model-3.html#cb621-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">data =</span> .) <span class="sc">%&gt;%</span> </span>
<span id="cb621-5"><a href="linear-model-3.html#cb621-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code></pre></div>
<pre><code>
Call:
lm(formula = balance ~ hand, data = .)

Residuals:
    Min      1Q  Median      3Q     Max 
-9.9566 -2.5078 -0.2365  2.4410 15.2834 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   5.9415     0.3816  15.570  &lt; 2e-16 ***
handneutral   4.4051     0.5397   8.163 3.76e-14 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 3.816 on 198 degrees of freedom
Multiple R-squared:  0.2518,    Adjusted R-squared:  0.248 
F-statistic: 66.63 on 1 and 198 DF,  p-value: 3.758e-14</code></pre>
<p>Are neutral hands different from good hands?</p>
<div class="sourceCode" id="cb623"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb623-1"><a href="linear-model-3.html#cb623-1" aria-hidden="true" tabindex="-1"></a>df.poker <span class="sc">%&gt;%</span> </span>
<span id="cb623-2"><a href="linear-model-3.html#cb623-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(hand <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;neutral&quot;</span>, <span class="st">&quot;good&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb623-3"><a href="linear-model-3.html#cb623-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lm</span>(<span class="at">formula =</span> balance <span class="sc">~</span> hand, </span>
<span id="cb623-4"><a href="linear-model-3.html#cb623-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">data =</span> .) <span class="sc">%&gt;%</span> </span>
<span id="cb623-5"><a href="linear-model-3.html#cb623-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code></pre></div>
<pre><code>
Call:
lm(formula = balance ~ hand, data = .)

Residuals:
     Min       1Q   Median       3Q      Max 
-12.9264  -2.7141   0.2585   2.7184  15.2834 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  10.3466     0.4448   23.26  &lt; 2e-16 ***
handgood      2.6798     0.6291    4.26 3.16e-05 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 4.448 on 198 degrees of freedom
Multiple R-squared:  0.08396,   Adjusted R-squared:  0.07933 
F-statistic: 18.15 on 1 and 198 DF,  p-value: 3.158e-05</code></pre>
<p>Doing the same thing by recoding our hand factor and taking “neutral” to be the reference category:</p>
<div class="sourceCode" id="cb625"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb625-1"><a href="linear-model-3.html#cb625-1" aria-hidden="true" tabindex="-1"></a>df.poker <span class="sc">%&gt;%</span> </span>
<span id="cb625-2"><a href="linear-model-3.html#cb625-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">hand =</span> <span class="fu">fct_relevel</span>(hand, <span class="st">&quot;neutral&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb625-3"><a href="linear-model-3.html#cb625-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lm</span>(<span class="at">formula =</span> balance <span class="sc">~</span> hand,</span>
<span id="cb625-4"><a href="linear-model-3.html#cb625-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">data =</span> .) <span class="sc">%&gt;%</span> </span>
<span id="cb625-5"><a href="linear-model-3.html#cb625-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code></pre></div>
<pre><code>
Call:
lm(formula = balance ~ hand, data = .)

Residuals:
     Min       1Q   Median       3Q      Max 
-12.9264  -2.5902  -0.0115   2.6573  15.2834 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  10.3466     0.4111  25.165  &lt; 2e-16 ***
handbad      -4.4051     0.5815  -7.576 4.55e-13 ***
handgood      2.6798     0.5815   4.609 6.02e-06 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 4.111 on 297 degrees of freedom
Multiple R-squared:  0.3377,    Adjusted R-squared:  0.3332 
F-statistic:  75.7 on 2 and 297 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div id="variance-decomposition" class="section level3" number="12.4.7">
<h3><span class="header-section-number">12.4.7</span> Variance decomposition</h3>
<p>Let’s first run the model</p>
<div class="sourceCode" id="cb627"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb627-1"><a href="linear-model-3.html#cb627-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">=</span> <span class="fu">lm</span>(<span class="at">formula =</span> balance <span class="sc">~</span> hand, </span>
<span id="cb627-2"><a href="linear-model-3.html#cb627-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">data =</span> df.poker)</span>
<span id="cb627-3"><a href="linear-model-3.html#cb627-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb627-4"><a href="linear-model-3.html#cb627-4" aria-hidden="true" tabindex="-1"></a>fit <span class="sc">%&gt;%</span></span>
<span id="cb627-5"><a href="linear-model-3.html#cb627-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">anova</span>()</span></code></pre></div>
<pre><code>Analysis of Variance Table

Response: balance
           Df Sum Sq Mean Sq F value    Pr(&gt;F)    
hand        2 2559.4  1279.7  75.703 &lt; 2.2e-16 ***
Residuals 297 5020.6    16.9                      
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div id="calculate-sums-of-squares" class="section level4" number="12.4.7.1">
<h4><span class="header-section-number">12.4.7.1</span> Calculate sums of squares</h4>
<p>And then let’s make sure that we understand how the variance is broken down:</p>
<div class="sourceCode" id="cb629"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb629-1"><a href="linear-model-3.html#cb629-1" aria-hidden="true" tabindex="-1"></a>df.poker <span class="sc">%&gt;%</span> </span>
<span id="cb629-2"><a href="linear-model-3.html#cb629-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">mean_grand =</span> <span class="fu">mean</span>(balance)) <span class="sc">%&gt;%</span> </span>
<span id="cb629-3"><a href="linear-model-3.html#cb629-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(hand) <span class="sc">%&gt;%</span> </span>
<span id="cb629-4"><a href="linear-model-3.html#cb629-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">mean_group =</span> <span class="fu">mean</span>(balance)) <span class="sc">%&gt;%</span> </span>
<span id="cb629-5"><a href="linear-model-3.html#cb629-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb629-6"><a href="linear-model-3.html#cb629-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">variance_total =</span> <span class="fu">sum</span>((balance <span class="sc">-</span> mean_grand)<span class="sc">^</span><span class="dv">2</span>),</span>
<span id="cb629-7"><a href="linear-model-3.html#cb629-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">variance_model =</span> <span class="fu">sum</span>((mean_group <span class="sc">-</span> mean_grand)<span class="sc">^</span><span class="dv">2</span>),</span>
<span id="cb629-8"><a href="linear-model-3.html#cb629-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">variance_residual =</span> variance_total <span class="sc">-</span> variance_model)</span></code></pre></div>
<pre><code># A tibble: 1 x 3
  variance_total variance_model variance_residual
           &lt;dbl&gt;          &lt;dbl&gt;             &lt;dbl&gt;
1          7580.          2559.             5021.</code></pre>
</div>
<div id="visualize-model-predictions" class="section level4" number="12.4.7.2">
<h4><span class="header-section-number">12.4.7.2</span> Visualize model predictions</h4>
<div id="total-variance" class="section level5" number="12.4.7.2.1">
<h5><span class="header-section-number">12.4.7.2.1</span> Total variance</h5>
<div class="sourceCode" id="cb631"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb631-1"><a href="linear-model-3.html#cb631-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb631-2"><a href="linear-model-3.html#cb631-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb631-3"><a href="linear-model-3.html#cb631-3" aria-hidden="true" tabindex="-1"></a>fit_c <span class="ot">=</span> <span class="fu">lm</span>(<span class="at">formula =</span> balance <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb631-4"><a href="linear-model-3.html#cb631-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">data =</span> df.poker)</span>
<span id="cb631-5"><a href="linear-model-3.html#cb631-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb631-6"><a href="linear-model-3.html#cb631-6" aria-hidden="true" tabindex="-1"></a>df.plot <span class="ot">=</span> df.poker <span class="sc">%&gt;%</span> </span>
<span id="cb631-7"><a href="linear-model-3.html#cb631-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">hand_jitter =</span> <span class="dv">1</span> <span class="sc">+</span> <span class="fu">runif</span>(<span class="fu">n</span>(), <span class="at">min =</span> <span class="sc">-</span><span class="fl">0.25</span>, <span class="at">max =</span> <span class="fl">0.25</span>))</span>
<span id="cb631-8"><a href="linear-model-3.html#cb631-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb631-9"><a href="linear-model-3.html#cb631-9" aria-hidden="true" tabindex="-1"></a>df.augment <span class="ot">=</span> fit_c <span class="sc">%&gt;%</span> </span>
<span id="cb631-10"><a href="linear-model-3.html#cb631-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">augment</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb631-11"><a href="linear-model-3.html#cb631-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb631-12"><a href="linear-model-3.html#cb631-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(df.plot <span class="sc">%&gt;%</span> <span class="fu">select</span>(hand, hand_jitter))</span>
<span id="cb631-13"><a href="linear-model-3.html#cb631-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb631-14"><a href="linear-model-3.html#cb631-14" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df.plot, </span>
<span id="cb631-15"><a href="linear-model-3.html#cb631-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> hand_jitter,</span>
<span id="cb631-16"><a href="linear-model-3.html#cb631-16" aria-hidden="true" tabindex="-1"></a>                       <span class="at">y =</span> balance,</span>
<span id="cb631-17"><a href="linear-model-3.html#cb631-17" aria-hidden="true" tabindex="-1"></a>                       <span class="at">fill =</span> hand)) <span class="sc">+</span> </span>
<span id="cb631-18"><a href="linear-model-3.html#cb631-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">mean</span>(df.poker<span class="sc">$</span>balance)) <span class="sc">+</span></span>
<span id="cb631-19"><a href="linear-model-3.html#cb631-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb631-20"><a href="linear-model-3.html#cb631-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> df.augment,</span>
<span id="cb631-21"><a href="linear-model-3.html#cb631-21" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">xend =</span> hand_jitter,</span>
<span id="cb631-22"><a href="linear-model-3.html#cb631-22" aria-hidden="true" tabindex="-1"></a>                   <span class="at">yend =</span> fitted),</span>
<span id="cb631-23"><a href="linear-model-3.html#cb631-23" aria-hidden="true" tabindex="-1"></a>               <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb631-24"><a href="linear-model-3.html#cb631-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;balance&quot;</span>) <span class="sc">+</span> </span>
<span id="cb631-25"><a href="linear-model-3.html#cb631-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb631-26"><a href="linear-model-3.html#cb631-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb631-27"><a href="linear-model-3.html#cb631-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="12-linear_model3_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
</div>
<div id="model-variance" class="section level5" number="12.4.7.2.2">
<h5><span class="header-section-number">12.4.7.2.2</span> Model variance</h5>
<div class="sourceCode" id="cb632"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb632-1"><a href="linear-model-3.html#cb632-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb632-2"><a href="linear-model-3.html#cb632-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb632-3"><a href="linear-model-3.html#cb632-3" aria-hidden="true" tabindex="-1"></a>df.plot <span class="ot">=</span> df.poker <span class="sc">%&gt;%</span> </span>
<span id="cb632-4"><a href="linear-model-3.html#cb632-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">hand_jitter =</span> hand <span class="sc">%&gt;%</span> <span class="fu">as.numeric</span>(),</span>
<span id="cb632-5"><a href="linear-model-3.html#cb632-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">hand_jitter =</span> hand_jitter <span class="sc">+</span> <span class="fu">runif</span>(<span class="fu">n</span>(), <span class="at">min =</span> <span class="sc">-</span><span class="fl">0.4</span>, <span class="at">max =</span> <span class="fl">0.4</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb632-6"><a href="linear-model-3.html#cb632-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(hand) <span class="sc">%&gt;%</span> </span>
<span id="cb632-7"><a href="linear-model-3.html#cb632-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">mean_group =</span> <span class="fu">mean</span>(balance)) <span class="sc">%&gt;%</span> </span>
<span id="cb632-8"><a href="linear-model-3.html#cb632-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb632-9"><a href="linear-model-3.html#cb632-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">mean_grand =</span> <span class="fu">mean</span>(balance))</span>
<span id="cb632-10"><a href="linear-model-3.html#cb632-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb632-11"><a href="linear-model-3.html#cb632-11" aria-hidden="true" tabindex="-1"></a>df.means <span class="ot">=</span> df.poker <span class="sc">%&gt;%</span> </span>
<span id="cb632-12"><a href="linear-model-3.html#cb632-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(hand) <span class="sc">%&gt;%</span> </span>
<span id="cb632-13"><a href="linear-model-3.html#cb632-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean =</span> <span class="fu">mean</span>(balance)) <span class="sc">%&gt;%</span> </span>
<span id="cb632-14"><a href="linear-model-3.html#cb632-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> hand,</span>
<span id="cb632-15"><a href="linear-model-3.html#cb632-15" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_from =</span> mean)</span>
<span id="cb632-16"><a href="linear-model-3.html#cb632-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb632-17"><a href="linear-model-3.html#cb632-17" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df.plot,</span>
<span id="cb632-18"><a href="linear-model-3.html#cb632-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> hand_jitter,</span>
<span id="cb632-19"><a href="linear-model-3.html#cb632-19" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> mean_group,</span>
<span id="cb632-20"><a href="linear-model-3.html#cb632-20" aria-hidden="true" tabindex="-1"></a>                     <span class="at">color =</span> hand)) <span class="sc">+</span> </span>
<span id="cb632-21"><a href="linear-model-3.html#cb632-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb632-22"><a href="linear-model-3.html#cb632-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> <span class="cn">NULL</span>,</span>
<span id="cb632-23"><a href="linear-model-3.html#cb632-23" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">x =</span> <span class="fl">0.6</span>,</span>
<span id="cb632-24"><a href="linear-model-3.html#cb632-24" aria-hidden="true" tabindex="-1"></a>                   <span class="at">xend =</span> <span class="fl">1.4</span>,</span>
<span id="cb632-25"><a href="linear-model-3.html#cb632-25" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> df.means<span class="sc">$</span>bad,</span>
<span id="cb632-26"><a href="linear-model-3.html#cb632-26" aria-hidden="true" tabindex="-1"></a>                   <span class="at">yend =</span> df.means<span class="sc">$</span>bad),</span>
<span id="cb632-27"><a href="linear-model-3.html#cb632-27" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb632-28"><a href="linear-model-3.html#cb632-28" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb632-29"><a href="linear-model-3.html#cb632-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> <span class="cn">NULL</span>,</span>
<span id="cb632-30"><a href="linear-model-3.html#cb632-30" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">x =</span> <span class="fl">1.6</span>,</span>
<span id="cb632-31"><a href="linear-model-3.html#cb632-31" aria-hidden="true" tabindex="-1"></a>                   <span class="at">xend =</span> <span class="fl">2.4</span>,</span>
<span id="cb632-32"><a href="linear-model-3.html#cb632-32" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> df.means<span class="sc">$</span>neutral,</span>
<span id="cb632-33"><a href="linear-model-3.html#cb632-33" aria-hidden="true" tabindex="-1"></a>                   <span class="at">yend =</span> df.means<span class="sc">$</span>neutral),</span>
<span id="cb632-34"><a href="linear-model-3.html#cb632-34" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">&quot;orange&quot;</span>,</span>
<span id="cb632-35"><a href="linear-model-3.html#cb632-35" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb632-36"><a href="linear-model-3.html#cb632-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> <span class="cn">NULL</span>,</span>
<span id="cb632-37"><a href="linear-model-3.html#cb632-37" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">x =</span> <span class="fl">2.6</span>,</span>
<span id="cb632-38"><a href="linear-model-3.html#cb632-38" aria-hidden="true" tabindex="-1"></a>                   <span class="at">xend =</span> <span class="fl">3.4</span>,</span>
<span id="cb632-39"><a href="linear-model-3.html#cb632-39" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> df.means<span class="sc">$</span>good,</span>
<span id="cb632-40"><a href="linear-model-3.html#cb632-40" aria-hidden="true" tabindex="-1"></a>                   <span class="at">yend =</span> df.means<span class="sc">$</span>good),</span>
<span id="cb632-41"><a href="linear-model-3.html#cb632-41" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">&quot;green&quot;</span>,</span>
<span id="cb632-42"><a href="linear-model-3.html#cb632-42" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb632-43"><a href="linear-model-3.html#cb632-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">xend =</span> hand_jitter,</span>
<span id="cb632-44"><a href="linear-model-3.html#cb632-44" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> mean_group,</span>
<span id="cb632-45"><a href="linear-model-3.html#cb632-45" aria-hidden="true" tabindex="-1"></a>                   <span class="at">yend =</span> mean_grand),</span>
<span id="cb632-46"><a href="linear-model-3.html#cb632-46" aria-hidden="true" tabindex="-1"></a>               <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb632-47"><a href="linear-model-3.html#cb632-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">mean</span>(df.poker<span class="sc">$</span>balance),</span>
<span id="cb632-48"><a href="linear-model-3.html#cb632-48" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb632-49"><a href="linear-model-3.html#cb632-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;balance&quot;</span>) <span class="sc">+</span> </span>
<span id="cb632-50"><a href="linear-model-3.html#cb632-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;orange&quot;</span>, <span class="st">&quot;green&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb632-51"><a href="linear-model-3.html#cb632-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;bad&quot;</span>, <span class="st">&quot;neutral&quot;</span>, <span class="st">&quot;good&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb632-52"><a href="linear-model-3.html#cb632-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">20</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">20</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">25</span>)) <span class="sc">+</span> </span>
<span id="cb632-53"><a href="linear-model-3.html#cb632-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb632-54"><a href="linear-model-3.html#cb632-54" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="12-linear_model3_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
</div>
<div id="residual-variance" class="section level5" number="12.4.7.2.3">
<h5><span class="header-section-number">12.4.7.2.3</span> Residual variance</h5>
<div class="sourceCode" id="cb633"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb633-1"><a href="linear-model-3.html#cb633-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb633-2"><a href="linear-model-3.html#cb633-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb633-3"><a href="linear-model-3.html#cb633-3" aria-hidden="true" tabindex="-1"></a>fit_a <span class="ot">=</span> <span class="fu">lm</span>(<span class="at">formula =</span> balance <span class="sc">~</span> hand,</span>
<span id="cb633-4"><a href="linear-model-3.html#cb633-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">data =</span> df.poker)</span>
<span id="cb633-5"><a href="linear-model-3.html#cb633-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb633-6"><a href="linear-model-3.html#cb633-6" aria-hidden="true" tabindex="-1"></a>df.plot <span class="ot">=</span> df.poker <span class="sc">%&gt;%</span> </span>
<span id="cb633-7"><a href="linear-model-3.html#cb633-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">hand_jitter =</span> hand <span class="sc">%&gt;%</span> <span class="fu">as.numeric</span>(),</span>
<span id="cb633-8"><a href="linear-model-3.html#cb633-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">hand_jitter =</span> hand_jitter <span class="sc">+</span> <span class="fu">runif</span>(<span class="fu">n</span>(), <span class="at">min =</span> <span class="sc">-</span><span class="fl">0.4</span>, <span class="at">max =</span> <span class="fl">0.4</span>))</span>
<span id="cb633-9"><a href="linear-model-3.html#cb633-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb633-10"><a href="linear-model-3.html#cb633-10" aria-hidden="true" tabindex="-1"></a>df.tidy <span class="ot">=</span> fit_a <span class="sc">%&gt;%</span> </span>
<span id="cb633-11"><a href="linear-model-3.html#cb633-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb633-12"><a href="linear-model-3.html#cb633-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">where</span>(is.numeric)) <span class="sc">%&gt;%</span> </span>
<span id="cb633-13"><a href="linear-model-3.html#cb633-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="at">.fns =</span> <span class="sc">~</span> <span class="fu">round</span>(., <span class="at">digits =</span> <span class="dv">2</span>)))</span>
<span id="cb633-14"><a href="linear-model-3.html#cb633-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb633-15"><a href="linear-model-3.html#cb633-15" aria-hidden="true" tabindex="-1"></a>df.augment <span class="ot">=</span> fit_a <span class="sc">%&gt;%</span> </span>
<span id="cb633-16"><a href="linear-model-3.html#cb633-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">augment</span>() <span class="sc">%&gt;%</span></span>
<span id="cb633-17"><a href="linear-model-3.html#cb633-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb633-18"><a href="linear-model-3.html#cb633-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(df.plot <span class="sc">%&gt;%</span> <span class="fu">select</span>(hand_jitter))</span>
<span id="cb633-19"><a href="linear-model-3.html#cb633-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb633-20"><a href="linear-model-3.html#cb633-20" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df.plot,</span>
<span id="cb633-21"><a href="linear-model-3.html#cb633-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> hand_jitter,</span>
<span id="cb633-22"><a href="linear-model-3.html#cb633-22" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> balance,</span>
<span id="cb633-23"><a href="linear-model-3.html#cb633-23" aria-hidden="true" tabindex="-1"></a>                     <span class="at">color =</span> hand)) <span class="sc">+</span> </span>
<span id="cb633-24"><a href="linear-model-3.html#cb633-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb633-25"><a href="linear-model-3.html#cb633-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> <span class="cn">NULL</span>,</span>
<span id="cb633-26"><a href="linear-model-3.html#cb633-26" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">x =</span> <span class="fl">0.6</span>,</span>
<span id="cb633-27"><a href="linear-model-3.html#cb633-27" aria-hidden="true" tabindex="-1"></a>                   <span class="at">xend =</span> <span class="fl">1.4</span>,</span>
<span id="cb633-28"><a href="linear-model-3.html#cb633-28" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> df.tidy<span class="sc">$</span>estimate[<span class="dv">1</span>],</span>
<span id="cb633-29"><a href="linear-model-3.html#cb633-29" aria-hidden="true" tabindex="-1"></a>                   <span class="at">yend =</span> df.tidy<span class="sc">$</span>estimate[<span class="dv">1</span>]),</span>
<span id="cb633-30"><a href="linear-model-3.html#cb633-30" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb633-31"><a href="linear-model-3.html#cb633-31" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb633-32"><a href="linear-model-3.html#cb633-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> <span class="cn">NULL</span>,</span>
<span id="cb633-33"><a href="linear-model-3.html#cb633-33" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">x =</span> <span class="fl">1.6</span>,</span>
<span id="cb633-34"><a href="linear-model-3.html#cb633-34" aria-hidden="true" tabindex="-1"></a>                   <span class="at">xend =</span> <span class="fl">2.4</span>,</span>
<span id="cb633-35"><a href="linear-model-3.html#cb633-35" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> df.tidy<span class="sc">$</span>estimate[<span class="dv">1</span>] <span class="sc">+</span> df.tidy<span class="sc">$</span>estimate[<span class="dv">2</span>],</span>
<span id="cb633-36"><a href="linear-model-3.html#cb633-36" aria-hidden="true" tabindex="-1"></a>                   <span class="at">yend =</span> df.tidy<span class="sc">$</span>estimate[<span class="dv">1</span>] <span class="sc">+</span> df.tidy<span class="sc">$</span>estimate[<span class="dv">2</span>]),</span>
<span id="cb633-37"><a href="linear-model-3.html#cb633-37" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">&quot;orange&quot;</span>,</span>
<span id="cb633-38"><a href="linear-model-3.html#cb633-38" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb633-39"><a href="linear-model-3.html#cb633-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> <span class="cn">NULL</span>,</span>
<span id="cb633-40"><a href="linear-model-3.html#cb633-40" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">x =</span> <span class="fl">2.6</span>,</span>
<span id="cb633-41"><a href="linear-model-3.html#cb633-41" aria-hidden="true" tabindex="-1"></a>                   <span class="at">xend =</span> <span class="fl">3.4</span>,</span>
<span id="cb633-42"><a href="linear-model-3.html#cb633-42" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> df.tidy<span class="sc">$</span>estimate[<span class="dv">1</span>] <span class="sc">+</span> df.tidy<span class="sc">$</span>estimate[<span class="dv">3</span>],</span>
<span id="cb633-43"><a href="linear-model-3.html#cb633-43" aria-hidden="true" tabindex="-1"></a>                   <span class="at">yend =</span> df.tidy<span class="sc">$</span>estimate[<span class="dv">1</span>] <span class="sc">+</span> df.tidy<span class="sc">$</span>estimate[<span class="dv">3</span>]),</span>
<span id="cb633-44"><a href="linear-model-3.html#cb633-44" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">&quot;green&quot;</span>,</span>
<span id="cb633-45"><a href="linear-model-3.html#cb633-45" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb633-46"><a href="linear-model-3.html#cb633-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> df.augment,</span>
<span id="cb633-47"><a href="linear-model-3.html#cb633-47" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">xend =</span> hand_jitter,</span>
<span id="cb633-48"><a href="linear-model-3.html#cb633-48" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> balance,</span>
<span id="cb633-49"><a href="linear-model-3.html#cb633-49" aria-hidden="true" tabindex="-1"></a>                   <span class="at">yend =</span> fitted),</span>
<span id="cb633-50"><a href="linear-model-3.html#cb633-50" aria-hidden="true" tabindex="-1"></a>               <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb633-51"><a href="linear-model-3.html#cb633-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;balance&quot;</span>) <span class="sc">+</span> </span>
<span id="cb633-52"><a href="linear-model-3.html#cb633-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;orange&quot;</span>, <span class="st">&quot;green&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb633-53"><a href="linear-model-3.html#cb633-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;bad&quot;</span>, <span class="st">&quot;neutral&quot;</span>, <span class="st">&quot;good&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb633-54"><a href="linear-model-3.html#cb633-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb633-55"><a href="linear-model-3.html#cb633-55" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="12-linear_model3_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
</div>
</div>
</div>
</div>
<div id="two-way-anova" class="section level2" number="12.5">
<h2><span class="header-section-number">12.5</span> Two-way ANOVA</h2>
<p>Now let’s take a look at a case where we have multiple categorical predictors.</p>
<div id="visualization-5" class="section level3" number="12.5.1">
<h3><span class="header-section-number">12.5.1</span> Visualization</h3>
<p>Let’s look at the overall effect of skill:</p>
<div class="sourceCode" id="cb634"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb634-1"><a href="linear-model-3.html#cb634-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df.poker,</span>
<span id="cb634-2"><a href="linear-model-3.html#cb634-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> skill,</span>
<span id="cb634-3"><a href="linear-model-3.html#cb634-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> balance)) <span class="sc">+</span></span>
<span id="cb634-4"><a href="linear-model-3.html#cb634-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="at">width =</span> <span class="fl">0.2</span>,</span>
<span id="cb634-5"><a href="linear-model-3.html#cb634-5" aria-hidden="true" tabindex="-1"></a>                                             <span class="at">height =</span> <span class="dv">0</span>),</span>
<span id="cb634-6"><a href="linear-model-3.html#cb634-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span> </span>
<span id="cb634-7"><a href="linear-model-3.html#cb634-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> <span class="st">&quot;mean_cl_boot&quot;</span>,</span>
<span id="cb634-8"><a href="linear-model-3.html#cb634-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">geom =</span> <span class="st">&quot;linerange&quot;</span>,</span>
<span id="cb634-9"><a href="linear-model-3.html#cb634-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb634-10"><a href="linear-model-3.html#cb634-10" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.9</span>)) <span class="sc">+</span> </span>
<span id="cb634-11"><a href="linear-model-3.html#cb634-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> <span class="st">&quot;mean&quot;</span>,</span>
<span id="cb634-12"><a href="linear-model-3.html#cb634-12" aria-hidden="true" tabindex="-1"></a>               <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>,</span>
<span id="cb634-13"><a href="linear-model-3.html#cb634-13" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb634-14"><a href="linear-model-3.html#cb634-14" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.9</span>),</span>
<span id="cb634-15"><a href="linear-model-3.html#cb634-15" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">shape =</span> skill),</span>
<span id="cb634-16"><a href="linear-model-3.html#cb634-16" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">3</span>,</span>
<span id="cb634-17"><a href="linear-model-3.html#cb634-17" aria-hidden="true" tabindex="-1"></a>               <span class="at">fill =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb634-18"><a href="linear-model-3.html#cb634-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">22</span>)) <span class="sc">+</span></span>
<span id="cb634-19"><a href="linear-model-3.html#cb634-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">shape =</span> F)</span></code></pre></div>
<p><img src="12-linear_model3_files/figure-html/unnamed-chunk-22-1.png" width="672" /></p>
<p>And now let’s take a look at the means for the full the 3 (hand) x 2 (skill) design:</p>
<div class="sourceCode" id="cb635"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb635-1"><a href="linear-model-3.html#cb635-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df.poker,</span>
<span id="cb635-2"><a href="linear-model-3.html#cb635-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> hand,</span>
<span id="cb635-3"><a href="linear-model-3.html#cb635-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> balance,</span>
<span id="cb635-4"><a href="linear-model-3.html#cb635-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">group =</span> skill,</span>
<span id="cb635-5"><a href="linear-model-3.html#cb635-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">fill =</span> hand)) <span class="sc">+</span></span>
<span id="cb635-6"><a href="linear-model-3.html#cb635-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="fu">position_jitterdodge</span>(<span class="at">jitter.width =</span> <span class="fl">0.3</span>,</span>
<span id="cb635-7"><a href="linear-model-3.html#cb635-7" aria-hidden="true" tabindex="-1"></a>                                             <span class="at">jitter.height =</span> <span class="dv">0</span>,</span>
<span id="cb635-8"><a href="linear-model-3.html#cb635-8" aria-hidden="true" tabindex="-1"></a>                                             <span class="at">dodge.width =</span> <span class="fl">0.9</span>),</span>
<span id="cb635-9"><a href="linear-model-3.html#cb635-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span> </span>
<span id="cb635-10"><a href="linear-model-3.html#cb635-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> <span class="st">&quot;mean_cl_boot&quot;</span>,</span>
<span id="cb635-11"><a href="linear-model-3.html#cb635-11" aria-hidden="true" tabindex="-1"></a>               <span class="at">geom =</span> <span class="st">&quot;linerange&quot;</span>,</span>
<span id="cb635-12"><a href="linear-model-3.html#cb635-12" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb635-13"><a href="linear-model-3.html#cb635-13" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.9</span>)) <span class="sc">+</span> </span>
<span id="cb635-14"><a href="linear-model-3.html#cb635-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> <span class="st">&quot;mean&quot;</span>,</span>
<span id="cb635-15"><a href="linear-model-3.html#cb635-15" aria-hidden="true" tabindex="-1"></a>               <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>,</span>
<span id="cb635-16"><a href="linear-model-3.html#cb635-16" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">shape =</span> skill),</span>
<span id="cb635-17"><a href="linear-model-3.html#cb635-17" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb635-18"><a href="linear-model-3.html#cb635-18" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.9</span>),</span>
<span id="cb635-19"><a href="linear-model-3.html#cb635-19" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb635-20"><a href="linear-model-3.html#cb635-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;orange&quot;</span>, <span class="st">&quot;green&quot;</span>)) <span class="sc">+</span></span>
<span id="cb635-21"><a href="linear-model-3.html#cb635-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">22</span>)) <span class="sc">+</span></span>
<span id="cb635-22"><a href="linear-model-3.html#cb635-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> F)</span></code></pre></div>
<p><img src="12-linear_model3_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
</div>
<div id="model-fitting-1" class="section level3" number="12.5.2">
<h3><span class="header-section-number">12.5.2</span> Model fitting</h3>
<p>For N-way ANOVAs, we need to be careful about what sums of squares we are using. The standard (based on the SPSS output) is to use type III sums of squares. We set this up in the following way:</p>
<div class="sourceCode" id="cb636"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb636-1"><a href="linear-model-3.html#cb636-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(<span class="at">formula =</span> balance <span class="sc">~</span> hand <span class="sc">*</span> skill,</span>
<span id="cb636-2"><a href="linear-model-3.html#cb636-2" aria-hidden="true" tabindex="-1"></a>   <span class="at">data =</span> df.poker,</span>
<span id="cb636-3"><a href="linear-model-3.html#cb636-3" aria-hidden="true" tabindex="-1"></a>   <span class="at">contrasts =</span> <span class="fu">list</span>(<span class="at">hand =</span> <span class="st">&quot;contr.sum&quot;</span>,</span>
<span id="cb636-4"><a href="linear-model-3.html#cb636-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">skill =</span> <span class="st">&quot;contr.sum&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb636-5"><a href="linear-model-3.html#cb636-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Anova</span>(<span class="at">type =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>Anova Table (Type III tests)

Response: balance
             Sum Sq  Df   F value    Pr(&gt;F)    
(Intercept) 28644.7   1 1772.1137 &lt; 2.2e-16 ***
hand         2559.4   2   79.1692 &lt; 2.2e-16 ***
skill          39.3   1    2.4344 0.1197776    
hand:skill    229.0   2    7.0830 0.0009901 ***
Residuals    4752.3 294                        
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>So, we fit our linear model, but set the contrasts to “contr.sum” (which yields effect coding instead of dummy coding), and then specify the desired type of sums of squares in the <code>Anova()</code> function call.</p>
<p>Alternatively, we could use the <code>afex</code> package and specify the ANOVA like so:</p>
<div class="sourceCode" id="cb638"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb638-1"><a href="linear-model-3.html#cb638-1" aria-hidden="true" tabindex="-1"></a><span class="fu">aov_ez</span>(<span class="at">id =</span> <span class="st">&quot;participant&quot;</span>,</span>
<span id="cb638-2"><a href="linear-model-3.html#cb638-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">dv =</span> <span class="st">&quot;balance&quot;</span>,</span>
<span id="cb638-3"><a href="linear-model-3.html#cb638-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">data =</span> df.poker,</span>
<span id="cb638-4"><a href="linear-model-3.html#cb638-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">between =</span> <span class="fu">c</span>(<span class="st">&quot;hand&quot;</span>, <span class="st">&quot;skill&quot;</span>)</span>
<span id="cb638-5"><a href="linear-model-3.html#cb638-5" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>Contrasts set to contr.sum for the following variables: hand, skill</code></pre>
<pre><code>Anova Table (Type 3 tests)

Response: balance
      Effect     df   MSE         F  ges p.value
1       hand 2, 294 16.16 79.17 *** .350   &lt;.001
2      skill 1, 294 16.16      2.43 .008    .120
3 hand:skill 2, 294 16.16  7.08 *** .046   &lt;.001
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;+&#39; 0.1 &#39; &#39; 1</code></pre>
<p>The <code>afex</code> package uses effect coding and type 3 sums of squares by default.</p>
</div>
<div id="interpreting-interactions" class="section level3" number="12.5.3">
<h3><span class="header-section-number">12.5.3</span> Interpreting interactions</h3>
<p>Code I’ve used to generate the different plots in the competition:</p>
<div class="sourceCode" id="cb641"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb641-1"><a href="linear-model-3.html#cb641-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb641-2"><a href="linear-model-3.html#cb641-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb641-3"><a href="linear-model-3.html#cb641-3" aria-hidden="true" tabindex="-1"></a>b0 <span class="ot">=</span> <span class="dv">15</span></span>
<span id="cb641-4"><a href="linear-model-3.html#cb641-4" aria-hidden="true" tabindex="-1"></a>nsamples <span class="ot">=</span> <span class="dv">30</span></span>
<span id="cb641-5"><a href="linear-model-3.html#cb641-5" aria-hidden="true" tabindex="-1"></a>sd <span class="ot">=</span> <span class="dv">5</span></span>
<span id="cb641-6"><a href="linear-model-3.html#cb641-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb641-7"><a href="linear-model-3.html#cb641-7" aria-hidden="true" tabindex="-1"></a><span class="co"># simple effect of condition</span></span>
<span id="cb641-8"><a href="linear-model-3.html#cb641-8" aria-hidden="true" tabindex="-1"></a>b1 <span class="ot">=</span> <span class="dv">10</span></span>
<span id="cb641-9"><a href="linear-model-3.html#cb641-9" aria-hidden="true" tabindex="-1"></a>b2 <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb641-10"><a href="linear-model-3.html#cb641-10" aria-hidden="true" tabindex="-1"></a>b1_2 <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb641-11"><a href="linear-model-3.html#cb641-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb641-12"><a href="linear-model-3.html#cb641-12" aria-hidden="true" tabindex="-1"></a><span class="co"># two simple effects</span></span>
<span id="cb641-13"><a href="linear-model-3.html#cb641-13" aria-hidden="true" tabindex="-1"></a><span class="co"># b1 = 5</span></span>
<span id="cb641-14"><a href="linear-model-3.html#cb641-14" aria-hidden="true" tabindex="-1"></a><span class="co"># b2 = -5</span></span>
<span id="cb641-15"><a href="linear-model-3.html#cb641-15" aria-hidden="true" tabindex="-1"></a><span class="co"># b1_2 = 0</span></span>
<span id="cb641-16"><a href="linear-model-3.html#cb641-16" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb641-17"><a href="linear-model-3.html#cb641-17" aria-hidden="true" tabindex="-1"></a><span class="co"># interaction effect</span></span>
<span id="cb641-18"><a href="linear-model-3.html#cb641-18" aria-hidden="true" tabindex="-1"></a><span class="co"># b1 = 10</span></span>
<span id="cb641-19"><a href="linear-model-3.html#cb641-19" aria-hidden="true" tabindex="-1"></a><span class="co"># b2 = 10</span></span>
<span id="cb641-20"><a href="linear-model-3.html#cb641-20" aria-hidden="true" tabindex="-1"></a><span class="co"># b1_2 = -20</span></span>
<span id="cb641-21"><a href="linear-model-3.html#cb641-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb641-22"><a href="linear-model-3.html#cb641-22" aria-hidden="true" tabindex="-1"></a><span class="co"># interaction and simple effect</span></span>
<span id="cb641-23"><a href="linear-model-3.html#cb641-23" aria-hidden="true" tabindex="-1"></a><span class="co"># b1 = 10</span></span>
<span id="cb641-24"><a href="linear-model-3.html#cb641-24" aria-hidden="true" tabindex="-1"></a><span class="co"># b2 = 0</span></span>
<span id="cb641-25"><a href="linear-model-3.html#cb641-25" aria-hidden="true" tabindex="-1"></a><span class="co"># b1_2 = -20</span></span>
<span id="cb641-26"><a href="linear-model-3.html#cb641-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb641-27"><a href="linear-model-3.html#cb641-27" aria-hidden="true" tabindex="-1"></a><span class="co"># all three</span></span>
<span id="cb641-28"><a href="linear-model-3.html#cb641-28" aria-hidden="true" tabindex="-1"></a><span class="co"># b1 = 2</span></span>
<span id="cb641-29"><a href="linear-model-3.html#cb641-29" aria-hidden="true" tabindex="-1"></a><span class="co"># b2 = 2</span></span>
<span id="cb641-30"><a href="linear-model-3.html#cb641-30" aria-hidden="true" tabindex="-1"></a><span class="co"># b1_2 = 10</span></span>
<span id="cb641-31"><a href="linear-model-3.html#cb641-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb641-32"><a href="linear-model-3.html#cb641-32" aria-hidden="true" tabindex="-1"></a>df.data <span class="ot">=</span> <span class="fu">tibble</span>(</span>
<span id="cb641-33"><a href="linear-model-3.html#cb641-33" aria-hidden="true" tabindex="-1"></a>  <span class="at">condition =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">each =</span> nsamples),</span>
<span id="cb641-34"><a href="linear-model-3.html#cb641-34" aria-hidden="true" tabindex="-1"></a>  <span class="at">treatment =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), nsamples),</span>
<span id="cb641-35"><a href="linear-model-3.html#cb641-35" aria-hidden="true" tabindex="-1"></a>  <span class="at">rating =</span> b0 <span class="sc">+</span> b1 <span class="sc">*</span> condition <span class="sc">+</span> b2 <span class="sc">*</span> treatment <span class="sc">+</span> (b1_2 <span class="sc">*</span> condition <span class="sc">*</span> treatment) <span class="sc">+</span> <span class="fu">rnorm</span>(nsamples, <span class="at">sd =</span> sd)) <span class="sc">%&gt;%</span></span>
<span id="cb641-36"><a href="linear-model-3.html#cb641-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">condition =</span> <span class="fu">factor</span>(condition, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>)),</span>
<span id="cb641-37"><a href="linear-model-3.html#cb641-37" aria-hidden="true" tabindex="-1"></a>  <span class="at">treatment =</span> <span class="fu">factor</span>(treatment, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;1&quot;</span>, <span class="st">&quot;2&quot;</span>)))</span>
<span id="cb641-38"><a href="linear-model-3.html#cb641-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb641-39"><a href="linear-model-3.html#cb641-39" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df.data,</span>
<span id="cb641-40"><a href="linear-model-3.html#cb641-40" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> condition,</span>
<span id="cb641-41"><a href="linear-model-3.html#cb641-41" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> rating,</span>
<span id="cb641-42"><a href="linear-model-3.html#cb641-42" aria-hidden="true" tabindex="-1"></a>           <span class="at">group =</span> treatment,</span>
<span id="cb641-43"><a href="linear-model-3.html#cb641-43" aria-hidden="true" tabindex="-1"></a>           <span class="at">fill =</span> treatment)) <span class="sc">+</span> </span>
<span id="cb641-44"><a href="linear-model-3.html#cb641-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> <span class="st">&quot;mean&quot;</span>,</span>
<span id="cb641-45"><a href="linear-model-3.html#cb641-45" aria-hidden="true" tabindex="-1"></a>               <span class="at">geom =</span> <span class="st">&quot;bar&quot;</span>,</span>
<span id="cb641-46"><a href="linear-model-3.html#cb641-46" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb641-47"><a href="linear-model-3.html#cb641-47" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.9</span>)) <span class="sc">+</span></span>
<span id="cb641-48"><a href="linear-model-3.html#cb641-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> <span class="st">&quot;mean_cl_boot&quot;</span>,</span>
<span id="cb641-49"><a href="linear-model-3.html#cb641-49" aria-hidden="true" tabindex="-1"></a>               <span class="at">geom =</span> <span class="st">&quot;linerange&quot;</span>,</span>
<span id="cb641-50"><a href="linear-model-3.html#cb641-50" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">1</span>,</span>
<span id="cb641-51"><a href="linear-model-3.html#cb641-51" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.9</span>)) <span class="sc">+</span></span>
<span id="cb641-52"><a href="linear-model-3.html#cb641-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;Set1&quot;</span>)</span></code></pre></div>
<p><img src="12-linear_model3_files/figure-html/unnamed-chunk-26-1.png" width="672" /></p>
<p>And here is one specific example. Let’s generate the data first:</p>
<div class="sourceCode" id="cb642"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb642-1"><a href="linear-model-3.html#cb642-1" aria-hidden="true" tabindex="-1"></a><span class="co"># make example reproducible </span></span>
<span id="cb642-2"><a href="linear-model-3.html#cb642-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb642-3"><a href="linear-model-3.html#cb642-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb642-4"><a href="linear-model-3.html#cb642-4" aria-hidden="true" tabindex="-1"></a><span class="co"># set parameters</span></span>
<span id="cb642-5"><a href="linear-model-3.html#cb642-5" aria-hidden="true" tabindex="-1"></a>nsamples <span class="ot">=</span> <span class="dv">30</span></span>
<span id="cb642-6"><a href="linear-model-3.html#cb642-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb642-7"><a href="linear-model-3.html#cb642-7" aria-hidden="true" tabindex="-1"></a>b0 <span class="ot">=</span> <span class="dv">15</span></span>
<span id="cb642-8"><a href="linear-model-3.html#cb642-8" aria-hidden="true" tabindex="-1"></a>b1 <span class="ot">=</span> <span class="dv">10</span> <span class="co"># simple effect of condition</span></span>
<span id="cb642-9"><a href="linear-model-3.html#cb642-9" aria-hidden="true" tabindex="-1"></a>b2 <span class="ot">=</span> <span class="dv">0</span> <span class="co"># simple effect of treatment</span></span>
<span id="cb642-10"><a href="linear-model-3.html#cb642-10" aria-hidden="true" tabindex="-1"></a>b1_2 <span class="ot">=</span> <span class="sc">-</span><span class="dv">20</span> <span class="co"># interaction effect</span></span>
<span id="cb642-11"><a href="linear-model-3.html#cb642-11" aria-hidden="true" tabindex="-1"></a>sd <span class="ot">=</span> <span class="dv">5</span></span>
<span id="cb642-12"><a href="linear-model-3.html#cb642-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb642-13"><a href="linear-model-3.html#cb642-13" aria-hidden="true" tabindex="-1"></a><span class="co"># generate data</span></span>
<span id="cb642-14"><a href="linear-model-3.html#cb642-14" aria-hidden="true" tabindex="-1"></a>df.data <span class="ot">=</span> <span class="fu">tibble</span>(</span>
<span id="cb642-15"><a href="linear-model-3.html#cb642-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">condition =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">each =</span> nsamples),</span>
<span id="cb642-16"><a href="linear-model-3.html#cb642-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">treatment =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), nsamples),</span>
<span id="cb642-17"><a href="linear-model-3.html#cb642-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">rating =</span> b0 <span class="sc">+</span> </span>
<span id="cb642-18"><a href="linear-model-3.html#cb642-18" aria-hidden="true" tabindex="-1"></a>    b1 <span class="sc">*</span> condition <span class="sc">+</span> </span>
<span id="cb642-19"><a href="linear-model-3.html#cb642-19" aria-hidden="true" tabindex="-1"></a>    b2 <span class="sc">*</span> treatment <span class="sc">+</span> (b1_2 <span class="sc">*</span> condition <span class="sc">*</span> treatment) <span class="sc">+</span> </span>
<span id="cb642-20"><a href="linear-model-3.html#cb642-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rnorm</span>(nsamples, <span class="at">sd =</span> sd)) <span class="sc">%&gt;%</span></span>
<span id="cb642-21"><a href="linear-model-3.html#cb642-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">condition =</span> <span class="fu">factor</span>(condition, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>)),</span>
<span id="cb642-22"><a href="linear-model-3.html#cb642-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">treatment =</span> <span class="fu">factor</span>(treatment, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;1&quot;</span>, <span class="st">&quot;2&quot;</span>)))</span></code></pre></div>
<p>Show part of the generated data frame:</p>
<div class="sourceCode" id="cb643"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb643-1"><a href="linear-model-3.html#cb643-1" aria-hidden="true" tabindex="-1"></a><span class="co"># show data frame</span></span>
<span id="cb643-2"><a href="linear-model-3.html#cb643-2" aria-hidden="true" tabindex="-1"></a>df.data <span class="sc">%&gt;%</span> </span>
<span id="cb643-3"><a href="linear-model-3.html#cb643-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(condition, treatment) <span class="sc">%&gt;%</span> </span>
<span id="cb643-4"><a href="linear-model-3.html#cb643-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">row_number</span>() <span class="sc">&lt;</span> <span class="dv">3</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb643-5"><a href="linear-model-3.html#cb643-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb643-6"><a href="linear-model-3.html#cb643-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">digits =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb643-7"><a href="linear-model-3.html#cb643-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="st">&quot;striped&quot;</span>,</span>
<span id="cb643-8"><a href="linear-model-3.html#cb643-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">full_width =</span> F)</span></code></pre></div>
<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
condition
</th>
<th style="text-align:left;">
treatment
</th>
<th style="text-align:right;">
rating
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
A
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
11.87
</td>
</tr>
<tr>
<td style="text-align:left;">
A
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
15.92
</td>
</tr>
<tr>
<td style="text-align:left;">
A
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
10.82
</td>
</tr>
<tr>
<td style="text-align:left;">
A
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
22.98
</td>
</tr>
<tr>
<td style="text-align:left;">
B
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
21.87
</td>
</tr>
<tr>
<td style="text-align:left;">
B
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
5.92
</td>
</tr>
<tr>
<td style="text-align:left;">
B
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
20.82
</td>
</tr>
<tr>
<td style="text-align:left;">
B
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
12.98
</td>
</tr>
</tbody>
</table>
<p>Plot the data:</p>
<div class="sourceCode" id="cb644"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb644-1"><a href="linear-model-3.html#cb644-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot data</span></span>
<span id="cb644-2"><a href="linear-model-3.html#cb644-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df.data,</span>
<span id="cb644-3"><a href="linear-model-3.html#cb644-3" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> condition,</span>
<span id="cb644-4"><a href="linear-model-3.html#cb644-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> rating,</span>
<span id="cb644-5"><a href="linear-model-3.html#cb644-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">group =</span> treatment,</span>
<span id="cb644-6"><a href="linear-model-3.html#cb644-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">fill =</span> treatment)) <span class="sc">+</span> </span>
<span id="cb644-7"><a href="linear-model-3.html#cb644-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> <span class="st">&quot;mean&quot;</span>,</span>
<span id="cb644-8"><a href="linear-model-3.html#cb644-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">geom =</span> <span class="st">&quot;bar&quot;</span>,</span>
<span id="cb644-9"><a href="linear-model-3.html#cb644-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb644-10"><a href="linear-model-3.html#cb644-10" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.9</span>)) <span class="sc">+</span></span>
<span id="cb644-11"><a href="linear-model-3.html#cb644-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> <span class="st">&quot;mean_cl_boot&quot;</span>,</span>
<span id="cb644-12"><a href="linear-model-3.html#cb644-12" aria-hidden="true" tabindex="-1"></a>               <span class="at">geom =</span> <span class="st">&quot;linerange&quot;</span>,</span>
<span id="cb644-13"><a href="linear-model-3.html#cb644-13" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">1</span>,</span>
<span id="cb644-14"><a href="linear-model-3.html#cb644-14" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.9</span>)) <span class="sc">+</span></span>
<span id="cb644-15"><a href="linear-model-3.html#cb644-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;Set1&quot;</span>)</span></code></pre></div>
<p><img src="12-linear_model3_files/figure-html/unnamed-chunk-29-1.png" width="672" /></p>
<p>And check whether we can successfully infer the parameters that we used to generate the data:</p>
<div class="sourceCode" id="cb645"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb645-1"><a href="linear-model-3.html#cb645-1" aria-hidden="true" tabindex="-1"></a><span class="co"># infer parameters</span></span>
<span id="cb645-2"><a href="linear-model-3.html#cb645-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(<span class="at">formula =</span> rating <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> condition <span class="sc">+</span> treatment <span class="sc">+</span> condition<span class="sc">:</span>treatment,</span>
<span id="cb645-3"><a href="linear-model-3.html#cb645-3" aria-hidden="true" tabindex="-1"></a>   <span class="at">data =</span> df.data) <span class="sc">%&gt;%</span> </span>
<span id="cb645-4"><a href="linear-model-3.html#cb645-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code></pre></div>
<pre><code>
Call:
lm(formula = rating ~ 1 + condition + treatment + condition:treatment, 
    data = df.data)

Residuals:
     Min       1Q   Median       3Q      Max 
-10.6546  -3.6343   0.7988   3.3514   8.3953 

Coefficients:
                      Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)             16.244      1.194  13.608  &lt; 2e-16 ***
conditionB              10.000      1.688   5.924 2.02e-07 ***
treatment2              -1.662      1.688  -0.985    0.329    
conditionB:treatment2  -20.000      2.387  -8.378 1.86e-11 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 4.623 on 56 degrees of freedom
Multiple R-squared:  0.7473,    Adjusted R-squared:  0.7338 
F-statistic: 55.21 on 3 and 56 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div id="variance-decomposition-1" class="section level3" number="12.5.4">
<h3><span class="header-section-number">12.5.4</span> Variance decomposition</h3>
<p>Let’s fit the model first:</p>
<div class="sourceCode" id="cb647"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb647-1"><a href="linear-model-3.html#cb647-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">=</span> <span class="fu">lm</span>(<span class="at">formula =</span> balance <span class="sc">~</span> hand <span class="sc">*</span> skill, </span>
<span id="cb647-2"><a href="linear-model-3.html#cb647-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">data =</span> df.poker)</span>
<span id="cb647-3"><a href="linear-model-3.html#cb647-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb647-4"><a href="linear-model-3.html#cb647-4" aria-hidden="true" tabindex="-1"></a>fit <span class="sc">%&gt;%</span></span>
<span id="cb647-5"><a href="linear-model-3.html#cb647-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">anova</span>()</span></code></pre></div>
<pre><code>Analysis of Variance Table

Response: balance
            Df Sum Sq Mean Sq F value    Pr(&gt;F)    
hand         2 2559.4 1279.70 79.1692 &lt; 2.2e-16 ***
skill        1   39.3   39.35  2.4344 0.1197776    
hand:skill   2  229.0  114.49  7.0830 0.0009901 ***
Residuals  294 4752.3   16.16                      
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div id="calculate-sums-of-squares-1" class="section level4" number="12.5.4.1">
<h4><span class="header-section-number">12.5.4.1</span> Calculate sums of squares</h4>
<div class="sourceCode" id="cb649"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb649-1"><a href="linear-model-3.html#cb649-1" aria-hidden="true" tabindex="-1"></a>df.poker <span class="sc">%&gt;%</span> </span>
<span id="cb649-2"><a href="linear-model-3.html#cb649-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">mean_grand =</span> <span class="fu">mean</span>(balance)) <span class="sc">%&gt;%</span> </span>
<span id="cb649-3"><a href="linear-model-3.html#cb649-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(skill) <span class="sc">%&gt;%</span> </span>
<span id="cb649-4"><a href="linear-model-3.html#cb649-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">mean_skill =</span> <span class="fu">mean</span>(balance)) <span class="sc">%&gt;%</span></span>
<span id="cb649-5"><a href="linear-model-3.html#cb649-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(hand) <span class="sc">%&gt;%</span> </span>
<span id="cb649-6"><a href="linear-model-3.html#cb649-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">mean_hand =</span> <span class="fu">mean</span>(balance)) <span class="sc">%&gt;%</span></span>
<span id="cb649-7"><a href="linear-model-3.html#cb649-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb649-8"><a href="linear-model-3.html#cb649-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">variance_total =</span> <span class="fu">sum</span>((balance <span class="sc">-</span> mean_grand)<span class="sc">^</span><span class="dv">2</span>),</span>
<span id="cb649-9"><a href="linear-model-3.html#cb649-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">variance_skill =</span> <span class="fu">sum</span>((mean_skill <span class="sc">-</span> mean_grand)<span class="sc">^</span><span class="dv">2</span>),</span>
<span id="cb649-10"><a href="linear-model-3.html#cb649-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">variance_hand =</span> <span class="fu">sum</span>((mean_hand <span class="sc">-</span> mean_grand)<span class="sc">^</span><span class="dv">2</span>),</span>
<span id="cb649-11"><a href="linear-model-3.html#cb649-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">variance_residual =</span> variance_total <span class="sc">-</span> variance_skill <span class="sc">-</span> variance_hand)</span></code></pre></div>
<pre><code># A tibble: 1 x 4
  variance_total variance_skill variance_hand variance_residual
           &lt;dbl&gt;          &lt;dbl&gt;         &lt;dbl&gt;             &lt;dbl&gt;
1          7580.           39.3         2559.             4981.</code></pre>
</div>
<div id="visualize-model-predictions-1" class="section level4" number="12.5.4.2">
<h4><span class="header-section-number">12.5.4.2</span> Visualize model predictions</h4>
<div id="skill-factor" class="section level5" number="12.5.4.2.1">
<h5><span class="header-section-number">12.5.4.2.1</span> <code>Skill</code> factor</h5>
<div class="sourceCode" id="cb651"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb651-1"><a href="linear-model-3.html#cb651-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb651-2"><a href="linear-model-3.html#cb651-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb651-3"><a href="linear-model-3.html#cb651-3" aria-hidden="true" tabindex="-1"></a>df.plot <span class="ot">=</span> df.poker <span class="sc">%&gt;%</span> </span>
<span id="cb651-4"><a href="linear-model-3.html#cb651-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">skill_jitter =</span> skill <span class="sc">%&gt;%</span> <span class="fu">as.numeric</span>(),</span>
<span id="cb651-5"><a href="linear-model-3.html#cb651-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">skill_jitter =</span> skill_jitter <span class="sc">+</span> <span class="fu">runif</span>(<span class="fu">n</span>(), <span class="at">min =</span> <span class="sc">-</span><span class="fl">0.4</span>, <span class="at">max =</span> <span class="fl">0.4</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb651-6"><a href="linear-model-3.html#cb651-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(skill) <span class="sc">%&gt;%</span> </span>
<span id="cb651-7"><a href="linear-model-3.html#cb651-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">mean_group =</span> <span class="fu">mean</span>(balance)) <span class="sc">%&gt;%</span> </span>
<span id="cb651-8"><a href="linear-model-3.html#cb651-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb651-9"><a href="linear-model-3.html#cb651-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">mean_grand =</span> <span class="fu">mean</span>(balance))</span>
<span id="cb651-10"><a href="linear-model-3.html#cb651-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb651-11"><a href="linear-model-3.html#cb651-11" aria-hidden="true" tabindex="-1"></a>df.means <span class="ot">=</span> df.poker <span class="sc">%&gt;%</span> </span>
<span id="cb651-12"><a href="linear-model-3.html#cb651-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(skill) <span class="sc">%&gt;%</span> </span>
<span id="cb651-13"><a href="linear-model-3.html#cb651-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean =</span> <span class="fu">mean</span>(balance)) <span class="sc">%&gt;%</span> </span>
<span id="cb651-14"><a href="linear-model-3.html#cb651-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> skill,</span>
<span id="cb651-15"><a href="linear-model-3.html#cb651-15" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_from =</span> mean)</span>
<span id="cb651-16"><a href="linear-model-3.html#cb651-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb651-17"><a href="linear-model-3.html#cb651-17" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df.plot,</span>
<span id="cb651-18"><a href="linear-model-3.html#cb651-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> skill_jitter,</span>
<span id="cb651-19"><a href="linear-model-3.html#cb651-19" aria-hidden="true" tabindex="-1"></a>                       <span class="at">y =</span> mean_group,</span>
<span id="cb651-20"><a href="linear-model-3.html#cb651-20" aria-hidden="true" tabindex="-1"></a>                       <span class="at">color =</span> skill)) <span class="sc">+</span> </span>
<span id="cb651-21"><a href="linear-model-3.html#cb651-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb651-22"><a href="linear-model-3.html#cb651-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> <span class="cn">NULL</span>,</span>
<span id="cb651-23"><a href="linear-model-3.html#cb651-23" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">x =</span> <span class="fl">0.6</span>,</span>
<span id="cb651-24"><a href="linear-model-3.html#cb651-24" aria-hidden="true" tabindex="-1"></a>                   <span class="at">xend =</span> <span class="fl">1.4</span>,</span>
<span id="cb651-25"><a href="linear-model-3.html#cb651-25" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> df.means<span class="sc">$</span>average,</span>
<span id="cb651-26"><a href="linear-model-3.html#cb651-26" aria-hidden="true" tabindex="-1"></a>                   <span class="at">yend =</span> df.means<span class="sc">$</span>average),</span>
<span id="cb651-27"><a href="linear-model-3.html#cb651-27" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb651-28"><a href="linear-model-3.html#cb651-28" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb651-29"><a href="linear-model-3.html#cb651-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> <span class="cn">NULL</span>,</span>
<span id="cb651-30"><a href="linear-model-3.html#cb651-30" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">x =</span> <span class="fl">1.6</span>,</span>
<span id="cb651-31"><a href="linear-model-3.html#cb651-31" aria-hidden="true" tabindex="-1"></a>                   <span class="at">xend =</span> <span class="fl">2.4</span>,</span>
<span id="cb651-32"><a href="linear-model-3.html#cb651-32" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> df.means<span class="sc">$</span>expert,</span>
<span id="cb651-33"><a href="linear-model-3.html#cb651-33" aria-hidden="true" tabindex="-1"></a>                   <span class="at">yend =</span> df.means<span class="sc">$</span>expert),</span>
<span id="cb651-34"><a href="linear-model-3.html#cb651-34" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">&quot;gray50&quot;</span>,</span>
<span id="cb651-35"><a href="linear-model-3.html#cb651-35" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb651-36"><a href="linear-model-3.html#cb651-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">xend =</span> skill_jitter,</span>
<span id="cb651-37"><a href="linear-model-3.html#cb651-37" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> mean_group,</span>
<span id="cb651-38"><a href="linear-model-3.html#cb651-38" aria-hidden="true" tabindex="-1"></a>                   <span class="at">yend =</span> mean_grand),</span>
<span id="cb651-39"><a href="linear-model-3.html#cb651-39" aria-hidden="true" tabindex="-1"></a>               <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb651-40"><a href="linear-model-3.html#cb651-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">mean</span>(df.poker<span class="sc">$</span>balance),</span>
<span id="cb651-41"><a href="linear-model-3.html#cb651-41" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb651-42"><a href="linear-model-3.html#cb651-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;balance&quot;</span>) <span class="sc">+</span> </span>
<span id="cb651-43"><a href="linear-model-3.html#cb651-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;gray50&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb651-44"><a href="linear-model-3.html#cb651-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;average&quot;</span>, <span class="st">&quot;expert&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb651-45"><a href="linear-model-3.html#cb651-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">20</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">20</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">25</span>)) <span class="sc">+</span></span>
<span id="cb651-46"><a href="linear-model-3.html#cb651-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb651-47"><a href="linear-model-3.html#cb651-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="12-linear_model3_files/figure-html/unnamed-chunk-33-1.png" width="672" /></p>
</div>
</div>
</div>
</div>
<div id="two-way-anova-with-interaction" class="section level2" number="12.6">
<h2><span class="header-section-number">12.6</span> Two-way ANOVA (with interaction)</h2>
<p>Let’s fit a two-way ANOVA with the interaction term.</p>
<div class="sourceCode" id="cb652"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb652-1"><a href="linear-model-3.html#cb652-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">=</span> <span class="fu">lm</span>(<span class="at">formula =</span> balance <span class="sc">~</span> hand <span class="sc">*</span> skill, <span class="at">data =</span> df.poker)</span>
<span id="cb652-2"><a href="linear-model-3.html#cb652-2" aria-hidden="true" tabindex="-1"></a>fit <span class="sc">%&gt;%</span> </span>
<span id="cb652-3"><a href="linear-model-3.html#cb652-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">anova</span>()</span></code></pre></div>
<pre><code>Analysis of Variance Table

Response: balance
            Df Sum Sq Mean Sq F value    Pr(&gt;F)    
hand         2 2559.4 1279.70 79.1692 &lt; 2.2e-16 ***
skill        1   39.3   39.35  2.4344 0.1197776    
hand:skill   2  229.0  114.49  7.0830 0.0009901 ***
Residuals  294 4752.3   16.16                      
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>And let’s compute how the the sums of squares are decomposed:</p>
<div class="sourceCode" id="cb654"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb654-1"><a href="linear-model-3.html#cb654-1" aria-hidden="true" tabindex="-1"></a>df.poker <span class="sc">%&gt;%</span> </span>
<span id="cb654-2"><a href="linear-model-3.html#cb654-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">mean_grand =</span> <span class="fu">mean</span>(balance)) <span class="sc">%&gt;%</span> </span>
<span id="cb654-3"><a href="linear-model-3.html#cb654-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(skill) <span class="sc">%&gt;%</span> </span>
<span id="cb654-4"><a href="linear-model-3.html#cb654-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">mean_skill =</span> <span class="fu">mean</span>(balance)) <span class="sc">%&gt;%</span> </span>
<span id="cb654-5"><a href="linear-model-3.html#cb654-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(hand) <span class="sc">%&gt;%</span> </span>
<span id="cb654-6"><a href="linear-model-3.html#cb654-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">mean_hand =</span> <span class="fu">mean</span>(balance)) <span class="sc">%&gt;%</span></span>
<span id="cb654-7"><a href="linear-model-3.html#cb654-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(hand, skill) <span class="sc">%&gt;%</span> </span>
<span id="cb654-8"><a href="linear-model-3.html#cb654-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">mean_hand_skill =</span> <span class="fu">mean</span>(balance)) <span class="sc">%&gt;%</span></span>
<span id="cb654-9"><a href="linear-model-3.html#cb654-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb654-10"><a href="linear-model-3.html#cb654-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">variance_total =</span> <span class="fu">sum</span>((balance <span class="sc">-</span> mean_grand)<span class="sc">^</span><span class="dv">2</span>),</span>
<span id="cb654-11"><a href="linear-model-3.html#cb654-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">variance_skill =</span> <span class="fu">sum</span>((mean_skill <span class="sc">-</span> mean_grand)<span class="sc">^</span><span class="dv">2</span>),</span>
<span id="cb654-12"><a href="linear-model-3.html#cb654-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">variance_hand =</span> <span class="fu">sum</span>((mean_hand <span class="sc">-</span> mean_grand)<span class="sc">^</span><span class="dv">2</span>),</span>
<span id="cb654-13"><a href="linear-model-3.html#cb654-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">variance_hand_skill =</span> <span class="fu">sum</span>((mean_hand_skill <span class="sc">-</span> mean_skill <span class="sc">-</span> mean_hand <span class="sc">+</span> </span>
<span id="cb654-14"><a href="linear-model-3.html#cb654-14" aria-hidden="true" tabindex="-1"></a>                                         mean_grand)<span class="sc">^</span><span class="dv">2</span>),</span>
<span id="cb654-15"><a href="linear-model-3.html#cb654-15" aria-hidden="true" tabindex="-1"></a>            <span class="at">variance_residual =</span> variance_total <span class="sc">-</span> variance_skill <span class="sc">-</span> variance_hand <span class="sc">-</span> </span>
<span id="cb654-16"><a href="linear-model-3.html#cb654-16" aria-hidden="true" tabindex="-1"></a>              variance_hand_skill)</span></code></pre></div>
<pre><code># A tibble: 1 x 5
  variance_total variance_skill variance_hand variance_hand_sk… variance_residu…
           &lt;dbl&gt;          &lt;dbl&gt;         &lt;dbl&gt;             &lt;dbl&gt;            &lt;dbl&gt;
1          7580.           39.3         2559.              229.            4752.</code></pre>
</div>
<div id="anova-with-unbalanced-design" class="section level2" number="12.7">
<h2><span class="header-section-number">12.7</span> ANOVA with unbalanced design</h2>
<p>For the standard <code>anova()</code> function, the order of the independent predictors matters when the design is unbalanced.</p>
<div class="sourceCode" id="cb656"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb656-1"><a href="linear-model-3.html#cb656-1" aria-hidden="true" tabindex="-1"></a><span class="co"># one order </span></span>
<span id="cb656-2"><a href="linear-model-3.html#cb656-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(<span class="at">formula =</span> balance <span class="sc">~</span> skill <span class="sc">+</span> hand, </span>
<span id="cb656-3"><a href="linear-model-3.html#cb656-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">data =</span> df.poker.unbalanced) <span class="sc">%&gt;%</span> </span>
<span id="cb656-4"><a href="linear-model-3.html#cb656-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">anova</span>()</span></code></pre></div>
<pre><code>Analysis of Variance Table

Response: balance
           Df Sum Sq Mean Sq F value  Pr(&gt;F)    
skill       1   74.3   74.28  4.2904 0.03922 *  
hand        2 2385.1 1192.57 68.8827 &lt; 2e-16 ***
Residuals 286 4951.5   17.31                    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb658"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb658-1"><a href="linear-model-3.html#cb658-1" aria-hidden="true" tabindex="-1"></a><span class="co"># another order </span></span>
<span id="cb658-2"><a href="linear-model-3.html#cb658-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(<span class="at">formula =</span> balance <span class="sc">~</span> hand <span class="sc">+</span> skill, </span>
<span id="cb658-3"><a href="linear-model-3.html#cb658-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">data =</span> df.poker.unbalanced) <span class="sc">%&gt;%</span> </span>
<span id="cb658-4"><a href="linear-model-3.html#cb658-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">anova</span>()</span></code></pre></div>
<pre><code>Analysis of Variance Table

Response: balance
           Df Sum Sq Mean Sq F value Pr(&gt;F)    
hand        2 2419.8 1209.92 69.8845 &lt;2e-16 ***
skill       1   39.6   39.59  2.2867 0.1316    
Residuals 286 4951.5   17.31                   
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>We should compute an ANOVA with type 3 sums of squares, and set the contrast to sum contrasts.</p>
<div class="sourceCode" id="cb660"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb660-1"><a href="linear-model-3.html#cb660-1" aria-hidden="true" tabindex="-1"></a><span class="co"># one order</span></span>
<span id="cb660-2"><a href="linear-model-3.html#cb660-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(<span class="at">formula =</span> balance <span class="sc">~</span> hand <span class="sc">+</span> skill,</span>
<span id="cb660-3"><a href="linear-model-3.html#cb660-3" aria-hidden="true" tabindex="-1"></a>   <span class="at">data =</span> df.poker.unbalanced,</span>
<span id="cb660-4"><a href="linear-model-3.html#cb660-4" aria-hidden="true" tabindex="-1"></a>   <span class="at">contrasts =</span> <span class="fu">list</span>(<span class="at">hand =</span> <span class="st">&quot;contr.sum&quot;</span>, </span>
<span id="cb660-5"><a href="linear-model-3.html#cb660-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">skill =</span> <span class="st">&quot;contr.sum&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb660-6"><a href="linear-model-3.html#cb660-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Anova</span>(<span class="at">type =</span> <span class="st">&quot;3&quot;</span>)</span></code></pre></div>
<pre><code>Anova Table (Type III tests)

Response: balance
             Sum Sq  Df   F value Pr(&gt;F)    
(Intercept) 27629.1   1 1595.8482 &lt;2e-16 ***
hand         2385.1   2   68.8827 &lt;2e-16 ***
skill          39.6   1    2.2867 0.1316    
Residuals    4951.5 286                     
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb662"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb662-1"><a href="linear-model-3.html#cb662-1" aria-hidden="true" tabindex="-1"></a><span class="co"># another order</span></span>
<span id="cb662-2"><a href="linear-model-3.html#cb662-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(<span class="at">formula =</span> balance <span class="sc">~</span> skill <span class="sc">+</span> hand,</span>
<span id="cb662-3"><a href="linear-model-3.html#cb662-3" aria-hidden="true" tabindex="-1"></a>   <span class="at">data =</span> df.poker.unbalanced,</span>
<span id="cb662-4"><a href="linear-model-3.html#cb662-4" aria-hidden="true" tabindex="-1"></a>   <span class="at">contrasts =</span> <span class="fu">list</span>(<span class="at">hand =</span> <span class="st">&quot;contr.sum&quot;</span>, </span>
<span id="cb662-5"><a href="linear-model-3.html#cb662-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">skill =</span> <span class="st">&quot;contr.sum&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb662-6"><a href="linear-model-3.html#cb662-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Anova</span>(<span class="at">type =</span> <span class="st">&quot;3&quot;</span>)</span></code></pre></div>
<pre><code>Anova Table (Type III tests)

Response: balance
             Sum Sq  Df   F value Pr(&gt;F)    
(Intercept) 27629.1   1 1595.8482 &lt;2e-16 ***
skill          39.6   1    2.2867 0.1316    
hand         2385.1   2   68.8827 &lt;2e-16 ***
Residuals    4951.5 286                     
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Now, the order of the independent variables doesn’t matter anymore.</p>
<p>We can also use the <code>aov_ez()</code> function from the <code>afex</code> package.</p>
<div class="sourceCode" id="cb664"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb664-1"><a href="linear-model-3.html#cb664-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(<span class="at">formula =</span> balance <span class="sc">~</span> skill <span class="sc">*</span> hand,</span>
<span id="cb664-2"><a href="linear-model-3.html#cb664-2" aria-hidden="true" tabindex="-1"></a>   <span class="at">data =</span> df.poker.unbalanced,</span>
<span id="cb664-3"><a href="linear-model-3.html#cb664-3" aria-hidden="true" tabindex="-1"></a>   <span class="at">contrasts =</span> <span class="fu">list</span>(<span class="at">hand =</span> <span class="st">&quot;contr.sum&quot;</span>, </span>
<span id="cb664-4"><a href="linear-model-3.html#cb664-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">skill =</span> <span class="st">&quot;contr.sum&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb664-5"><a href="linear-model-3.html#cb664-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Anova</span>(<span class="at">type =</span> <span class="st">&quot;3&quot;</span>)</span></code></pre></div>
<pre><code>Anova Table (Type III tests)

Response: balance
             Sum Sq  Df   F value    Pr(&gt;F)    
(Intercept) 27781.3   1 1676.9096 &lt; 2.2e-16 ***
skill          48.9   1    2.9540 0.0867525 .  
hand         2285.3   2   68.9729 &lt; 2.2e-16 ***
skill:hand    246.5   2    7.4401 0.0007089 ***
Residuals    4705.0 284                        
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb666"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb666-1"><a href="linear-model-3.html#cb666-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">=</span> <span class="fu">aov_ez</span>(<span class="at">id =</span> <span class="st">&quot;participant&quot;</span>,</span>
<span id="cb666-2"><a href="linear-model-3.html#cb666-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">dv =</span> <span class="st">&quot;balance&quot;</span>,</span>
<span id="cb666-3"><a href="linear-model-3.html#cb666-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> df.poker.unbalanced,</span>
<span id="cb666-4"><a href="linear-model-3.html#cb666-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">between =</span> <span class="fu">c</span>(<span class="st">&quot;hand&quot;</span>, <span class="st">&quot;skill&quot;</span>))</span></code></pre></div>
<pre><code>Contrasts set to contr.sum for the following variables: hand, skill</code></pre>
<div class="sourceCode" id="cb668"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb668-1"><a href="linear-model-3.html#cb668-1" aria-hidden="true" tabindex="-1"></a>fit<span class="sc">$</span>Anova</span></code></pre></div>
<pre><code>Anova Table (Type III tests)

Response: dv
             Sum Sq  Df   F value    Pr(&gt;F)    
(Intercept) 27781.3   1 1676.9096 &lt; 2.2e-16 ***
hand         2285.3   2   68.9729 &lt; 2.2e-16 ***
skill          48.9   1    2.9540 0.0867525 .  
hand:skill    246.5   2    7.4401 0.0007089 ***
Residuals    4705.0 284                        
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<div id="interpreting-parameters-very-important" class="section level2" number="12.8">
<h2><span class="header-section-number">12.8</span> Interpreting parameters (very important!)</h2>
<div class="sourceCode" id="cb670"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb670-1"><a href="linear-model-3.html#cb670-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">=</span> <span class="fu">lm</span>(<span class="at">formula =</span> balance <span class="sc">~</span> skill <span class="sc">*</span> hand,</span>
<span id="cb670-2"><a href="linear-model-3.html#cb670-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">data =</span> df.poker)</span>
<span id="cb670-3"><a href="linear-model-3.html#cb670-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb670-4"><a href="linear-model-3.html#cb670-4" aria-hidden="true" tabindex="-1"></a>fit <span class="sc">%&gt;%</span> </span>
<span id="cb670-5"><a href="linear-model-3.html#cb670-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code></pre></div>
<pre><code>
Call:
lm(formula = balance ~ skill * hand, data = df.poker)

Residuals:
     Min       1Q   Median       3Q      Max 
-13.6976  -2.4739   0.0348   2.4644  14.7806 

Coefficients:
                        Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)               4.5866     0.5686   8.067 1.85e-14 ***
skillexpert               2.7098     0.8041   3.370 0.000852 ***
handneutral               5.2572     0.8041   6.538 2.75e-10 ***
handgood                  9.2110     0.8041  11.455  &lt; 2e-16 ***
skillexpert:handneutral  -1.7042     1.1372  -1.499 0.135038    
skillexpert:handgood     -4.2522     1.1372  -3.739 0.000222 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 4.02 on 294 degrees of freedom
Multiple R-squared:  0.3731,    Adjusted R-squared:  0.3624 
F-statistic: 34.99 on 5 and 294 DF,  p-value: &lt; 2.2e-16</code></pre>
<blockquote>
<p>Important: The t-statistic for <code>skillexpert</code> is not telling us that there is a main effect of skill. Instead, it shows the difference between <code>skill = average</code> and <code>skill = expert</code> when all other predictors in the model are 0!!</p>
</blockquote>
<p>Here, this parameter just captures whether there is a significant difference between average and skilled players <strong>when they have a bad hand</strong> (because that’s the reference category here). Let’s check that this is true.</p>
<div class="sourceCode" id="cb672"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb672-1"><a href="linear-model-3.html#cb672-1" aria-hidden="true" tabindex="-1"></a>df.poker <span class="sc">%&gt;%</span> </span>
<span id="cb672-2"><a href="linear-model-3.html#cb672-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(skill, hand) <span class="sc">%&gt;%</span> </span>
<span id="cb672-3"><a href="linear-model-3.html#cb672-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean =</span> <span class="fu">mean</span>(balance)) <span class="sc">%&gt;%</span> </span>
<span id="cb672-4"><a href="linear-model-3.html#cb672-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(hand <span class="sc">==</span> <span class="st">&quot;bad&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb672-5"><a href="linear-model-3.html#cb672-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> skill,</span>
<span id="cb672-6"><a href="linear-model-3.html#cb672-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_from =</span> mean) <span class="sc">%&gt;%</span> </span>
<span id="cb672-7"><a href="linear-model-3.html#cb672-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">difference =</span> expert <span class="sc">-</span> average)</span></code></pre></div>
<pre><code># A tibble: 1 x 4
  hand  average expert difference
  &lt;fct&gt;   &lt;dbl&gt;  &lt;dbl&gt;      &lt;dbl&gt;
1 bad      4.59   7.30       2.71</code></pre>
<p>We see here that the difference in balance between the average and expert players when they have a bad hand is 2.7098. This is the same value as the <code>skillexpert</code> parameter in the <code>summary()</code> table above, and the corresponding significance test captures whether this difference is significantly different from 0. It doesn’t capture, whether there is an effect of skill overall! To test this, we need to do an analysis of variance (using the <code>Anova(type = 3)</code> function).</p>
</div>
<div id="additional-resources-10" class="section level2" number="12.9">
<h2><span class="header-section-number">12.9</span> Additional resources</h2>
<div id="datacamp-5" class="section level3" number="12.9.1">
<h3><span class="header-section-number">12.9.1</span> Datacamp</h3>
<ul>
<li><a href="https://www.datacamp.com/courses/statistical-modeling-in-r-part-1">Statistical modeling 1</a></li>
<li><a href="https://www.datacamp.com/courses/statistical-modeling-in-r-part-2">Statistical modeling 2</a></li>
<li><a href="https://www.datacamp.com/courses/correlation-and-regression">Correlation and regression</a></li>
</ul>
</div>
<div id="misc-5" class="section level3" number="12.9.2">
<h3><span class="header-section-number">12.9.2</span> Misc</h3>
<ul>
<li><a href="https://mcfromnz.wordpress.com/2011/03/02/anova-type-iiiiii-ss-explained/">Explanation of different types of sums of squares</a></li>
</ul>
</div>
</div>
<div id="session-info-11" class="section level2" number="12.10">
<h2><span class="header-section-number">12.10</span> Session info</h2>
<p>Information about this R session including which version of R was used, and what packages were loaded.</p>
<div class="sourceCode" id="cb674"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb674-1"><a href="linear-model-3.html#cb674-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span></code></pre></div>
<pre><code>R version 4.0.3 (2020-10-10)
Platform: x86_64-apple-darwin17.0 (64-bit)
Running under: macOS Catalina 10.15.7

Matrix products: default
BLAS:   /Library/Frameworks/R.framework/Versions/4.0/Resources/lib/libRblas.dylib
LAPACK: /Library/Frameworks/R.framework/Versions/4.0/Resources/lib/libRlapack.dylib

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
 [1] forcats_0.5.1    stringr_1.4.0    dplyr_1.0.4      purrr_0.3.4     
 [5] readr_1.4.0      tidyr_1.1.2      tibble_3.0.6     ggplot2_3.3.3   
 [9] tidyverse_1.3.0  emmeans_1.5.3    afex_0.28-1      lme4_1.1-26     
[13] Matrix_1.3-2     car_3.0-10       carData_3.0-4    broom_0.7.3     
[17] janitor_2.1.0    kableExtra_1.3.1 knitr_1.31      

loaded via a namespace (and not attached):
  [1] TH.data_1.0-10      minqa_1.2.4         colorspace_2.0-0   
  [4] ellipsis_0.3.1      rio_0.5.16          htmlTable_2.1.0    
  [7] estimability_1.3    snakecase_0.11.0    base64enc_0.1-3    
 [10] fs_1.5.0            rstudioapi_0.13     farver_2.1.0       
 [13] fansi_0.4.2         mvtnorm_1.1-1       lubridate_1.7.9.2  
 [16] xml2_1.3.2          codetools_0.2-18    splines_4.0.3      
 [19] Formula_1.2-4       jsonlite_1.7.2      nloptr_1.2.2.2     
 [22] cluster_2.1.0       dbplyr_2.0.0        png_0.1-7          
 [25] compiler_4.0.3      httr_1.4.2          backports_1.2.1    
 [28] assertthat_0.2.1    cli_2.3.0           htmltools_0.5.1.1  
 [31] tools_4.0.3         lmerTest_3.1-3      coda_0.19-4        
 [34] gtable_0.3.0        glue_1.4.2          reshape2_1.4.4     
 [37] Rcpp_1.0.6          cellranger_1.1.0    vctrs_0.3.6        
 [40] nlme_3.1-151        xfun_0.21           ps_1.6.0           
 [43] openxlsx_4.2.3      rvest_0.3.6         lifecycle_1.0.0    
 [46] statmod_1.4.35      MASS_7.3-53         zoo_1.8-8          
 [49] scales_1.1.1        hms_1.0.0           parallel_4.0.3     
 [52] sandwich_3.0-0      RColorBrewer_1.1-2  yaml_2.2.1         
 [55] curl_4.3            gridExtra_2.3       rpart_4.1-15       
 [58] latticeExtra_0.6-29 stringi_1.5.3       highr_0.8          
 [61] checkmate_2.0.0     boot_1.3-26         zip_2.1.1          
 [64] rlang_0.4.10        pkgconfig_2.0.3     evaluate_0.14      
 [67] lattice_0.20-41     labeling_0.4.2      htmlwidgets_1.5.3  
 [70] tidyselect_1.1.0    plyr_1.8.6          magrittr_2.0.1     
 [73] bookdown_0.21       R6_2.5.0            generics_0.1.0     
 [76] Hmisc_4.4-2         multcomp_1.4-15     DBI_1.1.1          
 [79] pillar_1.4.7        haven_2.3.1         foreign_0.8-81     
 [82] withr_2.4.1         nnet_7.3-15         survival_3.2-7     
 [85] abind_1.4-5         modelr_0.1.8        crayon_1.4.1       
 [88] utf8_1.1.4          rmarkdown_2.6       jpeg_0.1-8.1       
 [91] grid_4.0.3          readxl_1.3.1        data.table_1.13.6  
 [94] reprex_1.0.0        digest_0.6.27       webshot_0.5.2      
 [97] xtable_1.8-4        numDeriv_2016.8-1.1 munsell_0.5.0      
[100] viridisLite_0.3.0  </code></pre>
</div>
<div id="references-1" class="section level2" number="12.11">
<h2><span class="header-section-number">12.11</span> References</h2>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="linear-model-2.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="linear-model-4.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"],
"google": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/psych252/psych252book/edit/master/12-linear_model3.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"toc_depth": 3,
"search": false
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
