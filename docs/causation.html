<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 16 Causation | Psych 252: Statistical Methods for Behavioral and Social Sciences</title>
  <meta name="description" content="Course notes for Psych 252." />
  <meta name="generator" content="bookdown 0.37 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 16 Causation | Psych 252: Statistical Methods for Behavioral and Social Sciences" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Course notes for Psych 252." />
  <meta name="github-repo" content="psych252/psych252book" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 16 Causation | Psych 252: Statistical Methods for Behavioral and Social Sciences" />
  
  <meta name="twitter:description" content="Course notes for Psych 252." />
  

<meta name="author" content="Tobias Gerstenberg" />


<meta name="date" content="2024-01-06" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="model-comparison.html"/>
<link rel="next" href="linear-mixed-effects-models-1.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.31/datatables.js"></script>
<link href="libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
<script src="libs/viz-1.8.2/viz.js"></script>
<link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="libs/grViz-binding-1.0.10/grViz.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Psych 252</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#course-description"><i class="fa fa-check"></i>Course description</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#course-homepage"><i class="fa fa-check"></i>Course homepage</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#license-and-citation"><i class="fa fa-check"></i>License and citation</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#thanks"><i class="fa fa-check"></i><b>1.1</b> Thanks</a></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#list-of-r-packages-used-in-this-book"><i class="fa fa-check"></i><b>1.2</b> List of R packages used in this book</a></li>
<li class="chapter" data-level="1.3" data-path="introduction.html"><a href="introduction.html#session-info"><i class="fa fa-check"></i><b>1.3</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="visualization-1.html"><a href="visualization-1.html"><i class="fa fa-check"></i><b>2</b> Visualization 1</a>
<ul>
<li class="chapter" data-level="2.1" data-path="visualization-1.html"><a href="visualization-1.html#learning-goals"><i class="fa fa-check"></i><b>2.1</b> Learning goals</a></li>
<li class="chapter" data-level="2.2" data-path="visualization-1.html"><a href="visualization-1.html#load-packages"><i class="fa fa-check"></i><b>2.2</b> Load packages</a></li>
<li class="chapter" data-level="2.3" data-path="visualization-1.html"><a href="visualization-1.html#why-visualize-data"><i class="fa fa-check"></i><b>2.3</b> Why visualize data?</a></li>
<li class="chapter" data-level="2.4" data-path="visualization-1.html"><a href="visualization-1.html#some-basics"><i class="fa fa-check"></i><b>2.4</b> Some basics</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="visualization-1.html"><a href="visualization-1.html#setting-up-rstudio"><i class="fa fa-check"></i><b>2.4.1</b> Setting up RStudio</a></li>
<li class="chapter" data-level="2.4.2" data-path="visualization-1.html"><a href="visualization-1.html#getting-help"><i class="fa fa-check"></i><b>2.4.2</b> Getting help</a></li>
<li class="chapter" data-level="2.4.3" data-path="visualization-1.html"><a href="visualization-1.html#r-markdown-infos"><i class="fa fa-check"></i><b>2.4.3</b> R Markdown infos</a></li>
<li class="chapter" data-level="2.4.4" data-path="visualization-1.html"><a href="visualization-1.html#helpful-keyboard-shortcuts"><i class="fa fa-check"></i><b>2.4.4</b> Helpful keyboard shortcuts</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="visualization-1.html"><a href="visualization-1.html#data-visualization"><i class="fa fa-check"></i><b>2.5</b> Data visualization</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="visualization-1.html"><a href="visualization-1.html#setting-up-a-plot"><i class="fa fa-check"></i><b>2.5.1</b> Setting up a plot</a></li>
<li class="chapter" data-level="2.5.2" data-path="visualization-1.html"><a href="visualization-1.html#bar-plot"><i class="fa fa-check"></i><b>2.5.2</b> Bar plot</a></li>
<li class="chapter" data-level="2.5.3" data-path="visualization-1.html"><a href="visualization-1.html#setting-the-default-plot-theme"><i class="fa fa-check"></i><b>2.5.3</b> Setting the default plot theme</a></li>
<li class="chapter" data-level="2.5.4" data-path="visualization-1.html"><a href="visualization-1.html#scatter-plot"><i class="fa fa-check"></i><b>2.5.4</b> Scatter plot</a></li>
<li class="chapter" data-level="2.5.5" data-path="visualization-1.html"><a href="visualization-1.html#line-plot"><i class="fa fa-check"></i><b>2.5.5</b> Line plot</a></li>
<li class="chapter" data-level="2.5.6" data-path="visualization-1.html"><a href="visualization-1.html#adding-error-bars"><i class="fa fa-check"></i><b>2.5.6</b> Adding error bars</a></li>
<li class="chapter" data-level="2.5.7" data-path="visualization-1.html"><a href="visualization-1.html#order-matters"><i class="fa fa-check"></i><b>2.5.7</b> Order matters</a></li>
<li class="chapter" data-level="2.5.8" data-path="visualization-1.html"><a href="visualization-1.html#grouping-data"><i class="fa fa-check"></i><b>2.5.8</b> Grouping data</a></li>
<li class="chapter" data-level="2.5.9" data-path="visualization-1.html"><a href="visualization-1.html#making-facets"><i class="fa fa-check"></i><b>2.5.9</b> Making facets</a></li>
<li class="chapter" data-level="2.5.10" data-path="visualization-1.html"><a href="visualization-1.html#global-local-and-setting-aes"><i class="fa fa-check"></i><b>2.5.10</b> Global, local, and setting <code>aes()</code></a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="visualization-1.html"><a href="visualization-1.html#additional-resources"><i class="fa fa-check"></i><b>2.6</b> Additional resources</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="visualization-1.html"><a href="visualization-1.html#cheatsheets"><i class="fa fa-check"></i><b>2.6.1</b> Cheatsheets</a></li>
<li class="chapter" data-level="2.6.2" data-path="visualization-1.html"><a href="visualization-1.html#datacamp-courses"><i class="fa fa-check"></i><b>2.6.2</b> Datacamp courses</a></li>
<li class="chapter" data-level="2.6.3" data-path="visualization-1.html"><a href="visualization-1.html#books-and-chapters"><i class="fa fa-check"></i><b>2.6.3</b> Books and chapters</a></li>
<li class="chapter" data-level="2.6.4" data-path="visualization-1.html"><a href="visualization-1.html#misc"><i class="fa fa-check"></i><b>2.6.4</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="visualization-1.html"><a href="visualization-1.html#session-info-1"><i class="fa fa-check"></i><b>2.7</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="visualization-2.html"><a href="visualization-2.html"><i class="fa fa-check"></i><b>3</b> Visualization 2</a>
<ul>
<li class="chapter" data-level="3.1" data-path="visualization-2.html"><a href="visualization-2.html#learning-objectives"><i class="fa fa-check"></i><b>3.1</b> Learning objectives</a></li>
<li class="chapter" data-level="3.2" data-path="visualization-2.html"><a href="visualization-2.html#install-and-load-packages-load-data-set-theme"><i class="fa fa-check"></i><b>3.2</b> Install and load packages, load data, set theme</a></li>
<li class="chapter" data-level="3.3" data-path="visualization-2.html"><a href="visualization-2.html#overview-of-different-plot-types-for-different-things"><i class="fa fa-check"></i><b>3.3</b> Overview of different plot types for different things</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="visualization-2.html"><a href="visualization-2.html#proportions"><i class="fa fa-check"></i><b>3.3.1</b> Proportions</a></li>
<li class="chapter" data-level="3.3.2" data-path="visualization-2.html"><a href="visualization-2.html#comparisons"><i class="fa fa-check"></i><b>3.3.2</b> Comparisons</a></li>
<li class="chapter" data-level="3.3.3" data-path="visualization-2.html"><a href="visualization-2.html#relationships"><i class="fa fa-check"></i><b>3.3.3</b> Relationships</a></li>
<li class="chapter" data-level="3.3.4" data-path="visualization-2.html"><a href="visualization-2.html#temporal-data"><i class="fa fa-check"></i><b>3.3.4</b> Temporal data</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="visualization-2.html"><a href="visualization-2.html#customizing-plots"><i class="fa fa-check"></i><b>3.4</b> Customizing plots</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="visualization-2.html"><a href="visualization-2.html#anatomy-of-a-ggplot"><i class="fa fa-check"></i><b>3.4.1</b> Anatomy of a <code>ggplot</code></a></li>
<li class="chapter" data-level="3.4.2" data-path="visualization-2.html"><a href="visualization-2.html#changing-the-order-of-things"><i class="fa fa-check"></i><b>3.4.2</b> Changing the order of things</a></li>
<li class="chapter" data-level="3.4.3" data-path="visualization-2.html"><a href="visualization-2.html#dealing-with-legends"><i class="fa fa-check"></i><b>3.4.3</b> Dealing with legends</a></li>
<li class="chapter" data-level="3.4.4" data-path="visualization-2.html"><a href="visualization-2.html#choosing-good-colors"><i class="fa fa-check"></i><b>3.4.4</b> Choosing good colors</a></li>
<li class="chapter" data-level="3.4.5" data-path="visualization-2.html"><a href="visualization-2.html#customizing-themes"><i class="fa fa-check"></i><b>3.4.5</b> Customizing themes</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="visualization-2.html"><a href="visualization-2.html#saving-plots"><i class="fa fa-check"></i><b>3.5</b> Saving plots</a></li>
<li class="chapter" data-level="3.6" data-path="visualization-2.html"><a href="visualization-2.html#creating-figure-panels"><i class="fa fa-check"></i><b>3.6</b> Creating figure panels</a></li>
<li class="chapter" data-level="3.7" data-path="visualization-2.html"><a href="visualization-2.html#peeking-behind-the-scenes"><i class="fa fa-check"></i><b>3.7</b> Peeking behind the scenes</a></li>
<li class="chapter" data-level="3.8" data-path="visualization-2.html"><a href="visualization-2.html#making-animations"><i class="fa fa-check"></i><b>3.8</b> Making animations</a></li>
<li class="chapter" data-level="3.9" data-path="visualization-2.html"><a href="visualization-2.html#shiny-apps"><i class="fa fa-check"></i><b>3.9</b> Shiny apps</a></li>
<li class="chapter" data-level="3.10" data-path="visualization-2.html"><a href="visualization-2.html#defining-snippets"><i class="fa fa-check"></i><b>3.10</b> Defining snippets</a></li>
<li class="chapter" data-level="3.11" data-path="visualization-2.html"><a href="visualization-2.html#additional-resources-1"><i class="fa fa-check"></i><b>3.11</b> Additional resources</a>
<ul>
<li class="chapter" data-level="3.11.1" data-path="visualization-2.html"><a href="visualization-2.html#cheatsheets-1"><i class="fa fa-check"></i><b>3.11.1</b> Cheatsheets</a></li>
<li class="chapter" data-level="3.11.2" data-path="visualization-2.html"><a href="visualization-2.html#data-camp-courses"><i class="fa fa-check"></i><b>3.11.2</b> Data camp courses</a></li>
<li class="chapter" data-level="3.11.3" data-path="visualization-2.html"><a href="visualization-2.html#books-and-chapters-1"><i class="fa fa-check"></i><b>3.11.3</b> Books and chapters</a></li>
<li class="chapter" data-level="3.11.4" data-path="visualization-2.html"><a href="visualization-2.html#misc-1"><i class="fa fa-check"></i><b>3.11.4</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="3.12" data-path="visualization-2.html"><a href="visualization-2.html#session-info-2"><i class="fa fa-check"></i><b>3.12</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html"><i class="fa fa-check"></i><b>4</b> Data wrangling 1</a>
<ul>
<li class="chapter" data-level="4.1" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#learning-goals-1"><i class="fa fa-check"></i><b>4.1</b> Learning goals</a></li>
<li class="chapter" data-level="4.2" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#load-packages-1"><i class="fa fa-check"></i><b>4.2</b> Load packages</a></li>
<li class="chapter" data-level="4.3" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#some-r-basics"><i class="fa fa-check"></i><b>4.3</b> Some R basics</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#modes"><i class="fa fa-check"></i><b>4.3.1</b> Modes</a></li>
<li class="chapter" data-level="4.3.2" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#data-types"><i class="fa fa-check"></i><b>4.3.2</b> Data types</a></li>
<li class="chapter" data-level="4.3.3" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#operators"><i class="fa fa-check"></i><b>4.3.3</b> Operators</a></li>
<li class="chapter" data-level="4.3.4" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#control-flow"><i class="fa fa-check"></i><b>4.3.4</b> Control flow</a></li>
<li class="chapter" data-level="4.3.5" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#functions"><i class="fa fa-check"></i><b>4.3.5</b> Functions</a></li>
<li class="chapter" data-level="4.3.6" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#the-pipe-operator"><i class="fa fa-check"></i><b>4.3.6</b> The pipe operator <code>%&gt;%</code></a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#a-quick-note-on-naming-things"><i class="fa fa-check"></i><b>4.4</b> A quick note on naming things</a></li>
<li class="chapter" data-level="4.5" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#looking-at-data"><i class="fa fa-check"></i><b>4.5</b> Looking at data</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#head"><i class="fa fa-check"></i><b>4.5.1</b> <code>head()</code></a></li>
<li class="chapter" data-level="4.5.2" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#glimpse"><i class="fa fa-check"></i><b>4.5.2</b> <code>glimpse()</code></a></li>
<li class="chapter" data-level="4.5.3" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#distinct"><i class="fa fa-check"></i><b>4.5.3</b> <code>distinct()</code></a></li>
<li class="chapter" data-level="4.5.4" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#count"><i class="fa fa-check"></i><b>4.5.4</b> <code>count()</code></a></li>
<li class="chapter" data-level="4.5.5" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#datatable"><i class="fa fa-check"></i><b>4.5.5</b> <code>datatable()</code></a></li>
<li class="chapter" data-level="4.5.6" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#other-tools-for-taking-a-quick-look-at-data"><i class="fa fa-check"></i><b>4.5.6</b> Other tools for taking a quick look at data</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#wrangling-data"><i class="fa fa-check"></i><b>4.6</b> Wrangling data</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#filter"><i class="fa fa-check"></i><b>4.6.1</b> <code>filter()</code></a></li>
<li class="chapter" data-level="4.6.2" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#arrange"><i class="fa fa-check"></i><b>4.6.2</b> <code>arrange()</code></a></li>
<li class="chapter" data-level="4.6.3" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#rename"><i class="fa fa-check"></i><b>4.6.3</b> <code>rename()</code></a></li>
<li class="chapter" data-level="4.6.4" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#relocate"><i class="fa fa-check"></i><b>4.6.4</b> <code>relocate()</code></a></li>
<li class="chapter" data-level="4.6.5" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#select"><i class="fa fa-check"></i><b>4.6.5</b> <code>select()</code></a></li>
<li class="chapter" data-level="4.6.6" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#practice-2"><i class="fa fa-check"></i><b>4.6.6</b> Practice 2</a></li>
<li class="chapter" data-level="4.6.7" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#mutate"><i class="fa fa-check"></i><b>4.6.7</b> <code>mutate()</code></a></li>
<li class="chapter" data-level="4.6.8" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#practice-3"><i class="fa fa-check"></i><b>4.6.8</b> Practice 3</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#additional-resources-2"><i class="fa fa-check"></i><b>4.7</b> Additional resources</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#cheatsheets-2"><i class="fa fa-check"></i><b>4.7.1</b> Cheatsheets</a></li>
<li class="chapter" data-level="4.7.2" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#data-camp-courses-1"><i class="fa fa-check"></i><b>4.7.2</b> Data camp courses</a></li>
<li class="chapter" data-level="4.7.3" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#books-and-chapters-2"><i class="fa fa-check"></i><b>4.7.3</b> Books and chapters</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#session-info-3"><i class="fa fa-check"></i><b>4.8</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html"><i class="fa fa-check"></i><b>5</b> Data wrangling 2</a>
<ul>
<li class="chapter" data-level="5.1" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#learning-goals-2"><i class="fa fa-check"></i><b>5.1</b> Learning goals</a></li>
<li class="chapter" data-level="5.2" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#load-packages-2"><i class="fa fa-check"></i><b>5.2</b> Load packages</a></li>
<li class="chapter" data-level="5.3" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#settings"><i class="fa fa-check"></i><b>5.3</b> Settings</a></li>
<li class="chapter" data-level="5.4" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#wrangling-data-continued"><i class="fa fa-check"></i><b>5.4</b> Wrangling data (continued)</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#summarizing-data"><i class="fa fa-check"></i><b>5.4.1</b> Summarizing data</a></li>
<li class="chapter" data-level="5.4.2" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#reshaping-data"><i class="fa fa-check"></i><b>5.4.2</b> Reshaping data</a></li>
<li class="chapter" data-level="5.4.3" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#joining-multiple-data-frames"><i class="fa fa-check"></i><b>5.4.3</b> Joining multiple data frames</a></li>
<li class="chapter" data-level="5.4.4" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#dealing-with-missing-data"><i class="fa fa-check"></i><b>5.4.4</b> Dealing with missing data</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#reading-in-data"><i class="fa fa-check"></i><b>5.5</b> Reading in data</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#csv"><i class="fa fa-check"></i><b>5.5.1</b> csv</a></li>
<li class="chapter" data-level="5.5.2" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#rdata"><i class="fa fa-check"></i><b>5.5.2</b> RData</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#saving-data"><i class="fa fa-check"></i><b>5.6</b> Saving data</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#csv-1"><i class="fa fa-check"></i><b>5.6.1</b> csv</a></li>
<li class="chapter" data-level="5.6.2" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#rdata-1"><i class="fa fa-check"></i><b>5.6.2</b> RData</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#additional-resources-3"><i class="fa fa-check"></i><b>5.7</b> Additional resources</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#cheatsheets-3"><i class="fa fa-check"></i><b>5.7.1</b> Cheatsheets</a></li>
<li class="chapter" data-level="5.7.2" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#data-camp-courses-2"><i class="fa fa-check"></i><b>5.7.2</b> Data camp courses</a></li>
<li class="chapter" data-level="5.7.3" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#books-and-chapters-3"><i class="fa fa-check"></i><b>5.7.3</b> Books and chapters</a></li>
<li class="chapter" data-level="5.7.4" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#tutorials"><i class="fa fa-check"></i><b>5.7.4</b> Tutorials</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#session-info-4"><i class="fa fa-check"></i><b>5.8</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="probability-and-causality.html"><a href="probability-and-causality.html"><i class="fa fa-check"></i><b>6</b> Probability and causality</a>
<ul>
<li class="chapter" data-level="6.1" data-path="probability-and-causality.html"><a href="probability-and-causality.html#load-packages-load-data-set-theme"><i class="fa fa-check"></i><b>6.1</b> Load packages, load data, set theme</a></li>
<li class="chapter" data-level="6.2" data-path="probability-and-causality.html"><a href="probability-and-causality.html#counting"><i class="fa fa-check"></i><b>6.2</b> Counting</a></li>
<li class="chapter" data-level="6.3" data-path="probability-and-causality.html"><a href="probability-and-causality.html#the-random-secretary"><i class="fa fa-check"></i><b>6.3</b> The random secretary</a></li>
<li class="chapter" data-level="6.4" data-path="probability-and-causality.html"><a href="probability-and-causality.html#flipping-a-coin-many-times"><i class="fa fa-check"></i><b>6.4</b> Flipping a coin many times</a></li>
<li class="chapter" data-level="6.5" data-path="probability-and-causality.html"><a href="probability-and-causality.html#clue-guide-to-probability"><i class="fa fa-check"></i><b>6.5</b> Clue guide to probability</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="probability-and-causality.html"><a href="probability-and-causality.html#conditional-probability"><i class="fa fa-check"></i><b>6.5.1</b> Conditional probability</a></li>
<li class="chapter" data-level="6.5.2" data-path="probability-and-causality.html"><a href="probability-and-causality.html#law-of-total-probability"><i class="fa fa-check"></i><b>6.5.2</b> Law of total probability</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="probability-and-causality.html"><a href="probability-and-causality.html#probability-operations"><i class="fa fa-check"></i><b>6.6</b> Probability operations</a></li>
<li class="chapter" data-level="6.7" data-path="probability-and-causality.html"><a href="probability-and-causality.html#bayesian-reasoning-explained"><i class="fa fa-check"></i><b>6.7</b> Bayesian reasoning explained</a></li>
<li class="chapter" data-level="6.8" data-path="probability-and-causality.html"><a href="probability-and-causality.html#getting-bayes-right-matters"><i class="fa fa-check"></i><b>6.8</b> Getting Bayes right matters</a>
<ul>
<li class="chapter" data-level="6.8.1" data-path="probability-and-causality.html"><a href="probability-and-causality.html#bayesian-reasoning-example"><i class="fa fa-check"></i><b>6.8.1</b> Bayesian reasoning example</a></li>
<li class="chapter" data-level="6.8.2" data-path="probability-and-causality.html"><a href="probability-and-causality.html#bayesian-reasoning-example-covid-rapid-test"><i class="fa fa-check"></i><b>6.8.2</b> Bayesian reasoning example (COVID rapid test)</a></li>
<li class="chapter" data-level="6.8.3" data-path="probability-and-causality.html"><a href="probability-and-causality.html#most-people-in-the-hospital-are-vaccinated"><i class="fa fa-check"></i><b>6.8.3</b> Most people in the hospital are vaccinated</a></li>
</ul></li>
<li class="chapter" data-level="6.9" data-path="probability-and-causality.html"><a href="probability-and-causality.html#building-a-bayesis"><i class="fa fa-check"></i><b>6.9</b> Building a Bayesis</a>
<ul>
<li class="chapter" data-level="6.9.1" data-path="probability-and-causality.html"><a href="probability-and-causality.html#dice-example"><i class="fa fa-check"></i><b>6.9.1</b> Dice example</a></li>
</ul></li>
<li class="chapter" data-level="6.10" data-path="probability-and-causality.html"><a href="probability-and-causality.html#additional-resources-4"><i class="fa fa-check"></i><b>6.10</b> Additional resources</a>
<ul>
<li class="chapter" data-level="6.10.1" data-path="probability-and-causality.html"><a href="probability-and-causality.html#cheatsheets-4"><i class="fa fa-check"></i><b>6.10.1</b> Cheatsheets</a></li>
<li class="chapter" data-level="6.10.2" data-path="probability-and-causality.html"><a href="probability-and-causality.html#books-and-chapters-4"><i class="fa fa-check"></i><b>6.10.2</b> Books and chapters</a></li>
<li class="chapter" data-level="6.10.3" data-path="probability-and-causality.html"><a href="probability-and-causality.html#misc-2"><i class="fa fa-check"></i><b>6.10.3</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="6.11" data-path="probability-and-causality.html"><a href="probability-and-causality.html#session-info-5"><i class="fa fa-check"></i><b>6.11</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="simulation-1.html"><a href="simulation-1.html"><i class="fa fa-check"></i><b>7</b> Simulation 1</a>
<ul>
<li class="chapter" data-level="7.1" data-path="simulation-1.html"><a href="simulation-1.html#load-packages-and-set-plotting-theme"><i class="fa fa-check"></i><b>7.1</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="7.2" data-path="simulation-1.html"><a href="simulation-1.html#sampling"><i class="fa fa-check"></i><b>7.2</b> Sampling</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="simulation-1.html"><a href="simulation-1.html#drawing-numbers-from-a-vector"><i class="fa fa-check"></i><b>7.2.1</b> Drawing numbers from a vector</a></li>
<li class="chapter" data-level="7.2.2" data-path="simulation-1.html"><a href="simulation-1.html#drawing-rows-from-a-data-frame"><i class="fa fa-check"></i><b>7.2.2</b> Drawing rows from a data frame</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="simulation-1.html"><a href="simulation-1.html#working-with-distributions"><i class="fa fa-check"></i><b>7.3</b> Working with distributions</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="simulation-1.html"><a href="simulation-1.html#plotting-distributions"><i class="fa fa-check"></i><b>7.3.1</b> Plotting distributions</a></li>
<li class="chapter" data-level="7.3.2" data-path="simulation-1.html"><a href="simulation-1.html#sampling-from-distributions"><i class="fa fa-check"></i><b>7.3.2</b> Sampling from distributions</a></li>
<li class="chapter" data-level="7.3.3" data-path="simulation-1.html"><a href="simulation-1.html#understanding-density"><i class="fa fa-check"></i><b>7.3.3</b> Understanding <code>density()</code></a></li>
<li class="chapter" data-level="7.3.4" data-path="simulation-1.html"><a href="simulation-1.html#cumulative-probability-distribution"><i class="fa fa-check"></i><b>7.3.4</b> Cumulative probability distribution</a></li>
<li class="chapter" data-level="7.3.5" data-path="simulation-1.html"><a href="simulation-1.html#inverse-cumulative-distribution"><i class="fa fa-check"></i><b>7.3.5</b> Inverse cumulative distribution</a></li>
<li class="chapter" data-level="7.3.6" data-path="simulation-1.html"><a href="simulation-1.html#computing-probabilities"><i class="fa fa-check"></i><b>7.3.6</b> Computing probabilities</a></li>
<li class="chapter" data-level="7.3.7" data-path="simulation-1.html"><a href="simulation-1.html#make-the-plot"><i class="fa fa-check"></i><b>7.3.7</b> Make the plot</a></li>
<li class="chapter" data-level="7.3.8" data-path="simulation-1.html"><a href="simulation-1.html#analytic-solutions"><i class="fa fa-check"></i><b>7.3.8</b> Analytic solutions</a></li>
<li class="chapter" data-level="7.3.9" data-path="simulation-1.html"><a href="simulation-1.html#sampling-solution"><i class="fa fa-check"></i><b>7.3.9</b> Sampling solution</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="simulation-1.html"><a href="simulation-1.html#bayesian-inference-with-the-normal-distribution"><i class="fa fa-check"></i><b>7.4</b> Bayesian inference with the normal distribution</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="simulation-1.html"><a href="simulation-1.html#analytic-solution"><i class="fa fa-check"></i><b>7.4.1</b> Analytic solution</a></li>
<li class="chapter" data-level="7.4.2" data-path="simulation-1.html"><a href="simulation-1.html#solution-via-sampling"><i class="fa fa-check"></i><b>7.4.2</b> Solution via sampling</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="simulation-1.html"><a href="simulation-1.html#additional-resources-5"><i class="fa fa-check"></i><b>7.5</b> Additional resources</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="simulation-1.html"><a href="simulation-1.html#datacamp"><i class="fa fa-check"></i><b>7.5.1</b> Datacamp</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="simulation-1.html"><a href="simulation-1.html#session-info-6"><i class="fa fa-check"></i><b>7.6</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="simulation-2.html"><a href="simulation-2.html"><i class="fa fa-check"></i><b>8</b> Simulation 2</a>
<ul>
<li class="chapter" data-level="8.1" data-path="simulation-2.html"><a href="simulation-2.html#load-packages-and-set-plotting-theme-1"><i class="fa fa-check"></i><b>8.1</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="8.2" data-path="simulation-2.html"><a href="simulation-2.html#making-statistical-inferences-frequentist-style"><i class="fa fa-check"></i><b>8.2</b> Making statistical inferences (frequentist style)</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="simulation-2.html"><a href="simulation-2.html#population-distribution"><i class="fa fa-check"></i><b>8.2.1</b> Population distribution</a></li>
<li class="chapter" data-level="8.2.2" data-path="simulation-2.html"><a href="simulation-2.html#distribution-of-a-single-sample"><i class="fa fa-check"></i><b>8.2.2</b> Distribution of a single sample</a></li>
<li class="chapter" data-level="8.2.3" data-path="simulation-2.html"><a href="simulation-2.html#the-sampling-distribution"><i class="fa fa-check"></i><b>8.2.3</b> The sampling distribution</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="simulation-2.html"><a href="simulation-2.html#understanding-p-values"><i class="fa fa-check"></i><b>8.3</b> Understanding p-values</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="simulation-2.html"><a href="simulation-2.html#permutation-test"><i class="fa fa-check"></i><b>8.3.1</b> Permutation test</a></li>
<li class="chapter" data-level="8.3.2" data-path="simulation-2.html"><a href="simulation-2.html#t-test-by-hand"><i class="fa fa-check"></i><b>8.3.2</b> t-test by hand</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="simulation-2.html"><a href="simulation-2.html#confidence-intervals"><i class="fa fa-check"></i><b>8.4</b> Confidence intervals</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="simulation-2.html"><a href="simulation-2.html#mean_cl_boot-explained"><i class="fa fa-check"></i><b>8.4.1</b> <code>mean_cl_boot()</code> explained</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="simulation-2.html"><a href="simulation-2.html#additional-resources-6"><i class="fa fa-check"></i><b>8.5</b> Additional resources</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="simulation-2.html"><a href="simulation-2.html#datacamp-1"><i class="fa fa-check"></i><b>8.5.1</b> Datacamp</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="simulation-2.html"><a href="simulation-2.html#session-info-7"><i class="fa fa-check"></i><b>8.6</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="modeling-data.html"><a href="modeling-data.html"><i class="fa fa-check"></i><b>9</b> Modeling data</a>
<ul>
<li class="chapter" data-level="9.1" data-path="modeling-data.html"><a href="modeling-data.html#load-packages-and-set-plotting-theme-2"><i class="fa fa-check"></i><b>9.1</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="9.2" data-path="modeling-data.html"><a href="modeling-data.html#modeling-data-1"><i class="fa fa-check"></i><b>9.2</b> Modeling data</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="modeling-data.html"><a href="modeling-data.html#simplicity-vs.-accuracy-trade-off"><i class="fa fa-check"></i><b>9.2.1</b> Simplicity vs. accuracy trade-off</a></li>
<li class="chapter" data-level="9.2.2" data-path="modeling-data.html"><a href="modeling-data.html#sampling-distributions-for-median-and-mean"><i class="fa fa-check"></i><b>9.2.2</b> Sampling distributions for median and mean</a></li>
<li class="chapter" data-level="9.2.3" data-path="modeling-data.html"><a href="modeling-data.html#residuals-need-to-be-normally-distributed-not-the-data-itself"><i class="fa fa-check"></i><b>9.2.3</b> Residuals need to be normally distributed, not the data itself</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="modeling-data.html"><a href="modeling-data.html#hypothesis-testing-one-sample-t-test"><i class="fa fa-check"></i><b>9.3</b> Hypothesis testing: “One-sample t-test”</a></li>
<li class="chapter" data-level="9.4" data-path="modeling-data.html"><a href="modeling-data.html#building-a-sampling-distribution-of-pre"><i class="fa fa-check"></i><b>9.4</b> Building a sampling distribution of PRE</a></li>
<li class="chapter" data-level="9.5" data-path="modeling-data.html"><a href="modeling-data.html#misc-3"><i class="fa fa-check"></i><b>9.5</b> Misc</a></li>
<li class="chapter" data-level="9.6" data-path="modeling-data.html"><a href="modeling-data.html#additional-resources-7"><i class="fa fa-check"></i><b>9.6</b> Additional resources</a>
<ul>
<li class="chapter" data-level="9.6.1" data-path="modeling-data.html"><a href="modeling-data.html#reading"><i class="fa fa-check"></i><b>9.6.1</b> Reading</a></li>
<li class="chapter" data-level="9.6.2" data-path="modeling-data.html"><a href="modeling-data.html#datacamp-2"><i class="fa fa-check"></i><b>9.6.2</b> Datacamp</a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="modeling-data.html"><a href="modeling-data.html#session-info-8"><i class="fa fa-check"></i><b>9.7</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="linear-model-1.html"><a href="linear-model-1.html"><i class="fa fa-check"></i><b>10</b> Linear model 1</a>
<ul>
<li class="chapter" data-level="10.1" data-path="linear-model-1.html"><a href="linear-model-1.html#load-packages-and-set-plotting-theme-3"><i class="fa fa-check"></i><b>10.1</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="10.2" data-path="linear-model-1.html"><a href="linear-model-1.html#correlation"><i class="fa fa-check"></i><b>10.2</b> Correlation</a></li>
<li class="chapter" data-level="10.3" data-path="linear-model-1.html"><a href="linear-model-1.html#regression"><i class="fa fa-check"></i><b>10.3</b> Regression</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="linear-model-1.html"><a href="linear-model-1.html#define-and-fit-the-models"><i class="fa fa-check"></i><b>10.3.1</b> Define and fit the models</a></li>
<li class="chapter" data-level="10.3.2" data-path="linear-model-1.html"><a href="linear-model-1.html#calculate-the-sum-of-squared-errors-of-each-model"><i class="fa fa-check"></i><b>10.3.2</b> Calculate the sum of squared errors of each model</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="linear-model-1.html"><a href="linear-model-1.html#credit-example"><i class="fa fa-check"></i><b>10.4</b> Credit example</a></li>
<li class="chapter" data-level="10.5" data-path="linear-model-1.html"><a href="linear-model-1.html#additional-resources-8"><i class="fa fa-check"></i><b>10.5</b> Additional resources</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="linear-model-1.html"><a href="linear-model-1.html#datacamp-3"><i class="fa fa-check"></i><b>10.5.1</b> Datacamp</a></li>
<li class="chapter" data-level="10.5.2" data-path="linear-model-1.html"><a href="linear-model-1.html#misc-4"><i class="fa fa-check"></i><b>10.5.2</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="linear-model-1.html"><a href="linear-model-1.html#session-info-9"><i class="fa fa-check"></i><b>10.6</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="linear-model-2.html"><a href="linear-model-2.html"><i class="fa fa-check"></i><b>11</b> Linear model 2</a>
<ul>
<li class="chapter" data-level="11.1" data-path="linear-model-2.html"><a href="linear-model-2.html#learning-goals-3"><i class="fa fa-check"></i><b>11.1</b> Learning goals</a></li>
<li class="chapter" data-level="11.2" data-path="linear-model-2.html"><a href="linear-model-2.html#load-packages-and-set-plotting-theme-4"><i class="fa fa-check"></i><b>11.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="11.3" data-path="linear-model-2.html"><a href="linear-model-2.html#load-data-sets"><i class="fa fa-check"></i><b>11.3</b> Load data sets</a></li>
<li class="chapter" data-level="11.4" data-path="linear-model-2.html"><a href="linear-model-2.html#multiple-continuous-variables"><i class="fa fa-check"></i><b>11.4</b> Multiple continuous variables</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="linear-model-2.html"><a href="linear-model-2.html#explore-correlations"><i class="fa fa-check"></i><b>11.4.1</b> Explore correlations</a></li>
<li class="chapter" data-level="11.4.2" data-path="linear-model-2.html"><a href="linear-model-2.html#multipe-regression"><i class="fa fa-check"></i><b>11.4.2</b> Multipe regression</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="linear-model-2.html"><a href="linear-model-2.html#one-categorical-variable"><i class="fa fa-check"></i><b>11.5</b> One categorical variable</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="linear-model-2.html"><a href="linear-model-2.html#visualization-of-the-model-predictions"><i class="fa fa-check"></i><b>11.5.1</b> Visualization of the model predictions</a></li>
<li class="chapter" data-level="11.5.2" data-path="linear-model-2.html"><a href="linear-model-2.html#dummy-coding"><i class="fa fa-check"></i><b>11.5.2</b> Dummy coding</a></li>
<li class="chapter" data-level="11.5.3" data-path="linear-model-2.html"><a href="linear-model-2.html#reporting-the-results"><i class="fa fa-check"></i><b>11.5.3</b> Reporting the results</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="linear-model-2.html"><a href="linear-model-2.html#one-continuous-and-one-categorical-variable"><i class="fa fa-check"></i><b>11.6</b> One continuous and one categorical variable</a>
<ul>
<li class="chapter" data-level="11.6.1" data-path="linear-model-2.html"><a href="linear-model-2.html#visualization-of-the-model-predictions-1"><i class="fa fa-check"></i><b>11.6.1</b> Visualization of the model predictions</a></li>
</ul></li>
<li class="chapter" data-level="11.7" data-path="linear-model-2.html"><a href="linear-model-2.html#interactions"><i class="fa fa-check"></i><b>11.7</b> Interactions</a>
<ul>
<li class="chapter" data-level="11.7.1" data-path="linear-model-2.html"><a href="linear-model-2.html#visualization-3"><i class="fa fa-check"></i><b>11.7.1</b> Visualization</a></li>
<li class="chapter" data-level="11.7.2" data-path="linear-model-2.html"><a href="linear-model-2.html#hypothesis-test"><i class="fa fa-check"></i><b>11.7.2</b> Hypothesis test</a></li>
</ul></li>
<li class="chapter" data-level="11.8" data-path="linear-model-2.html"><a href="linear-model-2.html#additional-resources-9"><i class="fa fa-check"></i><b>11.8</b> Additional resources</a>
<ul>
<li class="chapter" data-level="11.8.1" data-path="linear-model-2.html"><a href="linear-model-2.html#datacamp-4"><i class="fa fa-check"></i><b>11.8.1</b> Datacamp</a></li>
<li class="chapter" data-level="11.8.2" data-path="linear-model-2.html"><a href="linear-model-2.html#misc-5"><i class="fa fa-check"></i><b>11.8.2</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="11.9" data-path="linear-model-2.html"><a href="linear-model-2.html#session-info-10"><i class="fa fa-check"></i><b>11.9</b> Session info</a></li>
<li class="chapter" data-level="11.10" data-path="linear-model-2.html"><a href="linear-model-2.html#references"><i class="fa fa-check"></i><b>11.10</b> References</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="linear-model-3.html"><a href="linear-model-3.html"><i class="fa fa-check"></i><b>12</b> Linear model 3</a>
<ul>
<li class="chapter" data-level="12.1" data-path="linear-model-3.html"><a href="linear-model-3.html#learning-goals-4"><i class="fa fa-check"></i><b>12.1</b> Learning goals</a></li>
<li class="chapter" data-level="12.2" data-path="linear-model-3.html"><a href="linear-model-3.html#load-packages-and-set-plotting-theme-5"><i class="fa fa-check"></i><b>12.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="12.3" data-path="linear-model-3.html"><a href="linear-model-3.html#load-data-sets-1"><i class="fa fa-check"></i><b>12.3</b> Load data sets</a></li>
<li class="chapter" data-level="12.4" data-path="linear-model-3.html"><a href="linear-model-3.html#one-way-anova"><i class="fa fa-check"></i><b>12.4</b> One-way ANOVA</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="linear-model-3.html"><a href="linear-model-3.html#visualization-4"><i class="fa fa-check"></i><b>12.4.1</b> Visualization</a></li>
<li class="chapter" data-level="12.4.2" data-path="linear-model-3.html"><a href="linear-model-3.html#model-fitting"><i class="fa fa-check"></i><b>12.4.2</b> Model fitting</a></li>
<li class="chapter" data-level="12.4.3" data-path="linear-model-3.html"><a href="linear-model-3.html#hypothesis-test-1"><i class="fa fa-check"></i><b>12.4.3</b> Hypothesis test</a></li>
<li class="chapter" data-level="12.4.4" data-path="linear-model-3.html"><a href="linear-model-3.html#visualize-the-models-predictions"><i class="fa fa-check"></i><b>12.4.4</b> Visualize the model’s predictions</a></li>
<li class="chapter" data-level="12.4.5" data-path="linear-model-3.html"><a href="linear-model-3.html#dummy-coding-1"><i class="fa fa-check"></i><b>12.4.5</b> Dummy coding</a></li>
<li class="chapter" data-level="12.4.6" data-path="linear-model-3.html"><a href="linear-model-3.html#follow-up-questions"><i class="fa fa-check"></i><b>12.4.6</b> Follow up questions</a></li>
<li class="chapter" data-level="12.4.7" data-path="linear-model-3.html"><a href="linear-model-3.html#variance-decomposition"><i class="fa fa-check"></i><b>12.4.7</b> Variance decomposition</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="linear-model-3.html"><a href="linear-model-3.html#two-way-anova"><i class="fa fa-check"></i><b>12.5</b> Two-way ANOVA</a>
<ul>
<li class="chapter" data-level="12.5.1" data-path="linear-model-3.html"><a href="linear-model-3.html#visualization-5"><i class="fa fa-check"></i><b>12.5.1</b> Visualization</a></li>
<li class="chapter" data-level="12.5.2" data-path="linear-model-3.html"><a href="linear-model-3.html#model-fitting-1"><i class="fa fa-check"></i><b>12.5.2</b> Model fitting</a></li>
<li class="chapter" data-level="12.5.3" data-path="linear-model-3.html"><a href="linear-model-3.html#interpreting-interactions"><i class="fa fa-check"></i><b>12.5.3</b> Interpreting interactions</a></li>
<li class="chapter" data-level="12.5.4" data-path="linear-model-3.html"><a href="linear-model-3.html#variance-decomposition-1"><i class="fa fa-check"></i><b>12.5.4</b> Variance decomposition</a></li>
</ul></li>
<li class="chapter" data-level="12.6" data-path="linear-model-3.html"><a href="linear-model-3.html#two-way-anova-with-interaction"><i class="fa fa-check"></i><b>12.6</b> Two-way ANOVA (with interaction)</a></li>
<li class="chapter" data-level="12.7" data-path="linear-model-3.html"><a href="linear-model-3.html#additional-resources-10"><i class="fa fa-check"></i><b>12.7</b> Additional resources</a>
<ul>
<li class="chapter" data-level="12.7.1" data-path="linear-model-3.html"><a href="linear-model-3.html#datacamp-5"><i class="fa fa-check"></i><b>12.7.1</b> Datacamp</a></li>
<li class="chapter" data-level="12.7.2" data-path="linear-model-3.html"><a href="linear-model-3.html#misc-6"><i class="fa fa-check"></i><b>12.7.2</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="12.8" data-path="linear-model-3.html"><a href="linear-model-3.html#session-info-11"><i class="fa fa-check"></i><b>12.8</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="linear-model-4.html"><a href="linear-model-4.html"><i class="fa fa-check"></i><b>13</b> Linear model 4</a>
<ul>
<li class="chapter" data-level="13.1" data-path="linear-model-4.html"><a href="linear-model-4.html#load-packages-and-set-plotting-theme-6"><i class="fa fa-check"></i><b>13.1</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="13.2" data-path="linear-model-4.html"><a href="linear-model-4.html#load-data-sets-2"><i class="fa fa-check"></i><b>13.2</b> Load data sets</a></li>
<li class="chapter" data-level="13.3" data-path="linear-model-4.html"><a href="linear-model-4.html#anova-with-unbalanced-design"><i class="fa fa-check"></i><b>13.3</b> ANOVA with unbalanced design</a></li>
<li class="chapter" data-level="13.4" data-path="linear-model-4.html"><a href="linear-model-4.html#interpreting-parameters-very-important"><i class="fa fa-check"></i><b>13.4</b> Interpreting parameters (very important!)</a></li>
<li class="chapter" data-level="13.5" data-path="linear-model-4.html"><a href="linear-model-4.html#linear-contrasts"><i class="fa fa-check"></i><b>13.5</b> Linear contrasts</a>
<ul>
<li class="chapter" data-level="13.5.1" data-path="linear-model-4.html"><a href="linear-model-4.html#hypothetical-data"><i class="fa fa-check"></i><b>13.5.1</b> Hypothetical data</a></li>
<li class="chapter" data-level="13.5.2" data-path="linear-model-4.html"><a href="linear-model-4.html#visualization-6"><i class="fa fa-check"></i><b>13.5.2</b> Visualization</a></li>
<li class="chapter" data-level="13.5.3" data-path="linear-model-4.html"><a href="linear-model-4.html#post-hoc-tests"><i class="fa fa-check"></i><b>13.5.3</b> Post-hoc tests</a></li>
<li class="chapter" data-level="13.5.4" data-path="linear-model-4.html"><a href="linear-model-4.html#understanding-dummy-coding"><i class="fa fa-check"></i><b>13.5.4</b> Understanding dummy coding</a></li>
<li class="chapter" data-level="13.5.5" data-path="linear-model-4.html"><a href="linear-model-4.html#understanding-sum-coding"><i class="fa fa-check"></i><b>13.5.5</b> Understanding sum coding</a></li>
</ul></li>
<li class="chapter" data-level="13.6" data-path="linear-model-4.html"><a href="linear-model-4.html#additional-resources-11"><i class="fa fa-check"></i><b>13.6</b> Additional resources</a>
<ul>
<li class="chapter" data-level="13.6.1" data-path="linear-model-4.html"><a href="linear-model-4.html#misc-7"><i class="fa fa-check"></i><b>13.6.1</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="13.7" data-path="linear-model-4.html"><a href="linear-model-4.html#session-info-12"><i class="fa fa-check"></i><b>13.7</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="power-analysis.html"><a href="power-analysis.html"><i class="fa fa-check"></i><b>14</b> Power analysis</a>
<ul>
<li class="chapter" data-level="14.1" data-path="power-analysis.html"><a href="power-analysis.html#learning-goals-5"><i class="fa fa-check"></i><b>14.1</b> Learning goals</a></li>
<li class="chapter" data-level="14.2" data-path="power-analysis.html"><a href="power-analysis.html#load-packages-and-set-plotting-theme-7"><i class="fa fa-check"></i><b>14.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="14.3" data-path="power-analysis.html"><a href="power-analysis.html#load-data-sets-3"><i class="fa fa-check"></i><b>14.3</b> Load data sets</a></li>
<li class="chapter" data-level="14.4" data-path="power-analysis.html"><a href="power-analysis.html#decision-making"><i class="fa fa-check"></i><b>14.4</b> Decision-making</a></li>
<li class="chapter" data-level="14.5" data-path="power-analysis.html"><a href="power-analysis.html#effect-sizes"><i class="fa fa-check"></i><b>14.5</b> Effect sizes</a>
<ul>
<li class="chapter" data-level="14.5.1" data-path="power-analysis.html"><a href="power-analysis.html#cohens-d"><i class="fa fa-check"></i><b>14.5.1</b> Cohen’s d</a></li>
</ul></li>
<li class="chapter" data-level="14.6" data-path="power-analysis.html"><a href="power-analysis.html#determining-sample-size"><i class="fa fa-check"></i><b>14.6</b> Determining sample size</a>
<ul>
<li class="chapter" data-level="14.6.1" data-path="power-analysis.html"><a href="power-analysis.html#pwr-package"><i class="fa fa-check"></i><b>14.6.1</b> <code>pwr</code> package</a></li>
<li class="chapter" data-level="14.6.2" data-path="power-analysis.html"><a href="power-analysis.html#power-analysis-1"><i class="fa fa-check"></i><b>14.6.2</b> Power analysis</a></li>
</ul></li>
<li class="chapter" data-level="14.7" data-path="power-analysis.html"><a href="power-analysis.html#additional-resources-12"><i class="fa fa-check"></i><b>14.7</b> Additional resources</a>
<ul>
<li class="chapter" data-level="14.7.1" data-path="power-analysis.html"><a href="power-analysis.html#datacamp-6"><i class="fa fa-check"></i><b>14.7.1</b> Datacamp</a></li>
<li class="chapter" data-level="14.7.2" data-path="power-analysis.html"><a href="power-analysis.html#cheatsheets-5"><i class="fa fa-check"></i><b>14.7.2</b> Cheatsheets</a></li>
<li class="chapter" data-level="14.7.3" data-path="power-analysis.html"><a href="power-analysis.html#misc-8"><i class="fa fa-check"></i><b>14.7.3</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="14.8" data-path="power-analysis.html"><a href="power-analysis.html#session-info-13"><i class="fa fa-check"></i><b>14.8</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="model-comparison.html"><a href="model-comparison.html"><i class="fa fa-check"></i><b>15</b> Model comparison</a>
<ul>
<li class="chapter" data-level="15.1" data-path="model-comparison.html"><a href="model-comparison.html#learning-goals-6"><i class="fa fa-check"></i><b>15.1</b> Learning goals</a></li>
<li class="chapter" data-level="15.2" data-path="model-comparison.html"><a href="model-comparison.html#load-packages-and-set-plotting-theme-8"><i class="fa fa-check"></i><b>15.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="15.3" data-path="model-comparison.html"><a href="model-comparison.html#model-comparison-1"><i class="fa fa-check"></i><b>15.3</b> Model comparison</a>
<ul>
<li class="chapter" data-level="15.3.1" data-path="model-comparison.html"><a href="model-comparison.html#fitting-vs.-predicting"><i class="fa fa-check"></i><b>15.3.1</b> Fitting vs. predicting</a></li>
<li class="chapter" data-level="15.3.2" data-path="model-comparison.html"><a href="model-comparison.html#f-test"><i class="fa fa-check"></i><b>15.3.2</b> F-test</a></li>
<li class="chapter" data-level="15.3.3" data-path="model-comparison.html"><a href="model-comparison.html#cross-validation"><i class="fa fa-check"></i><b>15.3.3</b> Cross-validation</a></li>
<li class="chapter" data-level="15.3.4" data-path="model-comparison.html"><a href="model-comparison.html#bootstrap"><i class="fa fa-check"></i><b>15.3.4</b> Bootstrap</a></li>
<li class="chapter" data-level="15.3.5" data-path="model-comparison.html"><a href="model-comparison.html#aic-and-bic"><i class="fa fa-check"></i><b>15.3.5</b> AIC and BIC</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="model-comparison.html"><a href="model-comparison.html#additional-resources-13"><i class="fa fa-check"></i><b>15.4</b> Additional resources</a>
<ul>
<li class="chapter" data-level="15.4.1" data-path="model-comparison.html"><a href="model-comparison.html#datacamp-course"><i class="fa fa-check"></i><b>15.4.1</b> Datacamp course</a></li>
<li class="chapter" data-level="15.4.2" data-path="model-comparison.html"><a href="model-comparison.html#reading-1"><i class="fa fa-check"></i><b>15.4.2</b> Reading</a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="model-comparison.html"><a href="model-comparison.html#session-info-14"><i class="fa fa-check"></i><b>15.5</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="causation.html"><a href="causation.html"><i class="fa fa-check"></i><b>16</b> Causation</a>
<ul>
<li class="chapter" data-level="16.1" data-path="causation.html"><a href="causation.html#learning-goals-7"><i class="fa fa-check"></i><b>16.1</b> Learning goals</a></li>
<li class="chapter" data-level="16.2" data-path="causation.html"><a href="causation.html#recommended-reading"><i class="fa fa-check"></i><b>16.2</b> Recommended reading</a></li>
<li class="chapter" data-level="16.3" data-path="causation.html"><a href="causation.html#load-packages-and-set-plotting-theme-9"><i class="fa fa-check"></i><b>16.3</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="16.4" data-path="causation.html"><a href="causation.html#bayesian-networks"><i class="fa fa-check"></i><b>16.4</b> Bayesian networks</a>
<ul>
<li class="chapter" data-level="16.4.1" data-path="causation.html"><a href="causation.html#sprinkler-example"><i class="fa fa-check"></i><b>16.4.1</b> Sprinkler example</a></li>
</ul></li>
<li class="chapter" data-level="16.5" data-path="causation.html"><a href="causation.html#controlling-for-variables"><i class="fa fa-check"></i><b>16.5</b> Controlling for variables</a>
<ul>
<li class="chapter" data-level="16.5.1" data-path="causation.html"><a href="causation.html#illustration-of-the-d-separation-algorithm"><i class="fa fa-check"></i><b>16.5.1</b> Illustration of the d-separation algorithm</a></li>
<li class="chapter" data-level="16.5.2" data-path="causation.html"><a href="causation.html#good-controls"><i class="fa fa-check"></i><b>16.5.2</b> Good controls</a></li>
<li class="chapter" data-level="16.5.3" data-path="causation.html"><a href="causation.html#bad-controls"><i class="fa fa-check"></i><b>16.5.3</b> Bad controls</a></li>
</ul></li>
<li class="chapter" data-level="16.6" data-path="causation.html"><a href="causation.html#mediation"><i class="fa fa-check"></i><b>16.6</b> Mediation</a>
<ul>
<li class="chapter" data-level="16.6.1" data-path="causation.html"><a href="causation.html#generate-data"><i class="fa fa-check"></i><b>16.6.1</b> Generate data</a></li>
<li class="chapter" data-level="16.6.2" data-path="causation.html"><a href="causation.html#method-1-baron-kennys-1986-indirect-effect-method"><i class="fa fa-check"></i><b>16.6.2</b> Method 1: Baron &amp; Kenny’s (1986) indirect effect method</a></li>
<li class="chapter" data-level="16.6.3" data-path="causation.html"><a href="causation.html#method-2-sobel-test"><i class="fa fa-check"></i><b>16.6.3</b> Method 2: Sobel Test</a></li>
<li class="chapter" data-level="16.6.4" data-path="causation.html"><a href="causation.html#method-3-bootstrapping"><i class="fa fa-check"></i><b>16.6.4</b> Method 3: Bootstrapping</a></li>
<li class="chapter" data-level="16.6.5" data-path="causation.html"><a href="causation.html#be-careful-about-mediation"><i class="fa fa-check"></i><b>16.6.5</b> Be careful about mediation!</a></li>
</ul></li>
<li class="chapter" data-level="16.7" data-path="causation.html"><a href="causation.html#moderation"><i class="fa fa-check"></i><b>16.7</b> Moderation</a>
<ul>
<li class="chapter" data-level="16.7.1" data-path="causation.html"><a href="causation.html#generate-data-1"><i class="fa fa-check"></i><b>16.7.1</b> Generate data</a></li>
<li class="chapter" data-level="16.7.2" data-path="causation.html"><a href="causation.html#moderation-analysis"><i class="fa fa-check"></i><b>16.7.2</b> Moderation analysis</a></li>
</ul></li>
<li class="chapter" data-level="16.8" data-path="causation.html"><a href="causation.html#additional-resources-14"><i class="fa fa-check"></i><b>16.8</b> Additional resources</a>
<ul>
<li class="chapter" data-level="16.8.1" data-path="causation.html"><a href="causation.html#books"><i class="fa fa-check"></i><b>16.8.1</b> Books</a></li>
<li class="chapter" data-level="16.8.2" data-path="causation.html"><a href="causation.html#tutorials-1"><i class="fa fa-check"></i><b>16.8.2</b> Tutorials</a></li>
<li class="chapter" data-level="16.8.3" data-path="causation.html"><a href="causation.html#misc-9"><i class="fa fa-check"></i><b>16.8.3</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="16.9" data-path="causation.html"><a href="causation.html#session-info-15"><i class="fa fa-check"></i><b>16.9</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html"><i class="fa fa-check"></i><b>17</b> Linear mixed effects models 1</a>
<ul>
<li class="chapter" data-level="17.1" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html#learning-goals-8"><i class="fa fa-check"></i><b>17.1</b> Learning goals</a></li>
<li class="chapter" data-level="17.2" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html#load-packages-and-set-plotting-theme-10"><i class="fa fa-check"></i><b>17.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="17.3" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html#dependence"><i class="fa fa-check"></i><b>17.3</b> Dependence</a></li>
<li class="chapter" data-level="17.4" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html#additional-resources-15"><i class="fa fa-check"></i><b>17.4</b> Additional resources</a>
<ul>
<li class="chapter" data-level="17.4.1" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html#readings"><i class="fa fa-check"></i><b>17.4.1</b> Readings</a></li>
</ul></li>
<li class="chapter" data-level="17.5" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html#session-info-16"><i class="fa fa-check"></i><b>17.5</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html"><i class="fa fa-check"></i><b>18</b> Linear mixed effects models 2</a>
<ul>
<li class="chapter" data-level="18.1" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#learning-goals-9"><i class="fa fa-check"></i><b>18.1</b> Learning goals</a></li>
<li class="chapter" data-level="18.2" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#load-packages-and-set-plotting-theme-11"><i class="fa fa-check"></i><b>18.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="18.3" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#a-worked-example"><i class="fa fa-check"></i><b>18.3</b> A worked example</a>
<ul>
<li class="chapter" data-level="18.3.1" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#complete-pooling"><i class="fa fa-check"></i><b>18.3.1</b> Complete pooling</a></li>
<li class="chapter" data-level="18.3.2" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#no-pooling"><i class="fa fa-check"></i><b>18.3.2</b> No pooling</a></li>
<li class="chapter" data-level="18.3.3" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#partial-pooling"><i class="fa fa-check"></i><b>18.3.3</b> Partial pooling</a></li>
<li class="chapter" data-level="18.3.4" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#compare-results"><i class="fa fa-check"></i><b>18.3.4</b> Compare results</a></li>
<li class="chapter" data-level="18.3.5" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#getting-p-values"><i class="fa fa-check"></i><b>18.3.5</b> Getting p-values</a></li>
<li class="chapter" data-level="18.3.6" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#reporting-results"><i class="fa fa-check"></i><b>18.3.6</b> Reporting results</a></li>
</ul></li>
<li class="chapter" data-level="18.4" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#simulating-a-linear-mixed-effects-model"><i class="fa fa-check"></i><b>18.4</b> Simulating a linear mixed effects model</a>
<ul>
<li class="chapter" data-level="18.4.1" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#the-effect-of-outliers"><i class="fa fa-check"></i><b>18.4.1</b> The effect of outliers</a></li>
<li class="chapter" data-level="18.4.2" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#different-slopes"><i class="fa fa-check"></i><b>18.4.2</b> Different slopes</a></li>
<li class="chapter" data-level="18.4.3" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#simpsons-paradox"><i class="fa fa-check"></i><b>18.4.3</b> Simpson’s paradox</a></li>
</ul></li>
<li class="chapter" data-level="18.5" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#additional-resources-16"><i class="fa fa-check"></i><b>18.5</b> Additional resources</a>
<ul>
<li class="chapter" data-level="18.5.1" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#readings-1"><i class="fa fa-check"></i><b>18.5.1</b> Readings</a></li>
</ul></li>
<li class="chapter" data-level="18.6" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#session-info-17"><i class="fa fa-check"></i><b>18.6</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html"><i class="fa fa-check"></i><b>19</b> Linear mixed effects models 3</a>
<ul>
<li class="chapter" data-level="19.1" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#learning-goals-10"><i class="fa fa-check"></i><b>19.1</b> Learning goals</a></li>
<li class="chapter" data-level="19.2" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#load-packages-and-set-plotting-theme-12"><i class="fa fa-check"></i><b>19.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="19.3" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#load-data-sets-4"><i class="fa fa-check"></i><b>19.3</b> Load data sets</a>
<ul>
<li class="chapter" data-level="19.3.1" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#sleep-data"><i class="fa fa-check"></i><b>19.3.1</b> Sleep data</a></li>
<li class="chapter" data-level="19.3.2" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#reasoning-data"><i class="fa fa-check"></i><b>19.3.2</b> Reasoning data</a></li>
<li class="chapter" data-level="19.3.3" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#weight-loss-data"><i class="fa fa-check"></i><b>19.3.3</b> Weight loss data</a></li>
<li class="chapter" data-level="19.3.4" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#politness-data"><i class="fa fa-check"></i><b>19.3.4</b> Politness data</a></li>
</ul></li>
<li class="chapter" data-level="19.4" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#understanding-the-lmer-syntax"><i class="fa fa-check"></i><b>19.4</b> Understanding the lmer() syntax</a></li>
<li class="chapter" data-level="19.5" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#anova-vs.-lmer"><i class="fa fa-check"></i><b>19.5</b> ANOVA vs. Lmer</a>
<ul>
<li class="chapter" data-level="19.5.1" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#between-subjects-anova"><i class="fa fa-check"></i><b>19.5.1</b> Between subjects ANOVA</a></li>
<li class="chapter" data-level="19.5.2" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#repeated-measures-anova"><i class="fa fa-check"></i><b>19.5.2</b> Repeated-measures ANOVA</a></li>
<li class="chapter" data-level="19.5.3" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#mixed-anova"><i class="fa fa-check"></i><b>19.5.3</b> Mixed ANOVA</a></li>
</ul></li>
<li class="chapter" data-level="19.6" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#session-info-18"><i class="fa fa-check"></i><b>19.6</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html"><i class="fa fa-check"></i><b>20</b> Linear mixed effects models 4</a>
<ul>
<li class="chapter" data-level="20.1" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#learning-goals-11"><i class="fa fa-check"></i><b>20.1</b> Learning goals</a></li>
<li class="chapter" data-level="20.2" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#load-packages-and-set-plotting-theme-13"><i class="fa fa-check"></i><b>20.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="20.3" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#load-data-sets-5"><i class="fa fa-check"></i><b>20.3</b> Load data sets</a>
<ul>
<li class="chapter" data-level="20.3.1" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#sleep-data-1"><i class="fa fa-check"></i><b>20.3.1</b> Sleep data</a></li>
<li class="chapter" data-level="20.3.2" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#reasoning-data-1"><i class="fa fa-check"></i><b>20.3.2</b> Reasoning data</a></li>
<li class="chapter" data-level="20.3.3" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#weight-loss-data-1"><i class="fa fa-check"></i><b>20.3.3</b> Weight loss data</a></li>
<li class="chapter" data-level="20.3.4" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#politness-data-1"><i class="fa fa-check"></i><b>20.3.4</b> Politness data</a></li>
</ul></li>
<li class="chapter" data-level="20.4" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#follow-up-tests-with-emmeans"><i class="fa fa-check"></i><b>20.4</b> Follow-up tests with emmeans</a>
<ul>
<li class="chapter" data-level="20.4.1" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#sleep-study"><i class="fa fa-check"></i><b>20.4.1</b> Sleep study</a></li>
<li class="chapter" data-level="20.4.2" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#weight-loss-study"><i class="fa fa-check"></i><b>20.4.2</b> Weight loss study</a></li>
<li class="chapter" data-level="20.4.3" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#politeness-study"><i class="fa fa-check"></i><b>20.4.3</b> Politeness study</a></li>
</ul></li>
<li class="chapter" data-level="20.5" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#mixtures-of-participants"><i class="fa fa-check"></i><b>20.5</b> Mixtures of participants</a></li>
<li class="chapter" data-level="20.6" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#bootstrapping"><i class="fa fa-check"></i><b>20.6</b> Bootstrapping</a>
<ul>
<li class="chapter" data-level="20.6.1" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#linear-model"><i class="fa fa-check"></i><b>20.6.1</b> Linear model</a></li>
</ul></li>
<li class="chapter" data-level="20.7" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#session-info-19"><i class="fa fa-check"></i><b>20.7</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html"><i class="fa fa-check"></i><b>21</b> Generalized linear model</a>
<ul>
<li class="chapter" data-level="21.1" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#learning-goals-12"><i class="fa fa-check"></i><b>21.1</b> Learning goals</a></li>
<li class="chapter" data-level="21.2" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#load-packages-and-set-plotting-theme-14"><i class="fa fa-check"></i><b>21.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="21.3" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#load-data-set"><i class="fa fa-check"></i><b>21.3</b> Load data set</a></li>
<li class="chapter" data-level="21.4" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#logistic-regression"><i class="fa fa-check"></i><b>21.4</b> Logistic regression</a>
<ul>
<li class="chapter" data-level="21.4.1" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#interpreting-the-parameters"><i class="fa fa-check"></i><b>21.4.1</b> Interpreting the parameters</a></li>
<li class="chapter" data-level="21.4.2" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#binary-predictor"><i class="fa fa-check"></i><b>21.4.2</b> Binary predictor</a></li>
<li class="chapter" data-level="21.4.3" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#continuous-predictor"><i class="fa fa-check"></i><b>21.4.3</b> Continuous predictor</a></li>
<li class="chapter" data-level="21.4.4" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#several-predictors"><i class="fa fa-check"></i><b>21.4.4</b> Several predictors</a></li>
<li class="chapter" data-level="21.4.5" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#using-the-ggeffects-package"><i class="fa fa-check"></i><b>21.4.5</b> Using the “ggeffects” package</a></li>
</ul></li>
<li class="chapter" data-level="21.5" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#simulate-a-logistic-regression"><i class="fa fa-check"></i><b>21.5</b> Simulate a logistic regression</a>
<ul>
<li class="chapter" data-level="21.5.1" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#calculate-the-models-likelihood"><i class="fa fa-check"></i><b>21.5.1</b> Calculate the model’s likelihood</a></li>
</ul></li>
<li class="chapter" data-level="21.6" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#testing-hypotheses"><i class="fa fa-check"></i><b>21.6</b> Testing hypotheses</a></li>
<li class="chapter" data-level="21.7" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#logistic-mixed-effects-model"><i class="fa fa-check"></i><b>21.7</b> Logistic mixed effects model</a></li>
<li class="chapter" data-level="21.8" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#additional-information"><i class="fa fa-check"></i><b>21.8</b> Additional information</a>
<ul>
<li class="chapter" data-level="21.8.1" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#misc-10"><i class="fa fa-check"></i><b>21.8.1</b> Misc</a></li>
<li class="chapter" data-level="21.8.2" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#datacamp-7"><i class="fa fa-check"></i><b>21.8.2</b> Datacamp</a></li>
</ul></li>
<li class="chapter" data-level="21.9" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#session-info-20"><i class="fa fa-check"></i><b>21.9</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="bayesian-data-analysis-1.html"><a href="bayesian-data-analysis-1.html"><i class="fa fa-check"></i><b>22</b> Bayesian data analysis 1</a>
<ul>
<li class="chapter" data-level="22.1" data-path="bayesian-data-analysis-1.html"><a href="bayesian-data-analysis-1.html#learning-goals-13"><i class="fa fa-check"></i><b>22.1</b> Learning goals</a></li>
<li class="chapter" data-level="22.2" data-path="bayesian-data-analysis-1.html"><a href="bayesian-data-analysis-1.html#load-packages-and-set-plotting-theme-15"><i class="fa fa-check"></i><b>22.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="22.3" data-path="bayesian-data-analysis-1.html"><a href="bayesian-data-analysis-1.html#doing-bayesian-inference-by-hand"><i class="fa fa-check"></i><b>22.3</b> Doing Bayesian inference “by hand”</a>
<ul>
<li class="chapter" data-level="22.3.1" data-path="bayesian-data-analysis-1.html"><a href="bayesian-data-analysis-1.html#sequential-updating-based-on-the-beta-distribution"><i class="fa fa-check"></i><b>22.3.1</b> Sequential updating based on the Beta distribution</a></li>
<li class="chapter" data-level="22.3.2" data-path="bayesian-data-analysis-1.html"><a href="bayesian-data-analysis-1.html#coin-flip-example"><i class="fa fa-check"></i><b>22.3.2</b> Coin flip example</a></li>
<li class="chapter" data-level="22.3.3" data-path="bayesian-data-analysis-1.html"><a href="bayesian-data-analysis-1.html#bayesian-inference-by-discretization"><i class="fa fa-check"></i><b>22.3.3</b> Bayesian inference by discretization</a></li>
</ul></li>
<li class="chapter" data-level="22.4" data-path="bayesian-data-analysis-1.html"><a href="bayesian-data-analysis-1.html#doing-bayesian-inference-with-greta"><i class="fa fa-check"></i><b>22.4</b> Doing Bayesian inference with Greta</a>
<ul>
<li class="chapter" data-level="22.4.1" data-path="bayesian-data-analysis-1.html"><a href="bayesian-data-analysis-1.html#attitude-data-set"><i class="fa fa-check"></i><b>22.4.1</b> Attitude data set</a></li>
<li class="chapter" data-level="22.4.2" data-path="bayesian-data-analysis-1.html"><a href="bayesian-data-analysis-1.html#frequentist-analysis"><i class="fa fa-check"></i><b>22.4.2</b> Frequentist analysis</a></li>
<li class="chapter" data-level="22.4.3" data-path="bayesian-data-analysis-1.html"><a href="bayesian-data-analysis-1.html#bayesian-regression"><i class="fa fa-check"></i><b>22.4.3</b> Bayesian regression</a></li>
</ul></li>
<li class="chapter" data-level="22.5" data-path="bayesian-data-analysis-1.html"><a href="bayesian-data-analysis-1.html#additional-resources-17"><i class="fa fa-check"></i><b>22.5</b> Additional resources</a>
<ul>
<li class="chapter" data-level="22.5.1" data-path="bayesian-data-analysis-1.html"><a href="bayesian-data-analysis-1.html#books-and-chapters-5"><i class="fa fa-check"></i><b>22.5.1</b> Books and chapters</a></li>
</ul></li>
<li class="chapter" data-level="22.6" data-path="bayesian-data-analysis-1.html"><a href="bayesian-data-analysis-1.html#session-info-21"><i class="fa fa-check"></i><b>22.6</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html"><i class="fa fa-check"></i><b>23</b> Bayesian data analysis 2</a>
<ul>
<li class="chapter" data-level="23.1" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#learning-goals-14"><i class="fa fa-check"></i><b>23.1</b> Learning goals</a></li>
<li class="chapter" data-level="23.2" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#load-packages-and-set-plotting-theme-16"><i class="fa fa-check"></i><b>23.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="23.3" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#load-data-sets-6"><i class="fa fa-check"></i><b>23.3</b> Load data sets</a></li>
<li class="chapter" data-level="23.4" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#poker"><i class="fa fa-check"></i><b>23.4</b> Poker</a>
<ul>
<li class="chapter" data-level="23.4.1" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#visualize-the-data"><i class="fa fa-check"></i><b>23.4.1</b> 1. Visualize the data</a></li>
<li class="chapter" data-level="23.4.2" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#specify-and-fit-the-model"><i class="fa fa-check"></i><b>23.4.2</b> 2. Specify and fit the model</a></li>
<li class="chapter" data-level="23.4.3" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#model-evaluation"><i class="fa fa-check"></i><b>23.4.3</b> 3. Model evaluation</a></li>
<li class="chapter" data-level="23.4.4" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#interpret-the-model-parameters"><i class="fa fa-check"></i><b>23.4.4</b> 4. Interpret the model parameters</a></li>
<li class="chapter" data-level="23.4.5" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#test-specific-hypotheses"><i class="fa fa-check"></i><b>23.4.5</b> 5. Test specific hypotheses</a></li>
</ul></li>
<li class="chapter" data-level="23.5" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#sleep-study-1"><i class="fa fa-check"></i><b>23.5</b> Sleep study</a>
<ul>
<li class="chapter" data-level="23.5.1" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#visualize-the-data-1"><i class="fa fa-check"></i><b>23.5.1</b> 1. Visualize the data</a></li>
<li class="chapter" data-level="23.5.2" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#specify-and-fit-the-model-1"><i class="fa fa-check"></i><b>23.5.2</b> 2. Specify and fit the model</a></li>
<li class="chapter" data-level="23.5.3" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#model-evaluation-1"><i class="fa fa-check"></i><b>23.5.3</b> 3. Model evaluation</a></li>
<li class="chapter" data-level="23.5.4" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#interpret-the-parameters"><i class="fa fa-check"></i><b>23.5.4</b> 4. Interpret the parameters</a></li>
<li class="chapter" data-level="23.5.5" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#test-specific-hypotheses-1"><i class="fa fa-check"></i><b>23.5.5</b> 5. Test specific hypotheses</a></li>
<li class="chapter" data-level="23.5.6" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#report-results"><i class="fa fa-check"></i><b>23.5.6</b> 6. Report results</a></li>
</ul></li>
<li class="chapter" data-level="23.6" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#titanic-study"><i class="fa fa-check"></i><b>23.6</b> Titanic study</a>
<ul>
<li class="chapter" data-level="23.6.1" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#visualize-the-data-2"><i class="fa fa-check"></i><b>23.6.1</b> 1. Visualize the data</a></li>
<li class="chapter" data-level="23.6.2" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#specify-and-fit-the-model-2"><i class="fa fa-check"></i><b>23.6.2</b> 2. Specify and fit the model</a></li>
<li class="chapter" data-level="23.6.3" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#model-evaluation-2"><i class="fa fa-check"></i><b>23.6.3</b> 3. Model evaluation</a></li>
<li class="chapter" data-level="23.6.4" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#interpret-the-parameters-1"><i class="fa fa-check"></i><b>23.6.4</b> 4. Interpret the parameters</a></li>
<li class="chapter" data-level="23.6.5" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#test-specific-hypotheses-2"><i class="fa fa-check"></i><b>23.6.5</b> 5. Test specific hypotheses</a></li>
<li class="chapter" data-level="23.6.6" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#report-results-1"><i class="fa fa-check"></i><b>23.6.6</b> 6. Report results</a></li>
</ul></li>
<li class="chapter" data-level="23.7" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#politeness-data"><i class="fa fa-check"></i><b>23.7</b> Politeness data</a>
<ul>
<li class="chapter" data-level="23.7.1" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#visualize-the-data-3"><i class="fa fa-check"></i><b>23.7.1</b> 1. Visualize the data</a></li>
<li class="chapter" data-level="23.7.2" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#specify-and-fit-the-model-3"><i class="fa fa-check"></i><b>23.7.2</b> 2. Specify and fit the model</a></li>
<li class="chapter" data-level="23.7.3" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#test-specific-hypotheses-3"><i class="fa fa-check"></i><b>23.7.3</b> 5. Test specific hypotheses</a></li>
</ul></li>
<li class="chapter" data-level="23.8" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#additional-resources-18"><i class="fa fa-check"></i><b>23.8</b> Additional resources</a></li>
<li class="chapter" data-level="23.9" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#session-info-22"><i class="fa fa-check"></i><b>23.9</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html"><i class="fa fa-check"></i><b>24</b> Bayesian data analysis 3</a>
<ul>
<li class="chapter" data-level="24.1" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#learning-goals-15"><i class="fa fa-check"></i><b>24.1</b> Learning goals</a></li>
<li class="chapter" data-level="24.2" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#load-packages-and-set-plotting-theme-17"><i class="fa fa-check"></i><b>24.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="24.3" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#evidence-for-the-null-hypothesis"><i class="fa fa-check"></i><b>24.3</b> Evidence for the null hypothesis</a>
<ul>
<li class="chapter" data-level="24.3.1" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#bayes-factor-1"><i class="fa fa-check"></i><b>24.3.1</b> Bayes factor</a></li>
<li class="chapter" data-level="24.3.2" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#loo"><i class="fa fa-check"></i><b>24.3.2</b> LOO</a></li>
</ul></li>
<li class="chapter" data-level="24.4" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#dealing-with-heteroscedasticity"><i class="fa fa-check"></i><b>24.4</b> Dealing with heteroscedasticity</a>
<ul>
<li class="chapter" data-level="24.4.1" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#visualize-the-data-4"><i class="fa fa-check"></i><b>24.4.1</b> Visualize the data</a></li>
<li class="chapter" data-level="24.4.2" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#frequentist-analysis-4"><i class="fa fa-check"></i><b>24.4.2</b> Frequentist analysis</a></li>
<li class="chapter" data-level="24.4.3" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#bayesian-analysis-3"><i class="fa fa-check"></i><b>24.4.3</b> Bayesian analysis</a></li>
</ul></li>
<li class="chapter" data-level="24.5" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#zero-one-inflated-beta-binomial-model"><i class="fa fa-check"></i><b>24.5</b> Zero-one inflated beta binomial model</a></li>
<li class="chapter" data-level="24.6" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#ordinal-regression"><i class="fa fa-check"></i><b>24.6</b> Ordinal regression</a>
<ul>
<li class="chapter" data-level="24.6.1" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#ordinal-regression-assuming-equal-variance"><i class="fa fa-check"></i><b>24.6.1</b> Ordinal regression (assuming equal variance)</a></li>
<li class="chapter" data-level="24.6.2" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#gaussian-regression-assuming-equal-variance"><i class="fa fa-check"></i><b>24.6.2</b> Gaussian regression (assuming equal variance)</a></li>
<li class="chapter" data-level="24.6.3" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#oridnal-regression-unequal-variance"><i class="fa fa-check"></i><b>24.6.3</b> Oridnal regression (unequal variance)</a></li>
<li class="chapter" data-level="24.6.4" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#gaussian-regression-unequal-variance"><i class="fa fa-check"></i><b>24.6.4</b> Gaussian regression (unequal variance)</a></li>
<li class="chapter" data-level="24.6.5" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#model-comparison-2"><i class="fa fa-check"></i><b>24.6.5</b> Model comparison</a></li>
</ul></li>
<li class="chapter" data-level="24.7" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#additional-resources-19"><i class="fa fa-check"></i><b>24.7</b> Additional resources</a></li>
<li class="chapter" data-level="24.8" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#session-info-23"><i class="fa fa-check"></i><b>24.8</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="25" data-path="model-assumptions.html"><a href="model-assumptions.html"><i class="fa fa-check"></i><b>25</b> Model assumptions</a>
<ul>
<li class="chapter" data-level="25.1" data-path="model-assumptions.html"><a href="model-assumptions.html#learning-goals-16"><i class="fa fa-check"></i><b>25.1</b> Learning goals</a></li>
<li class="chapter" data-level="25.2" data-path="model-assumptions.html"><a href="model-assumptions.html#load-packages-and-set-plotting-theme-18"><i class="fa fa-check"></i><b>25.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="25.3" data-path="model-assumptions.html"><a href="model-assumptions.html#model-assumptions-and-what-to-do-if-they-are-violated"><i class="fa fa-check"></i><b>25.3</b> Model assumptions and what to do if they are violated</a>
<ul>
<li class="chapter" data-level="25.3.1" data-path="model-assumptions.html"><a href="model-assumptions.html#influential-data-points"><i class="fa fa-check"></i><b>25.3.1</b> Influential data points</a></li>
<li class="chapter" data-level="25.3.2" data-path="model-assumptions.html"><a href="model-assumptions.html#linear-and-additive"><i class="fa fa-check"></i><b>25.3.2</b> Linear and additive</a></li>
<li class="chapter" data-level="25.3.3" data-path="model-assumptions.html"><a href="model-assumptions.html#normally-distributed-residuals"><i class="fa fa-check"></i><b>25.3.3</b> Normally distributed residuals</a></li>
<li class="chapter" data-level="25.3.4" data-path="model-assumptions.html"><a href="model-assumptions.html#non-parametric-tests"><i class="fa fa-check"></i><b>25.3.4</b> Non-parametric tests</a></li>
<li class="chapter" data-level="25.3.5" data-path="model-assumptions.html"><a href="model-assumptions.html#bootstrapping-regressions"><i class="fa fa-check"></i><b>25.3.5</b> Bootstrapping regressions</a></li>
</ul></li>
<li class="chapter" data-level="25.4" data-path="model-assumptions.html"><a href="model-assumptions.html#additional-resources-20"><i class="fa fa-check"></i><b>25.4</b> Additional resources</a></li>
<li class="chapter" data-level="25.5" data-path="model-assumptions.html"><a href="model-assumptions.html#session-info-24"><i class="fa fa-check"></i><b>25.5</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="26" data-path="reporting-statistics.html"><a href="reporting-statistics.html"><i class="fa fa-check"></i><b>26</b> Reporting statistics</a>
<ul>
<li class="chapter" data-level="26.1" data-path="reporting-statistics.html"><a href="reporting-statistics.html#general-advice"><i class="fa fa-check"></i><b>26.1</b> General advice</a>
<ul>
<li class="chapter" data-level="26.1.1" data-path="reporting-statistics.html"><a href="reporting-statistics.html#make-good-figures"><i class="fa fa-check"></i><b>26.1.1</b> Make good figures!</a></li>
<li class="chapter" data-level="26.1.2" data-path="reporting-statistics.html"><a href="reporting-statistics.html#use-statistical-models-to-answer-concrete-research-questions."><i class="fa fa-check"></i><b>26.1.2</b> Use statistical models to answer concrete research questions.</a></li>
<li class="chapter" data-level="26.1.3" data-path="reporting-statistics.html"><a href="reporting-statistics.html#illustrate-the-uncertainty-in-your-statistical-inferences."><i class="fa fa-check"></i><b>26.1.3</b> Illustrate the uncertainty in your statistical inferences.</a></li>
<li class="chapter" data-level="26.1.4" data-path="reporting-statistics.html"><a href="reporting-statistics.html#report-effect-sizes."><i class="fa fa-check"></i><b>26.1.4</b> Report effect sizes.</a></li>
<li class="chapter" data-level="26.1.5" data-path="reporting-statistics.html"><a href="reporting-statistics.html#reporting-statistical-results-using-rmarkdown"><i class="fa fa-check"></i><b>26.1.5</b> Reporting statistical results using RMarkdown</a></li>
</ul></li>
<li class="chapter" data-level="26.2" data-path="reporting-statistics.html"><a href="reporting-statistics.html#some-concrete-example"><i class="fa fa-check"></i><b>26.2</b> Some concrete example</a>
<ul>
<li class="chapter" data-level="26.2.1" data-path="reporting-statistics.html"><a href="reporting-statistics.html#frequentist-statistics"><i class="fa fa-check"></i><b>26.2.1</b> Frequentist statistics</a></li>
</ul></li>
<li class="chapter" data-level="26.3" data-path="reporting-statistics.html"><a href="reporting-statistics.html#session-info-25"><i class="fa fa-check"></i><b>26.3</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="27" data-path="cheatsheets-6.html"><a href="cheatsheets-6.html"><i class="fa fa-check"></i><b>27</b> Cheatsheets</a>
<ul>
<li class="chapter" data-level="27.1" data-path="cheatsheets-6.html"><a href="cheatsheets-6.html#statistics"><i class="fa fa-check"></i><b>27.1</b> Statistics</a></li>
<li class="chapter" data-level="27.2" data-path="cheatsheets-6.html"><a href="cheatsheets-6.html#r"><i class="fa fa-check"></i><b>27.2</b> R</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references-1.html"><a href="references-1.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Psych 252: Statistical Methods for Behavioral and Social Sciences</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="causation" class="section level1 hasAnchor" number="16">
<h1><span class="header-section-number">Chapter 16</span> Causation<a href="causation.html#causation" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Some of these notes are adapted from this tutorial: <a href="https://ademos.people.uic.edu/Chapter14.html">Mediation and moderation</a></p>
<div id="learning-goals-7" class="section level2 hasAnchor" number="16.1">
<h2><span class="header-section-number">16.1</span> Learning goals<a href="causation.html#learning-goals-7" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>Understanding what controlling for variables means.</li>
<li>Learning a graphical procedure that helps identify when it’s good vs. bad to control for variables.</li>
<li>Simulating a mediation analysis.</li>
<li>Baron and Kenny’s (1986) steps for mediation.</li>
<li>Testing the significance of a mediation.
<ul>
<li>Sobel test.</li>
<li>Bootstrapping.</li>
<li>Bayesian approach.</li>
</ul></li>
<li>Limitations of mediation analysis.</li>
<li>Simulating a moderator effect.</li>
</ul>
</div>
<div id="recommended-reading" class="section level2 hasAnchor" number="16.2">
<h2><span class="header-section-number">16.2</span> Recommended reading<a href="causation.html#recommended-reading" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li><span class="citation">Fiedler, Schott, and Meiser (<a href="#ref-fiedler2011mediation">2011</a>)</span></li>
<li><span class="citation">MacKinnon, Fairchild, and Fritz (<a href="#ref-mackinnon2007mediationa">2007</a>)</span></li>
</ul>
</div>
<div id="load-packages-and-set-plotting-theme-9" class="section level2 hasAnchor" number="16.3">
<h2><span class="header-section-number">16.3</span> Load packages and set plotting theme<a href="causation.html#load-packages-and-set-plotting-theme-9" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb879"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb879-1"><a href="causation.html#cb879-1" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;knitr&quot;</span>)         <span class="co"># for knitting RMarkdown </span></span>
<span id="cb879-2"><a href="causation.html#cb879-2" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;kableExtra&quot;</span>)    <span class="co"># for making nice tables</span></span>
<span id="cb879-3"><a href="causation.html#cb879-3" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;janitor&quot;</span>)       <span class="co"># for cleaning column names</span></span>
<span id="cb879-4"><a href="causation.html#cb879-4" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;mediation&quot;</span>)     <span class="co"># for mediation and moderation analysis </span></span>
<span id="cb879-5"><a href="causation.html#cb879-5" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;multilevel&quot;</span>)    <span class="co"># Sobel test</span></span>
<span id="cb879-6"><a href="causation.html#cb879-6" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;broom&quot;</span>)         <span class="co"># tidying up regression results</span></span>
<span id="cb879-7"><a href="causation.html#cb879-7" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;DiagrammeR&quot;</span>)    <span class="co"># for drawing diagrams</span></span>
<span id="cb879-8"><a href="causation.html#cb879-8" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;DiagrammeRsvg&quot;</span>) <span class="co"># for exporting pdfs of graphs </span></span>
<span id="cb879-9"><a href="causation.html#cb879-9" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;rsvg&quot;</span>)          <span class="co"># for exporting pdfs of graphs </span></span>
<span id="cb879-10"><a href="causation.html#cb879-10" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;tidyverse&quot;</span>)     <span class="co"># for wrangling, plotting, etc. </span></span></code></pre></div>
<div class="sourceCode" id="cb880"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb880-1"><a href="causation.html#cb880-1" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_classic</span>() <span class="sc">+</span> <span class="co">#set the theme </span></span>
<span id="cb880-2"><a href="causation.html#cb880-2" tabindex="-1"></a>            <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>))) <span class="co">#set the default text size</span></span>
<span id="cb880-3"><a href="causation.html#cb880-3" tabindex="-1"></a></span>
<span id="cb880-4"><a href="causation.html#cb880-4" tabindex="-1"></a>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">comment =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb880-5"><a href="causation.html#cb880-5" tabindex="-1"></a>               <span class="at">fig.show =</span> <span class="st">&quot;hold&quot;</span>)</span>
<span id="cb880-6"><a href="causation.html#cb880-6" tabindex="-1"></a></span>
<span id="cb880-7"><a href="causation.html#cb880-7" tabindex="-1"></a><span class="fu">options</span>(<span class="at">dplyr.summarise.inform =</span> <span class="cn">FALSE</span>) <span class="co"># Disable summarize ungroup messages</span></span></code></pre></div>
</div>
<div id="bayesian-networks" class="section level2 hasAnchor" number="16.4">
<h2><span class="header-section-number">16.4</span> Bayesian networks<a href="causation.html#bayesian-networks" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="sprinkler-example" class="section level3 hasAnchor" number="16.4.1">
<h3><span class="header-section-number">16.4.1</span> Sprinkler example<a href="causation.html#sprinkler-example" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="grViz html-widget html-fill-item" id="htmlwidget-745c879d9f3cfe2f99bb" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-745c879d9f3cfe2f99bb">{"x":{"diagram":"\ndigraph dot{\n  \n  # general settings for all nodes\n  node [\n    shape = circle,\n    style = filled,\n    color = black,\n    label = \"\"\n    fontname = \"Helvetica\",\n    fontsize = 10,\n    fillcolor = lightblue,\n    fixedsize=true,\n    width = 0.8\n    ]\n  \n  # edges between nodes\n  edge [color = black,\n        fontname = \"Helvetica\",\n        fontsize = 10]\n  1 -> 2 [label = \"\"]\n  1 -> 3 [label = \"\"]\n  2 -> 4 [label = \"\"] \n  3 -> 4 [label = \"\"]\n  \n  # labels for each node\n  1 [label = \"Cloudy\"]\n  2 [label = \"Sprinkler\"]\n  3 [label = \"Rain\"]\n  4 [label = \"Wet grass\"]\n  }","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode" id="cb881"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb881-1"><a href="causation.html#cb881-1" tabindex="-1"></a><span class="co"># cloudy </span></span>
<span id="cb881-2"><a href="causation.html#cb881-2" tabindex="-1"></a>df.cloudy <span class="ot">=</span> <span class="fu">tibble</span>(<span class="st">`</span><span class="at">p(C)</span><span class="st">`</span> <span class="ot">=</span> <span class="fl">0.5</span>)</span>
<span id="cb881-3"><a href="causation.html#cb881-3" tabindex="-1"></a></span>
<span id="cb881-4"><a href="causation.html#cb881-4" tabindex="-1"></a>df.cloudy <span class="sc">%&gt;%</span> </span>
<span id="cb881-5"><a href="causation.html#cb881-5" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb881-6"><a href="causation.html#cb881-6" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="st">&quot;striped&quot;</span>,</span>
<span id="cb881-7"><a href="causation.html#cb881-7" tabindex="-1"></a>                <span class="at">full_width =</span> F,</span>
<span id="cb881-8"><a href="causation.html#cb881-8" tabindex="-1"></a>                <span class="at">font_size =</span> <span class="dv">20</span>)</span></code></pre></div>
<table class="table table-striped" style="font-size: 20px; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
p(C)
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0.5
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb882"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb882-1"><a href="causation.html#cb882-1" tabindex="-1"></a><span class="co"># sprinkler given cloudy </span></span>
<span id="cb882-2"><a href="causation.html#cb882-2" tabindex="-1"></a>df.sprinkler_given_cloudy <span class="ot">=</span> <span class="fu">tibble</span>(<span class="at">C =</span> <span class="fu">c</span>(<span class="st">&quot;F&quot;</span>, <span class="st">&quot;T&quot;</span>),</span>
<span id="cb882-3"><a href="causation.html#cb882-3" tabindex="-1"></a>                                   <span class="st">`</span><span class="at">p(S)</span><span class="st">`</span><span class="ot">=</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.1</span>))</span>
<span id="cb882-4"><a href="causation.html#cb882-4" tabindex="-1"></a></span>
<span id="cb882-5"><a href="causation.html#cb882-5" tabindex="-1"></a>df.sprinkler_given_cloudy <span class="sc">%&gt;%</span> </span>
<span id="cb882-6"><a href="causation.html#cb882-6" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb882-7"><a href="causation.html#cb882-7" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="st">&quot;striped&quot;</span>,</span>
<span id="cb882-8"><a href="causation.html#cb882-8" tabindex="-1"></a>                <span class="at">full_width =</span> F,</span>
<span id="cb882-9"><a href="causation.html#cb882-9" tabindex="-1"></a>                <span class="at">font_size =</span> <span class="dv">20</span>)</span></code></pre></div>
<table class="table table-striped" style="font-size: 20px; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
C
</th>
<th style="text-align:right;">
p(S)
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
F
</td>
<td style="text-align:right;">
0.5
</td>
</tr>
<tr>
<td style="text-align:left;">
T
</td>
<td style="text-align:right;">
0.1
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb883"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb883-1"><a href="causation.html#cb883-1" tabindex="-1"></a><span class="co"># rain given cloudy </span></span>
<span id="cb883-2"><a href="causation.html#cb883-2" tabindex="-1"></a>df.rain_given_cloudy <span class="ot">=</span> <span class="fu">tibble</span>(<span class="at">C =</span> <span class="fu">c</span>(<span class="st">&quot;F&quot;</span>, <span class="st">&quot;T&quot;</span>),</span>
<span id="cb883-3"><a href="causation.html#cb883-3" tabindex="-1"></a>                              <span class="st">`</span><span class="at">p(R)</span><span class="st">`</span><span class="ot">=</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.8</span>))</span>
<span id="cb883-4"><a href="causation.html#cb883-4" tabindex="-1"></a></span>
<span id="cb883-5"><a href="causation.html#cb883-5" tabindex="-1"></a>df.rain_given_cloudy <span class="sc">%&gt;%</span> </span>
<span id="cb883-6"><a href="causation.html#cb883-6" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb883-7"><a href="causation.html#cb883-7" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="st">&quot;striped&quot;</span>,</span>
<span id="cb883-8"><a href="causation.html#cb883-8" tabindex="-1"></a>                <span class="at">full_width =</span> F,</span>
<span id="cb883-9"><a href="causation.html#cb883-9" tabindex="-1"></a>                <span class="at">font_size =</span> <span class="dv">20</span>)</span></code></pre></div>
<table class="table table-striped" style="font-size: 20px; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
C
</th>
<th style="text-align:right;">
p(R)
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
F
</td>
<td style="text-align:right;">
0.2
</td>
</tr>
<tr>
<td style="text-align:left;">
T
</td>
<td style="text-align:right;">
0.8
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb884"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb884-1"><a href="causation.html#cb884-1" tabindex="-1"></a><span class="co"># wet given sprinkler and rain  </span></span>
<span id="cb884-2"><a href="causation.html#cb884-2" tabindex="-1"></a>df.rain_given_sprinkler_and_rain <span class="ot">=</span> <span class="fu">tibble</span>(</span>
<span id="cb884-3"><a href="causation.html#cb884-3" tabindex="-1"></a>  <span class="at">S =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;F&quot;</span>, <span class="st">&quot;T&quot;</span>), <span class="dv">2</span>),</span>
<span id="cb884-4"><a href="causation.html#cb884-4" tabindex="-1"></a>  <span class="at">R =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;F&quot;</span>, <span class="st">&quot;T&quot;</span>), <span class="at">each =</span> <span class="dv">2</span>),</span>
<span id="cb884-5"><a href="causation.html#cb884-5" tabindex="-1"></a>  <span class="st">`</span><span class="at">p(W)</span><span class="st">`</span><span class="ot">=</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.9</span>, <span class="fl">0.9</span>, <span class="fl">0.99</span>)</span>
<span id="cb884-6"><a href="causation.html#cb884-6" tabindex="-1"></a>)</span>
<span id="cb884-7"><a href="causation.html#cb884-7" tabindex="-1"></a></span>
<span id="cb884-8"><a href="causation.html#cb884-8" tabindex="-1"></a>df.rain_given_sprinkler_and_rain <span class="sc">%&gt;%</span> </span>
<span id="cb884-9"><a href="causation.html#cb884-9" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb884-10"><a href="causation.html#cb884-10" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="st">&quot;striped&quot;</span>,</span>
<span id="cb884-11"><a href="causation.html#cb884-11" tabindex="-1"></a>                <span class="at">full_width =</span> F,</span>
<span id="cb884-12"><a href="causation.html#cb884-12" tabindex="-1"></a>                <span class="at">font_size =</span> <span class="dv">20</span>)</span></code></pre></div>
<table class="table table-striped" style="font-size: 20px; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
S
</th>
<th style="text-align:left;">
R
</th>
<th style="text-align:right;">
p(W)
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
F
</td>
<td style="text-align:left;">
F
</td>
<td style="text-align:right;">
0.00
</td>
</tr>
<tr>
<td style="text-align:left;">
T
</td>
<td style="text-align:left;">
F
</td>
<td style="text-align:right;">
0.90
</td>
</tr>
<tr>
<td style="text-align:left;">
F
</td>
<td style="text-align:left;">
T
</td>
<td style="text-align:right;">
0.90
</td>
</tr>
<tr>
<td style="text-align:left;">
T
</td>
<td style="text-align:left;">
T
</td>
<td style="text-align:right;">
0.99
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="controlling-for-variables" class="section level2 hasAnchor" number="16.5">
<h2><span class="header-section-number">16.5</span> Controlling for variables<a href="causation.html#controlling-for-variables" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="illustration-of-the-d-separation-algorithm" class="section level3 hasAnchor" number="16.5.1">
<h3><span class="header-section-number">16.5.1</span> Illustration of the d-separation algorithm<a href="causation.html#illustration-of-the-d-separation-algorithm" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Question: Are D and E independent?</li>
</ul>
<div id="full-dag" class="section level4 hasAnchor" number="16.5.1.1">
<h4><span class="header-section-number">16.5.1.1</span> Full DAG<a href="causation.html#full-dag" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb885"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb885-1"><a href="causation.html#cb885-1" tabindex="-1"></a>g <span class="ot">=</span> <span class="fu">grViz</span>(<span class="st">&quot;</span></span>
<span id="cb885-2"><a href="causation.html#cb885-2" tabindex="-1"></a><span class="st">digraph neato {</span></span>
<span id="cb885-3"><a href="causation.html#cb885-3" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb885-4"><a href="causation.html#cb885-4" tabindex="-1"></a><span class="st">  graph[layout = neato]</span></span>
<span id="cb885-5"><a href="causation.html#cb885-5" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb885-6"><a href="causation.html#cb885-6" tabindex="-1"></a><span class="st">  # general settings for all nodes</span></span>
<span id="cb885-7"><a href="causation.html#cb885-7" tabindex="-1"></a><span class="st">  node [</span></span>
<span id="cb885-8"><a href="causation.html#cb885-8" tabindex="-1"></a><span class="st">    shape = circle,</span></span>
<span id="cb885-9"><a href="causation.html#cb885-9" tabindex="-1"></a><span class="st">    style = filled,</span></span>
<span id="cb885-10"><a href="causation.html#cb885-10" tabindex="-1"></a><span class="st">    color = black,</span></span>
<span id="cb885-11"><a href="causation.html#cb885-11" tabindex="-1"></a><span class="st">    label = &#39;&#39;</span></span>
<span id="cb885-12"><a href="causation.html#cb885-12" tabindex="-1"></a><span class="st">    fontname = &#39;Helvetica&#39;,</span></span>
<span id="cb885-13"><a href="causation.html#cb885-13" tabindex="-1"></a><span class="st">    fontsize = 16,</span></span>
<span id="cb885-14"><a href="causation.html#cb885-14" tabindex="-1"></a><span class="st">    fillcolor = lightblue</span></span>
<span id="cb885-15"><a href="causation.html#cb885-15" tabindex="-1"></a><span class="st">    ]</span></span>
<span id="cb885-16"><a href="causation.html#cb885-16" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb885-17"><a href="causation.html#cb885-17" tabindex="-1"></a><span class="st">  # labels for each node</span></span>
<span id="cb885-18"><a href="causation.html#cb885-18" tabindex="-1"></a><span class="st">  a [label = &#39;A&#39; pos = &#39;0,0!&#39;]</span></span>
<span id="cb885-19"><a href="causation.html#cb885-19" tabindex="-1"></a><span class="st">  b [label = &#39;B&#39;  pos = &#39;2,0!&#39;]</span></span>
<span id="cb885-20"><a href="causation.html#cb885-20" tabindex="-1"></a><span class="st">  c [label = &#39;C&#39; pos = &#39;1,-1!&#39;]</span></span>
<span id="cb885-21"><a href="causation.html#cb885-21" tabindex="-1"></a><span class="st">  d [label = &#39;D&#39; pos = &#39;0,-2!&#39;]</span></span>
<span id="cb885-22"><a href="causation.html#cb885-22" tabindex="-1"></a><span class="st">  e [label = &#39;E&#39; pos = &#39;2,-2!&#39;]</span></span>
<span id="cb885-23"><a href="causation.html#cb885-23" tabindex="-1"></a><span class="st">  f [label = &#39;F&#39; pos = &#39;1,-3!&#39;]</span></span>
<span id="cb885-24"><a href="causation.html#cb885-24" tabindex="-1"></a><span class="st">  g [label = &#39;G&#39; pos = &#39;0,-4!&#39;]</span></span>
<span id="cb885-25"><a href="causation.html#cb885-25" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb885-26"><a href="causation.html#cb885-26" tabindex="-1"></a><span class="st">  # edges between nodes</span></span>
<span id="cb885-27"><a href="causation.html#cb885-27" tabindex="-1"></a><span class="st">  edge [color = black]</span></span>
<span id="cb885-28"><a href="causation.html#cb885-28" tabindex="-1"></a><span class="st">  a -&gt; c</span></span>
<span id="cb885-29"><a href="causation.html#cb885-29" tabindex="-1"></a><span class="st">  b -&gt; c</span></span>
<span id="cb885-30"><a href="causation.html#cb885-30" tabindex="-1"></a><span class="st">  c -&gt; {d e}</span></span>
<span id="cb885-31"><a href="causation.html#cb885-31" tabindex="-1"></a><span class="st">  d -&gt; f</span></span>
<span id="cb885-32"><a href="causation.html#cb885-32" tabindex="-1"></a><span class="st">  f -&gt; g</span></span>
<span id="cb885-33"><a href="causation.html#cb885-33" tabindex="-1"></a></span>
<span id="cb885-34"><a href="causation.html#cb885-34" tabindex="-1"></a><span class="st">  # direction in which arrows are drawn (from left to right)</span></span>
<span id="cb885-35"><a href="causation.html#cb885-35" tabindex="-1"></a><span class="st">  rankdir = LR</span></span>
<span id="cb885-36"><a href="causation.html#cb885-36" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb885-37"><a href="causation.html#cb885-37" tabindex="-1"></a><span class="st">&quot;</span>) </span>
<span id="cb885-38"><a href="causation.html#cb885-38" tabindex="-1"></a></span>
<span id="cb885-39"><a href="causation.html#cb885-39" tabindex="-1"></a><span class="co"># export as pdf </span></span>
<span id="cb885-40"><a href="causation.html#cb885-40" tabindex="-1"></a><span class="co"># g %&gt;% </span></span>
<span id="cb885-41"><a href="causation.html#cb885-41" tabindex="-1"></a><span class="co">#   export_svg %&gt;% </span></span>
<span id="cb885-42"><a href="causation.html#cb885-42" tabindex="-1"></a><span class="co">#   charToRaw %&gt;% </span></span>
<span id="cb885-43"><a href="causation.html#cb885-43" tabindex="-1"></a><span class="co">#   rsvg_pdf(&quot;figures/dag.pdf&quot;)</span></span>
<span id="cb885-44"><a href="causation.html#cb885-44" tabindex="-1"></a></span>
<span id="cb885-45"><a href="causation.html#cb885-45" tabindex="-1"></a><span class="co"># show plot</span></span>
<span id="cb885-46"><a href="causation.html#cb885-46" tabindex="-1"></a>g</span></code></pre></div>
<div class="grViz html-widget html-fill-item" id="htmlwidget-4e23cac6e9ad01d77f99" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-4e23cac6e9ad01d77f99">{"x":{"diagram":"\ndigraph neato {\n  \n  graph[layout = neato]\n  \n  # general settings for all nodes\n  node [\n    shape = circle,\n    style = filled,\n    color = black,\n    label = \"\"\n    fontname = \"Helvetica\",\n    fontsize = 16,\n    fillcolor = lightblue\n    ]\n  \n  # labels for each node\n  a [label = \"A\" pos = \"0,0!\"]\n  b [label = \"B\"  pos = \"2,0!\"]\n  c [label = \"C\" pos = \"1,-1!\"]\n  d [label = \"D\" pos = \"0,-2!\"]\n  e [label = \"E\" pos = \"2,-2!\"]\n  f [label = \"F\" pos = \"1,-3!\"]\n  g [label = \"G\" pos = \"0,-4!\"]\n  \n  # edges between nodes\n  edge [color = black]\n  a -> c\n  b -> c\n  c -> {d e}\n  d -> f\n  f -> g\n\n  # direction in which arrows are drawn (from left to right)\n  rankdir = LR\n}\n","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="draw-the-ancestral-graph" class="section level4 hasAnchor" number="16.5.1.2">
<h4><span class="header-section-number">16.5.1.2</span> Draw the ancestral graph<a href="causation.html#draw-the-ancestral-graph" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb886"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb886-1"><a href="causation.html#cb886-1" tabindex="-1"></a>g <span class="ot">=</span> <span class="fu">grViz</span>(<span class="st">&quot;</span></span>
<span id="cb886-2"><a href="causation.html#cb886-2" tabindex="-1"></a><span class="st">digraph neato {</span></span>
<span id="cb886-3"><a href="causation.html#cb886-3" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb886-4"><a href="causation.html#cb886-4" tabindex="-1"></a><span class="st">  graph[layout = neato]</span></span>
<span id="cb886-5"><a href="causation.html#cb886-5" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb886-6"><a href="causation.html#cb886-6" tabindex="-1"></a><span class="st">  # general settings for all nodes</span></span>
<span id="cb886-7"><a href="causation.html#cb886-7" tabindex="-1"></a><span class="st">  node [</span></span>
<span id="cb886-8"><a href="causation.html#cb886-8" tabindex="-1"></a><span class="st">    shape = circle,</span></span>
<span id="cb886-9"><a href="causation.html#cb886-9" tabindex="-1"></a><span class="st">    style = filled,</span></span>
<span id="cb886-10"><a href="causation.html#cb886-10" tabindex="-1"></a><span class="st">    color = black,</span></span>
<span id="cb886-11"><a href="causation.html#cb886-11" tabindex="-1"></a><span class="st">    label = &#39;&#39;</span></span>
<span id="cb886-12"><a href="causation.html#cb886-12" tabindex="-1"></a><span class="st">    fontname = &#39;Helvetica&#39;,</span></span>
<span id="cb886-13"><a href="causation.html#cb886-13" tabindex="-1"></a><span class="st">    fontsize = 16,</span></span>
<span id="cb886-14"><a href="causation.html#cb886-14" tabindex="-1"></a><span class="st">    fillcolor = lightblue</span></span>
<span id="cb886-15"><a href="causation.html#cb886-15" tabindex="-1"></a><span class="st">    ]</span></span>
<span id="cb886-16"><a href="causation.html#cb886-16" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb886-17"><a href="causation.html#cb886-17" tabindex="-1"></a><span class="st">  # labels for each node</span></span>
<span id="cb886-18"><a href="causation.html#cb886-18" tabindex="-1"></a><span class="st">  a [label = &#39;A&#39; pos = &#39;0,0!&#39;]</span></span>
<span id="cb886-19"><a href="causation.html#cb886-19" tabindex="-1"></a><span class="st">  b [label = &#39;B&#39;  pos = &#39;2,0!&#39;]</span></span>
<span id="cb886-20"><a href="causation.html#cb886-20" tabindex="-1"></a><span class="st">  c [label = &#39;C&#39; pos = &#39;1,-1!&#39;]</span></span>
<span id="cb886-21"><a href="causation.html#cb886-21" tabindex="-1"></a><span class="st">  d [label = &#39;D&#39; pos = &#39;0,-2!&#39;]</span></span>
<span id="cb886-22"><a href="causation.html#cb886-22" tabindex="-1"></a><span class="st">  e [label = &#39;E&#39; pos = &#39;2,-2!&#39;]</span></span>
<span id="cb886-23"><a href="causation.html#cb886-23" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb886-24"><a href="causation.html#cb886-24" tabindex="-1"></a><span class="st">  # edges between nodes</span></span>
<span id="cb886-25"><a href="causation.html#cb886-25" tabindex="-1"></a><span class="st">  edge [color = black]</span></span>
<span id="cb886-26"><a href="causation.html#cb886-26" tabindex="-1"></a><span class="st">  a -&gt; c</span></span>
<span id="cb886-27"><a href="causation.html#cb886-27" tabindex="-1"></a><span class="st">  b -&gt; c</span></span>
<span id="cb886-28"><a href="causation.html#cb886-28" tabindex="-1"></a><span class="st">  c -&gt; {d e}</span></span>
<span id="cb886-29"><a href="causation.html#cb886-29" tabindex="-1"></a></span>
<span id="cb886-30"><a href="causation.html#cb886-30" tabindex="-1"></a><span class="st">  # direction in which arrows are drawn (from left to right)</span></span>
<span id="cb886-31"><a href="causation.html#cb886-31" tabindex="-1"></a><span class="st">  rankdir = LR</span></span>
<span id="cb886-32"><a href="causation.html#cb886-32" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb886-33"><a href="causation.html#cb886-33" tabindex="-1"></a><span class="st">&quot;</span>) </span>
<span id="cb886-34"><a href="causation.html#cb886-34" tabindex="-1"></a></span>
<span id="cb886-35"><a href="causation.html#cb886-35" tabindex="-1"></a><span class="co"># export as pdf </span></span>
<span id="cb886-36"><a href="causation.html#cb886-36" tabindex="-1"></a><span class="co"># g %&gt;% </span></span>
<span id="cb886-37"><a href="causation.html#cb886-37" tabindex="-1"></a><span class="co">#   export_svg %&gt;% </span></span>
<span id="cb886-38"><a href="causation.html#cb886-38" tabindex="-1"></a><span class="co">#   charToRaw %&gt;% </span></span>
<span id="cb886-39"><a href="causation.html#cb886-39" tabindex="-1"></a><span class="co">#   rsvg_pdf(&quot;figures/ancestral_graph.pdf&quot;)</span></span>
<span id="cb886-40"><a href="causation.html#cb886-40" tabindex="-1"></a></span>
<span id="cb886-41"><a href="causation.html#cb886-41" tabindex="-1"></a><span class="co"># show plot</span></span>
<span id="cb886-42"><a href="causation.html#cb886-42" tabindex="-1"></a>g</span></code></pre></div>
<div class="grViz html-widget html-fill-item" id="htmlwidget-9dfbe09ac3771165ed59" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-9dfbe09ac3771165ed59">{"x":{"diagram":"\ndigraph neato {\n  \n  graph[layout = neato]\n  \n  # general settings for all nodes\n  node [\n    shape = circle,\n    style = filled,\n    color = black,\n    label = \"\"\n    fontname = \"Helvetica\",\n    fontsize = 16,\n    fillcolor = lightblue\n    ]\n  \n  # labels for each node\n  a [label = \"A\" pos = \"0,0!\"]\n  b [label = \"B\"  pos = \"2,0!\"]\n  c [label = \"C\" pos = \"1,-1!\"]\n  d [label = \"D\" pos = \"0,-2!\"]\n  e [label = \"E\" pos = \"2,-2!\"]\n  \n  # edges between nodes\n  edge [color = black]\n  a -> c\n  b -> c\n  c -> {d e}\n\n  # direction in which arrows are drawn (from left to right)\n  rankdir = LR\n}\n","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="moralize-the-ancestral-graph-by-marrying-any-parents-and-disorient-by-replacing-arrows-with-edges" class="section level4 hasAnchor" number="16.5.1.3">
<h4><span class="header-section-number">16.5.1.3</span> “Moralize” the ancestral graph by “marrying” any parents, and disorient by replacing arrows with edges<a href="causation.html#moralize-the-ancestral-graph-by-marrying-any-parents-and-disorient-by-replacing-arrows-with-edges" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb887"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb887-1"><a href="causation.html#cb887-1" tabindex="-1"></a>g <span class="ot">=</span> <span class="fu">grViz</span>(<span class="st">&quot;</span></span>
<span id="cb887-2"><a href="causation.html#cb887-2" tabindex="-1"></a><span class="st">graph neato {</span></span>
<span id="cb887-3"><a href="causation.html#cb887-3" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb887-4"><a href="causation.html#cb887-4" tabindex="-1"></a><span class="st">  graph[layout = neato]</span></span>
<span id="cb887-5"><a href="causation.html#cb887-5" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb887-6"><a href="causation.html#cb887-6" tabindex="-1"></a><span class="st">  # general settings for all nodes</span></span>
<span id="cb887-7"><a href="causation.html#cb887-7" tabindex="-1"></a><span class="st">  node [</span></span>
<span id="cb887-8"><a href="causation.html#cb887-8" tabindex="-1"></a><span class="st">    shape = circle,</span></span>
<span id="cb887-9"><a href="causation.html#cb887-9" tabindex="-1"></a><span class="st">    style = filled,</span></span>
<span id="cb887-10"><a href="causation.html#cb887-10" tabindex="-1"></a><span class="st">    color = black,</span></span>
<span id="cb887-11"><a href="causation.html#cb887-11" tabindex="-1"></a><span class="st">    label = &#39;&#39;</span></span>
<span id="cb887-12"><a href="causation.html#cb887-12" tabindex="-1"></a><span class="st">    fontname = &#39;Helvetica&#39;,</span></span>
<span id="cb887-13"><a href="causation.html#cb887-13" tabindex="-1"></a><span class="st">    fontsize = 16,</span></span>
<span id="cb887-14"><a href="causation.html#cb887-14" tabindex="-1"></a><span class="st">    fillcolor = lightblue</span></span>
<span id="cb887-15"><a href="causation.html#cb887-15" tabindex="-1"></a><span class="st">    ]</span></span>
<span id="cb887-16"><a href="causation.html#cb887-16" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb887-17"><a href="causation.html#cb887-17" tabindex="-1"></a><span class="st">  # labels for each node</span></span>
<span id="cb887-18"><a href="causation.html#cb887-18" tabindex="-1"></a><span class="st">  a [label = &#39;A&#39; pos = &#39;0,0!&#39;]</span></span>
<span id="cb887-19"><a href="causation.html#cb887-19" tabindex="-1"></a><span class="st">  b [label = &#39;B&#39;  pos = &#39;2,0!&#39;]</span></span>
<span id="cb887-20"><a href="causation.html#cb887-20" tabindex="-1"></a><span class="st">  c [label = &#39;C&#39; pos = &#39;1,-1!&#39;]</span></span>
<span id="cb887-21"><a href="causation.html#cb887-21" tabindex="-1"></a><span class="st">  d [label = &#39;D&#39; pos = &#39;0,-2!&#39;]</span></span>
<span id="cb887-22"><a href="causation.html#cb887-22" tabindex="-1"></a><span class="st">  e [label = &#39;E&#39; pos = &#39;2,-2!&#39;]</span></span>
<span id="cb887-23"><a href="causation.html#cb887-23" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb887-24"><a href="causation.html#cb887-24" tabindex="-1"></a><span class="st">  # edges between nodes</span></span>
<span id="cb887-25"><a href="causation.html#cb887-25" tabindex="-1"></a><span class="st">  edge [color = black]</span></span>
<span id="cb887-26"><a href="causation.html#cb887-26" tabindex="-1"></a><span class="st">  a -- c</span></span>
<span id="cb887-27"><a href="causation.html#cb887-27" tabindex="-1"></a><span class="st">  b -- c</span></span>
<span id="cb887-28"><a href="causation.html#cb887-28" tabindex="-1"></a><span class="st">  c -- {d e}</span></span>
<span id="cb887-29"><a href="causation.html#cb887-29" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb887-30"><a href="causation.html#cb887-30" tabindex="-1"></a><span class="st">  edge [color = black]</span></span>
<span id="cb887-31"><a href="causation.html#cb887-31" tabindex="-1"></a><span class="st">  a -- b</span></span>
<span id="cb887-32"><a href="causation.html#cb887-32" tabindex="-1"></a></span>
<span id="cb887-33"><a href="causation.html#cb887-33" tabindex="-1"></a><span class="st">  # direction in which arrows are drawn (from left to right)</span></span>
<span id="cb887-34"><a href="causation.html#cb887-34" tabindex="-1"></a><span class="st">  rankdir = LR</span></span>
<span id="cb887-35"><a href="causation.html#cb887-35" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb887-36"><a href="causation.html#cb887-36" tabindex="-1"></a><span class="st">&quot;</span>) </span>
<span id="cb887-37"><a href="causation.html#cb887-37" tabindex="-1"></a></span>
<span id="cb887-38"><a href="causation.html#cb887-38" tabindex="-1"></a><span class="co"># export as pdf </span></span>
<span id="cb887-39"><a href="causation.html#cb887-39" tabindex="-1"></a><span class="co"># g %&gt;% </span></span>
<span id="cb887-40"><a href="causation.html#cb887-40" tabindex="-1"></a><span class="co">#   export_svg %&gt;% </span></span>
<span id="cb887-41"><a href="causation.html#cb887-41" tabindex="-1"></a><span class="co">#   charToRaw %&gt;% </span></span>
<span id="cb887-42"><a href="causation.html#cb887-42" tabindex="-1"></a><span class="co">#   rsvg_pdf(&quot;figures/moralize_and_disorient.pdf&quot;)</span></span>
<span id="cb887-43"><a href="causation.html#cb887-43" tabindex="-1"></a></span>
<span id="cb887-44"><a href="causation.html#cb887-44" tabindex="-1"></a><span class="co"># show plot</span></span>
<span id="cb887-45"><a href="causation.html#cb887-45" tabindex="-1"></a>g</span></code></pre></div>
<div class="grViz html-widget html-fill-item" id="htmlwidget-239cdaf96c9fef50b6a4" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-239cdaf96c9fef50b6a4">{"x":{"diagram":"\ngraph neato {\n  \n  graph[layout = neato]\n  \n  # general settings for all nodes\n  node [\n    shape = circle,\n    style = filled,\n    color = black,\n    label = \"\"\n    fontname = \"Helvetica\",\n    fontsize = 16,\n    fillcolor = lightblue\n    ]\n  \n  # labels for each node\n  a [label = \"A\" pos = \"0,0!\"]\n  b [label = \"B\"  pos = \"2,0!\"]\n  c [label = \"C\" pos = \"1,-1!\"]\n  d [label = \"D\" pos = \"0,-2!\"]\n  e [label = \"E\" pos = \"2,-2!\"]\n  \n  # edges between nodes\n  edge [color = black]\n  a -- c\n  b -- c\n  c -- {d e}\n  \n  edge [color = black]\n  a -- b\n\n  # direction in which arrows are drawn (from left to right)\n  rankdir = LR\n}\n","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
<ul>
<li>For the case in which we check whether D and E are independent conditioned on C</li>
</ul>
<div class="sourceCode" id="cb888"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb888-1"><a href="causation.html#cb888-1" tabindex="-1"></a>g <span class="ot">=</span> <span class="fu">grViz</span>(<span class="st">&quot;</span></span>
<span id="cb888-2"><a href="causation.html#cb888-2" tabindex="-1"></a><span class="st">graph neato {</span></span>
<span id="cb888-3"><a href="causation.html#cb888-3" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb888-4"><a href="causation.html#cb888-4" tabindex="-1"></a><span class="st">  graph[layout = neato]</span></span>
<span id="cb888-5"><a href="causation.html#cb888-5" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb888-6"><a href="causation.html#cb888-6" tabindex="-1"></a><span class="st">  # general settings for all nodes</span></span>
<span id="cb888-7"><a href="causation.html#cb888-7" tabindex="-1"></a><span class="st">  node [</span></span>
<span id="cb888-8"><a href="causation.html#cb888-8" tabindex="-1"></a><span class="st">    shape = circle,</span></span>
<span id="cb888-9"><a href="causation.html#cb888-9" tabindex="-1"></a><span class="st">    style = filled,</span></span>
<span id="cb888-10"><a href="causation.html#cb888-10" tabindex="-1"></a><span class="st">    color = black,</span></span>
<span id="cb888-11"><a href="causation.html#cb888-11" tabindex="-1"></a><span class="st">    label = &#39;&#39;</span></span>
<span id="cb888-12"><a href="causation.html#cb888-12" tabindex="-1"></a><span class="st">    fontname = &#39;Helvetica&#39;,</span></span>
<span id="cb888-13"><a href="causation.html#cb888-13" tabindex="-1"></a><span class="st">    fontsize = 16,</span></span>
<span id="cb888-14"><a href="causation.html#cb888-14" tabindex="-1"></a><span class="st">    fillcolor = lightblue</span></span>
<span id="cb888-15"><a href="causation.html#cb888-15" tabindex="-1"></a><span class="st">    ]</span></span>
<span id="cb888-16"><a href="causation.html#cb888-16" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb888-17"><a href="causation.html#cb888-17" tabindex="-1"></a><span class="st">  # labels for each node</span></span>
<span id="cb888-18"><a href="causation.html#cb888-18" tabindex="-1"></a><span class="st">  a [label = &#39;A&#39; pos = &#39;0,0!&#39;]</span></span>
<span id="cb888-19"><a href="causation.html#cb888-19" tabindex="-1"></a><span class="st">  b [label = &#39;B&#39;  pos = &#39;2,0!&#39;]</span></span>
<span id="cb888-20"><a href="causation.html#cb888-20" tabindex="-1"></a><span class="st">  d [label = &#39;D&#39; pos = &#39;0,-2!&#39;]</span></span>
<span id="cb888-21"><a href="causation.html#cb888-21" tabindex="-1"></a><span class="st">  e [label = &#39;E&#39; pos = &#39;2,-2!&#39;]</span></span>
<span id="cb888-22"><a href="causation.html#cb888-22" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb888-23"><a href="causation.html#cb888-23" tabindex="-1"></a><span class="st">  # edges between nodes</span></span>
<span id="cb888-24"><a href="causation.html#cb888-24" tabindex="-1"></a><span class="st">  edge [color = black]</span></span>
<span id="cb888-25"><a href="causation.html#cb888-25" tabindex="-1"></a></span>
<span id="cb888-26"><a href="causation.html#cb888-26" tabindex="-1"></a><span class="st">  edge [color = black]</span></span>
<span id="cb888-27"><a href="causation.html#cb888-27" tabindex="-1"></a><span class="st">  a -- b</span></span>
<span id="cb888-28"><a href="causation.html#cb888-28" tabindex="-1"></a></span>
<span id="cb888-29"><a href="causation.html#cb888-29" tabindex="-1"></a><span class="st">  # direction in which arrows are drawn (from left to right)</span></span>
<span id="cb888-30"><a href="causation.html#cb888-30" tabindex="-1"></a><span class="st">  rankdir = LR</span></span>
<span id="cb888-31"><a href="causation.html#cb888-31" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb888-32"><a href="causation.html#cb888-32" tabindex="-1"></a><span class="st">&quot;</span>) </span>
<span id="cb888-33"><a href="causation.html#cb888-33" tabindex="-1"></a></span>
<span id="cb888-34"><a href="causation.html#cb888-34" tabindex="-1"></a><span class="do">## export as pdf </span></span>
<span id="cb888-35"><a href="causation.html#cb888-35" tabindex="-1"></a><span class="co">#g %&gt;% </span></span>
<span id="cb888-36"><a href="causation.html#cb888-36" tabindex="-1"></a><span class="co">#  export_svg %&gt;% </span></span>
<span id="cb888-37"><a href="causation.html#cb888-37" tabindex="-1"></a><span class="co">#  charToRaw %&gt;% </span></span>
<span id="cb888-38"><a href="causation.html#cb888-38" tabindex="-1"></a><span class="co">#  rsvg_pdf(&quot;figures/moralize_and_disorient2.pdf&quot;)</span></span>
<span id="cb888-39"><a href="causation.html#cb888-39" tabindex="-1"></a></span>
<span id="cb888-40"><a href="causation.html#cb888-40" tabindex="-1"></a><span class="co"># show plot</span></span>
<span id="cb888-41"><a href="causation.html#cb888-41" tabindex="-1"></a>g</span></code></pre></div>
<div class="grViz html-widget html-fill-item" id="htmlwidget-d365076f14fe93958afc" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-d365076f14fe93958afc">{"x":{"diagram":"\ngraph neato {\n  \n  graph[layout = neato]\n  \n  # general settings for all nodes\n  node [\n    shape = circle,\n    style = filled,\n    color = black,\n    label = \"\"\n    fontname = \"Helvetica\",\n    fontsize = 16,\n    fillcolor = lightblue\n    ]\n  \n  # labels for each node\n  a [label = \"A\" pos = \"0,0!\"]\n  b [label = \"B\"  pos = \"2,0!\"]\n  d [label = \"D\" pos = \"0,-2!\"]\n  e [label = \"E\" pos = \"2,-2!\"]\n  \n  # edges between nodes\n  edge [color = black]\n\n  edge [color = black]\n  a -- b\n\n  # direction in which arrows are drawn (from left to right)\n  rankdir = LR\n}\n","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div id="good-controls" class="section level3 hasAnchor" number="16.5.2">
<h3><span class="header-section-number">16.5.2</span> Good controls<a href="causation.html#good-controls" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="common-cause-with-direct-link-between-x-and-y" class="section level4 hasAnchor" number="16.5.2.1">
<h4><span class="header-section-number">16.5.2.1</span> Common cause (with direct link between X and Y)<a href="causation.html#common-cause-with-direct-link-between-x-and-y" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div id="dag" class="section level5 hasAnchor" number="16.5.2.1.1">
<h5><span class="header-section-number">16.5.2.1.1</span> DAG<a href="causation.html#dag" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb889"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb889-1"><a href="causation.html#cb889-1" tabindex="-1"></a>g <span class="ot">=</span> <span class="fu">grViz</span>(<span class="st">&quot;</span></span>
<span id="cb889-2"><a href="causation.html#cb889-2" tabindex="-1"></a><span class="st">digraph neato {</span></span>
<span id="cb889-3"><a href="causation.html#cb889-3" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb889-4"><a href="causation.html#cb889-4" tabindex="-1"></a><span class="st">  graph[layout = neato]</span></span>
<span id="cb889-5"><a href="causation.html#cb889-5" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb889-6"><a href="causation.html#cb889-6" tabindex="-1"></a><span class="st">  # general settings for all nodes</span></span>
<span id="cb889-7"><a href="causation.html#cb889-7" tabindex="-1"></a><span class="st">  node [</span></span>
<span id="cb889-8"><a href="causation.html#cb889-8" tabindex="-1"></a><span class="st">    shape = circle,</span></span>
<span id="cb889-9"><a href="causation.html#cb889-9" tabindex="-1"></a><span class="st">    style = filled,</span></span>
<span id="cb889-10"><a href="causation.html#cb889-10" tabindex="-1"></a><span class="st">    color = black,</span></span>
<span id="cb889-11"><a href="causation.html#cb889-11" tabindex="-1"></a><span class="st">    label = &#39;&#39;</span></span>
<span id="cb889-12"><a href="causation.html#cb889-12" tabindex="-1"></a><span class="st">    fontname = &#39;Helvetica&#39;,</span></span>
<span id="cb889-13"><a href="causation.html#cb889-13" tabindex="-1"></a><span class="st">    fontsize = 16,</span></span>
<span id="cb889-14"><a href="causation.html#cb889-14" tabindex="-1"></a><span class="st">    fillcolor = lightblue</span></span>
<span id="cb889-15"><a href="causation.html#cb889-15" tabindex="-1"></a><span class="st">    ]</span></span>
<span id="cb889-16"><a href="causation.html#cb889-16" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb889-17"><a href="causation.html#cb889-17" tabindex="-1"></a><span class="st">  # labels for each node</span></span>
<span id="cb889-18"><a href="causation.html#cb889-18" tabindex="-1"></a><span class="st">  x [label = &#39;X&#39; pos = &#39;0,0!&#39;]</span></span>
<span id="cb889-19"><a href="causation.html#cb889-19" tabindex="-1"></a><span class="st">  y [label = &#39;Y&#39;  pos = &#39;2,0!&#39;]</span></span>
<span id="cb889-20"><a href="causation.html#cb889-20" tabindex="-1"></a><span class="st">  z [label = &#39;Z&#39; pos = &#39;1,1!&#39;, fontcolor = &#39;red&#39;]</span></span>
<span id="cb889-21"><a href="causation.html#cb889-21" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb889-22"><a href="causation.html#cb889-22" tabindex="-1"></a><span class="st">  # edges between nodes</span></span>
<span id="cb889-23"><a href="causation.html#cb889-23" tabindex="-1"></a><span class="st">  edge [color = black]</span></span>
<span id="cb889-24"><a href="causation.html#cb889-24" tabindex="-1"></a><span class="st">  x -&gt; y</span></span>
<span id="cb889-25"><a href="causation.html#cb889-25" tabindex="-1"></a><span class="st">  z -&gt; {x y}</span></span>
<span id="cb889-26"><a href="causation.html#cb889-26" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb889-27"><a href="causation.html#cb889-27" tabindex="-1"></a><span class="st">  # direction in which arrows are drawn (from left to right)</span></span>
<span id="cb889-28"><a href="causation.html#cb889-28" tabindex="-1"></a><span class="st">  rankdir = LR</span></span>
<span id="cb889-29"><a href="causation.html#cb889-29" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb889-30"><a href="causation.html#cb889-30" tabindex="-1"></a><span class="st">&quot;</span>) </span>
<span id="cb889-31"><a href="causation.html#cb889-31" tabindex="-1"></a></span>
<span id="cb889-32"><a href="causation.html#cb889-32" tabindex="-1"></a><span class="co"># export as pdf </span></span>
<span id="cb889-33"><a href="causation.html#cb889-33" tabindex="-1"></a><span class="co"># g %&gt;% </span></span>
<span id="cb889-34"><a href="causation.html#cb889-34" tabindex="-1"></a><span class="co">#   export_svg %&gt;% </span></span>
<span id="cb889-35"><a href="causation.html#cb889-35" tabindex="-1"></a><span class="co">#   charToRaw %&gt;% </span></span>
<span id="cb889-36"><a href="causation.html#cb889-36" tabindex="-1"></a><span class="co">#   rsvg_pdf(&quot;figures/common_cause1.pdf&quot;)</span></span>
<span id="cb889-37"><a href="causation.html#cb889-37" tabindex="-1"></a></span>
<span id="cb889-38"><a href="causation.html#cb889-38" tabindex="-1"></a><span class="co"># show plot</span></span>
<span id="cb889-39"><a href="causation.html#cb889-39" tabindex="-1"></a>g</span></code></pre></div>
<div class="grViz html-widget html-fill-item" id="htmlwidget-e8a6d2c97f867f63aa42" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-e8a6d2c97f867f63aa42">{"x":{"diagram":"\ndigraph neato {\n  \n  graph[layout = neato]\n  \n  # general settings for all nodes\n  node [\n    shape = circle,\n    style = filled,\n    color = black,\n    label = \"\"\n    fontname = \"Helvetica\",\n    fontsize = 16,\n    fillcolor = lightblue\n    ]\n  \n  # labels for each node\n  x [label = \"X\" pos = \"0,0!\"]\n  y [label = \"Y\"  pos = \"2,0!\"]\n  z [label = \"Z\" pos = \"1,1!\", fontcolor = \"red\"]\n  \n  # edges between nodes\n  edge [color = black]\n  x -> y\n  z -> {x y}\n  \n  # direction in which arrows are drawn (from left to right)\n  rankdir = LR\n}\n","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="regression-1" class="section level5 hasAnchor" number="16.5.2.1.2">
<h5><span class="header-section-number">16.5.2.1.2</span> Regression<a href="causation.html#regression-1" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb890"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb890-1"><a href="causation.html#cb890-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb890-2"><a href="causation.html#cb890-2" tabindex="-1"></a></span>
<span id="cb890-3"><a href="causation.html#cb890-3" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">1000</span></span>
<span id="cb890-4"><a href="causation.html#cb890-4" tabindex="-1"></a>b_zx <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb890-5"><a href="causation.html#cb890-5" tabindex="-1"></a>b_xy <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb890-6"><a href="causation.html#cb890-6" tabindex="-1"></a>b_zy <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb890-7"><a href="causation.html#cb890-7" tabindex="-1"></a>sd <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb890-8"><a href="causation.html#cb890-8" tabindex="-1"></a></span>
<span id="cb890-9"><a href="causation.html#cb890-9" tabindex="-1"></a>df <span class="ot">=</span> <span class="fu">tibble</span>(<span class="at">z =</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">sd =</span> sd),</span>
<span id="cb890-10"><a href="causation.html#cb890-10" tabindex="-1"></a>            <span class="at">x =</span> b_zx <span class="sc">*</span> z <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">sd =</span> sd),</span>
<span id="cb890-11"><a href="causation.html#cb890-11" tabindex="-1"></a>            <span class="at">y =</span> b_zy <span class="sc">*</span> z <span class="sc">+</span> b_xy <span class="sc">*</span> x <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">sd =</span> sd))</span>
<span id="cb890-12"><a href="causation.html#cb890-12" tabindex="-1"></a></span>
<span id="cb890-13"><a href="causation.html#cb890-13" tabindex="-1"></a><span class="co"># without control</span></span>
<span id="cb890-14"><a href="causation.html#cb890-14" tabindex="-1"></a><span class="fu">lm</span>(<span class="at">formula =</span> y <span class="sc">~</span> x,</span>
<span id="cb890-15"><a href="causation.html#cb890-15" tabindex="-1"></a>   <span class="at">data =</span> df) <span class="sc">%&gt;%</span> </span>
<span id="cb890-16"><a href="causation.html#cb890-16" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code></pre></div>
<pre><code>
Call:
lm(formula = y ~ x, data = df)

Residuals:
    Min      1Q  Median      3Q     Max 
-4.6011 -0.9270 -0.0506  0.9711  4.0454 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  0.02449    0.04389   0.558    0.577    
x            2.82092    0.01890 149.225   &lt;2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 1.388 on 998 degrees of freedom
Multiple R-squared:  0.9571,    Adjusted R-squared:  0.9571 
F-statistic: 2.227e+04 on 1 and 998 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb892"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb892-1"><a href="causation.html#cb892-1" tabindex="-1"></a><span class="co"># with control</span></span>
<span id="cb892-2"><a href="causation.html#cb892-2" tabindex="-1"></a><span class="fu">lm</span>(<span class="at">formula =</span> y <span class="sc">~</span> x <span class="sc">+</span> z,</span>
<span id="cb892-3"><a href="causation.html#cb892-3" tabindex="-1"></a>   <span class="at">data =</span> df) <span class="sc">%&gt;%</span> </span>
<span id="cb892-4"><a href="causation.html#cb892-4" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code></pre></div>
<pre><code>
Call:
lm(formula = y ~ x + z, data = df)

Residuals:
    Min      1Q  Median      3Q     Max 
-3.6151 -0.6564 -0.0223  0.6815  2.8132 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  0.01624    0.03260   0.498    0.618    
x            2.02202    0.03135  64.489   &lt;2e-16 ***
z            2.00501    0.07036  28.497   &lt;2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 1.031 on 997 degrees of freedom
Multiple R-squared:  0.9764,    Adjusted R-squared:  0.9763 
F-statistic: 2.059e+04 on 2 and 997 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div id="moralize-and-disorient-the-ancestral-graph" class="section level5 hasAnchor" number="16.5.2.1.3">
<h5><span class="header-section-number">16.5.2.1.3</span> Moralize and disorient the ancestral graph<a href="causation.html#moralize-and-disorient-the-ancestral-graph" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb894"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb894-1"><a href="causation.html#cb894-1" tabindex="-1"></a>g <span class="ot">=</span> <span class="fu">grViz</span>(<span class="st">&quot;</span></span>
<span id="cb894-2"><a href="causation.html#cb894-2" tabindex="-1"></a><span class="st">graph neato {</span></span>
<span id="cb894-3"><a href="causation.html#cb894-3" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb894-4"><a href="causation.html#cb894-4" tabindex="-1"></a><span class="st">  graph[layout = neato]</span></span>
<span id="cb894-5"><a href="causation.html#cb894-5" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb894-6"><a href="causation.html#cb894-6" tabindex="-1"></a><span class="st">  # general settings for all nodes</span></span>
<span id="cb894-7"><a href="causation.html#cb894-7" tabindex="-1"></a><span class="st">  node [</span></span>
<span id="cb894-8"><a href="causation.html#cb894-8" tabindex="-1"></a><span class="st">    shape = circle,</span></span>
<span id="cb894-9"><a href="causation.html#cb894-9" tabindex="-1"></a><span class="st">    style = filled,</span></span>
<span id="cb894-10"><a href="causation.html#cb894-10" tabindex="-1"></a><span class="st">    color = black,</span></span>
<span id="cb894-11"><a href="causation.html#cb894-11" tabindex="-1"></a><span class="st">    label = &#39;&#39;</span></span>
<span id="cb894-12"><a href="causation.html#cb894-12" tabindex="-1"></a><span class="st">    fontname = &#39;Helvetica&#39;,</span></span>
<span id="cb894-13"><a href="causation.html#cb894-13" tabindex="-1"></a><span class="st">    fontsize = 16,</span></span>
<span id="cb894-14"><a href="causation.html#cb894-14" tabindex="-1"></a><span class="st">    fillcolor = lightblue</span></span>
<span id="cb894-15"><a href="causation.html#cb894-15" tabindex="-1"></a><span class="st">    ]</span></span>
<span id="cb894-16"><a href="causation.html#cb894-16" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb894-17"><a href="causation.html#cb894-17" tabindex="-1"></a><span class="st">  # labels for each node</span></span>
<span id="cb894-18"><a href="causation.html#cb894-18" tabindex="-1"></a><span class="st">  x [label = &#39;X&#39; pos = &#39;0,0!&#39;]</span></span>
<span id="cb894-19"><a href="causation.html#cb894-19" tabindex="-1"></a><span class="st">  y [label = &#39;Y&#39;  pos = &#39;2,0!&#39;]</span></span>
<span id="cb894-20"><a href="causation.html#cb894-20" tabindex="-1"></a><span class="st">  z [label = &#39;Z&#39; pos = &#39;1,1!&#39;, fontcolor = &#39;red&#39;]</span></span>
<span id="cb894-21"><a href="causation.html#cb894-21" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb894-22"><a href="causation.html#cb894-22" tabindex="-1"></a><span class="st">  # edges between nodes</span></span>
<span id="cb894-23"><a href="causation.html#cb894-23" tabindex="-1"></a><span class="st">  edge [color = black]</span></span>
<span id="cb894-24"><a href="causation.html#cb894-24" tabindex="-1"></a><span class="st">  x -- y</span></span>
<span id="cb894-25"><a href="causation.html#cb894-25" tabindex="-1"></a><span class="st">  z -- {x y}</span></span>
<span id="cb894-26"><a href="causation.html#cb894-26" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb894-27"><a href="causation.html#cb894-27" tabindex="-1"></a><span class="st">  # direction in which arrows are drawn (from left to right)</span></span>
<span id="cb894-28"><a href="causation.html#cb894-28" tabindex="-1"></a><span class="st">  rankdir = LR</span></span>
<span id="cb894-29"><a href="causation.html#cb894-29" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb894-30"><a href="causation.html#cb894-30" tabindex="-1"></a><span class="st">&quot;</span>) </span>
<span id="cb894-31"><a href="causation.html#cb894-31" tabindex="-1"></a></span>
<span id="cb894-32"><a href="causation.html#cb894-32" tabindex="-1"></a><span class="co"># export as pdf </span></span>
<span id="cb894-33"><a href="causation.html#cb894-33" tabindex="-1"></a><span class="co"># g %&gt;% </span></span>
<span id="cb894-34"><a href="causation.html#cb894-34" tabindex="-1"></a><span class="co">#   export_svg %&gt;% </span></span>
<span id="cb894-35"><a href="causation.html#cb894-35" tabindex="-1"></a><span class="co">#   charToRaw %&gt;% </span></span>
<span id="cb894-36"><a href="causation.html#cb894-36" tabindex="-1"></a><span class="co">#   rsvg_pdf(&quot;figures/common_cause1_undirected.pdf&quot;)</span></span>
<span id="cb894-37"><a href="causation.html#cb894-37" tabindex="-1"></a><span class="co">#   # rsvg_pdf(&quot;figures/common_cause1_undirected2.pdf&quot;)</span></span>
<span id="cb894-38"><a href="causation.html#cb894-38" tabindex="-1"></a></span>
<span id="cb894-39"><a href="causation.html#cb894-39" tabindex="-1"></a><span class="co"># show plot</span></span>
<span id="cb894-40"><a href="causation.html#cb894-40" tabindex="-1"></a>g</span></code></pre></div>
<div class="grViz html-widget html-fill-item" id="htmlwidget-81165e4670ab4fe62b00" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-81165e4670ab4fe62b00">{"x":{"diagram":"\ngraph neato {\n  \n  graph[layout = neato]\n  \n  # general settings for all nodes\n  node [\n    shape = circle,\n    style = filled,\n    color = black,\n    label = \"\"\n    fontname = \"Helvetica\",\n    fontsize = 16,\n    fillcolor = lightblue\n    ]\n  \n  # labels for each node\n  x [label = \"X\" pos = \"0,0!\"]\n  y [label = \"Y\"  pos = \"2,0!\"]\n  z [label = \"Z\" pos = \"1,1!\", fontcolor = \"red\"]\n  \n  # edges between nodes\n  edge [color = black]\n  x -- y\n  z -- {x y}\n  \n  # direction in which arrows are drawn (from left to right)\n  rankdir = LR\n}\n","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div id="common-cause-without-direct-link-between-x-and-y" class="section level4 hasAnchor" number="16.5.2.2">
<h4><span class="header-section-number">16.5.2.2</span> Common cause (without direct link between X and Y)<a href="causation.html#common-cause-without-direct-link-between-x-and-y" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div id="dag-1" class="section level5 hasAnchor" number="16.5.2.2.1">
<h5><span class="header-section-number">16.5.2.2.1</span> DAG<a href="causation.html#dag-1" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb895"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb895-1"><a href="causation.html#cb895-1" tabindex="-1"></a>g <span class="ot">=</span> <span class="fu">grViz</span>(<span class="st">&quot;</span></span>
<span id="cb895-2"><a href="causation.html#cb895-2" tabindex="-1"></a><span class="st">digraph neato {</span></span>
<span id="cb895-3"><a href="causation.html#cb895-3" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb895-4"><a href="causation.html#cb895-4" tabindex="-1"></a><span class="st">  graph[layout = neato]</span></span>
<span id="cb895-5"><a href="causation.html#cb895-5" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb895-6"><a href="causation.html#cb895-6" tabindex="-1"></a><span class="st">  # general settings for all nodes</span></span>
<span id="cb895-7"><a href="causation.html#cb895-7" tabindex="-1"></a><span class="st">  node [</span></span>
<span id="cb895-8"><a href="causation.html#cb895-8" tabindex="-1"></a><span class="st">    shape = circle,</span></span>
<span id="cb895-9"><a href="causation.html#cb895-9" tabindex="-1"></a><span class="st">    style = filled,</span></span>
<span id="cb895-10"><a href="causation.html#cb895-10" tabindex="-1"></a><span class="st">    color = black,</span></span>
<span id="cb895-11"><a href="causation.html#cb895-11" tabindex="-1"></a><span class="st">    label = &#39;&#39;</span></span>
<span id="cb895-12"><a href="causation.html#cb895-12" tabindex="-1"></a><span class="st">    fontname = &#39;Helvetica&#39;,</span></span>
<span id="cb895-13"><a href="causation.html#cb895-13" tabindex="-1"></a><span class="st">    fontsize = 16,</span></span>
<span id="cb895-14"><a href="causation.html#cb895-14" tabindex="-1"></a><span class="st">    fillcolor = lightblue</span></span>
<span id="cb895-15"><a href="causation.html#cb895-15" tabindex="-1"></a><span class="st">    ]</span></span>
<span id="cb895-16"><a href="causation.html#cb895-16" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb895-17"><a href="causation.html#cb895-17" tabindex="-1"></a><span class="st">  # labels for each node</span></span>
<span id="cb895-18"><a href="causation.html#cb895-18" tabindex="-1"></a><span class="st">  x [label = &#39;X&#39; pos = &#39;0,0!&#39;]</span></span>
<span id="cb895-19"><a href="causation.html#cb895-19" tabindex="-1"></a><span class="st">  y [label = &#39;Y&#39;  pos = &#39;2,0!&#39;]</span></span>
<span id="cb895-20"><a href="causation.html#cb895-20" tabindex="-1"></a><span class="st">  z [label = &#39;Z&#39; pos = &#39;1,1!&#39;, fontcolor = &#39;red&#39;]</span></span>
<span id="cb895-21"><a href="causation.html#cb895-21" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb895-22"><a href="causation.html#cb895-22" tabindex="-1"></a><span class="st">  # edges between nodes</span></span>
<span id="cb895-23"><a href="causation.html#cb895-23" tabindex="-1"></a><span class="st">  edge [color = black]</span></span>
<span id="cb895-24"><a href="causation.html#cb895-24" tabindex="-1"></a><span class="st">  z -&gt; {x y}</span></span>
<span id="cb895-25"><a href="causation.html#cb895-25" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb895-26"><a href="causation.html#cb895-26" tabindex="-1"></a><span class="st">  # direction in which arrows are drawn (from left to right)</span></span>
<span id="cb895-27"><a href="causation.html#cb895-27" tabindex="-1"></a><span class="st">  rankdir = LR</span></span>
<span id="cb895-28"><a href="causation.html#cb895-28" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb895-29"><a href="causation.html#cb895-29" tabindex="-1"></a><span class="st">&quot;</span>)</span>
<span id="cb895-30"><a href="causation.html#cb895-30" tabindex="-1"></a></span>
<span id="cb895-31"><a href="causation.html#cb895-31" tabindex="-1"></a><span class="co"># export as pdf </span></span>
<span id="cb895-32"><a href="causation.html#cb895-32" tabindex="-1"></a><span class="co"># g %&gt;% </span></span>
<span id="cb895-33"><a href="causation.html#cb895-33" tabindex="-1"></a><span class="co">#   export_svg %&gt;% </span></span>
<span id="cb895-34"><a href="causation.html#cb895-34" tabindex="-1"></a><span class="co">#   charToRaw %&gt;% </span></span>
<span id="cb895-35"><a href="causation.html#cb895-35" tabindex="-1"></a><span class="co">#   rsvg_pdf(&quot;figures/common_cause2.pdf&quot;)</span></span>
<span id="cb895-36"><a href="causation.html#cb895-36" tabindex="-1"></a></span>
<span id="cb895-37"><a href="causation.html#cb895-37" tabindex="-1"></a><span class="co"># show plot</span></span>
<span id="cb895-38"><a href="causation.html#cb895-38" tabindex="-1"></a>g</span></code></pre></div>
<div class="grViz html-widget html-fill-item" id="htmlwidget-a830244451ecbcba88c4" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-a830244451ecbcba88c4">{"x":{"diagram":"\ndigraph neato {\n  \n  graph[layout = neato]\n  \n  # general settings for all nodes\n  node [\n    shape = circle,\n    style = filled,\n    color = black,\n    label = \"\"\n    fontname = \"Helvetica\",\n    fontsize = 16,\n    fillcolor = lightblue\n    ]\n  \n  # labels for each node\n  x [label = \"X\" pos = \"0,0!\"]\n  y [label = \"Y\"  pos = \"2,0!\"]\n  z [label = \"Z\" pos = \"1,1!\", fontcolor = \"red\"]\n  \n  # edges between nodes\n  edge [color = black]\n  z -> {x y}\n  \n  # direction in which arrows are drawn (from left to right)\n  rankdir = LR\n}\n","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="regression-2" class="section level5 hasAnchor" number="16.5.2.2.2">
<h5><span class="header-section-number">16.5.2.2.2</span> Regression<a href="causation.html#regression-2" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb896"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb896-1"><a href="causation.html#cb896-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb896-2"><a href="causation.html#cb896-2" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">1000</span></span>
<span id="cb896-3"><a href="causation.html#cb896-3" tabindex="-1"></a>b_zx <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb896-4"><a href="causation.html#cb896-4" tabindex="-1"></a>b_zy <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb896-5"><a href="causation.html#cb896-5" tabindex="-1"></a>sd <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb896-6"><a href="causation.html#cb896-6" tabindex="-1"></a></span>
<span id="cb896-7"><a href="causation.html#cb896-7" tabindex="-1"></a>df <span class="ot">=</span> <span class="fu">tibble</span>(<span class="at">z =</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">sd =</span> sd),</span>
<span id="cb896-8"><a href="causation.html#cb896-8" tabindex="-1"></a>            <span class="at">x =</span> b_zx <span class="sc">*</span> z <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">sd =</span> sd),</span>
<span id="cb896-9"><a href="causation.html#cb896-9" tabindex="-1"></a>            <span class="at">y =</span> b_zy <span class="sc">*</span> z <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">sd =</span> sd))</span>
<span id="cb896-10"><a href="causation.html#cb896-10" tabindex="-1"></a></span>
<span id="cb896-11"><a href="causation.html#cb896-11" tabindex="-1"></a><span class="co"># without control</span></span>
<span id="cb896-12"><a href="causation.html#cb896-12" tabindex="-1"></a><span class="fu">lm</span>(<span class="at">formula =</span> y <span class="sc">~</span> x,</span>
<span id="cb896-13"><a href="causation.html#cb896-13" tabindex="-1"></a>   <span class="at">data =</span> df) <span class="sc">%&gt;%</span> </span>
<span id="cb896-14"><a href="causation.html#cb896-14" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code></pre></div>
<pre><code>
Call:
lm(formula = y ~ x, data = df)

Residuals:
    Min      1Q  Median      3Q     Max 
-4.6011 -0.9270 -0.0506  0.9711  4.0454 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  0.02449    0.04389   0.558    0.577    
x            0.82092    0.01890  43.426   &lt;2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 1.388 on 998 degrees of freedom
Multiple R-squared:  0.6539,    Adjusted R-squared:  0.6536 
F-statistic:  1886 on 1 and 998 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb898"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb898-1"><a href="causation.html#cb898-1" tabindex="-1"></a><span class="co"># with control</span></span>
<span id="cb898-2"><a href="causation.html#cb898-2" tabindex="-1"></a><span class="fu">lm</span>(<span class="at">formula =</span> y <span class="sc">~</span> x <span class="sc">+</span> z,</span>
<span id="cb898-3"><a href="causation.html#cb898-3" tabindex="-1"></a>   <span class="at">data =</span> df) <span class="sc">%&gt;%</span> </span>
<span id="cb898-4"><a href="causation.html#cb898-4" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code></pre></div>
<pre><code>
Call:
lm(formula = y ~ x + z, data = df)

Residuals:
    Min      1Q  Median      3Q     Max 
-3.6151 -0.6564 -0.0223  0.6815  2.8132 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  0.01624    0.03260   0.498    0.618    
x            0.02202    0.03135   0.702    0.483    
z            2.00501    0.07036  28.497   &lt;2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 1.031 on 997 degrees of freedom
Multiple R-squared:  0.8093,    Adjusted R-squared:  0.8089 
F-statistic:  2115 on 2 and 997 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
</div>
<div id="bad-controls" class="section level3 hasAnchor" number="16.5.3">
<h3><span class="header-section-number">16.5.3</span> Bad controls<a href="causation.html#bad-controls" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="common-effect" class="section level4 hasAnchor" number="16.5.3.1">
<h4><span class="header-section-number">16.5.3.1</span> Common effect<a href="causation.html#common-effect" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div id="dag-2" class="section level5 hasAnchor" number="16.5.3.1.1">
<h5><span class="header-section-number">16.5.3.1.1</span> DAG<a href="causation.html#dag-2" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb900"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb900-1"><a href="causation.html#cb900-1" tabindex="-1"></a>g <span class="ot">=</span> <span class="fu">grViz</span>(<span class="st">&quot;</span></span>
<span id="cb900-2"><a href="causation.html#cb900-2" tabindex="-1"></a><span class="st">digraph neato {</span></span>
<span id="cb900-3"><a href="causation.html#cb900-3" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb900-4"><a href="causation.html#cb900-4" tabindex="-1"></a><span class="st">  graph[layout = neato]</span></span>
<span id="cb900-5"><a href="causation.html#cb900-5" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb900-6"><a href="causation.html#cb900-6" tabindex="-1"></a><span class="st">  # general settings for all nodes</span></span>
<span id="cb900-7"><a href="causation.html#cb900-7" tabindex="-1"></a><span class="st">  node [</span></span>
<span id="cb900-8"><a href="causation.html#cb900-8" tabindex="-1"></a><span class="st">    shape = circle,</span></span>
<span id="cb900-9"><a href="causation.html#cb900-9" tabindex="-1"></a><span class="st">    style = filled,</span></span>
<span id="cb900-10"><a href="causation.html#cb900-10" tabindex="-1"></a><span class="st">    color = black,</span></span>
<span id="cb900-11"><a href="causation.html#cb900-11" tabindex="-1"></a><span class="st">    label = &#39;&#39;</span></span>
<span id="cb900-12"><a href="causation.html#cb900-12" tabindex="-1"></a><span class="st">    fontname = &#39;Helvetica&#39;,</span></span>
<span id="cb900-13"><a href="causation.html#cb900-13" tabindex="-1"></a><span class="st">    fontsize = 16,</span></span>
<span id="cb900-14"><a href="causation.html#cb900-14" tabindex="-1"></a><span class="st">    fillcolor = lightblue</span></span>
<span id="cb900-15"><a href="causation.html#cb900-15" tabindex="-1"></a><span class="st">    ]</span></span>
<span id="cb900-16"><a href="causation.html#cb900-16" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb900-17"><a href="causation.html#cb900-17" tabindex="-1"></a><span class="st">  # labels for each node</span></span>
<span id="cb900-18"><a href="causation.html#cb900-18" tabindex="-1"></a><span class="st">  x [label = &#39;X&#39; pos = &#39;0,0!&#39;]</span></span>
<span id="cb900-19"><a href="causation.html#cb900-19" tabindex="-1"></a><span class="st">  y [label = &#39;Y&#39;  pos = &#39;2,0!&#39;]</span></span>
<span id="cb900-20"><a href="causation.html#cb900-20" tabindex="-1"></a><span class="st">  z [label = &#39;Z&#39; pos = &#39;1,-1!&#39;, fontcolor = &#39;red&#39;]</span></span>
<span id="cb900-21"><a href="causation.html#cb900-21" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb900-22"><a href="causation.html#cb900-22" tabindex="-1"></a><span class="st">  # edges between nodes</span></span>
<span id="cb900-23"><a href="causation.html#cb900-23" tabindex="-1"></a><span class="st">  edge [color = black]</span></span>
<span id="cb900-24"><a href="causation.html#cb900-24" tabindex="-1"></a><span class="st">  x -&gt; z</span></span>
<span id="cb900-25"><a href="causation.html#cb900-25" tabindex="-1"></a><span class="st">  y -&gt; z</span></span>
<span id="cb900-26"><a href="causation.html#cb900-26" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb900-27"><a href="causation.html#cb900-27" tabindex="-1"></a><span class="st">  # direction in which arrows are drawn (from left to right)</span></span>
<span id="cb900-28"><a href="causation.html#cb900-28" tabindex="-1"></a><span class="st">  rankdir = LR</span></span>
<span id="cb900-29"><a href="causation.html#cb900-29" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb900-30"><a href="causation.html#cb900-30" tabindex="-1"></a><span class="st">&quot;</span>)</span>
<span id="cb900-31"><a href="causation.html#cb900-31" tabindex="-1"></a></span>
<span id="cb900-32"><a href="causation.html#cb900-32" tabindex="-1"></a><span class="co"># export as pdf </span></span>
<span id="cb900-33"><a href="causation.html#cb900-33" tabindex="-1"></a><span class="co"># g %&gt;%</span></span>
<span id="cb900-34"><a href="causation.html#cb900-34" tabindex="-1"></a><span class="co">#   export_svg %&gt;%</span></span>
<span id="cb900-35"><a href="causation.html#cb900-35" tabindex="-1"></a><span class="co">#   charToRaw %&gt;%</span></span>
<span id="cb900-36"><a href="causation.html#cb900-36" tabindex="-1"></a><span class="co">#   rsvg_pdf(&quot;figures/common_effect.pdf&quot;)</span></span>
<span id="cb900-37"><a href="causation.html#cb900-37" tabindex="-1"></a></span>
<span id="cb900-38"><a href="causation.html#cb900-38" tabindex="-1"></a><span class="co"># show plot</span></span>
<span id="cb900-39"><a href="causation.html#cb900-39" tabindex="-1"></a>g</span></code></pre></div>
<div class="grViz html-widget html-fill-item" id="htmlwidget-178eeec0db531f857eab" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-178eeec0db531f857eab">{"x":{"diagram":"\ndigraph neato {\n  \n  graph[layout = neato]\n  \n  # general settings for all nodes\n  node [\n    shape = circle,\n    style = filled,\n    color = black,\n    label = \"\"\n    fontname = \"Helvetica\",\n    fontsize = 16,\n    fillcolor = lightblue\n    ]\n  \n  # labels for each node\n  x [label = \"X\" pos = \"0,0!\"]\n  y [label = \"Y\"  pos = \"2,0!\"]\n  z [label = \"Z\" pos = \"1,-1!\", fontcolor = \"red\"]\n  \n  # edges between nodes\n  edge [color = black]\n  x -> z\n  y -> z\n  \n  # direction in which arrows are drawn (from left to right)\n  rankdir = LR\n}\n","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="regression-3" class="section level5 hasAnchor" number="16.5.3.1.2">
<h5><span class="header-section-number">16.5.3.1.2</span> Regression<a href="causation.html#regression-3" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb901"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb901-1"><a href="causation.html#cb901-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb901-2"><a href="causation.html#cb901-2" tabindex="-1"></a></span>
<span id="cb901-3"><a href="causation.html#cb901-3" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">1000</span></span>
<span id="cb901-4"><a href="causation.html#cb901-4" tabindex="-1"></a>b_xz <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb901-5"><a href="causation.html#cb901-5" tabindex="-1"></a>b_yz <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb901-6"><a href="causation.html#cb901-6" tabindex="-1"></a>sd <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb901-7"><a href="causation.html#cb901-7" tabindex="-1"></a></span>
<span id="cb901-8"><a href="causation.html#cb901-8" tabindex="-1"></a>df <span class="ot">=</span> <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">sd =</span> sd),</span>
<span id="cb901-9"><a href="causation.html#cb901-9" tabindex="-1"></a>            <span class="at">y =</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">sd =</span> sd),</span>
<span id="cb901-10"><a href="causation.html#cb901-10" tabindex="-1"></a>            <span class="at">z =</span> x <span class="sc">*</span> b_xz <span class="sc">+</span> y <span class="sc">*</span> b_yz <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">sd =</span> sd))</span>
<span id="cb901-11"><a href="causation.html#cb901-11" tabindex="-1"></a></span>
<span id="cb901-12"><a href="causation.html#cb901-12" tabindex="-1"></a><span class="co"># without control</span></span>
<span id="cb901-13"><a href="causation.html#cb901-13" tabindex="-1"></a><span class="fu">lm</span>(<span class="at">formula =</span> y <span class="sc">~</span> x,</span>
<span id="cb901-14"><a href="causation.html#cb901-14" tabindex="-1"></a>   <span class="at">data =</span> df) <span class="sc">%&gt;%</span> </span>
<span id="cb901-15"><a href="causation.html#cb901-15" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code></pre></div>
<pre><code>
Call:
lm(formula = y ~ x, data = df)

Residuals:
    Min      1Q  Median      3Q     Max 
-3.2484 -0.6720 -0.0138  0.7554  3.6443 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)
(Intercept) -0.016187   0.032905  -0.492    0.623
x            0.006433   0.031809   0.202    0.840

Residual standard error: 1.04 on 998 degrees of freedom
Multiple R-squared:  4.098e-05, Adjusted R-squared:  -0.000961 
F-statistic: 0.0409 on 1 and 998 DF,  p-value: 0.8398</code></pre>
<div class="sourceCode" id="cb903"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb903-1"><a href="causation.html#cb903-1" tabindex="-1"></a><span class="co"># with control</span></span>
<span id="cb903-2"><a href="causation.html#cb903-2" tabindex="-1"></a><span class="fu">lm</span>(<span class="at">formula =</span> y <span class="sc">~</span> x <span class="sc">+</span> z,</span>
<span id="cb903-3"><a href="causation.html#cb903-3" tabindex="-1"></a>   <span class="at">data =</span> df) <span class="sc">%&gt;%</span> </span>
<span id="cb903-4"><a href="causation.html#cb903-4" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code></pre></div>
<pre><code>
Call:
lm(formula = y ~ x + z, data = df)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.35547 -0.30016  0.00298  0.31119  1.73408 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -0.009608   0.014477  -0.664    0.507    
x           -0.816164   0.018936 -43.102   &lt;2e-16 ***
z            0.398921   0.006186  64.489   &lt;2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 0.4578 on 997 degrees of freedom
Multiple R-squared:  0.8066,    Adjusted R-squared:  0.8062 
F-statistic:  2079 on 2 and 997 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div id="moralize-and-disorient-the-ancestral-graph-1" class="section level5 hasAnchor" number="16.5.3.1.3">
<h5><span class="header-section-number">16.5.3.1.3</span> Moralize and disorient the ancestral graph<a href="causation.html#moralize-and-disorient-the-ancestral-graph-1" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb905"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb905-1"><a href="causation.html#cb905-1" tabindex="-1"></a>g <span class="ot">=</span> <span class="fu">grViz</span>(<span class="st">&quot;</span></span>
<span id="cb905-2"><a href="causation.html#cb905-2" tabindex="-1"></a><span class="st">graph neato {</span></span>
<span id="cb905-3"><a href="causation.html#cb905-3" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb905-4"><a href="causation.html#cb905-4" tabindex="-1"></a><span class="st">  graph[layout = neato]</span></span>
<span id="cb905-5"><a href="causation.html#cb905-5" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb905-6"><a href="causation.html#cb905-6" tabindex="-1"></a><span class="st">  # general settings for all nodes</span></span>
<span id="cb905-7"><a href="causation.html#cb905-7" tabindex="-1"></a><span class="st">  node [</span></span>
<span id="cb905-8"><a href="causation.html#cb905-8" tabindex="-1"></a><span class="st">    shape = circle,</span></span>
<span id="cb905-9"><a href="causation.html#cb905-9" tabindex="-1"></a><span class="st">    style = filled,</span></span>
<span id="cb905-10"><a href="causation.html#cb905-10" tabindex="-1"></a><span class="st">    color = black,</span></span>
<span id="cb905-11"><a href="causation.html#cb905-11" tabindex="-1"></a><span class="st">    label = &#39;&#39;</span></span>
<span id="cb905-12"><a href="causation.html#cb905-12" tabindex="-1"></a><span class="st">    fontname = &#39;Helvetica&#39;,</span></span>
<span id="cb905-13"><a href="causation.html#cb905-13" tabindex="-1"></a><span class="st">    fontsize = 16,</span></span>
<span id="cb905-14"><a href="causation.html#cb905-14" tabindex="-1"></a><span class="st">    fillcolor = lightblue</span></span>
<span id="cb905-15"><a href="causation.html#cb905-15" tabindex="-1"></a><span class="st">    ]</span></span>
<span id="cb905-16"><a href="causation.html#cb905-16" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb905-17"><a href="causation.html#cb905-17" tabindex="-1"></a><span class="st">  # labels for each node</span></span>
<span id="cb905-18"><a href="causation.html#cb905-18" tabindex="-1"></a><span class="st">  x [label = &#39;X&#39; pos = &#39;0,0!&#39;]</span></span>
<span id="cb905-19"><a href="causation.html#cb905-19" tabindex="-1"></a><span class="st">  y [label = &#39;Y&#39;  pos = &#39;2,0!&#39;]</span></span>
<span id="cb905-20"><a href="causation.html#cb905-20" tabindex="-1"></a><span class="st">  z [label = &#39;Z&#39; pos = &#39;1,-1!&#39;, fontcolor = &#39;red&#39;]</span></span>
<span id="cb905-21"><a href="causation.html#cb905-21" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb905-22"><a href="causation.html#cb905-22" tabindex="-1"></a><span class="st">  # edges between nodes</span></span>
<span id="cb905-23"><a href="causation.html#cb905-23" tabindex="-1"></a><span class="st">  edge [color = black]</span></span>
<span id="cb905-24"><a href="causation.html#cb905-24" tabindex="-1"></a><span class="st">  x -- y</span></span>
<span id="cb905-25"><a href="causation.html#cb905-25" tabindex="-1"></a><span class="st">  x -- z</span></span>
<span id="cb905-26"><a href="causation.html#cb905-26" tabindex="-1"></a><span class="st">  y -- z</span></span>
<span id="cb905-27"><a href="causation.html#cb905-27" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb905-28"><a href="causation.html#cb905-28" tabindex="-1"></a><span class="st">  # direction in which arrows are drawn (from left to right)</span></span>
<span id="cb905-29"><a href="causation.html#cb905-29" tabindex="-1"></a><span class="st">  rankdir = LR</span></span>
<span id="cb905-30"><a href="causation.html#cb905-30" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb905-31"><a href="causation.html#cb905-31" tabindex="-1"></a><span class="st">&quot;</span>)</span>
<span id="cb905-32"><a href="causation.html#cb905-32" tabindex="-1"></a></span>
<span id="cb905-33"><a href="causation.html#cb905-33" tabindex="-1"></a><span class="co"># export as pdf </span></span>
<span id="cb905-34"><a href="causation.html#cb905-34" tabindex="-1"></a><span class="co"># g %&gt;%</span></span>
<span id="cb905-35"><a href="causation.html#cb905-35" tabindex="-1"></a><span class="co">#   export_svg %&gt;%</span></span>
<span id="cb905-36"><a href="causation.html#cb905-36" tabindex="-1"></a><span class="co">#   charToRaw %&gt;%</span></span>
<span id="cb905-37"><a href="causation.html#cb905-37" tabindex="-1"></a><span class="co">#   rsvg_pdf(&quot;figures/common_effect_undirected1.pdf&quot;)</span></span>
<span id="cb905-38"><a href="causation.html#cb905-38" tabindex="-1"></a><span class="co">#   rsvg_pdf(&quot;figures/common_effect_undirected2.pdf&quot;)</span></span>
<span id="cb905-39"><a href="causation.html#cb905-39" tabindex="-1"></a></span>
<span id="cb905-40"><a href="causation.html#cb905-40" tabindex="-1"></a><span class="co"># show plot</span></span>
<span id="cb905-41"><a href="causation.html#cb905-41" tabindex="-1"></a>g</span></code></pre></div>
<div class="grViz html-widget html-fill-item" id="htmlwidget-1e264e579ad7c9d408c6" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-1e264e579ad7c9d408c6">{"x":{"diagram":"\ngraph neato {\n  \n  graph[layout = neato]\n  \n  # general settings for all nodes\n  node [\n    shape = circle,\n    style = filled,\n    color = black,\n    label = \"\"\n    fontname = \"Helvetica\",\n    fontsize = 16,\n    fillcolor = lightblue\n    ]\n  \n  # labels for each node\n  x [label = \"X\" pos = \"0,0!\"]\n  y [label = \"Y\"  pos = \"2,0!\"]\n  z [label = \"Z\" pos = \"1,-1!\", fontcolor = \"red\"]\n  \n  # edges between nodes\n  edge [color = black]\n  x -- y\n  x -- z\n  y -- z\n  \n  # direction in which arrows are drawn (from left to right)\n  rankdir = LR\n}\n","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div id="causal-chain-1" class="section level4 hasAnchor" number="16.5.3.2">
<h4><span class="header-section-number">16.5.3.2</span> Causal chain 1<a href="causation.html#causal-chain-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div id="dag-3" class="section level5 hasAnchor" number="16.5.3.2.1">
<h5><span class="header-section-number">16.5.3.2.1</span> DAG<a href="causation.html#dag-3" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb906"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb906-1"><a href="causation.html#cb906-1" tabindex="-1"></a>g <span class="ot">=</span> <span class="fu">grViz</span>(<span class="st">&quot;</span></span>
<span id="cb906-2"><a href="causation.html#cb906-2" tabindex="-1"></a><span class="st">digraph neato {</span></span>
<span id="cb906-3"><a href="causation.html#cb906-3" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb906-4"><a href="causation.html#cb906-4" tabindex="-1"></a><span class="st">  graph[layout = neato]</span></span>
<span id="cb906-5"><a href="causation.html#cb906-5" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb906-6"><a href="causation.html#cb906-6" tabindex="-1"></a><span class="st">  # general settings for all nodes</span></span>
<span id="cb906-7"><a href="causation.html#cb906-7" tabindex="-1"></a><span class="st">  node [</span></span>
<span id="cb906-8"><a href="causation.html#cb906-8" tabindex="-1"></a><span class="st">    shape = circle,</span></span>
<span id="cb906-9"><a href="causation.html#cb906-9" tabindex="-1"></a><span class="st">    style = filled,</span></span>
<span id="cb906-10"><a href="causation.html#cb906-10" tabindex="-1"></a><span class="st">    color = black,</span></span>
<span id="cb906-11"><a href="causation.html#cb906-11" tabindex="-1"></a><span class="st">    label = &#39;&#39;</span></span>
<span id="cb906-12"><a href="causation.html#cb906-12" tabindex="-1"></a><span class="st">    fontname = &#39;Helvetica&#39;,</span></span>
<span id="cb906-13"><a href="causation.html#cb906-13" tabindex="-1"></a><span class="st">    fontsize = 16,</span></span>
<span id="cb906-14"><a href="causation.html#cb906-14" tabindex="-1"></a><span class="st">    fillcolor = lightblue</span></span>
<span id="cb906-15"><a href="causation.html#cb906-15" tabindex="-1"></a><span class="st">    ]</span></span>
<span id="cb906-16"><a href="causation.html#cb906-16" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb906-17"><a href="causation.html#cb906-17" tabindex="-1"></a><span class="st">  # labels for each node</span></span>
<span id="cb906-18"><a href="causation.html#cb906-18" tabindex="-1"></a><span class="st">  x [label = &#39;X&#39; pos = &#39;0,0!&#39;]</span></span>
<span id="cb906-19"><a href="causation.html#cb906-19" tabindex="-1"></a><span class="st">  y [label = &#39;Y&#39;  pos = &#39;2,0!&#39;]</span></span>
<span id="cb906-20"><a href="causation.html#cb906-20" tabindex="-1"></a><span class="st">  z [label = &#39;Z&#39; pos = &#39;1, 0!&#39;, fontcolor = &#39;red&#39;]</span></span>
<span id="cb906-21"><a href="causation.html#cb906-21" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb906-22"><a href="causation.html#cb906-22" tabindex="-1"></a><span class="st">  # edges between nodes</span></span>
<span id="cb906-23"><a href="causation.html#cb906-23" tabindex="-1"></a><span class="st">  edge [color = black]</span></span>
<span id="cb906-24"><a href="causation.html#cb906-24" tabindex="-1"></a><span class="st">  x -&gt; z</span></span>
<span id="cb906-25"><a href="causation.html#cb906-25" tabindex="-1"></a><span class="st">  z -&gt; y</span></span>
<span id="cb906-26"><a href="causation.html#cb906-26" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb906-27"><a href="causation.html#cb906-27" tabindex="-1"></a><span class="st">  # direction in which arrows are drawn (from left to right)</span></span>
<span id="cb906-28"><a href="causation.html#cb906-28" tabindex="-1"></a><span class="st">  rankdir = LR</span></span>
<span id="cb906-29"><a href="causation.html#cb906-29" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb906-30"><a href="causation.html#cb906-30" tabindex="-1"></a><span class="st">&quot;</span>)</span>
<span id="cb906-31"><a href="causation.html#cb906-31" tabindex="-1"></a></span>
<span id="cb906-32"><a href="causation.html#cb906-32" tabindex="-1"></a><span class="co"># # export as pdf </span></span>
<span id="cb906-33"><a href="causation.html#cb906-33" tabindex="-1"></a><span class="co"># g %&gt;% </span></span>
<span id="cb906-34"><a href="causation.html#cb906-34" tabindex="-1"></a><span class="co">#   export_svg %&gt;% </span></span>
<span id="cb906-35"><a href="causation.html#cb906-35" tabindex="-1"></a><span class="co">#   charToRaw %&gt;% </span></span>
<span id="cb906-36"><a href="causation.html#cb906-36" tabindex="-1"></a><span class="co">#   rsvg_pdf(&quot;figures/causal_chain.pdf&quot;)</span></span>
<span id="cb906-37"><a href="causation.html#cb906-37" tabindex="-1"></a></span>
<span id="cb906-38"><a href="causation.html#cb906-38" tabindex="-1"></a><span class="co"># show plot</span></span>
<span id="cb906-39"><a href="causation.html#cb906-39" tabindex="-1"></a>g</span></code></pre></div>
<div class="grViz html-widget html-fill-item" id="htmlwidget-23be689d1e53102ba2b3" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-23be689d1e53102ba2b3">{"x":{"diagram":"\ndigraph neato {\n  \n  graph[layout = neato]\n  \n  # general settings for all nodes\n  node [\n    shape = circle,\n    style = filled,\n    color = black,\n    label = \"\"\n    fontname = \"Helvetica\",\n    fontsize = 16,\n    fillcolor = lightblue\n    ]\n  \n  # labels for each node\n  x [label = \"X\" pos = \"0,0!\"]\n  y [label = \"Y\"  pos = \"2,0!\"]\n  z [label = \"Z\" pos = \"1, 0!\", fontcolor = \"red\"]\n  \n  # edges between nodes\n  edge [color = black]\n  x -> z\n  z -> y\n  \n  # direction in which arrows are drawn (from left to right)\n  rankdir = LR\n}\n","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="regression-4" class="section level5 hasAnchor" number="16.5.3.2.2">
<h5><span class="header-section-number">16.5.3.2.2</span> Regression<a href="causation.html#regression-4" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb907"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb907-1"><a href="causation.html#cb907-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb907-2"><a href="causation.html#cb907-2" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">20</span></span>
<span id="cb907-3"><a href="causation.html#cb907-3" tabindex="-1"></a>b_xz <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb907-4"><a href="causation.html#cb907-4" tabindex="-1"></a>b_zy <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb907-5"><a href="causation.html#cb907-5" tabindex="-1"></a>sd <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb907-6"><a href="causation.html#cb907-6" tabindex="-1"></a></span>
<span id="cb907-7"><a href="causation.html#cb907-7" tabindex="-1"></a>df <span class="ot">=</span> <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">sd =</span> sd),</span>
<span id="cb907-8"><a href="causation.html#cb907-8" tabindex="-1"></a>            <span class="at">z =</span> x <span class="sc">*</span> b_xz <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">sd =</span> sd),</span>
<span id="cb907-9"><a href="causation.html#cb907-9" tabindex="-1"></a>            <span class="at">y =</span> z <span class="sc">*</span> b_zy <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">sd =</span> sd))</span>
<span id="cb907-10"><a href="causation.html#cb907-10" tabindex="-1"></a></span>
<span id="cb907-11"><a href="causation.html#cb907-11" tabindex="-1"></a><span class="co"># without control</span></span>
<span id="cb907-12"><a href="causation.html#cb907-12" tabindex="-1"></a><span class="fu">lm</span>(<span class="at">formula =</span> y <span class="sc">~</span> x,</span>
<span id="cb907-13"><a href="causation.html#cb907-13" tabindex="-1"></a>   <span class="at">data =</span> df) <span class="sc">%&gt;%</span> </span>
<span id="cb907-14"><a href="causation.html#cb907-14" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code></pre></div>
<pre><code>
Call:
lm(formula = y ~ x, data = df)

Residuals:
   Min     1Q Median     3Q    Max 
-3.336 -1.208  0.209  1.220  3.189 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   0.1547     0.3982   0.388    0.702    
x             3.8488     0.4374   8.799 6.15e-08 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 1.741 on 18 degrees of freedom
Multiple R-squared:  0.8114,    Adjusted R-squared:  0.8009 
F-statistic: 77.43 on 1 and 18 DF,  p-value: 6.154e-08</code></pre>
<div class="sourceCode" id="cb909"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb909-1"><a href="causation.html#cb909-1" tabindex="-1"></a><span class="co"># with control</span></span>
<span id="cb909-2"><a href="causation.html#cb909-2" tabindex="-1"></a><span class="fu">lm</span>(<span class="at">formula =</span> y <span class="sc">~</span> x <span class="sc">+</span> z,</span>
<span id="cb909-3"><a href="causation.html#cb909-3" tabindex="-1"></a>   <span class="at">data =</span> df) <span class="sc">%&gt;%</span> </span>
<span id="cb909-4"><a href="causation.html#cb909-4" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code></pre></div>
<pre><code>
Call:
lm(formula = y ~ x + z, data = df)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.35959 -0.56643 -0.06193  0.48088  1.80592 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  0.09559    0.18177   0.526    0.606    
x            0.64724    0.43278   1.496    0.153    
z            1.78614    0.21425   8.337 2.07e-07 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 0.7943 on 17 degrees of freedom
Multiple R-squared:  0.9629,    Adjusted R-squared:  0.9586 
F-statistic: 220.8 on 2 and 17 DF,  p-value: 6.868e-13</code></pre>
</div>
</div>
<div id="causal-chain-2" class="section level4 hasAnchor" number="16.5.3.3">
<h4><span class="header-section-number">16.5.3.3</span> Causal chain 2<a href="causation.html#causal-chain-2" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div id="dag-4" class="section level5 hasAnchor" number="16.5.3.3.1">
<h5><span class="header-section-number">16.5.3.3.1</span> DAG<a href="causation.html#dag-4" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb911"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb911-1"><a href="causation.html#cb911-1" tabindex="-1"></a>g <span class="ot">=</span> <span class="fu">grViz</span>(<span class="st">&quot;</span></span>
<span id="cb911-2"><a href="causation.html#cb911-2" tabindex="-1"></a><span class="st">digraph neato {</span></span>
<span id="cb911-3"><a href="causation.html#cb911-3" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb911-4"><a href="causation.html#cb911-4" tabindex="-1"></a><span class="st">  graph[layout = neato]</span></span>
<span id="cb911-5"><a href="causation.html#cb911-5" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb911-6"><a href="causation.html#cb911-6" tabindex="-1"></a><span class="st">  # general settings for all nodes</span></span>
<span id="cb911-7"><a href="causation.html#cb911-7" tabindex="-1"></a><span class="st">  node [</span></span>
<span id="cb911-8"><a href="causation.html#cb911-8" tabindex="-1"></a><span class="st">    shape = circle,</span></span>
<span id="cb911-9"><a href="causation.html#cb911-9" tabindex="-1"></a><span class="st">    style = filled,</span></span>
<span id="cb911-10"><a href="causation.html#cb911-10" tabindex="-1"></a><span class="st">    color = black,</span></span>
<span id="cb911-11"><a href="causation.html#cb911-11" tabindex="-1"></a><span class="st">    label = &#39;&#39;</span></span>
<span id="cb911-12"><a href="causation.html#cb911-12" tabindex="-1"></a><span class="st">    fontname = &#39;Helvetica&#39;,</span></span>
<span id="cb911-13"><a href="causation.html#cb911-13" tabindex="-1"></a><span class="st">    fontsize = 16,</span></span>
<span id="cb911-14"><a href="causation.html#cb911-14" tabindex="-1"></a><span class="st">    fillcolor = lightblue</span></span>
<span id="cb911-15"><a href="causation.html#cb911-15" tabindex="-1"></a><span class="st">    ]</span></span>
<span id="cb911-16"><a href="causation.html#cb911-16" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb911-17"><a href="causation.html#cb911-17" tabindex="-1"></a><span class="st">  # labels for each node</span></span>
<span id="cb911-18"><a href="causation.html#cb911-18" tabindex="-1"></a><span class="st">  x [label = &#39;X&#39; pos = &#39;0,0!&#39;]</span></span>
<span id="cb911-19"><a href="causation.html#cb911-19" tabindex="-1"></a><span class="st">  y [label = &#39;Y&#39;  pos = &#39;1,0!&#39;]</span></span>
<span id="cb911-20"><a href="causation.html#cb911-20" tabindex="-1"></a><span class="st">  z [label = &#39;Z&#39; pos = &#39;2, 0!&#39;, fontcolor = &#39;red&#39;]</span></span>
<span id="cb911-21"><a href="causation.html#cb911-21" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb911-22"><a href="causation.html#cb911-22" tabindex="-1"></a><span class="st">  # edges between nodes</span></span>
<span id="cb911-23"><a href="causation.html#cb911-23" tabindex="-1"></a><span class="st">  edge [color = black]</span></span>
<span id="cb911-24"><a href="causation.html#cb911-24" tabindex="-1"></a><span class="st">  x -&gt; y</span></span>
<span id="cb911-25"><a href="causation.html#cb911-25" tabindex="-1"></a><span class="st">  y -&gt; z</span></span>
<span id="cb911-26"><a href="causation.html#cb911-26" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb911-27"><a href="causation.html#cb911-27" tabindex="-1"></a><span class="st">  # direction in which arrows are drawn (from left to right)</span></span>
<span id="cb911-28"><a href="causation.html#cb911-28" tabindex="-1"></a><span class="st">  rankdir = LR</span></span>
<span id="cb911-29"><a href="causation.html#cb911-29" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb911-30"><a href="causation.html#cb911-30" tabindex="-1"></a><span class="st">&quot;</span>)</span>
<span id="cb911-31"><a href="causation.html#cb911-31" tabindex="-1"></a></span>
<span id="cb911-32"><a href="causation.html#cb911-32" tabindex="-1"></a><span class="co"># # export as pdf </span></span>
<span id="cb911-33"><a href="causation.html#cb911-33" tabindex="-1"></a><span class="co"># g %&gt;% </span></span>
<span id="cb911-34"><a href="causation.html#cb911-34" tabindex="-1"></a><span class="co">#   export_svg %&gt;% </span></span>
<span id="cb911-35"><a href="causation.html#cb911-35" tabindex="-1"></a><span class="co">#   charToRaw %&gt;% </span></span>
<span id="cb911-36"><a href="causation.html#cb911-36" tabindex="-1"></a><span class="co">#   rsvg_pdf(&quot;figures/causal_chain2.pdf&quot;)</span></span>
<span id="cb911-37"><a href="causation.html#cb911-37" tabindex="-1"></a></span>
<span id="cb911-38"><a href="causation.html#cb911-38" tabindex="-1"></a><span class="co"># show plot</span></span>
<span id="cb911-39"><a href="causation.html#cb911-39" tabindex="-1"></a>g</span></code></pre></div>
<div class="grViz html-widget html-fill-item" id="htmlwidget-d7d8fff68578584a6377" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-d7d8fff68578584a6377">{"x":{"diagram":"\ndigraph neato {\n  \n  graph[layout = neato]\n  \n  # general settings for all nodes\n  node [\n    shape = circle,\n    style = filled,\n    color = black,\n    label = \"\"\n    fontname = \"Helvetica\",\n    fontsize = 16,\n    fillcolor = lightblue\n    ]\n  \n  # labels for each node\n  x [label = \"X\" pos = \"0,0!\"]\n  y [label = \"Y\"  pos = \"1,0!\"]\n  z [label = \"Z\" pos = \"2, 0!\", fontcolor = \"red\"]\n  \n  # edges between nodes\n  edge [color = black]\n  x -> y\n  y -> z\n  \n  # direction in which arrows are drawn (from left to right)\n  rankdir = LR\n}\n","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="regression-5" class="section level5 hasAnchor" number="16.5.3.3.2">
<h5><span class="header-section-number">16.5.3.3.2</span> Regression<a href="causation.html#regression-5" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb912"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb912-1"><a href="causation.html#cb912-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb912-2"><a href="causation.html#cb912-2" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">20</span></span>
<span id="cb912-3"><a href="causation.html#cb912-3" tabindex="-1"></a>b_xy <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb912-4"><a href="causation.html#cb912-4" tabindex="-1"></a>b_yz <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb912-5"><a href="causation.html#cb912-5" tabindex="-1"></a>sd <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb912-6"><a href="causation.html#cb912-6" tabindex="-1"></a></span>
<span id="cb912-7"><a href="causation.html#cb912-7" tabindex="-1"></a>df <span class="ot">=</span> <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">sd =</span> sd),</span>
<span id="cb912-8"><a href="causation.html#cb912-8" tabindex="-1"></a>            <span class="at">y =</span> x <span class="sc">*</span> b_xy <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">sd =</span> sd),</span>
<span id="cb912-9"><a href="causation.html#cb912-9" tabindex="-1"></a>            <span class="at">z =</span> y <span class="sc">*</span> b_yz <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">sd =</span> sd),)</span>
<span id="cb912-10"><a href="causation.html#cb912-10" tabindex="-1"></a></span>
<span id="cb912-11"><a href="causation.html#cb912-11" tabindex="-1"></a><span class="co"># without control</span></span>
<span id="cb912-12"><a href="causation.html#cb912-12" tabindex="-1"></a><span class="fu">lm</span>(<span class="at">formula =</span> y <span class="sc">~</span> x,</span>
<span id="cb912-13"><a href="causation.html#cb912-13" tabindex="-1"></a>   <span class="at">data =</span> df) <span class="sc">%&gt;%</span> </span>
<span id="cb912-14"><a href="causation.html#cb912-14" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code></pre></div>
<pre><code>
Call:
lm(formula = y ~ x, data = df)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.69133 -0.43739 -0.07132  0.68033  1.63937 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  0.03307    0.19981   0.166     0.87    
x            1.79245    0.21951   8.166 1.83e-07 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 0.8738 on 18 degrees of freedom
Multiple R-squared:  0.7874,    Adjusted R-squared:  0.7756 
F-statistic: 66.68 on 1 and 18 DF,  p-value: 1.827e-07</code></pre>
<div class="sourceCode" id="cb914"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb914-1"><a href="causation.html#cb914-1" tabindex="-1"></a><span class="co"># with control</span></span>
<span id="cb914-2"><a href="causation.html#cb914-2" tabindex="-1"></a><span class="fu">lm</span>(<span class="at">formula =</span> y <span class="sc">~</span> x <span class="sc">+</span> z,</span>
<span id="cb914-3"><a href="causation.html#cb914-3" tabindex="-1"></a>   <span class="at">data =</span> df) <span class="sc">%&gt;%</span> </span>
<span id="cb914-4"><a href="causation.html#cb914-4" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code></pre></div>
<pre><code>
Call:
lm(formula = y ~ x + z, data = df)

Residuals:
    Min      1Q  Median      3Q     Max 
-0.9023 -0.2316  0.1173  0.2396  0.6319 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -0.03650    0.09153  -0.399    0.695    
x            0.06113    0.23056   0.265    0.794    
z            0.44983    0.05396   8.337 2.07e-07 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 0.3986 on 17 degrees of freedom
Multiple R-squared:  0.9582,    Adjusted R-squared:  0.9533 
F-statistic:   195 on 2 and 17 DF,  p-value: 1.896e-12</code></pre>
</div>
</div>
<div id="bias-amplification" class="section level4 hasAnchor" number="16.5.3.4">
<h4><span class="header-section-number">16.5.3.4</span> Bias amplification<a href="causation.html#bias-amplification" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div id="dag-5" class="section level5 hasAnchor" number="16.5.3.4.1">
<h5><span class="header-section-number">16.5.3.4.1</span> DAG<a href="causation.html#dag-5" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb916"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb916-1"><a href="causation.html#cb916-1" tabindex="-1"></a>g <span class="ot">=</span> <span class="fu">grViz</span>(<span class="st">&quot;</span></span>
<span id="cb916-2"><a href="causation.html#cb916-2" tabindex="-1"></a><span class="st">digraph neato {</span></span>
<span id="cb916-3"><a href="causation.html#cb916-3" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb916-4"><a href="causation.html#cb916-4" tabindex="-1"></a><span class="st">  graph[layout = neato]</span></span>
<span id="cb916-5"><a href="causation.html#cb916-5" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb916-6"><a href="causation.html#cb916-6" tabindex="-1"></a><span class="st">  # general settings for all nodes</span></span>
<span id="cb916-7"><a href="causation.html#cb916-7" tabindex="-1"></a><span class="st">  node [</span></span>
<span id="cb916-8"><a href="causation.html#cb916-8" tabindex="-1"></a><span class="st">    shape = circle,</span></span>
<span id="cb916-9"><a href="causation.html#cb916-9" tabindex="-1"></a><span class="st">    style = filled,</span></span>
<span id="cb916-10"><a href="causation.html#cb916-10" tabindex="-1"></a><span class="st">    color = black,</span></span>
<span id="cb916-11"><a href="causation.html#cb916-11" tabindex="-1"></a><span class="st">    label = &#39;&#39;</span></span>
<span id="cb916-12"><a href="causation.html#cb916-12" tabindex="-1"></a><span class="st">    fontname = &#39;Helvetica&#39;,</span></span>
<span id="cb916-13"><a href="causation.html#cb916-13" tabindex="-1"></a><span class="st">    fontsize = 16,</span></span>
<span id="cb916-14"><a href="causation.html#cb916-14" tabindex="-1"></a><span class="st">    fillcolor = lightblue</span></span>
<span id="cb916-15"><a href="causation.html#cb916-15" tabindex="-1"></a><span class="st">    ]</span></span>
<span id="cb916-16"><a href="causation.html#cb916-16" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb916-17"><a href="causation.html#cb916-17" tabindex="-1"></a><span class="st">  # labels for each node</span></span>
<span id="cb916-18"><a href="causation.html#cb916-18" tabindex="-1"></a><span class="st">  x [label = &#39;X&#39; pos = &#39;0,0!&#39;]</span></span>
<span id="cb916-19"><a href="causation.html#cb916-19" tabindex="-1"></a><span class="st">  y [label = &#39;Y&#39;  pos = &#39;2,0!&#39;]</span></span>
<span id="cb916-20"><a href="causation.html#cb916-20" tabindex="-1"></a><span class="st">  z [label = &#39;Z&#39; pos = &#39;-1, 1!&#39;, fontcolor = &#39;red&#39;]</span></span>
<span id="cb916-21"><a href="causation.html#cb916-21" tabindex="-1"></a><span class="st">  u [label = &#39;U&#39; pos = &#39;1, 1!&#39;, fillcolor = &#39;white&#39;]</span></span>
<span id="cb916-22"><a href="causation.html#cb916-22" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb916-23"><a href="causation.html#cb916-23" tabindex="-1"></a><span class="st">  # edges between nodes</span></span>
<span id="cb916-24"><a href="causation.html#cb916-24" tabindex="-1"></a><span class="st">  edge [color = black]</span></span>
<span id="cb916-25"><a href="causation.html#cb916-25" tabindex="-1"></a><span class="st">  x -&gt; y</span></span>
<span id="cb916-26"><a href="causation.html#cb916-26" tabindex="-1"></a><span class="st">  z -&gt; x</span></span>
<span id="cb916-27"><a href="causation.html#cb916-27" tabindex="-1"></a><span class="st">  u -&gt; {x y}</span></span>
<span id="cb916-28"><a href="causation.html#cb916-28" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb916-29"><a href="causation.html#cb916-29" tabindex="-1"></a><span class="st">  # direction in which arrows are drawn (from left to right)</span></span>
<span id="cb916-30"><a href="causation.html#cb916-30" tabindex="-1"></a><span class="st">  rankdir = LR</span></span>
<span id="cb916-31"><a href="causation.html#cb916-31" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb916-32"><a href="causation.html#cb916-32" tabindex="-1"></a><span class="st">&quot;</span>)</span>
<span id="cb916-33"><a href="causation.html#cb916-33" tabindex="-1"></a></span>
<span id="cb916-34"><a href="causation.html#cb916-34" tabindex="-1"></a><span class="co"># # export as pdf </span></span>
<span id="cb916-35"><a href="causation.html#cb916-35" tabindex="-1"></a><span class="co"># g %&gt;% </span></span>
<span id="cb916-36"><a href="causation.html#cb916-36" tabindex="-1"></a><span class="co">#   export_svg %&gt;% </span></span>
<span id="cb916-37"><a href="causation.html#cb916-37" tabindex="-1"></a><span class="co">#   charToRaw %&gt;% </span></span>
<span id="cb916-38"><a href="causation.html#cb916-38" tabindex="-1"></a><span class="co">#   rsvg_pdf(&quot;figures/bias_amplification.pdf&quot;)</span></span>
<span id="cb916-39"><a href="causation.html#cb916-39" tabindex="-1"></a></span>
<span id="cb916-40"><a href="causation.html#cb916-40" tabindex="-1"></a><span class="co"># show plot</span></span>
<span id="cb916-41"><a href="causation.html#cb916-41" tabindex="-1"></a>g</span></code></pre></div>
<div class="grViz html-widget html-fill-item" id="htmlwidget-e769bb6d04f924296368" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-e769bb6d04f924296368">{"x":{"diagram":"\ndigraph neato {\n  \n  graph[layout = neato]\n  \n  # general settings for all nodes\n  node [\n    shape = circle,\n    style = filled,\n    color = black,\n    label = \"\"\n    fontname = \"Helvetica\",\n    fontsize = 16,\n    fillcolor = lightblue\n    ]\n  \n  # labels for each node\n  x [label = \"X\" pos = \"0,0!\"]\n  y [label = \"Y\"  pos = \"2,0!\"]\n  z [label = \"Z\" pos = \"-1, 1!\", fontcolor = \"red\"]\n  u [label = \"U\" pos = \"1, 1!\", fillcolor = \"white\"]\n  \n  # edges between nodes\n  edge [color = black]\n  x -> y\n  z -> x\n  u -> {x y}\n  \n  # direction in which arrows are drawn (from left to right)\n  rankdir = LR\n}\n","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div id="regression-6" class="section level4 hasAnchor" number="16.5.3.5">
<h4><span class="header-section-number">16.5.3.5</span> Regression<a href="causation.html#regression-6" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb917"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb917-1"><a href="causation.html#cb917-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb917-2"><a href="causation.html#cb917-2" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">20</span></span>
<span id="cb917-3"><a href="causation.html#cb917-3" tabindex="-1"></a>b_xy <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb917-4"><a href="causation.html#cb917-4" tabindex="-1"></a>b_ux <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb917-5"><a href="causation.html#cb917-5" tabindex="-1"></a>b_uy <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb917-6"><a href="causation.html#cb917-6" tabindex="-1"></a>b_zx <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb917-7"><a href="causation.html#cb917-7" tabindex="-1"></a>sd <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb917-8"><a href="causation.html#cb917-8" tabindex="-1"></a></span>
<span id="cb917-9"><a href="causation.html#cb917-9" tabindex="-1"></a>df <span class="ot">=</span> <span class="fu">tibble</span>(<span class="at">u =</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">sd =</span> sd),</span>
<span id="cb917-10"><a href="causation.html#cb917-10" tabindex="-1"></a>            <span class="at">z =</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">sd =</span> sd),</span>
<span id="cb917-11"><a href="causation.html#cb917-11" tabindex="-1"></a>            <span class="at">x =</span> u <span class="sc">*</span> b_ux <span class="sc">+</span> z <span class="sc">*</span> b_zx <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">sd =</span> sd),</span>
<span id="cb917-12"><a href="causation.html#cb917-12" tabindex="-1"></a>            <span class="at">y =</span> u <span class="sc">*</span> b_uy <span class="sc">+</span> x <span class="sc">*</span> b_xy <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">sd =</span> sd))</span>
<span id="cb917-13"><a href="causation.html#cb917-13" tabindex="-1"></a></span>
<span id="cb917-14"><a href="causation.html#cb917-14" tabindex="-1"></a><span class="co"># without control</span></span>
<span id="cb917-15"><a href="causation.html#cb917-15" tabindex="-1"></a><span class="fu">lm</span>(<span class="at">formula =</span> y <span class="sc">~</span> x,</span>
<span id="cb917-16"><a href="causation.html#cb917-16" tabindex="-1"></a>   <span class="at">data =</span> df) <span class="sc">%&gt;%</span> </span>
<span id="cb917-17"><a href="causation.html#cb917-17" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code></pre></div>
<pre><code>
Call:
lm(formula = y ~ x, data = df)

Residuals:
    Min      1Q  Median      3Q     Max 
-2.2838 -0.8662 -0.2281  0.7201  3.1619 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   0.1903     0.3282    0.58    0.569    
x             2.5771     0.1375   18.74 2.96e-13 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 1.434 on 18 degrees of freedom
Multiple R-squared:  0.9512,    Adjusted R-squared:  0.9485 
F-statistic: 351.1 on 1 and 18 DF,  p-value: 2.961e-13</code></pre>
<div class="sourceCode" id="cb919"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb919-1"><a href="causation.html#cb919-1" tabindex="-1"></a><span class="co"># with control</span></span>
<span id="cb919-2"><a href="causation.html#cb919-2" tabindex="-1"></a><span class="fu">lm</span>(<span class="at">formula =</span> y <span class="sc">~</span> x <span class="sc">+</span> z,</span>
<span id="cb919-3"><a href="causation.html#cb919-3" tabindex="-1"></a>   <span class="at">data =</span> df) <span class="sc">%&gt;%</span> </span>
<span id="cb919-4"><a href="causation.html#cb919-4" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code></pre></div>
<pre><code>
Call:
lm(formula = y ~ x + z, data = df)

Residuals:
    Min      1Q  Median      3Q     Max 
-1.9114 -0.4876 -0.1044  0.6333  1.8935 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  0.07431    0.24564   0.303  0.76594    
x            2.78984    0.11553  24.147 1.35e-14 ***
z           -1.25270    0.31719  -3.949  0.00103 ** 
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 1.066 on 17 degrees of freedom
Multiple R-squared:  0.9746,    Adjusted R-squared:  0.9716 
F-statistic: 325.7 on 2 and 17 DF,  p-value: 2.793e-14</code></pre>
</div>
</div>
</div>
<div id="mediation" class="section level2 hasAnchor" number="16.6">
<h2><span class="header-section-number">16.6</span> Mediation<a href="causation.html#mediation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="figure"><span style="display:block;" id="fig:mediation"></span>
<img src="figures/mediation.png" alt="__Basic mediation model__. c = the total effect of X on Y; c = c’ + ab; c’ = the direct effect of X on Y after controlling for M; c’ = c - ab; ab = indirect effect of X on Y." width="75%" />
<p class="caption">
Figure 16.1: <strong>Basic mediation model</strong>. c = the total effect of X on Y; c = c’ + ab; c’ = the direct effect of X on Y after controlling for M; c’ = c - ab; ab = indirect effect of X on Y.
</p>
</div>
<p>Mediation tests whether the effects of <strong>X</strong> (the independent variable) on <strong>Y</strong> (the dependent variable) operate through a third variable, <strong>M</strong> (the mediator). In this way, mediators explain the causal relationship between two variables or “how” the relationship works, making it a very popular method in psychological research.</p>
<p>Figure <a href="causation.html#fig:mediation">16.1</a> shows the standard mediation model. Perfect mediation occurs when the effect of <strong>X</strong> on <strong>Y</strong> decreases to 0 with <strong>M</strong> in the model. Partial mediation occurs when the effect of <strong>X</strong> on <strong>Y</strong> decreases by a nontrivial amount (the actual amount is up for debate) with <strong>M</strong> in the model.</p>
<p><strong>Important</strong>: Both mediation and moderation assume that the DV <strong>did not CAUSE the mediator/moderator</strong>.</p>
<div id="generate-data" class="section level3 hasAnchor" number="16.6.1">
<h3><span class="header-section-number">16.6.1</span> Generate data<a href="causation.html#generate-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb921"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb921-1"><a href="causation.html#cb921-1" tabindex="-1"></a><span class="co"># make example reproducible</span></span>
<span id="cb921-2"><a href="causation.html#cb921-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb921-3"><a href="causation.html#cb921-3" tabindex="-1"></a></span>
<span id="cb921-4"><a href="causation.html#cb921-4" tabindex="-1"></a><span class="co"># number of participants</span></span>
<span id="cb921-5"><a href="causation.html#cb921-5" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">100</span> </span>
<span id="cb921-6"><a href="causation.html#cb921-6" tabindex="-1"></a></span>
<span id="cb921-7"><a href="causation.html#cb921-7" tabindex="-1"></a><span class="co"># generate data</span></span>
<span id="cb921-8"><a href="causation.html#cb921-8" tabindex="-1"></a>df.mediation <span class="ot">=</span> <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">rnorm</span>(n, <span class="dv">75</span>, <span class="dv">7</span>), <span class="co"># grades</span></span>
<span id="cb921-9"><a href="causation.html#cb921-9" tabindex="-1"></a>  <span class="at">m =</span> <span class="fl">0.7</span> <span class="sc">*</span> x <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">5</span>), <span class="co"># self-esteem</span></span>
<span id="cb921-10"><a href="causation.html#cb921-10" tabindex="-1"></a>  <span class="at">y =</span> <span class="fl">0.4</span> <span class="sc">*</span> m <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">5</span>)) <span class="co"># happiness</span></span></code></pre></div>
</div>
<div id="method-1-baron-kennys-1986-indirect-effect-method" class="section level3 hasAnchor" number="16.6.2">
<h3><span class="header-section-number">16.6.2</span> Method 1: Baron &amp; Kenny’s (1986) indirect effect method<a href="causation.html#method-1-baron-kennys-1986-indirect-effect-method" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <span class="citation">Baron and Kenny (<a href="#ref-baron1986moderator">1986</a>)</span> method is among the original methods for testing for mediation but tends to have low statistical power. It is covered in this chapter because it provides a very clear approach to establishing relationships between variables and is still occassionally requested by reviewers.</p>
<p><strong>The three steps</strong>:</p>
<ol style="list-style-type: decimal">
<li><p>Estimate the relationship between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> (hours since dawn on degree of wakefulness). Path “c” must be significantly different from 0; must have a total effect between the IV &amp; DV.</p></li>
<li><p>Estimate the relationship between <span class="math inline">\(X\)</span> and <span class="math inline">\(M\)</span> (hours since dawn on coffee consumption). Path “a” must be significantly different from 0; IV and mediator must be related.</p></li>
<li><p>Estimate the relationship between <span class="math inline">\(M\)</span> and <span class="math inline">\(Y\)</span> controlling for <span class="math inline">\(X\)</span> (coffee consumption on wakefulness, controlling for hours since dawn). Path “b” must be significantly different from 0; mediator and DV must be related. The effect of <span class="math inline">\(X\)</span> on <span class="math inline">\(Y\)</span> decreases with the inclusion of <span class="math inline">\(M\)</span> in the model.</p></li>
</ol>
<div id="total-effect" class="section level4 hasAnchor" number="16.6.2.1">
<h4><span class="header-section-number">16.6.2.1</span> Total effect<a href="causation.html#total-effect" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Total effect of X on Y (not controlling for M).</p>
<div class="sourceCode" id="cb922"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb922-1"><a href="causation.html#cb922-1" tabindex="-1"></a><span class="co"># fit the model</span></span>
<span id="cb922-2"><a href="causation.html#cb922-2" tabindex="-1"></a>fit.y_x <span class="ot">=</span> <span class="fu">lm</span>(<span class="at">formula =</span> y <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> x,</span>
<span id="cb922-3"><a href="causation.html#cb922-3" tabindex="-1"></a>            <span class="at">data =</span> df.mediation)</span>
<span id="cb922-4"><a href="causation.html#cb922-4" tabindex="-1"></a></span>
<span id="cb922-5"><a href="causation.html#cb922-5" tabindex="-1"></a><span class="co"># summarize the results</span></span>
<span id="cb922-6"><a href="causation.html#cb922-6" tabindex="-1"></a>fit.y_x <span class="sc">%&gt;%</span> <span class="fu">summary</span>()</span></code></pre></div>
<pre><code>
Call:
lm(formula = y ~ 1 + x, data = df.mediation)

Residuals:
    Min      1Q  Median      3Q     Max 
-10.917  -3.738  -0.259   2.910  12.540 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)  
(Intercept)  8.78300    6.16002   1.426   0.1571  
x            0.16899    0.08116   2.082   0.0399 *
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 5.16 on 98 degrees of freedom
Multiple R-squared:  0.04237,   Adjusted R-squared:  0.0326 
F-statistic: 4.336 on 1 and 98 DF,  p-value: 0.03993</code></pre>
</div>
<div id="path-a" class="section level4 hasAnchor" number="16.6.2.2">
<h4><span class="header-section-number">16.6.2.2</span> Path a<a href="causation.html#path-a" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb924"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb924-1"><a href="causation.html#cb924-1" tabindex="-1"></a>fit.m_x <span class="ot">=</span> <span class="fu">lm</span>(<span class="at">formula =</span> m <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> x,</span>
<span id="cb924-2"><a href="causation.html#cb924-2" tabindex="-1"></a>            <span class="at">data =</span> df.mediation)</span>
<span id="cb924-3"><a href="causation.html#cb924-3" tabindex="-1"></a></span>
<span id="cb924-4"><a href="causation.html#cb924-4" tabindex="-1"></a>fit.m_x <span class="sc">%&gt;%</span> <span class="fu">summary</span>()</span></code></pre></div>
<pre><code>
Call:
lm(formula = m ~ 1 + x, data = df.mediation)

Residuals:
    Min      1Q  Median      3Q     Max 
-9.5367 -3.4175 -0.4375  2.9032 16.4520 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  2.29696    5.79432   0.396    0.693    
x            0.66252    0.07634   8.678 8.87e-14 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 4.854 on 98 degrees of freedom
Multiple R-squared:  0.4346,    Adjusted R-squared:  0.4288 
F-statistic: 75.31 on 1 and 98 DF,  p-value: 8.872e-14</code></pre>
</div>
<div id="path-b-and-c" class="section level4 hasAnchor" number="16.6.2.3">
<h4><span class="header-section-number">16.6.2.3</span> Path b and c’<a href="causation.html#path-b-and-c" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Effect of M on Y controlling for X.</p>
<div class="sourceCode" id="cb926"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb926-1"><a href="causation.html#cb926-1" tabindex="-1"></a>fit.y_mx <span class="ot">=</span> <span class="fu">lm</span>(<span class="at">formula =</span> y <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> m <span class="sc">+</span> x,</span>
<span id="cb926-2"><a href="causation.html#cb926-2" tabindex="-1"></a>            <span class="at">data =</span> df.mediation)</span>
<span id="cb926-3"><a href="causation.html#cb926-3" tabindex="-1"></a></span>
<span id="cb926-4"><a href="causation.html#cb926-4" tabindex="-1"></a>fit.y_mx <span class="sc">%&gt;%</span> <span class="fu">summary</span>()</span></code></pre></div>
<pre><code>
Call:
lm(formula = y ~ 1 + m + x, data = df.mediation)

Residuals:
    Min      1Q  Median      3Q     Max 
-9.3651 -3.3037 -0.6222  3.1068 10.3991 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  7.80952    5.68297   1.374    0.173    
m            0.42381    0.09899   4.281 4.37e-05 ***
x           -0.11179    0.09949  -1.124    0.264    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 4.756 on 97 degrees of freedom
Multiple R-squared:  0.1946,    Adjusted R-squared:  0.1779 
F-statistic: 11.72 on 2 and 97 DF,  p-value: 2.771e-05</code></pre>
</div>
<div id="interpretation" class="section level4 hasAnchor" number="16.6.2.4">
<h4><span class="header-section-number">16.6.2.4</span> Interpretation<a href="causation.html#interpretation" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb928"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb928-1"><a href="causation.html#cb928-1" tabindex="-1"></a>fit.y_x <span class="sc">%&gt;%</span> </span>
<span id="cb928-2"><a href="causation.html#cb928-2" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb928-3"><a href="causation.html#cb928-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">path =</span> <span class="st">&quot;c&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb928-4"><a href="causation.html#cb928-4" tabindex="-1"></a>  <span class="fu">bind_rows</span>(fit.m_x <span class="sc">%&gt;%</span> </span>
<span id="cb928-5"><a href="causation.html#cb928-5" tabindex="-1"></a>              <span class="fu">tidy</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb928-6"><a href="causation.html#cb928-6" tabindex="-1"></a>              <span class="fu">mutate</span>(<span class="at">path =</span> <span class="st">&quot;a&quot;</span>),</span>
<span id="cb928-7"><a href="causation.html#cb928-7" tabindex="-1"></a>            fit.y_mx <span class="sc">%&gt;%</span> </span>
<span id="cb928-8"><a href="causation.html#cb928-8" tabindex="-1"></a>              <span class="fu">tidy</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb928-9"><a href="causation.html#cb928-9" tabindex="-1"></a>              <span class="fu">mutate</span>(<span class="at">path =</span> <span class="fu">c</span>(<span class="st">&quot;(Intercept)&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&#39;&quot;</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb928-10"><a href="causation.html#cb928-10" tabindex="-1"></a>  <span class="fu">filter</span>(term <span class="sc">!=</span> <span class="st">&quot;(Intercept)&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb928-11"><a href="causation.html#cb928-11" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">significance =</span> p.value <span class="sc">&lt;</span> .<span class="dv">05</span>,</span>
<span id="cb928-12"><a href="causation.html#cb928-12" tabindex="-1"></a>         <span class="at">dv =</span> <span class="fu">ifelse</span>(path <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;c&#39;&quot;</span>, <span class="st">&quot;b&quot;</span>), <span class="st">&quot;y&quot;</span>, <span class="st">&quot;m&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb928-13"><a href="causation.html#cb928-13" tabindex="-1"></a>  <span class="fu">select</span>(path, <span class="at">iv =</span> term, dv, estimate, p.value, significance)</span></code></pre></div>
<pre><code># A tibble: 4 × 6
  path  iv    dv    estimate  p.value significance
  &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;    &lt;dbl&gt;    &lt;dbl&gt; &lt;lgl&gt;       
1 c     x     m        0.169 3.99e- 2 TRUE        
2 a     x     m        0.663 8.87e-14 TRUE        
3 b     m     y        0.424 4.37e- 5 TRUE        
4 c&#39;    x     y       -0.112 2.64e- 1 FALSE       </code></pre>
<p>Here we find that our total effect model shows a significant positive relationship between hours since dawn (X) and wakefulness (Y). Our Path A model shows that hours since down (X) is also positively related to coffee consumption (M). Our Path B model then shows that coffee consumption (M) positively predicts wakefulness (Y) when controlling for hours since dawn (X).</p>
<p>Since the relationship between hours since dawn and wakefulness is no longer significant when controlling for coffee consumption, this suggests that coffee consumption does in fact mediate this relationship. However, this method alone does not allow for a formal test of the indirect effect so we don’t know if the change in this relationship is truly meaningful.</p>
</div>
</div>
<div id="method-2-sobel-test" class="section level3 hasAnchor" number="16.6.3">
<h3><span class="header-section-number">16.6.3</span> Method 2: Sobel Test<a href="causation.html#method-2-sobel-test" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The Sobel Test tests whether the indirect effect from X via M to Y is significant.</p>
<div class="sourceCode" id="cb930"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb930-1"><a href="causation.html#cb930-1" tabindex="-1"></a><span class="co"># run the sobel test</span></span>
<span id="cb930-2"><a href="causation.html#cb930-2" tabindex="-1"></a>fit.sobel <span class="ot">=</span> <span class="fu">sobel</span>(<span class="at">pred =</span> df.mediation<span class="sc">$</span>x,</span>
<span id="cb930-3"><a href="causation.html#cb930-3" tabindex="-1"></a>                  <span class="at">med =</span> df.mediation<span class="sc">$</span>m,</span>
<span id="cb930-4"><a href="causation.html#cb930-4" tabindex="-1"></a>                  <span class="at">out =</span> df.mediation<span class="sc">$</span>y)</span>
<span id="cb930-5"><a href="causation.html#cb930-5" tabindex="-1"></a></span>
<span id="cb930-6"><a href="causation.html#cb930-6" tabindex="-1"></a><span class="co"># calculate the p-value </span></span>
<span id="cb930-7"><a href="causation.html#cb930-7" tabindex="-1"></a>(<span class="dv">1</span> <span class="sc">-</span> <span class="fu">pnorm</span>(fit.sobel<span class="sc">$</span>z.value))<span class="sc">*</span><span class="dv">2</span></span></code></pre></div>
<pre><code>[1] 0.0001233403</code></pre>
<p>The relationship between “hours since dawn” and “wakefulness” is significantly mediated by “coffee consumption”.</p>
<p>The Sobel Test is largely considered an outdated method since it assumes that the indirect effect (ab) is normally distributed and tends to only have adequate power with large sample sizes. Thus, again, it is highly recommended to use the mediation bootstrapping method instead.</p>
</div>
<div id="method-3-bootstrapping" class="section level3 hasAnchor" number="16.6.4">
<h3><span class="header-section-number">16.6.4</span> Method 3: Bootstrapping<a href="causation.html#method-3-bootstrapping" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The “mediation” packages uses the more recent bootstrapping method of <span class="citation">Preacher and Hayes (<a href="#ref-preacher2004spss">2004</a>)</span> to address the power limitations of the Sobel Test.</p>
<p>This method does not require that the data are normally distributed, and is particularly suitable for small sample sizes.</p>
<div class="sourceCode" id="cb932"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb932-1"><a href="causation.html#cb932-1" tabindex="-1"></a><span class="co"># bootstrapped mediation </span></span>
<span id="cb932-2"><a href="causation.html#cb932-2" tabindex="-1"></a>fit.mediation <span class="ot">=</span> <span class="fu">mediate</span>(<span class="at">model.m =</span> fit.m_x,</span>
<span id="cb932-3"><a href="causation.html#cb932-3" tabindex="-1"></a>                        <span class="at">model.y =</span> fit.y_mx,</span>
<span id="cb932-4"><a href="causation.html#cb932-4" tabindex="-1"></a>                        <span class="at">treat =</span> <span class="st">&quot;x&quot;</span>,</span>
<span id="cb932-5"><a href="causation.html#cb932-5" tabindex="-1"></a>                        <span class="at">mediator =</span> <span class="st">&quot;m&quot;</span>,</span>
<span id="cb932-6"><a href="causation.html#cb932-6" tabindex="-1"></a>                        <span class="at">boot =</span> T)</span></code></pre></div>
<pre><code>Running nonparametric bootstrap</code></pre>
<div class="sourceCode" id="cb934"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb934-1"><a href="causation.html#cb934-1" tabindex="-1"></a><span class="co"># summarize results</span></span>
<span id="cb934-2"><a href="causation.html#cb934-2" tabindex="-1"></a><span class="fu">summary</span>(fit.mediation)</span></code></pre></div>
<pre><code>
Causal Mediation Analysis 

Nonparametric Bootstrap Confidence Intervals with the Percentile Method

               Estimate 95% CI Lower 95% CI Upper p-value    
ACME            0.28078      0.14133         0.43  &lt;2e-16 ***
ADE            -0.11179     -0.30293         0.11   0.274    
Total Effect    0.16899     -0.00539         0.35   0.056 .  
Prop. Mediated  1.66151     -1.91644        10.16   0.056 .  
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Sample Size Used: 100 


Simulations: 1000 </code></pre>
<ul>
<li>ACME = Average causal mediation effect</li>
<li>ADE = Average direct effect</li>
<li>Total effect = ACME + ADE</li>
</ul>
<p>Plot the results:</p>
<div class="sourceCode" id="cb936"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb936-1"><a href="causation.html#cb936-1" tabindex="-1"></a><span class="fu">plot</span>(fit.mediation)</span></code></pre></div>
<p><img src="16-causation_files/figure-html/unnamed-chunk-26-1.png" width="672" /></p>
<div id="interpretation-1" class="section level4 hasAnchor" number="16.6.4.1">
<h4><span class="header-section-number">16.6.4.1</span> Interpretation<a href="causation.html#interpretation-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The <code>mediate()</code> function gives us our Average Causal Mediation Effects (ACME), our Average Direct Effects (ADE), our combined indirect and direct effects (Total Effect), and the ratio of these estimates (Prop. Mediated). The ACME here is the indirect effect of M (total effect - direct effect) and thus this value tells us if our mediation effect is significant.</p>
</div>
</div>
<div id="be-careful-about-mediation" class="section level3 hasAnchor" number="16.6.5">
<h3><span class="header-section-number">16.6.5</span> Be careful about mediation!<a href="causation.html#be-careful-about-mediation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Different causal structures can lead to the same “mediation” effects. So it’s difficult to tell from a pattern of regression results what the relationships between variables is.</p>
<p>Here are three different causal structures that lead to similar effects</p>
<div class="sourceCode" id="cb937"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb937-1"><a href="causation.html#cb937-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb937-2"><a href="causation.html#cb937-2" tabindex="-1"></a></span>
<span id="cb937-3"><a href="causation.html#cb937-3" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">100</span> <span class="co"># number of observations</span></span>
<span id="cb937-4"><a href="causation.html#cb937-4" tabindex="-1"></a></span>
<span id="cb937-5"><a href="causation.html#cb937-5" tabindex="-1"></a><span class="co"># causal chain</span></span>
<span id="cb937-6"><a href="causation.html#cb937-6" tabindex="-1"></a>df.causal_chain <span class="ot">=</span> <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">1</span>), </span>
<span id="cb937-7"><a href="causation.html#cb937-7" tabindex="-1"></a>                         <span class="at">z =</span> <span class="dv">2</span> <span class="sc">*</span> x <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb937-8"><a href="causation.html#cb937-8" tabindex="-1"></a>                         <span class="at">y =</span> <span class="dv">2</span> <span class="sc">*</span> z <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">1</span>)) </span>
<span id="cb937-9"><a href="causation.html#cb937-9" tabindex="-1"></a></span>
<span id="cb937-10"><a href="causation.html#cb937-10" tabindex="-1"></a><span class="co"># visualize the graph </span></span>
<span id="cb937-11"><a href="causation.html#cb937-11" tabindex="-1"></a>g <span class="ot">=</span> <span class="fu">grViz</span>(<span class="st">&quot;</span></span>
<span id="cb937-12"><a href="causation.html#cb937-12" tabindex="-1"></a><span class="st">digraph neato {</span></span>
<span id="cb937-13"><a href="causation.html#cb937-13" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb937-14"><a href="causation.html#cb937-14" tabindex="-1"></a><span class="st">  graph[layout = neato]</span></span>
<span id="cb937-15"><a href="causation.html#cb937-15" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb937-16"><a href="causation.html#cb937-16" tabindex="-1"></a><span class="st">  # general settings for all nodes</span></span>
<span id="cb937-17"><a href="causation.html#cb937-17" tabindex="-1"></a><span class="st">  node [</span></span>
<span id="cb937-18"><a href="causation.html#cb937-18" tabindex="-1"></a><span class="st">    shape = circle,</span></span>
<span id="cb937-19"><a href="causation.html#cb937-19" tabindex="-1"></a><span class="st">    style = filled,</span></span>
<span id="cb937-20"><a href="causation.html#cb937-20" tabindex="-1"></a><span class="st">    color = black,</span></span>
<span id="cb937-21"><a href="causation.html#cb937-21" tabindex="-1"></a><span class="st">    label = &#39;&#39;</span></span>
<span id="cb937-22"><a href="causation.html#cb937-22" tabindex="-1"></a><span class="st">    fontname = &#39;Helvetica&#39;,</span></span>
<span id="cb937-23"><a href="causation.html#cb937-23" tabindex="-1"></a><span class="st">    fontsize = 16,</span></span>
<span id="cb937-24"><a href="causation.html#cb937-24" tabindex="-1"></a><span class="st">    fillcolor = lightblue</span></span>
<span id="cb937-25"><a href="causation.html#cb937-25" tabindex="-1"></a><span class="st">    ]</span></span>
<span id="cb937-26"><a href="causation.html#cb937-26" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb937-27"><a href="causation.html#cb937-27" tabindex="-1"></a><span class="st">  # labels for each node</span></span>
<span id="cb937-28"><a href="causation.html#cb937-28" tabindex="-1"></a><span class="st">  x [label = &#39;X&#39; pos = &#39;0,0!&#39;]</span></span>
<span id="cb937-29"><a href="causation.html#cb937-29" tabindex="-1"></a><span class="st">  z [label = &#39;Z&#39;  pos = &#39;1,1!&#39;]</span></span>
<span id="cb937-30"><a href="causation.html#cb937-30" tabindex="-1"></a><span class="st">  y [label = &#39;Y&#39; pos = &#39;2,0!&#39;]</span></span>
<span id="cb937-31"><a href="causation.html#cb937-31" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb937-32"><a href="causation.html#cb937-32" tabindex="-1"></a><span class="st">  # edges between nodes</span></span>
<span id="cb937-33"><a href="causation.html#cb937-33" tabindex="-1"></a><span class="st">  edge [color = black]</span></span>
<span id="cb937-34"><a href="causation.html#cb937-34" tabindex="-1"></a><span class="st">  x -&gt; z</span></span>
<span id="cb937-35"><a href="causation.html#cb937-35" tabindex="-1"></a><span class="st">  z -&gt; y</span></span>
<span id="cb937-36"><a href="causation.html#cb937-36" tabindex="-1"></a></span>
<span id="cb937-37"><a href="causation.html#cb937-37" tabindex="-1"></a><span class="st">  # direction in which arrows are drawn (from left to right)</span></span>
<span id="cb937-38"><a href="causation.html#cb937-38" tabindex="-1"></a><span class="st">  rankdir = LR</span></span>
<span id="cb937-39"><a href="causation.html#cb937-39" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb937-40"><a href="causation.html#cb937-40" tabindex="-1"></a><span class="st">&quot;</span>) </span>
<span id="cb937-41"><a href="causation.html#cb937-41" tabindex="-1"></a>g</span></code></pre></div>
<div class="grViz html-widget html-fill-item" id="htmlwidget-3a416be1a6cf8647bd90" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-3a416be1a6cf8647bd90">{"x":{"diagram":"\ndigraph neato {\n  \n  graph[layout = neato]\n  \n  # general settings for all nodes\n  node [\n    shape = circle,\n    style = filled,\n    color = black,\n    label = \"\"\n    fontname = \"Helvetica\",\n    fontsize = 16,\n    fillcolor = lightblue\n    ]\n  \n  # labels for each node\n  x [label = \"X\" pos = \"0,0!\"]\n  z [label = \"Z\"  pos = \"1,1!\"]\n  y [label = \"Y\" pos = \"2,0!\"]\n  \n  # edges between nodes\n  edge [color = black]\n  x -> z\n  z -> y\n\n  # direction in which arrows are drawn (from left to right)\n  rankdir = LR\n}\n","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode" id="cb938"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb938-1"><a href="causation.html#cb938-1" tabindex="-1"></a><span class="co"># fit models </span></span>
<span id="cb938-2"><a href="causation.html#cb938-2" tabindex="-1"></a>fit.yx <span class="ot">=</span> <span class="fu">lm</span>(<span class="at">formula =</span> y <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> x,</span>
<span id="cb938-3"><a href="causation.html#cb938-3" tabindex="-1"></a>    <span class="at">data =</span> df.causal_chain)</span>
<span id="cb938-4"><a href="causation.html#cb938-4" tabindex="-1"></a></span>
<span id="cb938-5"><a href="causation.html#cb938-5" tabindex="-1"></a>fit.zx <span class="ot">=</span> <span class="fu">lm</span>(<span class="at">formula =</span> z <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> x,</span>
<span id="cb938-6"><a href="causation.html#cb938-6" tabindex="-1"></a>    <span class="at">data =</span> df.causal_chain)</span>
<span id="cb938-7"><a href="causation.html#cb938-7" tabindex="-1"></a></span>
<span id="cb938-8"><a href="causation.html#cb938-8" tabindex="-1"></a>fit.yxz <span class="ot">=</span> <span class="fu">lm</span>(<span class="at">formula =</span> y <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> x <span class="sc">+</span> z,</span>
<span id="cb938-9"><a href="causation.html#cb938-9" tabindex="-1"></a>    <span class="at">data =</span> df.causal_chain)</span>
<span id="cb938-10"><a href="causation.html#cb938-10" tabindex="-1"></a></span>
<span id="cb938-11"><a href="causation.html#cb938-11" tabindex="-1"></a><span class="co"># print models </span></span>
<span id="cb938-12"><a href="causation.html#cb938-12" tabindex="-1"></a><span class="fu">summary</span>(fit.yx)</span></code></pre></div>
<pre><code>
Call:
lm(formula = y ~ 1 + x, data = df.causal_chain)

Residuals:
    Min      1Q  Median      3Q     Max 
-4.0180 -1.2143 -0.4065  1.1288  6.0959 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -0.04802    0.21582  -0.222    0.824    
x            4.01905    0.23972  16.766   &lt;2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 2.142 on 98 degrees of freedom
Multiple R-squared:  0.7415,    Adjusted R-squared:  0.7389 
F-statistic: 281.1 on 1 and 98 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb940"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb940-1"><a href="causation.html#cb940-1" tabindex="-1"></a><span class="fu">summary</span>(fit.zx)</span></code></pre></div>
<pre><code>
Call:
lm(formula = z ~ 1 + x, data = df.causal_chain)

Residuals:
    Min      1Q  Median      3Q     Max 
-1.8768 -0.6138 -0.1395  0.5394  2.3462 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -0.03769    0.09699  -0.389    0.698    
x            1.99894    0.10773  18.556   &lt;2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 0.9628 on 98 degrees of freedom
Multiple R-squared:  0.7784,    Adjusted R-squared:  0.7762 
F-statistic: 344.3 on 1 and 98 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb942"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb942-1"><a href="causation.html#cb942-1" tabindex="-1"></a><span class="fu">summary</span>(fit.yxz)</span></code></pre></div>
<pre><code>
Call:
lm(formula = y ~ 1 + x + z, data = df.causal_chain)

Residuals:
     Min       1Q   Median       3Q      Max 
-2.94359 -0.43645  0.00202  0.63692  2.63941 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  0.02535    0.10519   0.241    0.810    
x            0.12804    0.24804   0.516    0.607    
z            1.94653    0.10948  17.780   &lt;2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 1.043 on 97 degrees of freedom
Multiple R-squared:  0.9393,    Adjusted R-squared:  0.9381 
F-statistic: 750.6 on 2 and 97 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb944"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb944-1"><a href="causation.html#cb944-1" tabindex="-1"></a><span class="co"># mediation analysis </span></span>
<span id="cb944-2"><a href="causation.html#cb944-2" tabindex="-1"></a>fit.m <span class="ot">=</span> <span class="fu">mediate</span>(<span class="at">model.m =</span> fit.zx,</span>
<span id="cb944-3"><a href="causation.html#cb944-3" tabindex="-1"></a>              <span class="at">model.y =</span> fit.yxz,</span>
<span id="cb944-4"><a href="causation.html#cb944-4" tabindex="-1"></a>              <span class="at">treat =</span> <span class="st">&quot;x&quot;</span>,</span>
<span id="cb944-5"><a href="causation.html#cb944-5" tabindex="-1"></a>              <span class="at">mediator =</span> <span class="st">&quot;z&quot;</span>,</span>
<span id="cb944-6"><a href="causation.html#cb944-6" tabindex="-1"></a>              <span class="at">boot =</span> T)</span></code></pre></div>
<pre><code>Running nonparametric bootstrap</code></pre>
<div class="sourceCode" id="cb946"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb946-1"><a href="causation.html#cb946-1" tabindex="-1"></a><span class="fu">summary</span>(fit.m)</span></code></pre></div>
<pre><code>
Causal Mediation Analysis 

Nonparametric Bootstrap Confidence Intervals with the Percentile Method

               Estimate 95% CI Lower 95% CI Upper p-value    
ACME              3.891        3.390         4.51  &lt;2e-16 ***
ADE               0.128       -0.395         0.62    0.64    
Total Effect      4.019        3.585         4.44  &lt;2e-16 ***
Prop. Mediated    0.968        0.849         1.11  &lt;2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Sample Size Used: 100 


Simulations: 1000 </code></pre>
<div class="sourceCode" id="cb948"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb948-1"><a href="causation.html#cb948-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb948-2"><a href="causation.html#cb948-2" tabindex="-1"></a></span>
<span id="cb948-3"><a href="causation.html#cb948-3" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">100</span> <span class="co"># number of observations</span></span>
<span id="cb948-4"><a href="causation.html#cb948-4" tabindex="-1"></a></span>
<span id="cb948-5"><a href="causation.html#cb948-5" tabindex="-1"></a><span class="co"># common cause</span></span>
<span id="cb948-6"><a href="causation.html#cb948-6" tabindex="-1"></a>df.common_cause <span class="ot">=</span> <span class="fu">tibble</span>(<span class="at">z =</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb948-7"><a href="causation.html#cb948-7" tabindex="-1"></a>                         <span class="at">x =</span> <span class="dv">2</span> <span class="sc">*</span> z <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">1</span>), </span>
<span id="cb948-8"><a href="causation.html#cb948-8" tabindex="-1"></a>                         <span class="at">y =</span> <span class="dv">2</span> <span class="sc">*</span> z <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">1</span>)) </span>
<span id="cb948-9"><a href="causation.html#cb948-9" tabindex="-1"></a></span>
<span id="cb948-10"><a href="causation.html#cb948-10" tabindex="-1"></a><span class="co"># visualize the graph </span></span>
<span id="cb948-11"><a href="causation.html#cb948-11" tabindex="-1"></a>g <span class="ot">=</span> <span class="fu">grViz</span>(<span class="st">&quot;</span></span>
<span id="cb948-12"><a href="causation.html#cb948-12" tabindex="-1"></a><span class="st">digraph neato {</span></span>
<span id="cb948-13"><a href="causation.html#cb948-13" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb948-14"><a href="causation.html#cb948-14" tabindex="-1"></a><span class="st">  graph[layout = neato]</span></span>
<span id="cb948-15"><a href="causation.html#cb948-15" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb948-16"><a href="causation.html#cb948-16" tabindex="-1"></a><span class="st">  # general settings for all nodes</span></span>
<span id="cb948-17"><a href="causation.html#cb948-17" tabindex="-1"></a><span class="st">  node [</span></span>
<span id="cb948-18"><a href="causation.html#cb948-18" tabindex="-1"></a><span class="st">    shape = circle,</span></span>
<span id="cb948-19"><a href="causation.html#cb948-19" tabindex="-1"></a><span class="st">    style = filled,</span></span>
<span id="cb948-20"><a href="causation.html#cb948-20" tabindex="-1"></a><span class="st">    color = black,</span></span>
<span id="cb948-21"><a href="causation.html#cb948-21" tabindex="-1"></a><span class="st">    label = &#39;&#39;</span></span>
<span id="cb948-22"><a href="causation.html#cb948-22" tabindex="-1"></a><span class="st">    fontname = &#39;Helvetica&#39;,</span></span>
<span id="cb948-23"><a href="causation.html#cb948-23" tabindex="-1"></a><span class="st">    fontsize = 16,</span></span>
<span id="cb948-24"><a href="causation.html#cb948-24" tabindex="-1"></a><span class="st">    fillcolor = lightblue</span></span>
<span id="cb948-25"><a href="causation.html#cb948-25" tabindex="-1"></a><span class="st">    ]</span></span>
<span id="cb948-26"><a href="causation.html#cb948-26" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb948-27"><a href="causation.html#cb948-27" tabindex="-1"></a><span class="st">  # labels for each node</span></span>
<span id="cb948-28"><a href="causation.html#cb948-28" tabindex="-1"></a><span class="st">  x [label = &#39;X&#39; pos = &#39;0,0!&#39;]</span></span>
<span id="cb948-29"><a href="causation.html#cb948-29" tabindex="-1"></a><span class="st">  z [label = &#39;Z&#39;  pos = &#39;1,1!&#39;]</span></span>
<span id="cb948-30"><a href="causation.html#cb948-30" tabindex="-1"></a><span class="st">  y [label = &#39;Y&#39; pos = &#39;2,0!&#39;]</span></span>
<span id="cb948-31"><a href="causation.html#cb948-31" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb948-32"><a href="causation.html#cb948-32" tabindex="-1"></a><span class="st">  # edges between nodes</span></span>
<span id="cb948-33"><a href="causation.html#cb948-33" tabindex="-1"></a><span class="st">  edge [color = black]</span></span>
<span id="cb948-34"><a href="causation.html#cb948-34" tabindex="-1"></a><span class="st">  z -&gt; x</span></span>
<span id="cb948-35"><a href="causation.html#cb948-35" tabindex="-1"></a><span class="st">  z -&gt; y</span></span>
<span id="cb948-36"><a href="causation.html#cb948-36" tabindex="-1"></a></span>
<span id="cb948-37"><a href="causation.html#cb948-37" tabindex="-1"></a><span class="st">  # direction in which arrows are drawn (from left to right)</span></span>
<span id="cb948-38"><a href="causation.html#cb948-38" tabindex="-1"></a><span class="st">  rankdir = LR</span></span>
<span id="cb948-39"><a href="causation.html#cb948-39" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb948-40"><a href="causation.html#cb948-40" tabindex="-1"></a><span class="st">&quot;</span>) </span>
<span id="cb948-41"><a href="causation.html#cb948-41" tabindex="-1"></a>g</span></code></pre></div>
<div class="grViz html-widget html-fill-item" id="htmlwidget-84f3a6ea3ed48107444d" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-84f3a6ea3ed48107444d">{"x":{"diagram":"\ndigraph neato {\n  \n  graph[layout = neato]\n  \n  # general settings for all nodes\n  node [\n    shape = circle,\n    style = filled,\n    color = black,\n    label = \"\"\n    fontname = \"Helvetica\",\n    fontsize = 16,\n    fillcolor = lightblue\n    ]\n  \n  # labels for each node\n  x [label = \"X\" pos = \"0,0!\"]\n  z [label = \"Z\"  pos = \"1,1!\"]\n  y [label = \"Y\" pos = \"2,0!\"]\n  \n  # edges between nodes\n  edge [color = black]\n  z -> x\n  z -> y\n\n  # direction in which arrows are drawn (from left to right)\n  rankdir = LR\n}\n","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode" id="cb949"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb949-1"><a href="causation.html#cb949-1" tabindex="-1"></a><span class="co"># fit models </span></span>
<span id="cb949-2"><a href="causation.html#cb949-2" tabindex="-1"></a>fit.yx <span class="ot">=</span> <span class="fu">lm</span>(<span class="at">formula =</span> y <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> x,</span>
<span id="cb949-3"><a href="causation.html#cb949-3" tabindex="-1"></a>    <span class="at">data =</span> df.common_cause)</span>
<span id="cb949-4"><a href="causation.html#cb949-4" tabindex="-1"></a></span>
<span id="cb949-5"><a href="causation.html#cb949-5" tabindex="-1"></a>fit.zx <span class="ot">=</span> <span class="fu">lm</span>(<span class="at">formula =</span> z <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> x,</span>
<span id="cb949-6"><a href="causation.html#cb949-6" tabindex="-1"></a>    <span class="at">data =</span> df.common_cause)</span>
<span id="cb949-7"><a href="causation.html#cb949-7" tabindex="-1"></a></span>
<span id="cb949-8"><a href="causation.html#cb949-8" tabindex="-1"></a>fit.yxz <span class="ot">=</span> <span class="fu">lm</span>(<span class="at">formula =</span> y <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> x <span class="sc">+</span> z,</span>
<span id="cb949-9"><a href="causation.html#cb949-9" tabindex="-1"></a>    <span class="at">data =</span> df.common_cause)</span>
<span id="cb949-10"><a href="causation.html#cb949-10" tabindex="-1"></a></span>
<span id="cb949-11"><a href="causation.html#cb949-11" tabindex="-1"></a><span class="co"># print models </span></span>
<span id="cb949-12"><a href="causation.html#cb949-12" tabindex="-1"></a><span class="fu">summary</span>(fit.yx)</span></code></pre></div>
<pre><code>
Call:
lm(formula = y ~ 1 + x, data = df.common_cause)

Residuals:
    Min      1Q  Median      3Q     Max 
-3.4514 -0.9780 -0.1073  1.0144  3.3204 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  0.10793    0.13821   0.781    0.437    
x            0.77525    0.06799  11.402   &lt;2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 1.377 on 98 degrees of freedom
Multiple R-squared:  0.5702,    Adjusted R-squared:  0.5658 
F-statistic:   130 on 1 and 98 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb951"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb951-1"><a href="causation.html#cb951-1" tabindex="-1"></a><span class="fu">summary</span>(fit.zx)</span></code></pre></div>
<pre><code>
Call:
lm(formula = z ~ 1 + x, data = df.common_cause)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.90848 -0.28101  0.06274  0.24570  0.85736 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  0.03880    0.04266    0.91    0.365    
x            0.38942    0.02099   18.56   &lt;2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 0.4249 on 98 degrees of freedom
Multiple R-squared:  0.7784,    Adjusted R-squared:  0.7762 
F-statistic: 344.3 on 1 and 98 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb953"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb953-1"><a href="causation.html#cb953-1" tabindex="-1"></a><span class="fu">summary</span>(fit.yxz)</span></code></pre></div>
<pre><code>
Call:
lm(formula = y ~ 1 + x + z, data = df.common_cause)

Residuals:
     Min       1Q   Median       3Q      Max 
-2.94359 -0.43645  0.00202  0.63692  2.63941 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  0.02535    0.10519   0.241    0.810    
x           -0.05347    0.10948  -0.488    0.626    
z            2.12804    0.24804   8.580 1.55e-13 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 1.043 on 97 degrees of freedom
Multiple R-squared:  0.7556,    Adjusted R-squared:  0.7506 
F-statistic:   150 on 2 and 97 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb955"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb955-1"><a href="causation.html#cb955-1" tabindex="-1"></a><span class="co"># mediation analysis </span></span>
<span id="cb955-2"><a href="causation.html#cb955-2" tabindex="-1"></a>fit.m <span class="ot">=</span> <span class="fu">mediate</span>(<span class="at">model.m =</span> fit.zx,</span>
<span id="cb955-3"><a href="causation.html#cb955-3" tabindex="-1"></a>                <span class="at">model.y =</span> fit.yxz,</span>
<span id="cb955-4"><a href="causation.html#cb955-4" tabindex="-1"></a>                <span class="at">treat =</span> <span class="st">&quot;x&quot;</span>,</span>
<span id="cb955-5"><a href="causation.html#cb955-5" tabindex="-1"></a>                <span class="at">mediator =</span> <span class="st">&quot;z&quot;</span>,</span>
<span id="cb955-6"><a href="causation.html#cb955-6" tabindex="-1"></a>                <span class="at">boot =</span> T)</span></code></pre></div>
<pre><code>Running nonparametric bootstrap</code></pre>
<div class="sourceCode" id="cb957"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb957-1"><a href="causation.html#cb957-1" tabindex="-1"></a><span class="fu">summary</span>(fit.m)</span></code></pre></div>
<pre><code>
Causal Mediation Analysis 

Nonparametric Bootstrap Confidence Intervals with the Percentile Method

               Estimate 95% CI Lower 95% CI Upper p-value    
ACME             0.8287       0.6065         1.04  &lt;2e-16 ***
ADE             -0.0535      -0.2675         0.16    0.56    
Total Effect     0.7752       0.6353         0.90  &lt;2e-16 ***
Prop. Mediated   1.0690       0.8134         1.37  &lt;2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Sample Size Used: 100 


Simulations: 1000 </code></pre>
<p>Both models here lead to the same pattern of “mediation”. However, only the first one is a chain: X–&gt;Z–&gt;Y. The second one is a common cause X&lt;–Z–&gt;Y (where X does not cause Y).</p>
</div>
</div>
<div id="moderation" class="section level2 hasAnchor" number="16.7">
<h2><span class="header-section-number">16.7</span> Moderation<a href="causation.html#moderation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="figure"><span style="display:block;" id="fig:moderation"></span>
<img src="figures/moderation.png" alt="__Basic moderation model__." width="75%" />
<p class="caption">
Figure 16.2: <strong>Basic moderation model</strong>.
</p>
</div>
<p>Moderation can be tested by looking for significant interactions between the moderating variable (Z) and the IV (X). Notably, it is important to mean center both your moderator and your IV to reduce multicolinearity and make interpretation easier.</p>
<div id="generate-data-1" class="section level3 hasAnchor" number="16.7.1">
<h3><span class="header-section-number">16.7.1</span> Generate data<a href="causation.html#generate-data-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb959"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb959-1"><a href="causation.html#cb959-1" tabindex="-1"></a><span class="co"># make example reproducible </span></span>
<span id="cb959-2"><a href="causation.html#cb959-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb959-3"><a href="causation.html#cb959-3" tabindex="-1"></a></span>
<span id="cb959-4"><a href="causation.html#cb959-4" tabindex="-1"></a><span class="co"># number of participants</span></span>
<span id="cb959-5"><a href="causation.html#cb959-5" tabindex="-1"></a>n  <span class="ot">=</span> <span class="dv">100</span> </span>
<span id="cb959-6"><a href="causation.html#cb959-6" tabindex="-1"></a></span>
<span id="cb959-7"><a href="causation.html#cb959-7" tabindex="-1"></a>df.moderation <span class="ot">=</span> <span class="fu">tibble</span>(<span class="at">x  =</span> <span class="fu">abs</span>(<span class="fu">rnorm</span>(n, <span class="dv">6</span>, <span class="dv">4</span>)), <span class="co"># hours of sleep</span></span>
<span id="cb959-8"><a href="causation.html#cb959-8" tabindex="-1"></a>                       <span class="at">x1 =</span> <span class="fu">abs</span>(<span class="fu">rnorm</span>(n, <span class="dv">60</span>, <span class="dv">30</span>)), <span class="co"># adding some systematic variance to our DV</span></span>
<span id="cb959-9"><a href="causation.html#cb959-9" tabindex="-1"></a>                       <span class="at">z  =</span> <span class="fu">rnorm</span>(n, <span class="dv">30</span>, <span class="dv">8</span>), <span class="co"># ounces of coffee consumed</span></span>
<span id="cb959-10"><a href="causation.html#cb959-10" tabindex="-1"></a>                       <span class="at">y  =</span> <span class="fu">abs</span>((<span class="sc">-</span><span class="fl">0.8</span> <span class="sc">*</span> x) <span class="sc">*</span> (<span class="fl">0.2</span> <span class="sc">*</span> z) <span class="sc">-</span> <span class="fl">0.5</span> <span class="sc">*</span> x <span class="sc">-</span> <span class="fl">0.4</span> <span class="sc">*</span> x1 <span class="sc">+</span> <span class="dv">10</span> <span class="sc">+</span> </span>
<span id="cb959-11"><a href="causation.html#cb959-11" tabindex="-1"></a>                                  <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">3</span>))) <span class="co"># attention Paid</span></span></code></pre></div>
</div>
<div id="moderation-analysis" class="section level3 hasAnchor" number="16.7.2">
<h3><span class="header-section-number">16.7.2</span> Moderation analysis<a href="causation.html#moderation-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb960"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb960-1"><a href="causation.html#cb960-1" tabindex="-1"></a><span class="co"># scale the predictors </span></span>
<span id="cb960-2"><a href="causation.html#cb960-2" tabindex="-1"></a>df.moderation <span class="ot">=</span> df.moderation <span class="sc">%&gt;%</span></span>
<span id="cb960-3"><a href="causation.html#cb960-3" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(x, z), <span class="sc">~</span> <span class="fu">scale</span>(.)[,])</span>
<span id="cb960-4"><a href="causation.html#cb960-4" tabindex="-1"></a></span>
<span id="cb960-5"><a href="causation.html#cb960-5" tabindex="-1"></a><span class="co"># run regression model with interaction </span></span>
<span id="cb960-6"><a href="causation.html#cb960-6" tabindex="-1"></a>fit.moderation <span class="ot">=</span> <span class="fu">lm</span>(<span class="at">formula =</span> y <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> x <span class="sc">*</span> z,</span>
<span id="cb960-7"><a href="causation.html#cb960-7" tabindex="-1"></a>                    <span class="at">data =</span> df.moderation)</span>
<span id="cb960-8"><a href="causation.html#cb960-8" tabindex="-1"></a></span>
<span id="cb960-9"><a href="causation.html#cb960-9" tabindex="-1"></a><span class="co"># summarize result </span></span>
<span id="cb960-10"><a href="causation.html#cb960-10" tabindex="-1"></a>fit.moderation <span class="sc">%&gt;%</span> </span>
<span id="cb960-11"><a href="causation.html#cb960-11" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code></pre></div>
<pre><code>
Call:
lm(formula = y ~ 1 + x * z, data = df.moderation)

Residuals:
    Min      1Q  Median      3Q     Max 
-21.466  -8.972  -0.233   6.180  38.051 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   48.544      1.173  41.390  &lt; 2e-16 ***
x             17.863      1.196  14.936  &lt; 2e-16 ***
z              8.393      1.181   7.108 2.08e-10 ***
x:z            6.094      1.077   5.656 1.59e-07 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 11.65 on 96 degrees of freedom
Multiple R-squared:  0.7661,    Adjusted R-squared:  0.7587 
F-statistic: 104.8 on 3 and 96 DF,  p-value: &lt; 2.2e-16</code></pre>
<div id="visualize-result" class="section level4 hasAnchor" number="16.7.2.1">
<h4><span class="header-section-number">16.7.2.1</span> Visualize result<a href="causation.html#visualize-result" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb962"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb962-1"><a href="causation.html#cb962-1" tabindex="-1"></a><span class="co"># generate data grid with three levels of the moderator </span></span>
<span id="cb962-2"><a href="causation.html#cb962-2" tabindex="-1"></a>df.newdata <span class="ot">=</span> df.moderation <span class="sc">%&gt;%</span> </span>
<span id="cb962-3"><a href="causation.html#cb962-3" tabindex="-1"></a>  <span class="fu">expand</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="fu">min</span>(x), </span>
<span id="cb962-4"><a href="causation.html#cb962-4" tabindex="-1"></a>               <span class="fu">max</span>(x)), </span>
<span id="cb962-5"><a href="causation.html#cb962-5" tabindex="-1"></a>         <span class="at">z =</span> <span class="fu">c</span>(<span class="fu">mean</span>(z) <span class="sc">-</span> <span class="fu">sd</span>(z),</span>
<span id="cb962-6"><a href="causation.html#cb962-6" tabindex="-1"></a>               <span class="fu">mean</span>(z),</span>
<span id="cb962-7"><a href="causation.html#cb962-7" tabindex="-1"></a>               <span class="fu">mean</span>(z) <span class="sc">+</span> <span class="fu">sd</span>(z))) <span class="sc">%&gt;%</span> </span>
<span id="cb962-8"><a href="causation.html#cb962-8" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">moderator =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;low&quot;</span>, <span class="st">&quot;average&quot;</span>, <span class="st">&quot;high&quot;</span>), <span class="fu">nrow</span>(.)<span class="sc">/</span><span class="dv">3</span>))</span>
<span id="cb962-9"><a href="causation.html#cb962-9" tabindex="-1"></a></span>
<span id="cb962-10"><a href="causation.html#cb962-10" tabindex="-1"></a><span class="co"># predictions for the three levels of the moderator </span></span>
<span id="cb962-11"><a href="causation.html#cb962-11" tabindex="-1"></a>df.prediction <span class="ot">=</span> fit.moderation <span class="sc">%&gt;%</span> </span>
<span id="cb962-12"><a href="causation.html#cb962-12" tabindex="-1"></a>  <span class="fu">augment</span>(<span class="at">newdata =</span> df.newdata) <span class="sc">%&gt;%</span> </span>
<span id="cb962-13"><a href="causation.html#cb962-13" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">moderator =</span> <span class="fu">factor</span>(moderator, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;high&quot;</span>, <span class="st">&quot;average&quot;</span>, <span class="st">&quot;low&quot;</span>)))</span>
<span id="cb962-14"><a href="causation.html#cb962-14" tabindex="-1"></a></span>
<span id="cb962-15"><a href="causation.html#cb962-15" tabindex="-1"></a><span class="co"># visualize the result </span></span>
<span id="cb962-16"><a href="causation.html#cb962-16" tabindex="-1"></a>df.moderation <span class="sc">%&gt;%</span> </span>
<span id="cb962-17"><a href="causation.html#cb962-17" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x,</span>
<span id="cb962-18"><a href="causation.html#cb962-18" tabindex="-1"></a>             <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb962-19"><a href="causation.html#cb962-19" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb962-20"><a href="causation.html#cb962-20" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> df.prediction,</span>
<span id="cb962-21"><a href="causation.html#cb962-21" tabindex="-1"></a>            <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">y =</span> .fitted,</span>
<span id="cb962-22"><a href="causation.html#cb962-22" tabindex="-1"></a>                          <span class="at">group =</span> moderator,</span>
<span id="cb962-23"><a href="causation.html#cb962-23" tabindex="-1"></a>                          <span class="at">color =</span> moderator),</span>
<span id="cb962-24"><a href="causation.html#cb962-24" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb962-25"><a href="causation.html#cb962-25" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;hours of sleep (z-scored)&quot;</span>,</span>
<span id="cb962-26"><a href="causation.html#cb962-26" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;attention paid&quot;</span>,</span>
<span id="cb962-27"><a href="causation.html#cb962-27" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">&quot;coffee consumed&quot;</span>) <span class="sc">+</span> </span>
<span id="cb962-28"><a href="causation.html#cb962-28" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;Set1&quot;</span>)</span></code></pre></div>
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead.
This warning is displayed once every 8 hours.
Call `lifecycle::last_lifecycle_warnings()` to see where this warning was generated.</code></pre>
<p><img src="16-causation_files/figure-html/unnamed-chunk-31-1.png" width="672" /></p>
<div class="sourceCode" id="cb964"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb964-1"><a href="causation.html#cb964-1" tabindex="-1"></a>df.prediction <span class="sc">%&gt;%</span> </span>
<span id="cb964-2"><a href="causation.html#cb964-2" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">9</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb964-3"><a href="causation.html#cb964-3" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">digits =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb964-4"><a href="causation.html#cb964-4" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="st">&quot;striped&quot;</span>,</span>
<span id="cb964-5"><a href="causation.html#cb964-5" tabindex="-1"></a>              <span class="at">full_width =</span> F)</span></code></pre></div>
<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
x
</th>
<th style="text-align:right;">
z
</th>
<th style="text-align:left;">
moderator
</th>
<th style="text-align:right;">
.fitted
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
-1.83
</td>
<td style="text-align:right;">
-1
</td>
<td style="text-align:left;">
low
</td>
<td style="text-align:right;">
18.58
</td>
</tr>
<tr>
<td style="text-align:right;">
-1.83
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
average
</td>
<td style="text-align:right;">
15.80
</td>
</tr>
<tr>
<td style="text-align:right;">
-1.83
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
high
</td>
<td style="text-align:right;">
13.02
</td>
</tr>
<tr>
<td style="text-align:right;">
2.41
</td>
<td style="text-align:right;">
-1
</td>
<td style="text-align:left;">
low
</td>
<td style="text-align:right;">
68.52
</td>
</tr>
<tr>
<td style="text-align:right;">
2.41
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
average
</td>
<td style="text-align:right;">
91.60
</td>
</tr>
<tr>
<td style="text-align:right;">
2.41
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
high
</td>
<td style="text-align:right;">
114.68
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="additional-resources-14" class="section level2 hasAnchor" number="16.8">
<h2><span class="header-section-number">16.8</span> Additional resources<a href="causation.html#additional-resources-14" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="books" class="section level3 hasAnchor" number="16.8.1">
<h3><span class="header-section-number">16.8.1</span> Books<a href="causation.html#books" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><a href="https://www.guilford.com/books/Introduction-to-Mediation-Moderation-and-Conditional-Process-Analysis/Andrew-Hayes/9781462534654">Introduction to Mediation, Moderation, and Conditional Process Analysis (Second Edition): A Regression-Based Approach</a>
<ul>
<li><a href="https://bookdown.org/connect/#/apps/1523/access">Recoded with BRMS and Tidyverse</a></li>
</ul></li>
</ul>
</div>
<div id="tutorials-1" class="section level3 hasAnchor" number="16.8.2">
<h3><span class="header-section-number">16.8.2</span> Tutorials<a href="causation.html#tutorials-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><a href="https://ademos.people.uic.edu/Chapter14.html">R tutorial on mediation and moderation</a></li>
<li><a href="https://ademos.people.uic.edu/Chapter15.html">R tutorial on moderated mediation</a></li>
<li><a href="http://www.imachordata.com/bayesian-sem-with-brms/">Path analysis with brms</a></li>
<li><a href="http://web.mit.edu/jmn/www/6.034/d-separation.pdf">Understanding d-separation</a></li>
</ul>
</div>
<div id="misc-9" class="section level3 hasAnchor" number="16.8.3">
<h3><span class="header-section-number">16.8.3</span> Misc<a href="causation.html#misc-9" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><a href="http://causality.cs.ucla.edu/blog/index.php/2019/08/14/a-crash-course-in-good-and-bad-control/">Judea Pearl on good, bad, and neutral controls</a></li>
<li><a href="http://babieslearninglanguage.blogspot.com/2019/10/confounds-and-covariates.html">Mike Frank on covariates vs. confounds</a></li>
</ul>
</div>
</div>
<div id="session-info-15" class="section level2 hasAnchor" number="16.9">
<h2><span class="header-section-number">16.9</span> Session info<a href="causation.html#session-info-15" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Information about this R session including which version of R was used, and what packages were loaded.</p>
<div class="sourceCode" id="cb965"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb965-1"><a href="causation.html#cb965-1" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span></code></pre></div>
<pre><code>R version 4.3.2 (2023-10-31)
Platform: aarch64-apple-darwin20 (64-bit)
Running under: macOS Sonoma 14.1.2

Matrix products: default
BLAS:   /Library/Frameworks/R.framework/Versions/4.3-arm64/Resources/lib/libRblas.0.dylib 
LAPACK: /Library/Frameworks/R.framework/Versions/4.3-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.11.0

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

time zone: America/Los_Angeles
tzcode source: internal

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
 [1] lubridate_1.9.3   forcats_1.0.0     stringr_1.5.1     dplyr_1.1.4      
 [5] purrr_1.0.2       readr_2.1.4       tidyr_1.3.0       tibble_3.2.1     
 [9] ggplot2_3.4.4     tidyverse_2.0.0   rsvg_2.6.0        DiagrammeRsvg_0.1
[13] DiagrammeR_1.0.10 broom_1.0.5       multilevel_2.7    nlme_3.1-164     
[17] mediation_4.5.0   sandwich_3.1-0    mvtnorm_1.2-4     Matrix_1.6-4     
[21] MASS_7.3-60       janitor_2.2.0     kableExtra_1.3.4  knitr_1.45       

loaded via a namespace (and not attached):
 [1] tidyselect_1.2.0   viridisLite_0.4.2  farver_2.1.1       fastmap_1.1.1     
 [5] digest_0.6.33      rpart_4.1.23       timechange_0.2.0   lifecycle_1.0.4   
 [9] cluster_2.1.6      ellipsis_0.3.2     magrittr_2.0.3     compiler_4.3.2    
[13] rlang_1.1.2        Hmisc_5.1-1        sass_0.4.8         tools_4.3.2       
[17] utf8_1.2.4         yaml_2.3.8         data.table_1.14.10 labeling_0.4.3    
[21] htmlwidgets_1.6.4  curl_5.2.0         xml2_1.3.6         RColorBrewer_1.1-3
[25] withr_2.5.2        foreign_0.8-86     nnet_7.3-19        grid_4.3.2        
[29] fansi_1.0.6        colorspace_2.1-0   scales_1.3.0       cli_3.6.2         
[33] crayon_1.5.2       rmarkdown_2.25     generics_0.1.3     rstudioapi_0.15.0 
[37] tzdb_0.4.0         httr_1.4.7         visNetwork_2.1.2   minqa_1.2.6       
[41] cachem_1.0.8       splines_4.3.2      rvest_1.0.3        base64enc_0.1-3   
[45] vctrs_0.6.5        V8_4.4.1           boot_1.3-28.1      webshot_0.5.5     
[49] jsonlite_1.8.8     bookdown_0.37      hms_1.1.3          Formula_1.2-5     
[53] htmlTable_2.4.2    systemfonts_1.0.5  jquerylib_0.1.4    glue_1.6.2        
[57] nloptr_2.0.3       stringi_1.8.3      gtable_0.3.4       lme4_1.1-35.1     
[61] munsell_0.5.0      pillar_1.9.0       htmltools_0.5.7    R6_2.5.1          
[65] evaluate_0.23      lpSolve_5.6.20     lattice_0.22-5     highr_0.10        
[69] backports_1.4.1    snakecase_0.11.1   bslib_0.6.1        Rcpp_1.0.11       
[73] svglite_2.1.3      gridExtra_2.3      checkmate_2.3.1    xfun_0.41         
[77] zoo_1.8-12         pkgconfig_2.0.3   </code></pre>

</div>
</div>
<h3>References<a href="references-1.html#references-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-baron1986moderator" class="csl-entry">
Baron, Reuben M, and David A Kenny. 1986. <span>“The Moderator–Mediator Variable Distinction in Social Psychological Research: Conceptual, Strategic, and Statistical Considerations.”</span> <em>Journal of Personality and Social Psychology</em> 51 (6): 1173–82.
</div>
<div id="ref-fiedler2011mediation" class="csl-entry">
Fiedler, Klaus, Malte Schott, and Thorsten Meiser. 2011. <span>“What Mediation Analysis Can (Not) Do.”</span> <em>Journal of Experimental Social Psychology</em> 47 (6): 1231–36.
</div>
<div id="ref-mackinnon2007mediationa" class="csl-entry">
MacKinnon, David P., Amanda J. Fairchild, and Matthew S. Fritz. 2007. <span>“Mediation <span>Analysis</span>.”</span> <em>Annual Review of Psychology</em> 58 (1): 593–614. <a href="https://doi.org/10.1146/annurev.psych.58.110405.085542">https://doi.org/10.1146/annurev.psych.58.110405.085542</a>.
</div>
<div id="ref-preacher2004spss" class="csl-entry">
Preacher, Kristopher J, and Andrew F Hayes. 2004. <span>“SPSS and SAS Procedures for Estimating Indirect Effects in Simple Mediation Models.”</span> <em>Behavior Research Methods, Instruments &amp; Computers</em> 36 (4): 717–31.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="model-comparison.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="linear-mixed-effects-models-1.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"],
"google": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/psych252/psych252book/edit/master/16-causation.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": false,
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"toc_depth": 3
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
