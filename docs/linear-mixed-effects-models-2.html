<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 18 Linear mixed effects models 2 | Psych 252: Statistical Methods for Behavioral and Social Sciences</title>
  <meta name="description" content="Course notes for Psych 252." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 18 Linear mixed effects models 2 | Psych 252: Statistical Methods for Behavioral and Social Sciences" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Course notes for Psych 252." />
  <meta name="github-repo" content="psych252/psych252book" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 18 Linear mixed effects models 2 | Psych 252: Statistical Methods for Behavioral and Social Sciences" />
  
  <meta name="twitter:description" content="Course notes for Psych 252." />
  

<meta name="author" content="Tobias Gerstenberg" />


<meta name="date" content="2021-03-11" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="linear-mixed-effects-models-1.html"/>
<link rel="next" href="linear-mixed-effects-models-3.html"/>
<script src="libs/header-attrs-2.6/header-attrs.js"></script>
<script src="libs/jquery-3.5.1/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.17/datatables.js"></script>
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.10.20/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.1/js/crosstalk.min.js"></script>
<script src="libs/viz-1.8.2/viz.js"></script>
<link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="libs/grViz-binding-1.0.6.1/grViz.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Psych 252</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#course-description"><i class="fa fa-check"></i>Course description</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#course-homepage"><i class="fa fa-check"></i>Course homepage</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#thanks"><i class="fa fa-check"></i><b>1.1</b> Thanks</a></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#list-of-r-packages-used-in-this-book"><i class="fa fa-check"></i><b>1.2</b> List of R packages used in this book</a></li>
<li class="chapter" data-level="1.3" data-path="introduction.html"><a href="introduction.html#installing-packages"><i class="fa fa-check"></i><b>1.3</b> Installing packages</a></li>
<li class="chapter" data-level="1.4" data-path="introduction.html"><a href="introduction.html#session-info"><i class="fa fa-check"></i><b>1.4</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="visualization-1.html"><a href="visualization-1.html"><i class="fa fa-check"></i><b>2</b> Visualization 1</a>
<ul>
<li class="chapter" data-level="2.1" data-path="visualization-1.html"><a href="visualization-1.html#learning-goals"><i class="fa fa-check"></i><b>2.1</b> Learning goals</a></li>
<li class="chapter" data-level="2.2" data-path="visualization-1.html"><a href="visualization-1.html#load-packages"><i class="fa fa-check"></i><b>2.2</b> Load packages</a></li>
<li class="chapter" data-level="2.3" data-path="visualization-1.html"><a href="visualization-1.html#why-visualize-data"><i class="fa fa-check"></i><b>2.3</b> Why visualize data?</a></li>
<li class="chapter" data-level="2.4" data-path="visualization-1.html"><a href="visualization-1.html#some-basics"><i class="fa fa-check"></i><b>2.4</b> Some basics</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="visualization-1.html"><a href="visualization-1.html#setting-up-rstudio"><i class="fa fa-check"></i><b>2.4.1</b> Setting up RStudio</a></li>
<li class="chapter" data-level="2.4.2" data-path="visualization-1.html"><a href="visualization-1.html#getting-help"><i class="fa fa-check"></i><b>2.4.2</b> Getting help</a></li>
<li class="chapter" data-level="2.4.3" data-path="visualization-1.html"><a href="visualization-1.html#r-markdown-infos"><i class="fa fa-check"></i><b>2.4.3</b> R Markdown infos</a></li>
<li class="chapter" data-level="2.4.4" data-path="visualization-1.html"><a href="visualization-1.html#helpful-keyboard-shortcuts"><i class="fa fa-check"></i><b>2.4.4</b> Helpful keyboard shortcuts</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="visualization-1.html"><a href="visualization-1.html#data-visualization"><i class="fa fa-check"></i><b>2.5</b> Data visualization</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="visualization-1.html"><a href="visualization-1.html#setting-up-a-plot"><i class="fa fa-check"></i><b>2.5.1</b> Setting up a plot</a></li>
<li class="chapter" data-level="2.5.2" data-path="visualization-1.html"><a href="visualization-1.html#bar-plot"><i class="fa fa-check"></i><b>2.5.2</b> Bar plot</a></li>
<li class="chapter" data-level="2.5.3" data-path="visualization-1.html"><a href="visualization-1.html#setting-the-default-plot-theme"><i class="fa fa-check"></i><b>2.5.3</b> Setting the default plot theme</a></li>
<li class="chapter" data-level="2.5.4" data-path="visualization-1.html"><a href="visualization-1.html#scatter-plot"><i class="fa fa-check"></i><b>2.5.4</b> Scatter plot</a></li>
<li class="chapter" data-level="2.5.5" data-path="visualization-1.html"><a href="visualization-1.html#line-plot"><i class="fa fa-check"></i><b>2.5.5</b> Line plot</a></li>
<li class="chapter" data-level="2.5.6" data-path="visualization-1.html"><a href="visualization-1.html#adding-error-bars"><i class="fa fa-check"></i><b>2.5.6</b> Adding error bars</a></li>
<li class="chapter" data-level="2.5.7" data-path="visualization-1.html"><a href="visualization-1.html#order-matters"><i class="fa fa-check"></i><b>2.5.7</b> Order matters</a></li>
<li class="chapter" data-level="2.5.8" data-path="visualization-1.html"><a href="visualization-1.html#grouping-data"><i class="fa fa-check"></i><b>2.5.8</b> Grouping data</a></li>
<li class="chapter" data-level="2.5.9" data-path="visualization-1.html"><a href="visualization-1.html#making-facets"><i class="fa fa-check"></i><b>2.5.9</b> Making facets</a></li>
<li class="chapter" data-level="2.5.10" data-path="visualization-1.html"><a href="visualization-1.html#global-local-and-setting-aes"><i class="fa fa-check"></i><b>2.5.10</b> Global, local, and setting <code>aes()</code></a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="visualization-1.html"><a href="visualization-1.html#additional-resources"><i class="fa fa-check"></i><b>2.6</b> Additional resources</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="visualization-1.html"><a href="visualization-1.html#cheatsheets"><i class="fa fa-check"></i><b>2.6.1</b> Cheatsheets</a></li>
<li class="chapter" data-level="2.6.2" data-path="visualization-1.html"><a href="visualization-1.html#datacamp-courses"><i class="fa fa-check"></i><b>2.6.2</b> Datacamp courses</a></li>
<li class="chapter" data-level="2.6.3" data-path="visualization-1.html"><a href="visualization-1.html#books-and-chapters"><i class="fa fa-check"></i><b>2.6.3</b> Books and chapters</a></li>
<li class="chapter" data-level="2.6.4" data-path="visualization-1.html"><a href="visualization-1.html#misc"><i class="fa fa-check"></i><b>2.6.4</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="visualization-1.html"><a href="visualization-1.html#session-info-1"><i class="fa fa-check"></i><b>2.7</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="visualization-2.html"><a href="visualization-2.html"><i class="fa fa-check"></i><b>3</b> Visualization 2</a>
<ul>
<li class="chapter" data-level="3.1" data-path="visualization-2.html"><a href="visualization-2.html#learning-objectives"><i class="fa fa-check"></i><b>3.1</b> Learning objectives</a></li>
<li class="chapter" data-level="3.2" data-path="visualization-2.html"><a href="visualization-2.html#install-and-load-packages-load-data-set-theme"><i class="fa fa-check"></i><b>3.2</b> Install and load packages, load data, set theme</a></li>
<li class="chapter" data-level="3.3" data-path="visualization-2.html"><a href="visualization-2.html#overview-of-different-plot-types-for-different-things"><i class="fa fa-check"></i><b>3.3</b> Overview of different plot types for different things</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="visualization-2.html"><a href="visualization-2.html#proportions"><i class="fa fa-check"></i><b>3.3.1</b> Proportions</a></li>
<li class="chapter" data-level="3.3.2" data-path="visualization-2.html"><a href="visualization-2.html#comparisons"><i class="fa fa-check"></i><b>3.3.2</b> Comparisons</a></li>
<li class="chapter" data-level="3.3.3" data-path="visualization-2.html"><a href="visualization-2.html#relationships"><i class="fa fa-check"></i><b>3.3.3</b> Relationships</a></li>
<li class="chapter" data-level="3.3.4" data-path="visualization-2.html"><a href="visualization-2.html#temporal-data"><i class="fa fa-check"></i><b>3.3.4</b> Temporal data</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="visualization-2.html"><a href="visualization-2.html#customizing-plots"><i class="fa fa-check"></i><b>3.4</b> Customizing plots</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="visualization-2.html"><a href="visualization-2.html#anatomy-of-a-ggplot"><i class="fa fa-check"></i><b>3.4.1</b> Anatomy of a <code>ggplot</code></a></li>
<li class="chapter" data-level="3.4.2" data-path="visualization-2.html"><a href="visualization-2.html#changing-the-order-of-things"><i class="fa fa-check"></i><b>3.4.2</b> Changing the order of things</a></li>
<li class="chapter" data-level="3.4.3" data-path="visualization-2.html"><a href="visualization-2.html#dealing-with-legends"><i class="fa fa-check"></i><b>3.4.3</b> Dealing with legends</a></li>
<li class="chapter" data-level="3.4.4" data-path="visualization-2.html"><a href="visualization-2.html#choosing-good-colors"><i class="fa fa-check"></i><b>3.4.4</b> Choosing good colors</a></li>
<li class="chapter" data-level="3.4.5" data-path="visualization-2.html"><a href="visualization-2.html#customizing-themes"><i class="fa fa-check"></i><b>3.4.5</b> Customizing themes</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="visualization-2.html"><a href="visualization-2.html#saving-plots"><i class="fa fa-check"></i><b>3.5</b> Saving plots</a></li>
<li class="chapter" data-level="3.6" data-path="visualization-2.html"><a href="visualization-2.html#creating-figure-panels"><i class="fa fa-check"></i><b>3.6</b> Creating figure panels</a></li>
<li class="chapter" data-level="3.7" data-path="visualization-2.html"><a href="visualization-2.html#peeking-behind-the-scenes"><i class="fa fa-check"></i><b>3.7</b> Peeking behind the scenes</a></li>
<li class="chapter" data-level="3.8" data-path="visualization-2.html"><a href="visualization-2.html#making-animations"><i class="fa fa-check"></i><b>3.8</b> Making animations</a></li>
<li class="chapter" data-level="3.9" data-path="visualization-2.html"><a href="visualization-2.html#shiny-apps"><i class="fa fa-check"></i><b>3.9</b> Shiny apps</a></li>
<li class="chapter" data-level="3.10" data-path="visualization-2.html"><a href="visualization-2.html#defining-snippets"><i class="fa fa-check"></i><b>3.10</b> Defining snippets</a></li>
<li class="chapter" data-level="3.11" data-path="visualization-2.html"><a href="visualization-2.html#additional-resources-1"><i class="fa fa-check"></i><b>3.11</b> Additional resources</a>
<ul>
<li class="chapter" data-level="3.11.1" data-path="visualization-2.html"><a href="visualization-2.html#cheatsheets-1"><i class="fa fa-check"></i><b>3.11.1</b> Cheatsheets</a></li>
<li class="chapter" data-level="3.11.2" data-path="visualization-2.html"><a href="visualization-2.html#data-camp-courses"><i class="fa fa-check"></i><b>3.11.2</b> Data camp courses</a></li>
<li class="chapter" data-level="3.11.3" data-path="visualization-2.html"><a href="visualization-2.html#books-and-chapters-1"><i class="fa fa-check"></i><b>3.11.3</b> Books and chapters</a></li>
<li class="chapter" data-level="3.11.4" data-path="visualization-2.html"><a href="visualization-2.html#misc-1"><i class="fa fa-check"></i><b>3.11.4</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="3.12" data-path="visualization-2.html"><a href="visualization-2.html#session-info-2"><i class="fa fa-check"></i><b>3.12</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html"><i class="fa fa-check"></i><b>4</b> Data wrangling 1</a>
<ul>
<li class="chapter" data-level="4.1" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#learning-goals-1"><i class="fa fa-check"></i><b>4.1</b> Learning goals</a></li>
<li class="chapter" data-level="4.2" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#load-packages-1"><i class="fa fa-check"></i><b>4.2</b> Load packages</a></li>
<li class="chapter" data-level="4.3" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#some-r-basics"><i class="fa fa-check"></i><b>4.3</b> Some R basics</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#modes"><i class="fa fa-check"></i><b>4.3.1</b> Modes</a></li>
<li class="chapter" data-level="4.3.2" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#data-types"><i class="fa fa-check"></i><b>4.3.2</b> Data types</a></li>
<li class="chapter" data-level="4.3.3" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#operators"><i class="fa fa-check"></i><b>4.3.3</b> Operators</a></li>
<li class="chapter" data-level="4.3.4" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#control-flow"><i class="fa fa-check"></i><b>4.3.4</b> Control flow</a></li>
<li class="chapter" data-level="4.3.5" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#functions"><i class="fa fa-check"></i><b>4.3.5</b> Functions</a></li>
<li class="chapter" data-level="4.3.6" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#the-pipe-operator"><i class="fa fa-check"></i><b>4.3.6</b> The pipe operator <code>%&gt;%</code></a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#a-quick-note-on-naming-things"><i class="fa fa-check"></i><b>4.4</b> A quick note on naming things</a></li>
<li class="chapter" data-level="4.5" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#looking-at-data"><i class="fa fa-check"></i><b>4.5</b> Looking at data</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#head"><i class="fa fa-check"></i><b>4.5.1</b> <code>head()</code></a></li>
<li class="chapter" data-level="4.5.2" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#glimpse"><i class="fa fa-check"></i><b>4.5.2</b> <code>glimpse()</code></a></li>
<li class="chapter" data-level="4.5.3" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#distinct"><i class="fa fa-check"></i><b>4.5.3</b> <code>distinct()</code></a></li>
<li class="chapter" data-level="4.5.4" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#count"><i class="fa fa-check"></i><b>4.5.4</b> <code>count()</code></a></li>
<li class="chapter" data-level="4.5.5" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#datatable"><i class="fa fa-check"></i><b>4.5.5</b> <code>datatable()</code></a></li>
<li class="chapter" data-level="4.5.6" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#other-tools-for-taking-a-quick-look-at-data"><i class="fa fa-check"></i><b>4.5.6</b> Other tools for taking a quick look at data</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#wrangling-data"><i class="fa fa-check"></i><b>4.6</b> Wrangling data</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#filter"><i class="fa fa-check"></i><b>4.6.1</b> <code>filter()</code></a></li>
<li class="chapter" data-level="4.6.2" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#arrange"><i class="fa fa-check"></i><b>4.6.2</b> <code>arrange()</code></a></li>
<li class="chapter" data-level="4.6.3" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#rename"><i class="fa fa-check"></i><b>4.6.3</b> <code>rename()</code></a></li>
<li class="chapter" data-level="4.6.4" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#relocate"><i class="fa fa-check"></i><b>4.6.4</b> <code>relocate()</code></a></li>
<li class="chapter" data-level="4.6.5" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#select"><i class="fa fa-check"></i><b>4.6.5</b> <code>select()</code></a></li>
<li class="chapter" data-level="4.6.6" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#practice-2"><i class="fa fa-check"></i><b>4.6.6</b> Practice 2</a></li>
<li class="chapter" data-level="4.6.7" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#mutate"><i class="fa fa-check"></i><b>4.6.7</b> <code>mutate()</code></a></li>
<li class="chapter" data-level="4.6.8" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#practice-3"><i class="fa fa-check"></i><b>4.6.8</b> Practice 3</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#additional-resources-2"><i class="fa fa-check"></i><b>4.7</b> Additional resources</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#cheatsheets-2"><i class="fa fa-check"></i><b>4.7.1</b> Cheatsheets</a></li>
<li class="chapter" data-level="4.7.2" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#data-camp-courses-1"><i class="fa fa-check"></i><b>4.7.2</b> Data camp courses</a></li>
<li class="chapter" data-level="4.7.3" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#books-and-chapters-2"><i class="fa fa-check"></i><b>4.7.3</b> Books and chapters</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#session-info-3"><i class="fa fa-check"></i><b>4.8</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html"><i class="fa fa-check"></i><b>5</b> Data wrangling 2</a>
<ul>
<li class="chapter" data-level="5.1" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#learning-goals-2"><i class="fa fa-check"></i><b>5.1</b> Learning goals</a></li>
<li class="chapter" data-level="5.2" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#load-packages-2"><i class="fa fa-check"></i><b>5.2</b> Load packages</a></li>
<li class="chapter" data-level="5.3" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#settings"><i class="fa fa-check"></i><b>5.3</b> Settings</a></li>
<li class="chapter" data-level="5.4" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#wrangling-data-continued"><i class="fa fa-check"></i><b>5.4</b> Wrangling data (continued)</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#summarizing-data"><i class="fa fa-check"></i><b>5.4.1</b> Summarizing data</a></li>
<li class="chapter" data-level="5.4.2" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#reshaping-data"><i class="fa fa-check"></i><b>5.4.2</b> Reshaping data</a></li>
<li class="chapter" data-level="5.4.3" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#joining-multiple-data-frames"><i class="fa fa-check"></i><b>5.4.3</b> Joining multiple data frames</a></li>
<li class="chapter" data-level="5.4.4" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#dealing-with-missing-data"><i class="fa fa-check"></i><b>5.4.4</b> Dealing with missing data</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#reading-in-data"><i class="fa fa-check"></i><b>5.5</b> Reading in data</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#csv"><i class="fa fa-check"></i><b>5.5.1</b> csv</a></li>
<li class="chapter" data-level="5.5.2" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#rdata"><i class="fa fa-check"></i><b>5.5.2</b> RData</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#saving-data"><i class="fa fa-check"></i><b>5.6</b> Saving data</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#csv-1"><i class="fa fa-check"></i><b>5.6.1</b> csv</a></li>
<li class="chapter" data-level="5.6.2" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#rdata-1"><i class="fa fa-check"></i><b>5.6.2</b> RData</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#additional-resources-3"><i class="fa fa-check"></i><b>5.7</b> Additional resources</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#cheatsheets-3"><i class="fa fa-check"></i><b>5.7.1</b> Cheatsheets</a></li>
<li class="chapter" data-level="5.7.2" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#data-camp-courses-2"><i class="fa fa-check"></i><b>5.7.2</b> Data camp courses</a></li>
<li class="chapter" data-level="5.7.3" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#books-and-chapters-3"><i class="fa fa-check"></i><b>5.7.3</b> Books and chapters</a></li>
<li class="chapter" data-level="5.7.4" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#tutorials"><i class="fa fa-check"></i><b>5.7.4</b> Tutorials</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#session-info-4"><i class="fa fa-check"></i><b>5.8</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="probability-and-causality.html"><a href="probability-and-causality.html"><i class="fa fa-check"></i><b>6</b> Probability and causality</a>
<ul>
<li class="chapter" data-level="6.1" data-path="probability-and-causality.html"><a href="probability-and-causality.html#load-packages-load-data-set-theme"><i class="fa fa-check"></i><b>6.1</b> Load packages, load data, set theme</a></li>
<li class="chapter" data-level="6.2" data-path="probability-and-causality.html"><a href="probability-and-causality.html#counting"><i class="fa fa-check"></i><b>6.2</b> Counting</a></li>
<li class="chapter" data-level="6.3" data-path="probability-and-causality.html"><a href="probability-and-causality.html#the-random-secretary"><i class="fa fa-check"></i><b>6.3</b> The random secretary</a></li>
<li class="chapter" data-level="6.4" data-path="probability-and-causality.html"><a href="probability-and-causality.html#flipping-a-coin-many-times"><i class="fa fa-check"></i><b>6.4</b> Flipping a coin many times</a></li>
<li class="chapter" data-level="6.5" data-path="probability-and-causality.html"><a href="probability-and-causality.html#clue-guide-to-probability"><i class="fa fa-check"></i><b>6.5</b> Clue guide to probability</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="probability-and-causality.html"><a href="probability-and-causality.html#conditional-probability"><i class="fa fa-check"></i><b>6.5.1</b> Conditional probability</a></li>
<li class="chapter" data-level="6.5.2" data-path="probability-and-causality.html"><a href="probability-and-causality.html#law-of-total-probability"><i class="fa fa-check"></i><b>6.5.2</b> Law of total probability</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="probability-and-causality.html"><a href="probability-and-causality.html#probability-operations"><i class="fa fa-check"></i><b>6.6</b> Probability operations</a></li>
<li class="chapter" data-level="6.7" data-path="probability-and-causality.html"><a href="probability-and-causality.html#bayesian-reasoning-example"><i class="fa fa-check"></i><b>6.7</b> Bayesian reasoning example</a></li>
<li class="chapter" data-level="6.8" data-path="probability-and-causality.html"><a href="probability-and-causality.html#bayesian-networks"><i class="fa fa-check"></i><b>6.8</b> Bayesian networks</a>
<ul>
<li class="chapter" data-level="6.8.1" data-path="probability-and-causality.html"><a href="probability-and-causality.html#sprinkler-example"><i class="fa fa-check"></i><b>6.8.1</b> Sprinkler example</a></li>
</ul></li>
<li class="chapter" data-level="6.9" data-path="probability-and-causality.html"><a href="probability-and-causality.html#additional-resources-4"><i class="fa fa-check"></i><b>6.9</b> Additional resources</a>
<ul>
<li class="chapter" data-level="6.9.1" data-path="probability-and-causality.html"><a href="probability-and-causality.html#cheatsheets-4"><i class="fa fa-check"></i><b>6.9.1</b> Cheatsheets</a></li>
<li class="chapter" data-level="6.9.2" data-path="probability-and-causality.html"><a href="probability-and-causality.html#books-and-chapters-4"><i class="fa fa-check"></i><b>6.9.2</b> Books and chapters</a></li>
<li class="chapter" data-level="6.9.3" data-path="probability-and-causality.html"><a href="probability-and-causality.html#misc-2"><i class="fa fa-check"></i><b>6.9.3</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="6.10" data-path="probability-and-causality.html"><a href="probability-and-causality.html#session-info-5"><i class="fa fa-check"></i><b>6.10</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="simulation-1.html"><a href="simulation-1.html"><i class="fa fa-check"></i><b>7</b> Simulation 1</a>
<ul>
<li class="chapter" data-level="7.1" data-path="simulation-1.html"><a href="simulation-1.html#load-packages-and-set-plotting-theme"><i class="fa fa-check"></i><b>7.1</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="7.2" data-path="simulation-1.html"><a href="simulation-1.html#sampling"><i class="fa fa-check"></i><b>7.2</b> Sampling</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="simulation-1.html"><a href="simulation-1.html#drawing-numbers-from-a-vector"><i class="fa fa-check"></i><b>7.2.1</b> Drawing numbers from a vector</a></li>
<li class="chapter" data-level="7.2.2" data-path="simulation-1.html"><a href="simulation-1.html#drawing-rows-from-a-data-frame"><i class="fa fa-check"></i><b>7.2.2</b> Drawing rows from a data frame</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="simulation-1.html"><a href="simulation-1.html#working-with-distributions"><i class="fa fa-check"></i><b>7.3</b> Working with distributions</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="simulation-1.html"><a href="simulation-1.html#plotting-distributions"><i class="fa fa-check"></i><b>7.3.1</b> Plotting distributions</a></li>
<li class="chapter" data-level="7.3.2" data-path="simulation-1.html"><a href="simulation-1.html#sampling-from-distributions"><i class="fa fa-check"></i><b>7.3.2</b> Sampling from distributions</a></li>
<li class="chapter" data-level="7.3.3" data-path="simulation-1.html"><a href="simulation-1.html#understanding-density"><i class="fa fa-check"></i><b>7.3.3</b> Understanding <code>density()</code></a></li>
<li class="chapter" data-level="7.3.4" data-path="simulation-1.html"><a href="simulation-1.html#cumulative-probability-distribution"><i class="fa fa-check"></i><b>7.3.4</b> Cumulative probability distribution</a></li>
<li class="chapter" data-level="7.3.5" data-path="simulation-1.html"><a href="simulation-1.html#inverse-cumulative-distribution"><i class="fa fa-check"></i><b>7.3.5</b> Inverse cumulative distribution</a></li>
<li class="chapter" data-level="7.3.6" data-path="simulation-1.html"><a href="simulation-1.html#computing-probabilities"><i class="fa fa-check"></i><b>7.3.6</b> Computing probabilities</a></li>
<li class="chapter" data-level="7.3.7" data-path="simulation-1.html"><a href="simulation-1.html#make-the-plot"><i class="fa fa-check"></i><b>7.3.7</b> Make the plot</a></li>
<li class="chapter" data-level="7.3.8" data-path="simulation-1.html"><a href="simulation-1.html#analytic-solutions"><i class="fa fa-check"></i><b>7.3.8</b> Analytic solutions</a></li>
<li class="chapter" data-level="7.3.9" data-path="simulation-1.html"><a href="simulation-1.html#sampling-solution"><i class="fa fa-check"></i><b>7.3.9</b> Sampling solution</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="simulation-1.html"><a href="simulation-1.html#bayesian-inference-with-the-normal-distribution"><i class="fa fa-check"></i><b>7.4</b> Bayesian inference with the normal distribution</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="simulation-1.html"><a href="simulation-1.html#analytic-solution"><i class="fa fa-check"></i><b>7.4.1</b> Analytic solution</a></li>
<li class="chapter" data-level="7.4.2" data-path="simulation-1.html"><a href="simulation-1.html#solution-via-sampling"><i class="fa fa-check"></i><b>7.4.2</b> Solution via sampling</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="simulation-1.html"><a href="simulation-1.html#additional-resources-5"><i class="fa fa-check"></i><b>7.5</b> Additional resources</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="simulation-1.html"><a href="simulation-1.html#cheatsheets-5"><i class="fa fa-check"></i><b>7.5.1</b> Cheatsheets</a></li>
<li class="chapter" data-level="7.5.2" data-path="simulation-1.html"><a href="simulation-1.html#datacamp"><i class="fa fa-check"></i><b>7.5.2</b> Datacamp</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="simulation-1.html"><a href="simulation-1.html#session-info-6"><i class="fa fa-check"></i><b>7.6</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="simulation-2.html"><a href="simulation-2.html"><i class="fa fa-check"></i><b>8</b> Simulation 2</a>
<ul>
<li class="chapter" data-level="8.1" data-path="simulation-2.html"><a href="simulation-2.html#load-packages-and-set-plotting-theme-1"><i class="fa fa-check"></i><b>8.1</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="8.2" data-path="simulation-2.html"><a href="simulation-2.html#making-statistical-inferences-frequentist-style"><i class="fa fa-check"></i><b>8.2</b> Making statistical inferences (frequentist style)</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="simulation-2.html"><a href="simulation-2.html#population-distribution"><i class="fa fa-check"></i><b>8.2.1</b> Population distribution</a></li>
<li class="chapter" data-level="8.2.2" data-path="simulation-2.html"><a href="simulation-2.html#distribution-of-a-single-sample"><i class="fa fa-check"></i><b>8.2.2</b> Distribution of a single sample</a></li>
<li class="chapter" data-level="8.2.3" data-path="simulation-2.html"><a href="simulation-2.html#the-sampling-distribution"><i class="fa fa-check"></i><b>8.2.3</b> The sampling distribution</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="simulation-2.html"><a href="simulation-2.html#understanding-p-values"><i class="fa fa-check"></i><b>8.3</b> Understanding p-values</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="simulation-2.html"><a href="simulation-2.html#permutation-test"><i class="fa fa-check"></i><b>8.3.1</b> Permutation test</a></li>
<li class="chapter" data-level="8.3.2" data-path="simulation-2.html"><a href="simulation-2.html#t-test-by-hand"><i class="fa fa-check"></i><b>8.3.2</b> t-test by hand</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="simulation-2.html"><a href="simulation-2.html#confidence-intervals"><i class="fa fa-check"></i><b>8.4</b> Confidence intervals</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="simulation-2.html"><a href="simulation-2.html#mean_cl_boot-explained"><i class="fa fa-check"></i><b>8.4.1</b> <code>mean_cl_boot()</code> explained</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="simulation-2.html"><a href="simulation-2.html#additional-resources-6"><i class="fa fa-check"></i><b>8.5</b> Additional resources</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="simulation-2.html"><a href="simulation-2.html#datacamp-1"><i class="fa fa-check"></i><b>8.5.1</b> Datacamp</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="simulation-2.html"><a href="simulation-2.html#session-info-7"><i class="fa fa-check"></i><b>8.6</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="modeling-data.html"><a href="modeling-data.html"><i class="fa fa-check"></i><b>9</b> Modeling data</a>
<ul>
<li class="chapter" data-level="9.1" data-path="modeling-data.html"><a href="modeling-data.html#load-packages-and-set-plotting-theme-2"><i class="fa fa-check"></i><b>9.1</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="9.2" data-path="modeling-data.html"><a href="modeling-data.html#modeling-data-1"><i class="fa fa-check"></i><b>9.2</b> Modeling data</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="modeling-data.html"><a href="modeling-data.html#simplicity-vs.-accuracy-trade-off"><i class="fa fa-check"></i><b>9.2.1</b> Simplicity vs. accuracy trade-off</a></li>
<li class="chapter" data-level="9.2.2" data-path="modeling-data.html"><a href="modeling-data.html#error-definitions-and-best-estimators"><i class="fa fa-check"></i><b>9.2.2</b> Error definitions and best estimators</a></li>
<li class="chapter" data-level="9.2.3" data-path="modeling-data.html"><a href="modeling-data.html#sampling-distributions-for-median-and-mean"><i class="fa fa-check"></i><b>9.2.3</b> Sampling distributions for median and mean</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="modeling-data.html"><a href="modeling-data.html#hypothesis-testing-one-sample-t-test"><i class="fa fa-check"></i><b>9.3</b> Hypothesis testing: “One-sample t-test”</a></li>
<li class="chapter" data-level="9.4" data-path="modeling-data.html"><a href="modeling-data.html#building-a-sampling-distribution-of-pre"><i class="fa fa-check"></i><b>9.4</b> Building a sampling distribution of PRE</a></li>
<li class="chapter" data-level="9.5" data-path="modeling-data.html"><a href="modeling-data.html#additional-resources-7"><i class="fa fa-check"></i><b>9.5</b> Additional resources</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="modeling-data.html"><a href="modeling-data.html#reading"><i class="fa fa-check"></i><b>9.5.1</b> Reading</a></li>
<li class="chapter" data-level="9.5.2" data-path="modeling-data.html"><a href="modeling-data.html#datacamp-2"><i class="fa fa-check"></i><b>9.5.2</b> Datacamp</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="modeling-data.html"><a href="modeling-data.html#session-info-8"><i class="fa fa-check"></i><b>9.6</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="linear-model-1.html"><a href="linear-model-1.html"><i class="fa fa-check"></i><b>10</b> Linear model 1</a>
<ul>
<li class="chapter" data-level="10.1" data-path="linear-model-1.html"><a href="linear-model-1.html#load-packages-and-set-plotting-theme-3"><i class="fa fa-check"></i><b>10.1</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="10.2" data-path="linear-model-1.html"><a href="linear-model-1.html#correlation"><i class="fa fa-check"></i><b>10.2</b> Correlation</a></li>
<li class="chapter" data-level="10.3" data-path="linear-model-1.html"><a href="linear-model-1.html#regression"><i class="fa fa-check"></i><b>10.3</b> Regression</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="linear-model-1.html"><a href="linear-model-1.html#define-and-fit-the-models"><i class="fa fa-check"></i><b>10.3.1</b> Define and fit the models</a></li>
<li class="chapter" data-level="10.3.2" data-path="linear-model-1.html"><a href="linear-model-1.html#calculate-the-sum-of-squared-errors-of-each-model"><i class="fa fa-check"></i><b>10.3.2</b> Calculate the sum of squared errors of each model</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="linear-model-1.html"><a href="linear-model-1.html#credit-example"><i class="fa fa-check"></i><b>10.4</b> Credit example</a></li>
<li class="chapter" data-level="10.5" data-path="linear-model-1.html"><a href="linear-model-1.html#additional-resources-8"><i class="fa fa-check"></i><b>10.5</b> Additional resources</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="linear-model-1.html"><a href="linear-model-1.html#datacamp-3"><i class="fa fa-check"></i><b>10.5.1</b> Datacamp</a></li>
<li class="chapter" data-level="10.5.2" data-path="linear-model-1.html"><a href="linear-model-1.html#misc-3"><i class="fa fa-check"></i><b>10.5.2</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="linear-model-1.html"><a href="linear-model-1.html#session-info-9"><i class="fa fa-check"></i><b>10.6</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="linear-model-2.html"><a href="linear-model-2.html"><i class="fa fa-check"></i><b>11</b> Linear model 2</a>
<ul>
<li class="chapter" data-level="11.1" data-path="linear-model-2.html"><a href="linear-model-2.html#learning-goals-3"><i class="fa fa-check"></i><b>11.1</b> Learning goals</a></li>
<li class="chapter" data-level="11.2" data-path="linear-model-2.html"><a href="linear-model-2.html#load-packages-and-set-plotting-theme-4"><i class="fa fa-check"></i><b>11.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="11.3" data-path="linear-model-2.html"><a href="linear-model-2.html#load-data-sets"><i class="fa fa-check"></i><b>11.3</b> Load data sets</a></li>
<li class="chapter" data-level="11.4" data-path="linear-model-2.html"><a href="linear-model-2.html#multiple-continuous-variables"><i class="fa fa-check"></i><b>11.4</b> Multiple continuous variables</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="linear-model-2.html"><a href="linear-model-2.html#explore-correlations"><i class="fa fa-check"></i><b>11.4.1</b> Explore correlations</a></li>
<li class="chapter" data-level="11.4.2" data-path="linear-model-2.html"><a href="linear-model-2.html#multipe-regression"><i class="fa fa-check"></i><b>11.4.2</b> Multipe regression</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="linear-model-2.html"><a href="linear-model-2.html#one-categorical-variable"><i class="fa fa-check"></i><b>11.5</b> One categorical variable</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="linear-model-2.html"><a href="linear-model-2.html#visualization-of-the-model-predictions"><i class="fa fa-check"></i><b>11.5.1</b> Visualization of the model predictions</a></li>
<li class="chapter" data-level="11.5.2" data-path="linear-model-2.html"><a href="linear-model-2.html#dummy-coding"><i class="fa fa-check"></i><b>11.5.2</b> Dummy coding</a></li>
<li class="chapter" data-level="11.5.3" data-path="linear-model-2.html"><a href="linear-model-2.html#reporting-the-results"><i class="fa fa-check"></i><b>11.5.3</b> Reporting the results</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="linear-model-2.html"><a href="linear-model-2.html#one-continuous-and-one-categorical-variable"><i class="fa fa-check"></i><b>11.6</b> One continuous and one categorical variable</a>
<ul>
<li class="chapter" data-level="11.6.1" data-path="linear-model-2.html"><a href="linear-model-2.html#visualization-of-the-model-predictions-1"><i class="fa fa-check"></i><b>11.6.1</b> Visualization of the model predictions</a></li>
</ul></li>
<li class="chapter" data-level="11.7" data-path="linear-model-2.html"><a href="linear-model-2.html#interactions"><i class="fa fa-check"></i><b>11.7</b> Interactions</a>
<ul>
<li class="chapter" data-level="11.7.1" data-path="linear-model-2.html"><a href="linear-model-2.html#visualization-3"><i class="fa fa-check"></i><b>11.7.1</b> Visualization</a></li>
<li class="chapter" data-level="11.7.2" data-path="linear-model-2.html"><a href="linear-model-2.html#hypothesis-test"><i class="fa fa-check"></i><b>11.7.2</b> Hypothesis test</a></li>
</ul></li>
<li class="chapter" data-level="11.8" data-path="linear-model-2.html"><a href="linear-model-2.html#additional-resources-9"><i class="fa fa-check"></i><b>11.8</b> Additional resources</a>
<ul>
<li class="chapter" data-level="11.8.1" data-path="linear-model-2.html"><a href="linear-model-2.html#datacamp-4"><i class="fa fa-check"></i><b>11.8.1</b> Datacamp</a></li>
<li class="chapter" data-level="11.8.2" data-path="linear-model-2.html"><a href="linear-model-2.html#misc-4"><i class="fa fa-check"></i><b>11.8.2</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="11.9" data-path="linear-model-2.html"><a href="linear-model-2.html#session-info-10"><i class="fa fa-check"></i><b>11.9</b> Session info</a></li>
<li class="chapter" data-level="11.10" data-path="linear-model-2.html"><a href="linear-model-2.html#references"><i class="fa fa-check"></i><b>11.10</b> References</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="linear-model-3.html"><a href="linear-model-3.html"><i class="fa fa-check"></i><b>12</b> Linear model 3</a>
<ul>
<li class="chapter" data-level="12.1" data-path="linear-model-3.html"><a href="linear-model-3.html#learning-goals-4"><i class="fa fa-check"></i><b>12.1</b> Learning goals</a></li>
<li class="chapter" data-level="12.2" data-path="linear-model-3.html"><a href="linear-model-3.html#load-packages-and-set-plotting-theme-5"><i class="fa fa-check"></i><b>12.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="12.3" data-path="linear-model-3.html"><a href="linear-model-3.html#load-data-sets-1"><i class="fa fa-check"></i><b>12.3</b> Load data sets</a></li>
<li class="chapter" data-level="12.4" data-path="linear-model-3.html"><a href="linear-model-3.html#one-way-anova"><i class="fa fa-check"></i><b>12.4</b> One-way ANOVA</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="linear-model-3.html"><a href="linear-model-3.html#visualization-4"><i class="fa fa-check"></i><b>12.4.1</b> Visualization</a></li>
<li class="chapter" data-level="12.4.2" data-path="linear-model-3.html"><a href="linear-model-3.html#model-fitting"><i class="fa fa-check"></i><b>12.4.2</b> Model fitting</a></li>
<li class="chapter" data-level="12.4.3" data-path="linear-model-3.html"><a href="linear-model-3.html#hypothesis-test-1"><i class="fa fa-check"></i><b>12.4.3</b> Hypothesis test</a></li>
<li class="chapter" data-level="12.4.4" data-path="linear-model-3.html"><a href="linear-model-3.html#visualize-the-models-predictions"><i class="fa fa-check"></i><b>12.4.4</b> Visualize the model’s predictions</a></li>
<li class="chapter" data-level="12.4.5" data-path="linear-model-3.html"><a href="linear-model-3.html#dummy-coding-1"><i class="fa fa-check"></i><b>12.4.5</b> Dummy coding</a></li>
<li class="chapter" data-level="12.4.6" data-path="linear-model-3.html"><a href="linear-model-3.html#follow-up-questions"><i class="fa fa-check"></i><b>12.4.6</b> Follow up questions</a></li>
<li class="chapter" data-level="12.4.7" data-path="linear-model-3.html"><a href="linear-model-3.html#variance-decomposition"><i class="fa fa-check"></i><b>12.4.7</b> Variance decomposition</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="linear-model-3.html"><a href="linear-model-3.html#two-way-anova"><i class="fa fa-check"></i><b>12.5</b> Two-way ANOVA</a>
<ul>
<li class="chapter" data-level="12.5.1" data-path="linear-model-3.html"><a href="linear-model-3.html#visualization-5"><i class="fa fa-check"></i><b>12.5.1</b> Visualization</a></li>
<li class="chapter" data-level="12.5.2" data-path="linear-model-3.html"><a href="linear-model-3.html#model-fitting-1"><i class="fa fa-check"></i><b>12.5.2</b> Model fitting</a></li>
<li class="chapter" data-level="12.5.3" data-path="linear-model-3.html"><a href="linear-model-3.html#interpreting-interactions"><i class="fa fa-check"></i><b>12.5.3</b> Interpreting interactions</a></li>
<li class="chapter" data-level="12.5.4" data-path="linear-model-3.html"><a href="linear-model-3.html#variance-decomposition-1"><i class="fa fa-check"></i><b>12.5.4</b> Variance decomposition</a></li>
</ul></li>
<li class="chapter" data-level="12.6" data-path="linear-model-3.html"><a href="linear-model-3.html#two-way-anova-with-interaction"><i class="fa fa-check"></i><b>12.6</b> Two-way ANOVA (with interaction)</a></li>
<li class="chapter" data-level="12.7" data-path="linear-model-3.html"><a href="linear-model-3.html#anova-with-unbalanced-design"><i class="fa fa-check"></i><b>12.7</b> ANOVA with unbalanced design</a></li>
<li class="chapter" data-level="12.8" data-path="linear-model-3.html"><a href="linear-model-3.html#interpreting-parameters-very-important"><i class="fa fa-check"></i><b>12.8</b> Interpreting parameters (very important!)</a></li>
<li class="chapter" data-level="12.9" data-path="linear-model-3.html"><a href="linear-model-3.html#additional-resources-10"><i class="fa fa-check"></i><b>12.9</b> Additional resources</a>
<ul>
<li class="chapter" data-level="12.9.1" data-path="linear-model-3.html"><a href="linear-model-3.html#datacamp-5"><i class="fa fa-check"></i><b>12.9.1</b> Datacamp</a></li>
<li class="chapter" data-level="12.9.2" data-path="linear-model-3.html"><a href="linear-model-3.html#misc-5"><i class="fa fa-check"></i><b>12.9.2</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="12.10" data-path="linear-model-3.html"><a href="linear-model-3.html#session-info-11"><i class="fa fa-check"></i><b>12.10</b> Session info</a></li>
<li class="chapter" data-level="12.11" data-path="linear-model-3.html"><a href="linear-model-3.html#references-1"><i class="fa fa-check"></i><b>12.11</b> References</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="linear-model-4.html"><a href="linear-model-4.html"><i class="fa fa-check"></i><b>13</b> Linear model 4</a>
<ul>
<li class="chapter" data-level="13.1" data-path="linear-model-4.html"><a href="linear-model-4.html#load-packages-and-set-plotting-theme-6"><i class="fa fa-check"></i><b>13.1</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="13.2" data-path="linear-model-4.html"><a href="linear-model-4.html#load-data-sets-2"><i class="fa fa-check"></i><b>13.2</b> Load data sets</a></li>
<li class="chapter" data-level="13.3" data-path="linear-model-4.html"><a href="linear-model-4.html#linear-contrasts"><i class="fa fa-check"></i><b>13.3</b> Linear contrasts</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="linear-model-4.html"><a href="linear-model-4.html#hypothetical-data"><i class="fa fa-check"></i><b>13.3.1</b> Hypothetical data</a></li>
<li class="chapter" data-level="13.3.2" data-path="linear-model-4.html"><a href="linear-model-4.html#visualization-6"><i class="fa fa-check"></i><b>13.3.2</b> Visualization</a></li>
<li class="chapter" data-level="13.3.3" data-path="linear-model-4.html"><a href="linear-model-4.html#post-hoc-tests"><i class="fa fa-check"></i><b>13.3.3</b> Post-hoc tests</a></li>
<li class="chapter" data-level="13.3.4" data-path="linear-model-4.html"><a href="linear-model-4.html#understanding-dummy-coding"><i class="fa fa-check"></i><b>13.3.4</b> Understanding dummy coding</a></li>
<li class="chapter" data-level="13.3.5" data-path="linear-model-4.html"><a href="linear-model-4.html#understanding-effect-coding"><i class="fa fa-check"></i><b>13.3.5</b> Understanding effect coding</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="linear-model-4.html"><a href="linear-model-4.html#session-info-12"><i class="fa fa-check"></i><b>13.4</b> Session info</a></li>
<li class="chapter" data-level="13.5" data-path="linear-model-4.html"><a href="linear-model-4.html#references-2"><i class="fa fa-check"></i><b>13.5</b> References</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="power-analysis.html"><a href="power-analysis.html"><i class="fa fa-check"></i><b>14</b> Power analysis</a>
<ul>
<li class="chapter" data-level="14.1" data-path="power-analysis.html"><a href="power-analysis.html#learning-goals-5"><i class="fa fa-check"></i><b>14.1</b> Learning goals</a></li>
<li class="chapter" data-level="14.2" data-path="power-analysis.html"><a href="power-analysis.html#load-packages-and-set-plotting-theme-7"><i class="fa fa-check"></i><b>14.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="14.3" data-path="power-analysis.html"><a href="power-analysis.html#load-data-sets-3"><i class="fa fa-check"></i><b>14.3</b> Load data sets</a></li>
<li class="chapter" data-level="14.4" data-path="power-analysis.html"><a href="power-analysis.html#decision-making"><i class="fa fa-check"></i><b>14.4</b> Decision-making</a></li>
<li class="chapter" data-level="14.5" data-path="power-analysis.html"><a href="power-analysis.html#effect-sizes"><i class="fa fa-check"></i><b>14.5</b> Effect sizes</a>
<ul>
<li class="chapter" data-level="14.5.1" data-path="power-analysis.html"><a href="power-analysis.html#cohens-d"><i class="fa fa-check"></i><b>14.5.1</b> Cohen’s d</a></li>
</ul></li>
<li class="chapter" data-level="14.6" data-path="power-analysis.html"><a href="power-analysis.html#determining-sample-size"><i class="fa fa-check"></i><b>14.6</b> Determining sample size</a>
<ul>
<li class="chapter" data-level="14.6.1" data-path="power-analysis.html"><a href="power-analysis.html#pwr-package"><i class="fa fa-check"></i><b>14.6.1</b> <code>pwr</code> package</a></li>
<li class="chapter" data-level="14.6.2" data-path="power-analysis.html"><a href="power-analysis.html#power-analysis-via-simulation"><i class="fa fa-check"></i><b>14.6.2</b> Power analysis via simulation</a></li>
</ul></li>
<li class="chapter" data-level="14.7" data-path="power-analysis.html"><a href="power-analysis.html#additional-resources-11"><i class="fa fa-check"></i><b>14.7</b> Additional resources</a>
<ul>
<li class="chapter" data-level="14.7.1" data-path="power-analysis.html"><a href="power-analysis.html#datacamp-6"><i class="fa fa-check"></i><b>14.7.1</b> Datacamp</a></li>
<li class="chapter" data-level="14.7.2" data-path="power-analysis.html"><a href="power-analysis.html#cheatsheets-6"><i class="fa fa-check"></i><b>14.7.2</b> Cheatsheets</a></li>
<li class="chapter" data-level="14.7.3" data-path="power-analysis.html"><a href="power-analysis.html#misc-6"><i class="fa fa-check"></i><b>14.7.3</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="14.8" data-path="power-analysis.html"><a href="power-analysis.html#session-info-13"><i class="fa fa-check"></i><b>14.8</b> Session info</a></li>
<li class="chapter" data-level="14.9" data-path="power-analysis.html"><a href="power-analysis.html#references-3"><i class="fa fa-check"></i><b>14.9</b> References</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="mediation-moderation.html"><a href="mediation-moderation.html"><i class="fa fa-check"></i><b>15</b> Mediation &amp; Moderation</a>
<ul>
<li class="chapter" data-level="15.1" data-path="mediation-moderation.html"><a href="mediation-moderation.html#learning-goals-6"><i class="fa fa-check"></i><b>15.1</b> Learning goals</a></li>
<li class="chapter" data-level="15.2" data-path="mediation-moderation.html"><a href="mediation-moderation.html#recommended-reading"><i class="fa fa-check"></i><b>15.2</b> Recommended reading</a></li>
<li class="chapter" data-level="15.3" data-path="mediation-moderation.html"><a href="mediation-moderation.html#load-packages-and-set-plotting-theme-8"><i class="fa fa-check"></i><b>15.3</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="15.4" data-path="mediation-moderation.html"><a href="mediation-moderation.html#controlling-for-variables"><i class="fa fa-check"></i><b>15.4</b> Controlling for variables</a>
<ul>
<li class="chapter" data-level="15.4.1" data-path="mediation-moderation.html"><a href="mediation-moderation.html#illustration-of-the-d-separation-algorithm"><i class="fa fa-check"></i><b>15.4.1</b> Illustration of the d-separation algorithm</a></li>
<li class="chapter" data-level="15.4.2" data-path="mediation-moderation.html"><a href="mediation-moderation.html#good-controls"><i class="fa fa-check"></i><b>15.4.2</b> Good controls</a></li>
<li class="chapter" data-level="15.4.3" data-path="mediation-moderation.html"><a href="mediation-moderation.html#bad-controls"><i class="fa fa-check"></i><b>15.4.3</b> Bad controls</a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="mediation-moderation.html"><a href="mediation-moderation.html#mediation"><i class="fa fa-check"></i><b>15.5</b> Mediation</a>
<ul>
<li class="chapter" data-level="15.5.1" data-path="mediation-moderation.html"><a href="mediation-moderation.html#generate-data"><i class="fa fa-check"></i><b>15.5.1</b> Generate data</a></li>
<li class="chapter" data-level="15.5.2" data-path="mediation-moderation.html"><a href="mediation-moderation.html#method-1-baron-kennys-1986-indirect-effect-method"><i class="fa fa-check"></i><b>15.5.2</b> Method 1: Baron &amp; Kenny’s (1986) indirect effect method</a></li>
<li class="chapter" data-level="15.5.3" data-path="mediation-moderation.html"><a href="mediation-moderation.html#method-2-sobel-test"><i class="fa fa-check"></i><b>15.5.3</b> Method 2: Sobel Test</a></li>
<li class="chapter" data-level="15.5.4" data-path="mediation-moderation.html"><a href="mediation-moderation.html#method-3-bootstrapping"><i class="fa fa-check"></i><b>15.5.4</b> Method 3: Bootstrapping</a></li>
</ul></li>
<li class="chapter" data-level="15.6" data-path="mediation-moderation.html"><a href="mediation-moderation.html#moderation"><i class="fa fa-check"></i><b>15.6</b> Moderation</a>
<ul>
<li class="chapter" data-level="15.6.1" data-path="mediation-moderation.html"><a href="mediation-moderation.html#generate-data-1"><i class="fa fa-check"></i><b>15.6.1</b> Generate data</a></li>
<li class="chapter" data-level="15.6.2" data-path="mediation-moderation.html"><a href="mediation-moderation.html#moderation-analysis"><i class="fa fa-check"></i><b>15.6.2</b> Moderation analysis</a></li>
</ul></li>
<li class="chapter" data-level="15.7" data-path="mediation-moderation.html"><a href="mediation-moderation.html#additional-resources-12"><i class="fa fa-check"></i><b>15.7</b> Additional resources</a>
<ul>
<li class="chapter" data-level="15.7.1" data-path="mediation-moderation.html"><a href="mediation-moderation.html#books"><i class="fa fa-check"></i><b>15.7.1</b> Books</a></li>
<li class="chapter" data-level="15.7.2" data-path="mediation-moderation.html"><a href="mediation-moderation.html#tutorials-1"><i class="fa fa-check"></i><b>15.7.2</b> Tutorials</a></li>
<li class="chapter" data-level="15.7.3" data-path="mediation-moderation.html"><a href="mediation-moderation.html#misc-7"><i class="fa fa-check"></i><b>15.7.3</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="15.8" data-path="mediation-moderation.html"><a href="mediation-moderation.html#session-info-14"><i class="fa fa-check"></i><b>15.8</b> Session info</a></li>
<li class="chapter" data-level="15.9" data-path="mediation-moderation.html"><a href="mediation-moderation.html#references-4"><i class="fa fa-check"></i><b>15.9</b> References</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="model-comparison.html"><a href="model-comparison.html"><i class="fa fa-check"></i><b>16</b> Model comparison</a>
<ul>
<li class="chapter" data-level="16.1" data-path="model-comparison.html"><a href="model-comparison.html#learning-goals-7"><i class="fa fa-check"></i><b>16.1</b> Learning goals</a></li>
<li class="chapter" data-level="16.2" data-path="model-comparison.html"><a href="model-comparison.html#load-packages-and-set-plotting-theme-9"><i class="fa fa-check"></i><b>16.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="16.3" data-path="model-comparison.html"><a href="model-comparison.html#model-comparison-1"><i class="fa fa-check"></i><b>16.3</b> Model comparison</a>
<ul>
<li class="chapter" data-level="16.3.1" data-path="model-comparison.html"><a href="model-comparison.html#fitting-vs.-predicting"><i class="fa fa-check"></i><b>16.3.1</b> Fitting vs. predicting</a></li>
<li class="chapter" data-level="16.3.2" data-path="model-comparison.html"><a href="model-comparison.html#f-test"><i class="fa fa-check"></i><b>16.3.2</b> F-test</a></li>
<li class="chapter" data-level="16.3.3" data-path="model-comparison.html"><a href="model-comparison.html#cross-validation"><i class="fa fa-check"></i><b>16.3.3</b> Cross-validation</a></li>
<li class="chapter" data-level="16.3.4" data-path="model-comparison.html"><a href="model-comparison.html#bootstrap"><i class="fa fa-check"></i><b>16.3.4</b> Bootstrap</a></li>
<li class="chapter" data-level="16.3.5" data-path="model-comparison.html"><a href="model-comparison.html#aic-and-bic"><i class="fa fa-check"></i><b>16.3.5</b> AIC and BIC</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="model-comparison.html"><a href="model-comparison.html#additional-resources-13"><i class="fa fa-check"></i><b>16.4</b> Additional resources</a>
<ul>
<li class="chapter" data-level="16.4.1" data-path="model-comparison.html"><a href="model-comparison.html#datacamp-course"><i class="fa fa-check"></i><b>16.4.1</b> Datacamp course</a></li>
<li class="chapter" data-level="16.4.2" data-path="model-comparison.html"><a href="model-comparison.html#reading-1"><i class="fa fa-check"></i><b>16.4.2</b> Reading</a></li>
</ul></li>
<li class="chapter" data-level="16.5" data-path="model-comparison.html"><a href="model-comparison.html#session-info-15"><i class="fa fa-check"></i><b>16.5</b> Session info</a></li>
<li class="chapter" data-level="16.6" data-path="model-comparison.html"><a href="model-comparison.html#references-5"><i class="fa fa-check"></i><b>16.6</b> References</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html"><i class="fa fa-check"></i><b>17</b> Linear mixed effects models 1</a>
<ul>
<li class="chapter" data-level="17.1" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html#learning-goals-8"><i class="fa fa-check"></i><b>17.1</b> Learning goals</a></li>
<li class="chapter" data-level="17.2" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html#load-packages-and-set-plotting-theme-10"><i class="fa fa-check"></i><b>17.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="17.3" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html#dependence"><i class="fa fa-check"></i><b>17.3</b> Dependence</a></li>
<li class="chapter" data-level="17.4" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html#additional-resources-14"><i class="fa fa-check"></i><b>17.4</b> Additional resources</a>
<ul>
<li class="chapter" data-level="17.4.1" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html#readings"><i class="fa fa-check"></i><b>17.4.1</b> Readings</a></li>
</ul></li>
<li class="chapter" data-level="17.5" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html#session-info-16"><i class="fa fa-check"></i><b>17.5</b> Session info</a></li>
<li class="chapter" data-level="17.6" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html#references-6"><i class="fa fa-check"></i><b>17.6</b> References</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html"><i class="fa fa-check"></i><b>18</b> Linear mixed effects models 2</a>
<ul>
<li class="chapter" data-level="18.1" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#learning-goals-9"><i class="fa fa-check"></i><b>18.1</b> Learning goals</a></li>
<li class="chapter" data-level="18.2" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#load-packages-and-set-plotting-theme-11"><i class="fa fa-check"></i><b>18.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="18.3" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#a-worked-example"><i class="fa fa-check"></i><b>18.3</b> A worked example</a>
<ul>
<li class="chapter" data-level="18.3.1" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#complete-pooling"><i class="fa fa-check"></i><b>18.3.1</b> Complete pooling</a></li>
<li class="chapter" data-level="18.3.2" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#no-pooling"><i class="fa fa-check"></i><b>18.3.2</b> No pooling</a></li>
<li class="chapter" data-level="18.3.3" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#partial-pooling"><i class="fa fa-check"></i><b>18.3.3</b> Partial pooling</a></li>
<li class="chapter" data-level="18.3.4" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#compare-results"><i class="fa fa-check"></i><b>18.3.4</b> Compare results</a></li>
<li class="chapter" data-level="18.3.5" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#getting-p-values"><i class="fa fa-check"></i><b>18.3.5</b> Getting p-values</a></li>
<li class="chapter" data-level="18.3.6" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#reporting-results"><i class="fa fa-check"></i><b>18.3.6</b> Reporting results</a></li>
<li class="chapter" data-level="18.3.7" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#the-effect-of-outliers"><i class="fa fa-check"></i><b>18.3.7</b> The effect of outliers</a></li>
<li class="chapter" data-level="18.3.8" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#different-slopes"><i class="fa fa-check"></i><b>18.3.8</b> Different slopes</a></li>
<li class="chapter" data-level="18.3.9" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#simpsons-paradox"><i class="fa fa-check"></i><b>18.3.9</b> Simpson’s paradox</a></li>
</ul></li>
<li class="chapter" data-level="18.4" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#additional-resources-15"><i class="fa fa-check"></i><b>18.4</b> Additional resources</a>
<ul>
<li class="chapter" data-level="18.4.1" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#readings-1"><i class="fa fa-check"></i><b>18.4.1</b> Readings</a></li>
</ul></li>
<li class="chapter" data-level="18.5" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#session-info-17"><i class="fa fa-check"></i><b>18.5</b> Session info</a></li>
<li class="chapter" data-level="18.6" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#references-7"><i class="fa fa-check"></i><b>18.6</b> References</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html"><i class="fa fa-check"></i><b>19</b> Linear mixed effects models 3</a>
<ul>
<li class="chapter" data-level="19.1" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#learning-goals-10"><i class="fa fa-check"></i><b>19.1</b> Learning goals</a></li>
<li class="chapter" data-level="19.2" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#load-packages-and-set-plotting-theme-12"><i class="fa fa-check"></i><b>19.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="19.3" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#load-data-sets-4"><i class="fa fa-check"></i><b>19.3</b> Load data sets</a>
<ul>
<li class="chapter" data-level="19.3.1" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#sleep-data"><i class="fa fa-check"></i><b>19.3.1</b> Sleep data</a></li>
<li class="chapter" data-level="19.3.2" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#reasoning-data"><i class="fa fa-check"></i><b>19.3.2</b> Reasoning data</a></li>
<li class="chapter" data-level="19.3.3" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#weight-loss-data"><i class="fa fa-check"></i><b>19.3.3</b> Weight loss data</a></li>
<li class="chapter" data-level="19.3.4" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#politness-data"><i class="fa fa-check"></i><b>19.3.4</b> Politness data</a></li>
</ul></li>
<li class="chapter" data-level="19.4" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#understanding-the-lmer-syntax"><i class="fa fa-check"></i><b>19.4</b> Understanding the lmer() syntax</a></li>
<li class="chapter" data-level="19.5" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#anova-vs.-lmer"><i class="fa fa-check"></i><b>19.5</b> ANOVA vs. Lmer</a>
<ul>
<li class="chapter" data-level="19.5.1" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#between-subjects-anova"><i class="fa fa-check"></i><b>19.5.1</b> Between subjects ANOVA</a></li>
<li class="chapter" data-level="19.5.2" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#repeated-measures-anova"><i class="fa fa-check"></i><b>19.5.2</b> Repeated-measures ANOVA</a></li>
<li class="chapter" data-level="19.5.3" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#mixed-anova"><i class="fa fa-check"></i><b>19.5.3</b> Mixed ANOVA</a></li>
</ul></li>
<li class="chapter" data-level="19.6" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#follow-up-tests-with-emmeans"><i class="fa fa-check"></i><b>19.6</b> Follow-up tests with emmeans</a>
<ul>
<li class="chapter" data-level="19.6.1" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#sleep-study"><i class="fa fa-check"></i><b>19.6.1</b> Sleep study</a></li>
<li class="chapter" data-level="19.6.2" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#weight-loss-study"><i class="fa fa-check"></i><b>19.6.2</b> Weight loss study</a></li>
<li class="chapter" data-level="19.6.3" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#politeness-study"><i class="fa fa-check"></i><b>19.6.3</b> Politeness study</a></li>
</ul></li>
<li class="chapter" data-level="19.7" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#mixtures-of-participants"><i class="fa fa-check"></i><b>19.7</b> Mixtures of participants</a></li>
<li class="chapter" data-level="19.8" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#bootstrapping"><i class="fa fa-check"></i><b>19.8</b> Bootstrapping</a>
<ul>
<li class="chapter" data-level="19.8.1" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#linear-model"><i class="fa fa-check"></i><b>19.8.1</b> Linear model</a></li>
</ul></li>
<li class="chapter" data-level="19.9" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#session-info-18"><i class="fa fa-check"></i><b>19.9</b> Session info</a></li>
<li class="chapter" data-level="19.10" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#references-8"><i class="fa fa-check"></i><b>19.10</b> References</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html"><i class="fa fa-check"></i><b>20</b> Generalized linear model</a>
<ul>
<li class="chapter" data-level="20.1" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#learning-goals-11"><i class="fa fa-check"></i><b>20.1</b> Learning goals</a></li>
<li class="chapter" data-level="20.2" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#load-packages-and-set-plotting-theme-13"><i class="fa fa-check"></i><b>20.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="20.3" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#load-data-set"><i class="fa fa-check"></i><b>20.3</b> Load data set</a></li>
<li class="chapter" data-level="20.4" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#logistic-regression"><i class="fa fa-check"></i><b>20.4</b> Logistic regression</a>
<ul>
<li class="chapter" data-level="20.4.1" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#interpreting-the-parameters"><i class="fa fa-check"></i><b>20.4.1</b> Interpreting the parameters</a></li>
<li class="chapter" data-level="20.4.2" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#binary-predictor"><i class="fa fa-check"></i><b>20.4.2</b> Binary predictor</a></li>
<li class="chapter" data-level="20.4.3" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#continuous-predictor"><i class="fa fa-check"></i><b>20.4.3</b> Continuous predictor</a></li>
<li class="chapter" data-level="20.4.4" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#several-predictors"><i class="fa fa-check"></i><b>20.4.4</b> Several predictors</a></li>
<li class="chapter" data-level="20.4.5" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#using-the-ggeffects-package"><i class="fa fa-check"></i><b>20.4.5</b> Using the “ggeffects” package</a></li>
</ul></li>
<li class="chapter" data-level="20.5" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#simulate-a-logistic-regression"><i class="fa fa-check"></i><b>20.5</b> Simulate a logistic regression</a></li>
<li class="chapter" data-level="20.6" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#testing-hypotheses"><i class="fa fa-check"></i><b>20.6</b> Testing hypotheses</a></li>
<li class="chapter" data-level="20.7" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#logistic-mixed-effects-model"><i class="fa fa-check"></i><b>20.7</b> Logistic mixed effects model</a></li>
<li class="chapter" data-level="20.8" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#additional-information"><i class="fa fa-check"></i><b>20.8</b> Additional information</a>
<ul>
<li class="chapter" data-level="20.8.1" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#datacamp-7"><i class="fa fa-check"></i><b>20.8.1</b> Datacamp</a></li>
</ul></li>
<li class="chapter" data-level="20.9" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#session-info-19"><i class="fa fa-check"></i><b>20.9</b> Session info</a></li>
<li class="chapter" data-level="20.10" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#references-9"><i class="fa fa-check"></i><b>20.10</b> References</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="bayesian-data-analysis.html"><a href="bayesian-data-analysis.html"><i class="fa fa-check"></i><b>21</b> Bayesian data analysis</a>
<ul>
<li class="chapter" data-level="21.1" data-path="bayesian-data-analysis.html"><a href="bayesian-data-analysis.html#learning-goals-12"><i class="fa fa-check"></i><b>21.1</b> Learning goals</a></li>
<li class="chapter" data-level="21.2" data-path="bayesian-data-analysis.html"><a href="bayesian-data-analysis.html#load-packages-and-set-plotting-theme-14"><i class="fa fa-check"></i><b>21.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="21.3" data-path="bayesian-data-analysis.html"><a href="bayesian-data-analysis.html#doing-bayesian-inference-by-hand"><i class="fa fa-check"></i><b>21.3</b> Doing Bayesian inference “by hand”</a>
<ul>
<li class="chapter" data-level="21.3.1" data-path="bayesian-data-analysis.html"><a href="bayesian-data-analysis.html#sequential-updating-based-on-the-beta-distribution"><i class="fa fa-check"></i><b>21.3.1</b> Sequential updating based on the Beta distribution</a></li>
<li class="chapter" data-level="21.3.2" data-path="bayesian-data-analysis.html"><a href="bayesian-data-analysis.html#coin-flip-example"><i class="fa fa-check"></i><b>21.3.2</b> Coin flip example</a></li>
<li class="chapter" data-level="21.3.3" data-path="bayesian-data-analysis.html"><a href="bayesian-data-analysis.html#bayesian-inference-by-discretization"><i class="fa fa-check"></i><b>21.3.3</b> Bayesian inference by discretization</a></li>
</ul></li>
<li class="chapter" data-level="21.4" data-path="bayesian-data-analysis.html"><a href="bayesian-data-analysis.html#doing-bayesian-inference-with-greta"><i class="fa fa-check"></i><b>21.4</b> Doing Bayesian inference with Greta</a>
<ul>
<li class="chapter" data-level="21.4.1" data-path="bayesian-data-analysis.html"><a href="bayesian-data-analysis.html#attitude-data-set"><i class="fa fa-check"></i><b>21.4.1</b> Attitude data set</a></li>
<li class="chapter" data-level="21.4.2" data-path="bayesian-data-analysis.html"><a href="bayesian-data-analysis.html#frequentist-analysis"><i class="fa fa-check"></i><b>21.4.2</b> Frequentist analysis</a></li>
<li class="chapter" data-level="21.4.3" data-path="bayesian-data-analysis.html"><a href="bayesian-data-analysis.html#bayesian-regression"><i class="fa fa-check"></i><b>21.4.3</b> Bayesian regression</a></li>
</ul></li>
<li class="chapter" data-level="21.5" data-path="bayesian-data-analysis.html"><a href="bayesian-data-analysis.html#session-info-20"><i class="fa fa-check"></i><b>21.5</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html"><i class="fa fa-check"></i><b>22</b> Bayesian data analysis 2</a>
<ul>
<li class="chapter" data-level="22.1" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#learning-goals-13"><i class="fa fa-check"></i><b>22.1</b> Learning goals</a></li>
<li class="chapter" data-level="22.2" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#load-packages-and-set-plotting-theme-15"><i class="fa fa-check"></i><b>22.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="22.3" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#load-data-sets-5"><i class="fa fa-check"></i><b>22.3</b> Load data sets</a></li>
<li class="chapter" data-level="22.4" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#poker"><i class="fa fa-check"></i><b>22.4</b> Poker</a>
<ul>
<li class="chapter" data-level="22.4.1" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#visualize-the-data"><i class="fa fa-check"></i><b>22.4.1</b> 1. Visualize the data</a></li>
<li class="chapter" data-level="22.4.2" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#specify-and-fit-the-model"><i class="fa fa-check"></i><b>22.4.2</b> 2. Specify and fit the model</a></li>
<li class="chapter" data-level="22.4.3" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#model-evaluation"><i class="fa fa-check"></i><b>22.4.3</b> 3. Model evaluation</a></li>
<li class="chapter" data-level="22.4.4" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#interpret-the-model-parameters"><i class="fa fa-check"></i><b>22.4.4</b> 4. Interpret the model parameters</a></li>
<li class="chapter" data-level="22.4.5" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#test-specific-hypotheses"><i class="fa fa-check"></i><b>22.4.5</b> 5. Test specific hypotheses</a></li>
</ul></li>
<li class="chapter" data-level="22.5" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#sleep-study-1"><i class="fa fa-check"></i><b>22.5</b> Sleep study</a>
<ul>
<li class="chapter" data-level="22.5.1" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#visualize-the-data-1"><i class="fa fa-check"></i><b>22.5.1</b> 1. Visualize the data</a></li>
<li class="chapter" data-level="22.5.2" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#specify-and-fit-the-model-1"><i class="fa fa-check"></i><b>22.5.2</b> 2. Specify and fit the model</a></li>
<li class="chapter" data-level="22.5.3" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#model-evaluation-1"><i class="fa fa-check"></i><b>22.5.3</b> 3. Model evaluation</a></li>
<li class="chapter" data-level="22.5.4" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#interpret-the-parameters"><i class="fa fa-check"></i><b>22.5.4</b> 4. Interpret the parameters</a></li>
<li class="chapter" data-level="22.5.5" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#test-specific-hypotheses-1"><i class="fa fa-check"></i><b>22.5.5</b> 5. Test specific hypotheses</a></li>
<li class="chapter" data-level="22.5.6" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#report-results"><i class="fa fa-check"></i><b>22.5.6</b> 6. Report results</a></li>
</ul></li>
<li class="chapter" data-level="22.6" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#titanic-study"><i class="fa fa-check"></i><b>22.6</b> Titanic study</a>
<ul>
<li class="chapter" data-level="22.6.1" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#visualize-that-data"><i class="fa fa-check"></i><b>22.6.1</b> 1. Visualize that data</a></li>
<li class="chapter" data-level="22.6.2" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#specify-and-fit-the-model-2"><i class="fa fa-check"></i><b>22.6.2</b> 2. Specify and fit the model</a></li>
<li class="chapter" data-level="22.6.3" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#model-evaluation-2"><i class="fa fa-check"></i><b>22.6.3</b> 3. Model evaluation</a></li>
<li class="chapter" data-level="22.6.4" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#interpret-the-parameters-1"><i class="fa fa-check"></i><b>22.6.4</b> 4. Interpret the parameters</a></li>
<li class="chapter" data-level="22.6.5" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#test-specific-hypotheses-2"><i class="fa fa-check"></i><b>22.6.5</b> 5. Test specific hypotheses</a></li>
<li class="chapter" data-level="22.6.6" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#report-results-1"><i class="fa fa-check"></i><b>22.6.6</b> 6. Report results</a></li>
</ul></li>
<li class="chapter" data-level="22.7" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#politeness-data"><i class="fa fa-check"></i><b>22.7</b> Politeness data</a>
<ul>
<li class="chapter" data-level="22.7.1" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#visualize-the-data-2"><i class="fa fa-check"></i><b>22.7.1</b> 1. Visualize the data</a></li>
<li class="chapter" data-level="22.7.2" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#test-specific-hypotheses-3"><i class="fa fa-check"></i><b>22.7.2</b> 5. Test specific hypotheses</a></li>
</ul></li>
<li class="chapter" data-level="22.8" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#additional-resources-16"><i class="fa fa-check"></i><b>22.8</b> Additional resources</a></li>
<li class="chapter" data-level="22.9" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#session-info-21"><i class="fa fa-check"></i><b>22.9</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html"><i class="fa fa-check"></i><b>23</b> Bayesian data analysis 3</a>
<ul>
<li class="chapter" data-level="23.1" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#learning-goals-14"><i class="fa fa-check"></i><b>23.1</b> Learning goals</a></li>
<li class="chapter" data-level="23.2" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#load-packages-and-set-plotting-theme-16"><i class="fa fa-check"></i><b>23.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="23.3" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#evidence-for-the-null-hypothesis"><i class="fa fa-check"></i><b>23.3</b> Evidence for the null hypothesis</a>
<ul>
<li class="chapter" data-level="23.3.1" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#bayes-factor-1"><i class="fa fa-check"></i><b>23.3.1</b> Bayes factor</a></li>
<li class="chapter" data-level="23.3.2" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#loo"><i class="fa fa-check"></i><b>23.3.2</b> LOO</a></li>
</ul></li>
<li class="chapter" data-level="23.4" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#dealing-with-heteroscedasticity"><i class="fa fa-check"></i><b>23.4</b> Dealing with heteroscedasticity</a>
<ul>
<li class="chapter" data-level="23.4.1" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#visualize-the-data-3"><i class="fa fa-check"></i><b>23.4.1</b> Visualize the data</a></li>
<li class="chapter" data-level="23.4.2" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#frequentist-analysis-4"><i class="fa fa-check"></i><b>23.4.2</b> Frequentist analysis</a></li>
<li class="chapter" data-level="23.4.3" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#bayesian-analysis-3"><i class="fa fa-check"></i><b>23.4.3</b> Bayesian analysis</a></li>
</ul></li>
<li class="chapter" data-level="23.5" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#zero-one-inflated-beta-binomial-model"><i class="fa fa-check"></i><b>23.5</b> Zero-one inflated beta binomial model</a></li>
<li class="chapter" data-level="23.6" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#ordinal-regression"><i class="fa fa-check"></i><b>23.6</b> Ordinal regression</a>
<ul>
<li class="chapter" data-level="23.6.1" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#ordinal-regression-assuming-equal-variance"><i class="fa fa-check"></i><b>23.6.1</b> Ordinal regression (assuming equal variance)</a></li>
<li class="chapter" data-level="23.6.2" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#gaussian-regression-assuming-equal-variance"><i class="fa fa-check"></i><b>23.6.2</b> Gaussian regression (assuming equal variance)</a></li>
<li class="chapter" data-level="23.6.3" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#oridnal-regression-unequal-variance"><i class="fa fa-check"></i><b>23.6.3</b> Oridnal regression (unequal variance)</a></li>
<li class="chapter" data-level="23.6.4" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#gaussian-regression-unequal-variance"><i class="fa fa-check"></i><b>23.6.4</b> Gaussian regression (unequal variance)</a></li>
<li class="chapter" data-level="23.6.5" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#model-comparison-2"><i class="fa fa-check"></i><b>23.6.5</b> Model comparison</a></li>
</ul></li>
<li class="chapter" data-level="23.7" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#additional-resources-17"><i class="fa fa-check"></i><b>23.7</b> Additional resources</a></li>
<li class="chapter" data-level="23.8" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#session-info-22"><i class="fa fa-check"></i><b>23.8</b> Session info</a></li>
<li class="chapter" data-level="" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#references-10"><i class="fa fa-check"></i>References</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="model-assumptions.html"><a href="model-assumptions.html"><i class="fa fa-check"></i><b>24</b> Model assumptions</a>
<ul>
<li class="chapter" data-level="24.1" data-path="model-assumptions.html"><a href="model-assumptions.html#learning-goals-15"><i class="fa fa-check"></i><b>24.1</b> Learning goals</a></li>
<li class="chapter" data-level="24.2" data-path="model-assumptions.html"><a href="model-assumptions.html#load-packages-and-set-plotting-theme-17"><i class="fa fa-check"></i><b>24.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="24.3" data-path="model-assumptions.html"><a href="model-assumptions.html#model-assumptions-and-what-to-do-if-they-are-violated"><i class="fa fa-check"></i><b>24.3</b> Model assumptions and what to do if they are violated</a>
<ul>
<li class="chapter" data-level="24.3.1" data-path="model-assumptions.html"><a href="model-assumptions.html#influential-data-points"><i class="fa fa-check"></i><b>24.3.1</b> Influential data points</a></li>
<li class="chapter" data-level="24.3.2" data-path="model-assumptions.html"><a href="model-assumptions.html#linear-and-additive"><i class="fa fa-check"></i><b>24.3.2</b> Linear and additive</a></li>
<li class="chapter" data-level="24.3.3" data-path="model-assumptions.html"><a href="model-assumptions.html#normally-distributed-residuals"><i class="fa fa-check"></i><b>24.3.3</b> Normally distributed residuals</a></li>
<li class="chapter" data-level="24.3.4" data-path="model-assumptions.html"><a href="model-assumptions.html#non-parametric-tests"><i class="fa fa-check"></i><b>24.3.4</b> Non-parametric tests</a></li>
<li class="chapter" data-level="24.3.5" data-path="model-assumptions.html"><a href="model-assumptions.html#bootstrapping-regressions"><i class="fa fa-check"></i><b>24.3.5</b> Bootstrapping regressions</a></li>
</ul></li>
<li class="chapter" data-level="24.4" data-path="model-assumptions.html"><a href="model-assumptions.html#additional-resources-18"><i class="fa fa-check"></i><b>24.4</b> Additional resources</a></li>
<li class="chapter" data-level="24.5" data-path="model-assumptions.html"><a href="model-assumptions.html#session-info-23"><i class="fa fa-check"></i><b>24.5</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="25" data-path="reporting-statistics.html"><a href="reporting-statistics.html"><i class="fa fa-check"></i><b>25</b> Reporting statistics</a>
<ul>
<li class="chapter" data-level="25.1" data-path="reporting-statistics.html"><a href="reporting-statistics.html#general-advice"><i class="fa fa-check"></i><b>25.1</b> General advice</a>
<ul>
<li class="chapter" data-level="25.1.1" data-path="reporting-statistics.html"><a href="reporting-statistics.html#make-good-figures"><i class="fa fa-check"></i><b>25.1.1</b> Make good figures!</a></li>
<li class="chapter" data-level="25.1.2" data-path="reporting-statistics.html"><a href="reporting-statistics.html#use-statistical-models-to-answer-concrete-research-questions."><i class="fa fa-check"></i><b>25.1.2</b> Use statistical models to answer concrete research questions.</a></li>
<li class="chapter" data-level="25.1.3" data-path="reporting-statistics.html"><a href="reporting-statistics.html#illustrate-the-uncertainty-in-your-statistical-inferences."><i class="fa fa-check"></i><b>25.1.3</b> Illustrate the uncertainty in your statistical inferences.</a></li>
<li class="chapter" data-level="25.1.4" data-path="reporting-statistics.html"><a href="reporting-statistics.html#report-effect-sizes."><i class="fa fa-check"></i><b>25.1.4</b> Report effect sizes.</a></li>
<li class="chapter" data-level="25.1.5" data-path="reporting-statistics.html"><a href="reporting-statistics.html#reporting-statistical-results-using-rmarkdown"><i class="fa fa-check"></i><b>25.1.5</b> Reporting statistical results using RMarkdown</a></li>
</ul></li>
<li class="chapter" data-level="25.2" data-path="reporting-statistics.html"><a href="reporting-statistics.html#some-concrete-example"><i class="fa fa-check"></i><b>25.2</b> Some concrete example</a>
<ul>
<li class="chapter" data-level="25.2.1" data-path="reporting-statistics.html"><a href="reporting-statistics.html#frequentist-statistics"><i class="fa fa-check"></i><b>25.2.1</b> Frequentist statistics</a></li>
</ul></li>
<li class="chapter" data-level="25.3" data-path="reporting-statistics.html"><a href="reporting-statistics.html#session-info-24"><i class="fa fa-check"></i><b>25.3</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="26" data-path="cheatsheets-7.html"><a href="cheatsheets-7.html"><i class="fa fa-check"></i><b>26</b> Cheatsheets</a>
<ul>
<li class="chapter" data-level="26.1" data-path="cheatsheets-7.html"><a href="cheatsheets-7.html#statistics"><i class="fa fa-check"></i><b>26.1</b> Statistics</a></li>
<li class="chapter" data-level="26.2" data-path="cheatsheets-7.html"><a href="cheatsheets-7.html#r"><i class="fa fa-check"></i><b>26.2</b> R</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references-11.html"><a href="references-11.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Psych 252: Statistical Methods for Behavioral and Social Sciences</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="linear-mixed-effects-models-2" class="section level1" number="18">
<h1><span class="header-section-number">Chapter 18</span> Linear mixed effects models 2</h1>
<div id="learning-goals-9" class="section level2" number="18.1">
<h2><span class="header-section-number">18.1</span> Learning goals</h2>
<ul>
<li>An <code>lmer()</code> worked example
<ul>
<li>complete pooling vs. no pooling vs. partial pooling</li>
<li>getting p-values</li>
<li>checking model assumptions</li>
</ul></li>
<li>Simulating mixed effects models
<ul>
<li>effect of outliers</li>
<li>non-homogeneity of variance</li>
<li>Simpson’s paradox</li>
</ul></li>
</ul>
</div>
<div id="load-packages-and-set-plotting-theme-11" class="section level2" number="18.2">
<h2><span class="header-section-number">18.2</span> Load packages and set plotting theme</h2>
<div class="sourceCode" id="cb928"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb928-1"><a href="linear-mixed-effects-models-2.html#cb928-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;knitr&quot;</span>)       <span class="co"># for knitting RMarkdown </span></span>
<span id="cb928-2"><a href="linear-mixed-effects-models-2.html#cb928-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;kableExtra&quot;</span>)  <span class="co"># for making nice tables</span></span>
<span id="cb928-3"><a href="linear-mixed-effects-models-2.html#cb928-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;janitor&quot;</span>)     <span class="co"># for cleaning column names</span></span>
<span id="cb928-4"><a href="linear-mixed-effects-models-2.html#cb928-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;broom.mixed&quot;</span>) <span class="co"># for tidying up linear models </span></span>
<span id="cb928-5"><a href="linear-mixed-effects-models-2.html#cb928-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;ggeffects&quot;</span>)   <span class="co"># for plotting marginal effects</span></span>
<span id="cb928-6"><a href="linear-mixed-effects-models-2.html#cb928-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;afex&quot;</span>)        <span class="co"># for the mixed() function </span></span>
<span id="cb928-7"><a href="linear-mixed-effects-models-2.html#cb928-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;lme4&quot;</span>)        <span class="co"># for linear mixed effects models</span></span>
<span id="cb928-8"><a href="linear-mixed-effects-models-2.html#cb928-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;performance&quot;</span>) <span class="co"># for assessing model performance</span></span>
<span id="cb928-9"><a href="linear-mixed-effects-models-2.html#cb928-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;see&quot;</span>)         <span class="co"># for assessing model performance</span></span>
<span id="cb928-10"><a href="linear-mixed-effects-models-2.html#cb928-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;tidyverse&quot;</span>)   <span class="co"># for wrangling, plotting, etc. </span></span></code></pre></div>
<div class="sourceCode" id="cb929"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb929-1"><a href="linear-mixed-effects-models-2.html#cb929-1" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_classic</span>() <span class="sc">+</span> <span class="co">#set the theme </span></span>
<span id="cb929-2"><a href="linear-mixed-effects-models-2.html#cb929-2" aria-hidden="true" tabindex="-1"></a>            <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>))) <span class="co">#set the default text size</span></span>
<span id="cb929-3"><a href="linear-mixed-effects-models-2.html#cb929-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb929-4"><a href="linear-mixed-effects-models-2.html#cb929-4" aria-hidden="true" tabindex="-1"></a>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">comment =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb929-5"><a href="linear-mixed-effects-models-2.html#cb929-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">fig.show =</span> <span class="st">&quot;hold&quot;</span>)</span>
<span id="cb929-6"><a href="linear-mixed-effects-models-2.html#cb929-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb929-7"><a href="linear-mixed-effects-models-2.html#cb929-7" aria-hidden="true" tabindex="-1"></a><span class="co"># include references for used packages</span></span>
<span id="cb929-8"><a href="linear-mixed-effects-models-2.html#cb929-8" aria-hidden="true" tabindex="-1"></a><span class="fu">write_bib</span>(<span class="fu">.packages</span>(), <span class="st">&quot;packages.bib&quot;</span>) </span></code></pre></div>
</div>
<div id="a-worked-example" class="section level2" number="18.3">
<h2><span class="header-section-number">18.3</span> A worked example</h2>
<p>Let’s illustrate the concept of pooling and shrinkage via the sleep data set that comes with the lmer package.</p>
<div class="sourceCode" id="cb930"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb930-1"><a href="linear-mixed-effects-models-2.html#cb930-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load sleepstudy data set </span></span>
<span id="cb930-2"><a href="linear-mixed-effects-models-2.html#cb930-2" aria-hidden="true" tabindex="-1"></a>df.sleep <span class="ot">=</span> sleepstudy <span class="sc">%&gt;%</span> </span>
<span id="cb930-3"><a href="linear-mixed-effects-models-2.html#cb930-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb930-4"><a href="linear-mixed-effects-models-2.html#cb930-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb930-5"><a href="linear-mixed-effects-models-2.html#cb930-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">subject =</span> <span class="fu">as.character</span>(subject)) <span class="sc">%&gt;%</span> </span>
<span id="cb930-6"><a href="linear-mixed-effects-models-2.html#cb930-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(subject, days, reaction)</span></code></pre></div>
<div class="sourceCode" id="cb931"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb931-1"><a href="linear-mixed-effects-models-2.html#cb931-1" aria-hidden="true" tabindex="-1"></a><span class="co"># add two fake participants (with missing data)</span></span>
<span id="cb931-2"><a href="linear-mixed-effects-models-2.html#cb931-2" aria-hidden="true" tabindex="-1"></a>df.sleep <span class="ot">=</span> df.sleep <span class="sc">%&gt;%</span> </span>
<span id="cb931-3"><a href="linear-mixed-effects-models-2.html#cb931-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(<span class="fu">tibble</span>(<span class="at">subject =</span> <span class="st">&quot;374&quot;</span>,</span>
<span id="cb931-4"><a href="linear-mixed-effects-models-2.html#cb931-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">days =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>,</span>
<span id="cb931-5"><a href="linear-mixed-effects-models-2.html#cb931-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">reaction =</span> <span class="fu">c</span>(<span class="dv">286</span>, <span class="dv">288</span>)),</span>
<span id="cb931-6"><a href="linear-mixed-effects-models-2.html#cb931-6" aria-hidden="true" tabindex="-1"></a>            <span class="fu">tibble</span>(<span class="at">subject =</span> <span class="st">&quot;373&quot;</span>,</span>
<span id="cb931-7"><a href="linear-mixed-effects-models-2.html#cb931-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">days =</span> <span class="dv">0</span>,</span>
<span id="cb931-8"><a href="linear-mixed-effects-models-2.html#cb931-8" aria-hidden="true" tabindex="-1"></a>                   <span class="at">reaction =</span> <span class="dv">245</span>))</span></code></pre></div>
<p>Let’s start by visualizing the data</p>
<div class="sourceCode" id="cb932"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb932-1"><a href="linear-mixed-effects-models-2.html#cb932-1" aria-hidden="true" tabindex="-1"></a><span class="co"># visualize the data</span></span>
<span id="cb932-2"><a href="linear-mixed-effects-models-2.html#cb932-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df.sleep,</span>
<span id="cb932-3"><a href="linear-mixed-effects-models-2.html#cb932-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> days, <span class="at">y =</span> reaction)) <span class="sc">+</span> </span>
<span id="cb932-4"><a href="linear-mixed-effects-models-2.html#cb932-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb932-5"><a href="linear-mixed-effects-models-2.html#cb932-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>subject, <span class="at">ncol =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb932-6"><a href="linear-mixed-effects-models-2.html#cb932-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Days of sleep deprivation&quot;</span>, </span>
<span id="cb932-7"><a href="linear-mixed-effects-models-2.html#cb932-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Average reaction time (ms)&quot;</span>) <span class="sc">+</span> </span>
<span id="cb932-8"><a href="linear-mixed-effects-models-2.html#cb932-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">4</span> <span class="sc">*</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb932-9"><a href="linear-mixed-effects-models-2.html#cb932-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb932-10"><a href="linear-mixed-effects-models-2.html#cb932-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>))</span></code></pre></div>
<p><img src="18-linear_mixed_effects_models2_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<p>The plot shows the effect of the number of days of sleep deprivation on the average reaction time (presumably in an experiment). Note that for participant 373 and 374 we only have one and two data points respectively.</p>
<div id="complete-pooling" class="section level3" number="18.3.1">
<h3><span class="header-section-number">18.3.1</span> Complete pooling</h3>
<p>Let’s first fit a model the simply combines all the data points. This model ignores the dependence structure in the data (i.e. the fact that we have repeated observations from the same participants).</p>
<div class="sourceCode" id="cb933"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb933-1"><a href="linear-mixed-effects-models-2.html#cb933-1" aria-hidden="true" tabindex="-1"></a>fit.complete <span class="ot">=</span> <span class="fu">lm</span>(<span class="at">formula =</span> reaction <span class="sc">~</span> days,</span>
<span id="cb933-2"><a href="linear-mixed-effects-models-2.html#cb933-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> df.sleep)</span>
<span id="cb933-3"><a href="linear-mixed-effects-models-2.html#cb933-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb933-4"><a href="linear-mixed-effects-models-2.html#cb933-4" aria-hidden="true" tabindex="-1"></a>fit.params <span class="ot">=</span> <span class="fu">tidy</span>(fit.complete)</span>
<span id="cb933-5"><a href="linear-mixed-effects-models-2.html#cb933-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb933-6"><a href="linear-mixed-effects-models-2.html#cb933-6" aria-hidden="true" tabindex="-1"></a>fit.complete <span class="sc">%&gt;%</span> </span>
<span id="cb933-7"><a href="linear-mixed-effects-models-2.html#cb933-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code></pre></div>
<pre><code>
Call:
lm(formula = reaction ~ days, data = df.sleep)

Residuals:
     Min       1Q   Median       3Q      Max 
-110.646  -27.951    1.829   26.388  139.875 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  252.321      6.406  39.389  &lt; 2e-16 ***
days          10.328      1.210   8.537 5.48e-15 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 47.43 on 181 degrees of freedom
Multiple R-squared:  0.2871,    Adjusted R-squared:  0.2831 
F-statistic: 72.88 on 1 and 181 DF,  p-value: 5.484e-15</code></pre>
<p>And let’s visualize the predictions of this model.</p>
<div class="sourceCode" id="cb935"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb935-1"><a href="linear-mixed-effects-models-2.html#cb935-1" aria-hidden="true" tabindex="-1"></a><span class="co"># visualization (aggregate) </span></span>
<span id="cb935-2"><a href="linear-mixed-effects-models-2.html#cb935-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df.sleep,</span>
<span id="cb935-3"><a href="linear-mixed-effects-models-2.html#cb935-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> days, <span class="at">y =</span> reaction)) <span class="sc">+</span> </span>
<span id="cb935-4"><a href="linear-mixed-effects-models-2.html#cb935-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> fit.params<span class="sc">$</span>estimate[<span class="dv">1</span>],</span>
<span id="cb935-5"><a href="linear-mixed-effects-models-2.html#cb935-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">slope =</span> fit.params<span class="sc">$</span>estimate[<span class="dv">2</span>],</span>
<span id="cb935-6"><a href="linear-mixed-effects-models-2.html#cb935-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb935-7"><a href="linear-mixed-effects-models-2.html#cb935-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb935-8"><a href="linear-mixed-effects-models-2.html#cb935-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Days of sleep deprivation&quot;</span>, </span>
<span id="cb935-9"><a href="linear-mixed-effects-models-2.html#cb935-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Average reaction time (ms)&quot;</span>) <span class="sc">+</span> </span>
<span id="cb935-10"><a href="linear-mixed-effects-models-2.html#cb935-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">4</span> <span class="sc">*</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb935-11"><a href="linear-mixed-effects-models-2.html#cb935-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb935-12"><a href="linear-mixed-effects-models-2.html#cb935-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>))</span></code></pre></div>
<p><img src="18-linear_mixed_effects_models2_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<p>And here is what the model’s predictions look like separated by participant.</p>
<div class="sourceCode" id="cb936"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb936-1"><a href="linear-mixed-effects-models-2.html#cb936-1" aria-hidden="true" tabindex="-1"></a><span class="co"># visualization (separate participants) </span></span>
<span id="cb936-2"><a href="linear-mixed-effects-models-2.html#cb936-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df.sleep,</span>
<span id="cb936-3"><a href="linear-mixed-effects-models-2.html#cb936-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> days, <span class="at">y =</span> reaction)) <span class="sc">+</span> </span>
<span id="cb936-4"><a href="linear-mixed-effects-models-2.html#cb936-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> fit.params<span class="sc">$</span>estimate[<span class="dv">1</span>],</span>
<span id="cb936-5"><a href="linear-mixed-effects-models-2.html#cb936-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">slope =</span> fit.params<span class="sc">$</span>estimate[<span class="dv">2</span>],</span>
<span id="cb936-6"><a href="linear-mixed-effects-models-2.html#cb936-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb936-7"><a href="linear-mixed-effects-models-2.html#cb936-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb936-8"><a href="linear-mixed-effects-models-2.html#cb936-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>subject, <span class="at">ncol =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb936-9"><a href="linear-mixed-effects-models-2.html#cb936-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Days of sleep deprivation&quot;</span>, </span>
<span id="cb936-10"><a href="linear-mixed-effects-models-2.html#cb936-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Average reaction time (ms)&quot;</span>) <span class="sc">+</span> </span>
<span id="cb936-11"><a href="linear-mixed-effects-models-2.html#cb936-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">4</span> <span class="sc">*</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb936-12"><a href="linear-mixed-effects-models-2.html#cb936-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb936-13"><a href="linear-mixed-effects-models-2.html#cb936-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>))</span></code></pre></div>
<p><img src="18-linear_mixed_effects_models2_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<p>The model predicts the same relationship between sleep deprivation and reaction time for each participant (not surprising since we didn’t even tell the model that this data is based on different participants).</p>
</div>
<div id="no-pooling" class="section level3" number="18.3.2">
<h3><span class="header-section-number">18.3.2</span> No pooling</h3>
<p>We could also fit separate regressions for each participant. Let’s do that.</p>
<div class="sourceCode" id="cb937"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb937-1"><a href="linear-mixed-effects-models-2.html#cb937-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fit regressions and extract parameter estimates </span></span>
<span id="cb937-2"><a href="linear-mixed-effects-models-2.html#cb937-2" aria-hidden="true" tabindex="-1"></a>df.no_pooling <span class="ot">=</span> df.sleep <span class="sc">%&gt;%</span> </span>
<span id="cb937-3"><a href="linear-mixed-effects-models-2.html#cb937-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(subject) <span class="sc">%&gt;%</span> </span>
<span id="cb937-4"><a href="linear-mixed-effects-models-2.html#cb937-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>(<span class="at">data =</span> <span class="fu">c</span>(days, reaction)) <span class="sc">%&gt;%</span> </span>
<span id="cb937-5"><a href="linear-mixed-effects-models-2.html#cb937-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">fit =</span> <span class="fu">map</span>(data, <span class="sc">~</span> <span class="fu">lm</span>(reaction <span class="sc">~</span> days, <span class="at">data =</span> .)),</span>
<span id="cb937-6"><a href="linear-mixed-effects-models-2.html#cb937-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">params =</span> <span class="fu">map</span>(fit, tidy)) <span class="sc">%&gt;%</span> </span>
<span id="cb937-7"><a href="linear-mixed-effects-models-2.html#cb937-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb937-8"><a href="linear-mixed-effects-models-2.html#cb937-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(<span class="fu">c</span>(params)) <span class="sc">%&gt;%</span> </span>
<span id="cb937-9"><a href="linear-mixed-effects-models-2.html#cb937-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(subject, term, estimate) <span class="sc">%&gt;%</span> </span>
<span id="cb937-10"><a href="linear-mixed-effects-models-2.html#cb937-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">complete</span>(subject, term, <span class="at">fill =</span> <span class="fu">list</span>(<span class="at">estimate =</span> <span class="dv">0</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb937-11"><a href="linear-mixed-effects-models-2.html#cb937-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> term,</span>
<span id="cb937-12"><a href="linear-mixed-effects-models-2.html#cb937-12" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_from =</span> estimate) <span class="sc">%&gt;%</span> </span>
<span id="cb937-13"><a href="linear-mixed-effects-models-2.html#cb937-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>()</span></code></pre></div>
<p>And let’s visualize what the predictions of these separate regressions would look like:</p>
<div class="sourceCode" id="cb938"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb938-1"><a href="linear-mixed-effects-models-2.html#cb938-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df.sleep,</span>
<span id="cb938-2"><a href="linear-mixed-effects-models-2.html#cb938-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> days,</span>
<span id="cb938-3"><a href="linear-mixed-effects-models-2.html#cb938-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> reaction)) <span class="sc">+</span> </span>
<span id="cb938-4"><a href="linear-mixed-effects-models-2.html#cb938-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">data =</span> df.no_pooling <span class="sc">%&gt;%</span> </span>
<span id="cb938-5"><a href="linear-mixed-effects-models-2.html#cb938-5" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(subject <span class="sc">!=</span> <span class="dv">373</span>),</span>
<span id="cb938-6"><a href="linear-mixed-effects-models-2.html#cb938-6" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">intercept =</span> intercept,</span>
<span id="cb938-7"><a href="linear-mixed-effects-models-2.html#cb938-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">slope =</span> days),</span>
<span id="cb938-8"><a href="linear-mixed-effects-models-2.html#cb938-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb938-9"><a href="linear-mixed-effects-models-2.html#cb938-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb938-10"><a href="linear-mixed-effects-models-2.html#cb938-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>subject, <span class="at">ncol =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb938-11"><a href="linear-mixed-effects-models-2.html#cb938-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Days of sleep deprivation&quot;</span>, </span>
<span id="cb938-12"><a href="linear-mixed-effects-models-2.html#cb938-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Average reaction time (ms)&quot;</span>) <span class="sc">+</span> </span>
<span id="cb938-13"><a href="linear-mixed-effects-models-2.html#cb938-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">4</span> <span class="sc">*</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb938-14"><a href="linear-mixed-effects-models-2.html#cb938-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb938-15"><a href="linear-mixed-effects-models-2.html#cb938-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>))</span></code></pre></div>
<p><img src="18-linear_mixed_effects_models2_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<p>When we fit separate regression, no information is shared between participants.</p>
</div>
<div id="partial-pooling" class="section level3" number="18.3.3">
<h3><span class="header-section-number">18.3.3</span> Partial pooling</h3>
<p>By usign linear mixed effects models, we are partially pooling information. That is, the estimates for one participant are influenced by the rest of the participants.</p>
<p>We’ll fit a number of mixed effects models that differ in their random effects structure.</p>
<div id="random-intercept-and-random-slope" class="section level4" number="18.3.3.1">
<h4><span class="header-section-number">18.3.3.1</span> Random intercept and random slope</h4>
<p>This model allows for random differences in the intercepts and slopes between subjects (and also models the correlation between intercepts and slopes).</p>
<p>Let’s fit the model</p>
<div class="sourceCode" id="cb939"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb939-1"><a href="linear-mixed-effects-models-2.html#cb939-1" aria-hidden="true" tabindex="-1"></a>fit.random_intercept_slope <span class="ot">=</span> <span class="fu">lmer</span>(<span class="at">formula =</span> reaction <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> days <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> days <span class="sc">|</span> subject),</span>
<span id="cb939-2"><a href="linear-mixed-effects-models-2.html#cb939-2" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">data =</span> df.sleep)</span></code></pre></div>
<p>and take a look at the model’s predictions:</p>
<div class="sourceCode" id="cb940"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb940-1"><a href="linear-mixed-effects-models-2.html#cb940-1" aria-hidden="true" tabindex="-1"></a>fit.random_intercept_slope <span class="sc">%&gt;%</span> </span>
<span id="cb940-2"><a href="linear-mixed-effects-models-2.html#cb940-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">augment</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb940-3"><a href="linear-mixed-effects-models-2.html#cb940-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb940-4"><a href="linear-mixed-effects-models-2.html#cb940-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> .,</span>
<span id="cb940-5"><a href="linear-mixed-effects-models-2.html#cb940-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> days,</span>
<span id="cb940-6"><a href="linear-mixed-effects-models-2.html#cb940-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> reaction)) <span class="sc">+</span> </span>
<span id="cb940-7"><a href="linear-mixed-effects-models-2.html#cb940-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> fitted),</span>
<span id="cb940-8"><a href="linear-mixed-effects-models-2.html#cb940-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span> </span>
<span id="cb940-9"><a href="linear-mixed-effects-models-2.html#cb940-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb940-10"><a href="linear-mixed-effects-models-2.html#cb940-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>subject, <span class="at">ncol =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb940-11"><a href="linear-mixed-effects-models-2.html#cb940-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Days of sleep deprivation&quot;</span>, </span>
<span id="cb940-12"><a href="linear-mixed-effects-models-2.html#cb940-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Average reaction time (ms)&quot;</span>) <span class="sc">+</span> </span>
<span id="cb940-13"><a href="linear-mixed-effects-models-2.html#cb940-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">4</span> <span class="sc">*</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb940-14"><a href="linear-mixed-effects-models-2.html#cb940-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb940-15"><a href="linear-mixed-effects-models-2.html#cb940-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>))</span></code></pre></div>
<p><img src="18-linear_mixed_effects_models2_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<p>As we can see, the lines for each participant are different. We’ve allowed for the intercept as well as the relationship between sleep deprivation and reaction time to be different between participants.</p>
</div>
<div id="only-random-intercepts" class="section level4" number="18.3.3.2">
<h4><span class="header-section-number">18.3.3.2</span> Only random intercepts</h4>
<p>Let’s fit a model that only allows for the intercepts to vary between participants.</p>
<div class="sourceCode" id="cb941"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb941-1"><a href="linear-mixed-effects-models-2.html#cb941-1" aria-hidden="true" tabindex="-1"></a>fit.random_intercept <span class="ot">=</span> <span class="fu">lmer</span>(<span class="at">formula =</span> reaction <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> days <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> subject),</span>
<span id="cb941-2"><a href="linear-mixed-effects-models-2.html#cb941-2" aria-hidden="true" tabindex="-1"></a>                            <span class="at">data =</span> df.sleep)</span></code></pre></div>
<p>And let’s visualize what these predictions look like:</p>
<div class="sourceCode" id="cb942"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb942-1"><a href="linear-mixed-effects-models-2.html#cb942-1" aria-hidden="true" tabindex="-1"></a>fit.random_intercept <span class="sc">%&gt;%</span> </span>
<span id="cb942-2"><a href="linear-mixed-effects-models-2.html#cb942-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">augment</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb942-3"><a href="linear-mixed-effects-models-2.html#cb942-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb942-4"><a href="linear-mixed-effects-models-2.html#cb942-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> .,</span>
<span id="cb942-5"><a href="linear-mixed-effects-models-2.html#cb942-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> days,</span>
<span id="cb942-6"><a href="linear-mixed-effects-models-2.html#cb942-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> reaction)) <span class="sc">+</span> </span>
<span id="cb942-7"><a href="linear-mixed-effects-models-2.html#cb942-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> fitted),</span>
<span id="cb942-8"><a href="linear-mixed-effects-models-2.html#cb942-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span> </span>
<span id="cb942-9"><a href="linear-mixed-effects-models-2.html#cb942-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb942-10"><a href="linear-mixed-effects-models-2.html#cb942-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>subject, <span class="at">ncol =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb942-11"><a href="linear-mixed-effects-models-2.html#cb942-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Days of sleep deprivation&quot;</span>, </span>
<span id="cb942-12"><a href="linear-mixed-effects-models-2.html#cb942-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Average reaction time (ms)&quot;</span>) <span class="sc">+</span> </span>
<span id="cb942-13"><a href="linear-mixed-effects-models-2.html#cb942-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">4</span> <span class="sc">*</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb942-14"><a href="linear-mixed-effects-models-2.html#cb942-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb942-15"><a href="linear-mixed-effects-models-2.html#cb942-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>))</span></code></pre></div>
<p><img src="18-linear_mixed_effects_models2_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<p>Now, all the lines are parallel but the intercept differs between participants.</p>
</div>
<div id="only-random-slopes" class="section level4" number="18.3.3.3">
<h4><span class="header-section-number">18.3.3.3</span> Only random slopes</h4>
<p>Finally, let’s compare a model that only allows for the slopes to differ but not the intercepts.</p>
<div class="sourceCode" id="cb943"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb943-1"><a href="linear-mixed-effects-models-2.html#cb943-1" aria-hidden="true" tabindex="-1"></a>fit.random_slope <span class="ot">=</span> <span class="fu">lmer</span>(<span class="at">formula =</span> reaction <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> days <span class="sc">+</span> (<span class="dv">0</span> <span class="sc">+</span> days <span class="sc">|</span> subject),</span>
<span id="cb943-2"><a href="linear-mixed-effects-models-2.html#cb943-2" aria-hidden="true" tabindex="-1"></a>                        <span class="at">data =</span> df.sleep)</span></code></pre></div>
<p>And let’s visualize the model fit:</p>
<div class="sourceCode" id="cb944"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb944-1"><a href="linear-mixed-effects-models-2.html#cb944-1" aria-hidden="true" tabindex="-1"></a>fit.random_slope <span class="sc">%&gt;%</span> </span>
<span id="cb944-2"><a href="linear-mixed-effects-models-2.html#cb944-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">augment</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb944-3"><a href="linear-mixed-effects-models-2.html#cb944-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb944-4"><a href="linear-mixed-effects-models-2.html#cb944-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> .,</span>
<span id="cb944-5"><a href="linear-mixed-effects-models-2.html#cb944-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> days,</span>
<span id="cb944-6"><a href="linear-mixed-effects-models-2.html#cb944-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> reaction)) <span class="sc">+</span> </span>
<span id="cb944-7"><a href="linear-mixed-effects-models-2.html#cb944-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> fitted),</span>
<span id="cb944-8"><a href="linear-mixed-effects-models-2.html#cb944-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span> </span>
<span id="cb944-9"><a href="linear-mixed-effects-models-2.html#cb944-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb944-10"><a href="linear-mixed-effects-models-2.html#cb944-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(subject), <span class="at">ncol =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb944-11"><a href="linear-mixed-effects-models-2.html#cb944-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Days of sleep deprivation&quot;</span>, </span>
<span id="cb944-12"><a href="linear-mixed-effects-models-2.html#cb944-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Average reaction time (ms)&quot;</span>) <span class="sc">+</span> </span>
<span id="cb944-13"><a href="linear-mixed-effects-models-2.html#cb944-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">4</span> <span class="sc">*</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb944-14"><a href="linear-mixed-effects-models-2.html#cb944-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb944-15"><a href="linear-mixed-effects-models-2.html#cb944-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>))</span></code></pre></div>
<p><img src="18-linear_mixed_effects_models2_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<p>Here, all the lines have the same starting point (i.e. the same intercept) but the slopes are different.</p>
</div>
</div>
<div id="compare-results" class="section level3" number="18.3.4">
<h3><span class="header-section-number">18.3.4</span> Compare results</h3>
<p>Let’s compare the results of the different methods – complete pooling, no pooling, and partial pooling (with random intercepts and slopes).</p>
<div class="sourceCode" id="cb945"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb945-1"><a href="linear-mixed-effects-models-2.html#cb945-1" aria-hidden="true" tabindex="-1"></a><span class="co"># complete pooling</span></span>
<span id="cb945-2"><a href="linear-mixed-effects-models-2.html#cb945-2" aria-hidden="true" tabindex="-1"></a>fit.complete_pooling <span class="ot">=</span> <span class="fu">lm</span>(<span class="at">formula =</span> reaction <span class="sc">~</span> days,</span>
<span id="cb945-3"><a href="linear-mixed-effects-models-2.html#cb945-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">data =</span> df.sleep)  </span>
<span id="cb945-4"><a href="linear-mixed-effects-models-2.html#cb945-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb945-5"><a href="linear-mixed-effects-models-2.html#cb945-5" aria-hidden="true" tabindex="-1"></a>df.complete_pooling <span class="ot">=</span>  fit.complete_pooling <span class="sc">%&gt;%</span> </span>
<span id="cb945-6"><a href="linear-mixed-effects-models-2.html#cb945-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">augment</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb945-7"><a href="linear-mixed-effects-models-2.html#cb945-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(fit.complete_pooling <span class="sc">%&gt;%</span> </span>
<span id="cb945-8"><a href="linear-mixed-effects-models-2.html#cb945-8" aria-hidden="true" tabindex="-1"></a>              <span class="fu">augment</span>(<span class="at">newdata =</span> <span class="fu">tibble</span>(<span class="at">subject =</span> <span class="fu">c</span>(<span class="st">&quot;373&quot;</span>, <span class="st">&quot;374&quot;</span>),</span>
<span id="cb945-9"><a href="linear-mixed-effects-models-2.html#cb945-9" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">days =</span> <span class="fu">rep</span>(<span class="dv">10</span>, <span class="dv">2</span>)))) <span class="sc">%&gt;%</span> </span>
<span id="cb945-10"><a href="linear-mixed-effects-models-2.html#cb945-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb945-11"><a href="linear-mixed-effects-models-2.html#cb945-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(reaction, days, <span class="at">complete_pooling =</span> fitted)</span>
<span id="cb945-12"><a href="linear-mixed-effects-models-2.html#cb945-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb945-13"><a href="linear-mixed-effects-models-2.html#cb945-13" aria-hidden="true" tabindex="-1"></a><span class="co"># no pooling</span></span>
<span id="cb945-14"><a href="linear-mixed-effects-models-2.html#cb945-14" aria-hidden="true" tabindex="-1"></a>df.no_pooling <span class="ot">=</span> df.sleep <span class="sc">%&gt;%</span> </span>
<span id="cb945-15"><a href="linear-mixed-effects-models-2.html#cb945-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(subject) <span class="sc">%&gt;%</span> </span>
<span id="cb945-16"><a href="linear-mixed-effects-models-2.html#cb945-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>(<span class="at">data =</span> <span class="fu">c</span>(days, reaction)) <span class="sc">%&gt;%</span> </span>
<span id="cb945-17"><a href="linear-mixed-effects-models-2.html#cb945-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">fit =</span> <span class="fu">map</span>(data, <span class="sc">~</span> <span class="fu">lm</span>(reaction <span class="sc">~</span> days, <span class="at">data =</span> .)),</span>
<span id="cb945-18"><a href="linear-mixed-effects-models-2.html#cb945-18" aria-hidden="true" tabindex="-1"></a>         <span class="at">augment =</span> <span class="fu">map</span>(fit, augment)) <span class="sc">%&gt;%</span> </span>
<span id="cb945-19"><a href="linear-mixed-effects-models-2.html#cb945-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(<span class="fu">c</span>(augment)) <span class="sc">%&gt;%</span> </span>
<span id="cb945-20"><a href="linear-mixed-effects-models-2.html#cb945-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb945-21"><a href="linear-mixed-effects-models-2.html#cb945-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb945-22"><a href="linear-mixed-effects-models-2.html#cb945-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(subject, reaction, days, <span class="at">no_pooling =</span> fitted)</span>
<span id="cb945-23"><a href="linear-mixed-effects-models-2.html#cb945-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb945-24"><a href="linear-mixed-effects-models-2.html#cb945-24" aria-hidden="true" tabindex="-1"></a><span class="co"># partial pooling</span></span>
<span id="cb945-25"><a href="linear-mixed-effects-models-2.html#cb945-25" aria-hidden="true" tabindex="-1"></a>fit.lmer <span class="ot">=</span> <span class="fu">lmer</span>(<span class="at">formula =</span> reaction <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> days <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> days <span class="sc">|</span> subject),</span>
<span id="cb945-26"><a href="linear-mixed-effects-models-2.html#cb945-26" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> df.sleep) </span>
<span id="cb945-27"><a href="linear-mixed-effects-models-2.html#cb945-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb945-28"><a href="linear-mixed-effects-models-2.html#cb945-28" aria-hidden="true" tabindex="-1"></a>df.partial_pooling <span class="ot">=</span> fit.lmer <span class="sc">%&gt;%</span> </span>
<span id="cb945-29"><a href="linear-mixed-effects-models-2.html#cb945-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">augment</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb945-30"><a href="linear-mixed-effects-models-2.html#cb945-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(fit.lmer <span class="sc">%&gt;%</span> </span>
<span id="cb945-31"><a href="linear-mixed-effects-models-2.html#cb945-31" aria-hidden="true" tabindex="-1"></a>              <span class="fu">augment</span>(<span class="at">newdata =</span> <span class="fu">tibble</span>(<span class="at">subject =</span> <span class="fu">c</span>(<span class="st">&quot;373&quot;</span>, <span class="st">&quot;374&quot;</span>),</span>
<span id="cb945-32"><a href="linear-mixed-effects-models-2.html#cb945-32" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">days =</span> <span class="fu">rep</span>(<span class="dv">10</span>, <span class="dv">2</span>)))) <span class="sc">%&gt;%</span> </span>
<span id="cb945-33"><a href="linear-mixed-effects-models-2.html#cb945-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb945-34"><a href="linear-mixed-effects-models-2.html#cb945-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(subject, reaction, days, <span class="at">partial_pooling =</span> fitted)</span>
<span id="cb945-35"><a href="linear-mixed-effects-models-2.html#cb945-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb945-36"><a href="linear-mixed-effects-models-2.html#cb945-36" aria-hidden="true" tabindex="-1"></a><span class="co"># combine results</span></span>
<span id="cb945-37"><a href="linear-mixed-effects-models-2.html#cb945-37" aria-hidden="true" tabindex="-1"></a>df.pooling <span class="ot">=</span> df.partial_pooling <span class="sc">%&gt;%</span> </span>
<span id="cb945-38"><a href="linear-mixed-effects-models-2.html#cb945-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(df.complete_pooling) <span class="sc">%&gt;%</span> </span>
<span id="cb945-39"><a href="linear-mixed-effects-models-2.html#cb945-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(df.no_pooling)</span></code></pre></div>
<p>Let’s compare the predictions of the different models visually:</p>
<div class="sourceCode" id="cb946"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb946-1"><a href="linear-mixed-effects-models-2.html#cb946-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df.pooling,</span>
<span id="cb946-2"><a href="linear-mixed-effects-models-2.html#cb946-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> days,</span>
<span id="cb946-3"><a href="linear-mixed-effects-models-2.html#cb946-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> reaction)) <span class="sc">+</span> </span>
<span id="cb946-4"><a href="linear-mixed-effects-models-2.html#cb946-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>,</span>
<span id="cb946-5"><a href="linear-mixed-effects-models-2.html#cb946-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">se =</span> F,</span>
<span id="cb946-6"><a href="linear-mixed-effects-models-2.html#cb946-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">&quot;orange&quot;</span>,</span>
<span id="cb946-7"><a href="linear-mixed-effects-models-2.html#cb946-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">fullrange =</span> T) <span class="sc">+</span> </span>
<span id="cb946-8"><a href="linear-mixed-effects-models-2.html#cb946-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> complete_pooling),</span>
<span id="cb946-9"><a href="linear-mixed-effects-models-2.html#cb946-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">&quot;green&quot;</span>) <span class="sc">+</span> </span>
<span id="cb946-10"><a href="linear-mixed-effects-models-2.html#cb946-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> partial_pooling),</span>
<span id="cb946-11"><a href="linear-mixed-effects-models-2.html#cb946-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span> </span>
<span id="cb946-12"><a href="linear-mixed-effects-models-2.html#cb946-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb946-13"><a href="linear-mixed-effects-models-2.html#cb946-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>subject, <span class="at">ncol =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb946-14"><a href="linear-mixed-effects-models-2.html#cb946-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Days of sleep deprivation&quot;</span>, </span>
<span id="cb946-15"><a href="linear-mixed-effects-models-2.html#cb946-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Average reaction time (ms)&quot;</span>) <span class="sc">+</span> </span>
<span id="cb946-16"><a href="linear-mixed-effects-models-2.html#cb946-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">4</span> <span class="sc">*</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb946-17"><a href="linear-mixed-effects-models-2.html#cb946-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb946-18"><a href="linear-mixed-effects-models-2.html#cb946-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>))</span></code></pre></div>
<p><img src="18-linear_mixed_effects_models2_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<p>To better see the differences between the approaches, let’s focus on the predictions for the participants with incomplete data:</p>
<div class="sourceCode" id="cb947"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb947-1"><a href="linear-mixed-effects-models-2.html#cb947-1" aria-hidden="true" tabindex="-1"></a><span class="co"># subselection</span></span>
<span id="cb947-2"><a href="linear-mixed-effects-models-2.html#cb947-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df.pooling <span class="sc">%&gt;%</span> </span>
<span id="cb947-3"><a href="linear-mixed-effects-models-2.html#cb947-3" aria-hidden="true" tabindex="-1"></a>         <span class="fu">filter</span>(subject <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;373&quot;</span>, <span class="st">&quot;374&quot;</span>)),</span>
<span id="cb947-4"><a href="linear-mixed-effects-models-2.html#cb947-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> days,</span>
<span id="cb947-5"><a href="linear-mixed-effects-models-2.html#cb947-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> reaction)) <span class="sc">+</span> </span>
<span id="cb947-6"><a href="linear-mixed-effects-models-2.html#cb947-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>,</span>
<span id="cb947-7"><a href="linear-mixed-effects-models-2.html#cb947-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">se =</span> F,</span>
<span id="cb947-8"><a href="linear-mixed-effects-models-2.html#cb947-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">&quot;orange&quot;</span>,</span>
<span id="cb947-9"><a href="linear-mixed-effects-models-2.html#cb947-9" aria-hidden="true" tabindex="-1"></a>              <span class="at">fullrange =</span> T) <span class="sc">+</span> </span>
<span id="cb947-10"><a href="linear-mixed-effects-models-2.html#cb947-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> complete_pooling),</span>
<span id="cb947-11"><a href="linear-mixed-effects-models-2.html#cb947-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">&quot;green&quot;</span>) <span class="sc">+</span> </span>
<span id="cb947-12"><a href="linear-mixed-effects-models-2.html#cb947-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> partial_pooling),</span>
<span id="cb947-13"><a href="linear-mixed-effects-models-2.html#cb947-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span> </span>
<span id="cb947-14"><a href="linear-mixed-effects-models-2.html#cb947-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb947-15"><a href="linear-mixed-effects-models-2.html#cb947-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(subject)) <span class="sc">+</span></span>
<span id="cb947-16"><a href="linear-mixed-effects-models-2.html#cb947-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Days of sleep deprivation&quot;</span>, </span>
<span id="cb947-17"><a href="linear-mixed-effects-models-2.html#cb947-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Average reaction time (ms)&quot;</span>) <span class="sc">+</span> </span>
<span id="cb947-18"><a href="linear-mixed-effects-models-2.html#cb947-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">4</span> <span class="sc">*</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb947-19"><a href="linear-mixed-effects-models-2.html#cb947-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb947-20"><a href="linear-mixed-effects-models-2.html#cb947-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>))</span></code></pre></div>
<p><img src="18-linear_mixed_effects_models2_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
<div id="coefficients" class="section level4" number="18.3.4.1">
<h4><span class="header-section-number">18.3.4.1</span> Coefficients</h4>
<p>One good way to get a sense for what the different models are doing is by taking a look at the coefficients:</p>
<div class="sourceCode" id="cb948"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb948-1"><a href="linear-mixed-effects-models-2.html#cb948-1" aria-hidden="true" tabindex="-1"></a>fit.complete_pooling <span class="sc">%&gt;%</span> </span>
<span id="cb948-2"><a href="linear-mixed-effects-models-2.html#cb948-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coef</span>()</span></code></pre></div>
<pre><code>(Intercept)        days 
  252.32070    10.32766 </code></pre>
<div class="sourceCode" id="cb950"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb950-1"><a href="linear-mixed-effects-models-2.html#cb950-1" aria-hidden="true" tabindex="-1"></a>fit.random_intercept <span class="sc">%&gt;%</span> </span>
<span id="cb950-2"><a href="linear-mixed-effects-models-2.html#cb950-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coef</span>()</span></code></pre></div>
<pre><code>$subject
    (Intercept)     days
308    292.2749 10.43191
309    174.0559 10.43191
310    188.7454 10.43191
330    256.0247 10.43191
331    261.8141 10.43191
332    259.8262 10.43191
333    268.0765 10.43191
334    248.6471 10.43191
335    206.5096 10.43191
337    323.5643 10.43191
349    230.5114 10.43191
350    265.6957 10.43191
351    243.7988 10.43191
352    287.8850 10.43191
369    258.6454 10.43191
370    245.2931 10.43191
371    248.3508 10.43191
372    269.6861 10.43191
373    248.2086 10.43191
374    273.9400 10.43191

attr(,&quot;class&quot;)
[1] &quot;coef.mer&quot;</code></pre>
<div class="sourceCode" id="cb952"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb952-1"><a href="linear-mixed-effects-models-2.html#cb952-1" aria-hidden="true" tabindex="-1"></a>fit.random_slope <span class="sc">%&gt;%</span> </span>
<span id="cb952-2"><a href="linear-mixed-effects-models-2.html#cb952-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coef</span>()</span></code></pre></div>
<pre><code>$subject
    (Intercept)       days
308    252.2965 19.9526801
309    252.2965 -4.3719650
310    252.2965 -0.9574726
330    252.2965  8.9909957
331    252.2965 10.5394285
332    252.2965 11.3994289
333    252.2965 12.6074020
334    252.2965 10.3413879
335    252.2965 -0.5722073
337    252.2965 24.2246485
349    252.2965  7.7702676
350    252.2965 15.0661415
351    252.2965  7.9675415
352    252.2965 17.0002999
369    252.2965 11.6982767
370    252.2965 11.3939807
371    252.2965  9.4535879
372    252.2965 13.4569059
373    252.2965 10.4142695
374    252.2965 11.9097917

attr(,&quot;class&quot;)
[1] &quot;coef.mer&quot;</code></pre>
<div class="sourceCode" id="cb954"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb954-1"><a href="linear-mixed-effects-models-2.html#cb954-1" aria-hidden="true" tabindex="-1"></a>fit.random_intercept_slope <span class="sc">%&gt;%</span> </span>
<span id="cb954-2"><a href="linear-mixed-effects-models-2.html#cb954-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coef</span>()</span></code></pre></div>
<pre><code>$subject
    (Intercept)       days
308    253.9478 19.6264337
309    211.7331  1.7319161
310    213.1582  4.9061511
330    275.1425  5.6436007
331    273.7286  7.3862730
332    260.6504 10.1632571
333    268.3683 10.2246059
334    244.5524 11.4837802
335    251.3702 -0.3355788
337    286.2319 19.1090424
349    226.7663 11.5531844
350    238.7807 17.0156827
351    256.2344  7.4119456
352    272.3511 13.9920878
369    254.9484 11.2985770
370    226.3701 15.2027877
371    252.5051  9.4335409
372    263.8916 11.7253429
373    248.9753 10.3915288
374    271.1450 11.0782516

attr(,&quot;class&quot;)
[1] &quot;coef.mer&quot;</code></pre>
</div>
<div id="shrinkage" class="section level4" number="18.3.4.2">
<h4><span class="header-section-number">18.3.4.2</span> Shrinkage</h4>
<p>In mixed effects models, the variance of parameter estimates across participants shrinks compared to a no pooling model (where we fit a different regression to each participant). Expressed differently, individual parameter estimates are borrowing strength from the overall data set in mixed effects models.</p>
<div class="sourceCode" id="cb956"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb956-1"><a href="linear-mixed-effects-models-2.html#cb956-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get estimates from partial pooling model</span></span>
<span id="cb956-2"><a href="linear-mixed-effects-models-2.html#cb956-2" aria-hidden="true" tabindex="-1"></a>df.partial_pooling <span class="ot">=</span> fit.random_intercept_slope <span class="sc">%&gt;%</span> </span>
<span id="cb956-3"><a href="linear-mixed-effects-models-2.html#cb956-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coef</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb956-4"><a href="linear-mixed-effects-models-2.html#cb956-4" aria-hidden="true" tabindex="-1"></a>  .[[<span class="dv">1</span>]] <span class="sc">%&gt;%</span> </span>
<span id="cb956-5"><a href="linear-mixed-effects-models-2.html#cb956-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">&quot;subject&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb956-6"><a href="linear-mixed-effects-models-2.html#cb956-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>()</span>
<span id="cb956-7"><a href="linear-mixed-effects-models-2.html#cb956-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb956-8"><a href="linear-mixed-effects-models-2.html#cb956-8" aria-hidden="true" tabindex="-1"></a><span class="co"># combine estimates from no pooling with partial pooling model </span></span>
<span id="cb956-9"><a href="linear-mixed-effects-models-2.html#cb956-9" aria-hidden="true" tabindex="-1"></a>df.plot <span class="ot">=</span> df.sleep <span class="sc">%&gt;%</span> </span>
<span id="cb956-10"><a href="linear-mixed-effects-models-2.html#cb956-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(subject) <span class="sc">%&gt;%</span> </span>
<span id="cb956-11"><a href="linear-mixed-effects-models-2.html#cb956-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>(<span class="at">data =</span> <span class="fu">c</span>(days, reaction)) <span class="sc">%&gt;%</span> </span>
<span id="cb956-12"><a href="linear-mixed-effects-models-2.html#cb956-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">fit =</span> <span class="fu">map</span>(data, <span class="sc">~</span> <span class="fu">lm</span>(reaction <span class="sc">~</span> days, <span class="at">data =</span> .)),</span>
<span id="cb956-13"><a href="linear-mixed-effects-models-2.html#cb956-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">tidy =</span> <span class="fu">map</span>(fit, tidy)) <span class="sc">%&gt;%</span> </span>
<span id="cb956-14"><a href="linear-mixed-effects-models-2.html#cb956-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(<span class="fu">c</span>(tidy)) <span class="sc">%&gt;%</span> </span>
<span id="cb956-15"><a href="linear-mixed-effects-models-2.html#cb956-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(subject, term, estimate) <span class="sc">%&gt;%</span> </span>
<span id="cb956-16"><a href="linear-mixed-effects-models-2.html#cb956-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> term,</span>
<span id="cb956-17"><a href="linear-mixed-effects-models-2.html#cb956-17" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_from =</span> estimate) <span class="sc">%&gt;%</span> </span>
<span id="cb956-18"><a href="linear-mixed-effects-models-2.html#cb956-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb956-19"><a href="linear-mixed-effects-models-2.html#cb956-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">method =</span> <span class="st">&quot;no pooling&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb956-20"><a href="linear-mixed-effects-models-2.html#cb956-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(df.partial_pooling <span class="sc">%&gt;%</span> </span>
<span id="cb956-21"><a href="linear-mixed-effects-models-2.html#cb956-21" aria-hidden="true" tabindex="-1"></a>              <span class="fu">mutate</span>(<span class="at">method =</span> <span class="st">&quot;partial pooling&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb956-22"><a href="linear-mixed-effects-models-2.html#cb956-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span><span class="fu">c</span>(subject, method),</span>
<span id="cb956-23"><a href="linear-mixed-effects-models-2.html#cb956-23" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&quot;index&quot;</span>, </span>
<span id="cb956-24"><a href="linear-mixed-effects-models-2.html#cb956-24" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">&quot;value&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb956-25"><a href="linear-mixed-effects-models-2.html#cb956-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">index =</span> <span class="fu">factor</span>(index, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;intercept&quot;</span>, <span class="st">&quot;days&quot;</span>)))</span>
<span id="cb956-26"><a href="linear-mixed-effects-models-2.html#cb956-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb956-27"><a href="linear-mixed-effects-models-2.html#cb956-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb956-28"><a href="linear-mixed-effects-models-2.html#cb956-28" aria-hidden="true" tabindex="-1"></a><span class="co"># visualize the results  </span></span>
<span id="cb956-29"><a href="linear-mixed-effects-models-2.html#cb956-29" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df.plot,</span>
<span id="cb956-30"><a href="linear-mixed-effects-models-2.html#cb956-30" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> value,</span>
<span id="cb956-31"><a href="linear-mixed-effects-models-2.html#cb956-31" aria-hidden="true" tabindex="-1"></a>                     <span class="at">group =</span> method,</span>
<span id="cb956-32"><a href="linear-mixed-effects-models-2.html#cb956-32" aria-hidden="true" tabindex="-1"></a>                     <span class="at">fill =</span> method)) <span class="sc">+</span> </span>
<span id="cb956-33"><a href="linear-mixed-effects-models-2.html#cb956-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_density</span>(<span class="at">position =</span> <span class="st">&quot;identity&quot;</span>,</span>
<span id="cb956-34"><a href="linear-mixed-effects-models-2.html#cb956-34" aria-hidden="true" tabindex="-1"></a>               <span class="at">geom =</span> <span class="st">&quot;area&quot;</span>,</span>
<span id="cb956-35"><a href="linear-mixed-effects-models-2.html#cb956-35" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb956-36"><a href="linear-mixed-effects-models-2.html#cb956-36" aria-hidden="true" tabindex="-1"></a>               <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb956-37"><a href="linear-mixed-effects-models-2.html#cb956-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="at">cols =</span> <span class="fu">vars</span>(index),</span>
<span id="cb956-38"><a href="linear-mixed-effects-models-2.html#cb956-38" aria-hidden="true" tabindex="-1"></a>             <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>)</span></code></pre></div>
<pre><code>Warning: Removed 1 rows containing non-finite values (stat_density).</code></pre>
<p><img src="18-linear_mixed_effects_models2_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
</div>
<div id="getting-p-values" class="section level3" number="18.3.5">
<h3><span class="header-section-number">18.3.5</span> Getting p-values</h3>
<p>To get p-values for mixed effects models, I recommend using the <code>mixed()</code> function from the <code>afex</code> package.</p>
<div class="sourceCode" id="cb958"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb958-1"><a href="linear-mixed-effects-models-2.html#cb958-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lmer</span>(<span class="at">formula =</span> reaction <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> days <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> days <span class="sc">|</span> subject),</span>
<span id="cb958-2"><a href="linear-mixed-effects-models-2.html#cb958-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">data =</span> df.sleep) <span class="sc">%&gt;%</span> </span>
<span id="cb958-3"><a href="linear-mixed-effects-models-2.html#cb958-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code></pre></div>
<pre><code>Linear mixed model fit by REML. t-tests use Satterthwaite&#39;s method [
lmerModLmerTest]
Formula: reaction ~ 1 + days + (1 + days | subject)
   Data: df.sleep

REML criterion at convergence: 1771.4

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-3.9707 -0.4703  0.0276  0.4594  5.2009 

Random effects:
 Groups   Name        Variance Std.Dev. Corr
 subject  (Intercept) 582.72   24.140       
          days         35.03    5.919   0.07
 Residual             649.36   25.483       
Number of obs: 183, groups:  subject, 20

Fixed effects:
            Estimate Std. Error      df t value Pr(&gt;|t|)    
(Intercept)  252.543      6.433  19.295  39.257  &lt; 2e-16 ***
days          10.452      1.542  17.163   6.778 3.06e-06 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Correlation of Fixed Effects:
     (Intr)
days -0.137</code></pre>
<div class="sourceCode" id="cb960"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb960-1"><a href="linear-mixed-effects-models-2.html#cb960-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mixed</span>(<span class="at">formula =</span> reaction <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> days <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> days <span class="sc">|</span> subject),</span>
<span id="cb960-2"><a href="linear-mixed-effects-models-2.html#cb960-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> df.sleep,</span>
<span id="cb960-3"><a href="linear-mixed-effects-models-2.html#cb960-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">method =</span> <span class="st">&quot;KR&quot;</span>)</span></code></pre></div>
<pre><code>Contrasts set to contr.sum for the following variables: subject</code></pre>
<pre><code>Numerical variables NOT centered on 0: days
If in interactions, interpretation of lower order (e.g., main) effects difficult.</code></pre>
<pre><code>Fitting one lmer() model. [DONE]
Calculating p-values. [DONE]</code></pre>
<pre><code>Mixed Model Anova Table (Type 3 tests, KR-method)

Model: reaction ~ 1 + days + (1 + days | subject)
Data: df.sleep
  Effect       df         F p.value
1   days 1, 17.08 45.53 ***   &lt;.001
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;+&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Our good ol’ model comparison approach produces a Likelihood ratio test in this case:</p>
<div class="sourceCode" id="cb965"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb965-1"><a href="linear-mixed-effects-models-2.html#cb965-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mixed</span>(<span class="at">formula =</span> reaction <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> days <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> days <span class="sc">|</span> subject),</span>
<span id="cb965-2"><a href="linear-mixed-effects-models-2.html#cb965-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> df.sleep,</span>
<span id="cb965-3"><a href="linear-mixed-effects-models-2.html#cb965-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">method =</span> <span class="st">&quot;LRT&quot;</span>)</span></code></pre></div>
<pre><code>Contrasts set to contr.sum for the following variables: subject</code></pre>
<pre><code>Numerical variables NOT centered on 0: days
If in interactions, interpretation of lower order (e.g., main) effects difficult.</code></pre>
<pre><code>REML argument to lmer() set to FALSE for method = &#39;PB&#39; or &#39;LRT&#39;</code></pre>
<pre><code>Fitting 2 (g)lmer() models:
[..]</code></pre>
<pre><code>Mixed Model Anova Table (Type 3 tests, LRT-method)

Model: reaction ~ 1 + days + (1 + days | subject)
Data: df.sleep
Df full model: 6
  Effect df     Chisq p.value
1   days  1 23.60 ***   &lt;.001
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;+&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb971"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb971-1"><a href="linear-mixed-effects-models-2.html#cb971-1" aria-hidden="true" tabindex="-1"></a>fit1 <span class="ot">=</span> <span class="fu">lmer</span>(<span class="at">formula =</span> reaction <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> days <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> days <span class="sc">|</span> subject),</span>
<span id="cb971-2"><a href="linear-mixed-effects-models-2.html#cb971-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> df.sleep)</span>
<span id="cb971-3"><a href="linear-mixed-effects-models-2.html#cb971-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb971-4"><a href="linear-mixed-effects-models-2.html#cb971-4" aria-hidden="true" tabindex="-1"></a>fit2 <span class="ot">=</span> <span class="fu">lmer</span>(<span class="at">formula =</span> reaction <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> days <span class="sc">|</span> subject),</span>
<span id="cb971-5"><a href="linear-mixed-effects-models-2.html#cb971-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> df.sleep)</span>
<span id="cb971-6"><a href="linear-mixed-effects-models-2.html#cb971-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb971-7"><a href="linear-mixed-effects-models-2.html#cb971-7" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(fit1, fit2)</span></code></pre></div>
<pre><code>refitting model(s) with ML (instead of REML)</code></pre>
<pre><code>Data: df.sleep
Models:
fit2: reaction ~ 1 + (1 + days | subject)
fit1: reaction ~ 1 + days + (1 + days | subject)
     npar    AIC    BIC  logLik deviance  Chisq Df Pr(&gt;Chisq)    
fit2    5 1813.2 1829.3 -901.62   1803.2                         
fit1    6 1791.6 1810.9 -889.82   1779.6 23.602  1  1.184e-06 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<div id="reporting-results" class="section level3" number="18.3.6">
<h3><span class="header-section-number">18.3.6</span> Reporting results</h3>
<div id="plotting-marginal-effects" class="section level4" number="18.3.6.1">
<h4><span class="header-section-number">18.3.6.1</span> Plotting marginal effects</h4>
<div class="sourceCode" id="cb974"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb974-1"><a href="linear-mixed-effects-models-2.html#cb974-1" aria-hidden="true" tabindex="-1"></a><span class="co"># library(&quot;ggeffects&quot;)</span></span>
<span id="cb974-2"><a href="linear-mixed-effects-models-2.html#cb974-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb974-3"><a href="linear-mixed-effects-models-2.html#cb974-3" aria-hidden="true" tabindex="-1"></a><span class="co"># using the plot() function</span></span>
<span id="cb974-4"><a href="linear-mixed-effects-models-2.html#cb974-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggpredict</span>(<span class="at">model =</span> fit.random_intercept_slope,</span>
<span id="cb974-5"><a href="linear-mixed-effects-models-2.html#cb974-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">terms =</span> <span class="st">&quot;days&quot;</span>,</span>
<span id="cb974-6"><a href="linear-mixed-effects-models-2.html#cb974-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">type =</span> <span class="st">&quot;fe&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb974-7"><a href="linear-mixed-effects-models-2.html#cb974-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>()</span>
<span id="cb974-8"><a href="linear-mixed-effects-models-2.html#cb974-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb974-9"><a href="linear-mixed-effects-models-2.html#cb974-9" aria-hidden="true" tabindex="-1"></a><span class="co"># using our own ggplot magic</span></span>
<span id="cb974-10"><a href="linear-mixed-effects-models-2.html#cb974-10" aria-hidden="true" tabindex="-1"></a>df.plot <span class="ot">=</span> <span class="fu">ggpredict</span>(<span class="at">model =</span> fit.random_intercept_slope,</span>
<span id="cb974-11"><a href="linear-mixed-effects-models-2.html#cb974-11" aria-hidden="true" tabindex="-1"></a>                    <span class="at">terms =</span> <span class="st">&quot;days&quot;</span>,</span>
<span id="cb974-12"><a href="linear-mixed-effects-models-2.html#cb974-12" aria-hidden="true" tabindex="-1"></a>                    <span class="at">type =</span> <span class="st">&quot;fe&quot;</span>)</span>
<span id="cb974-13"><a href="linear-mixed-effects-models-2.html#cb974-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb974-14"><a href="linear-mixed-effects-models-2.html#cb974-14" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df.plot,</span>
<span id="cb974-15"><a href="linear-mixed-effects-models-2.html#cb974-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> x, </span>
<span id="cb974-16"><a href="linear-mixed-effects-models-2.html#cb974-16" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> predicted,</span>
<span id="cb974-17"><a href="linear-mixed-effects-models-2.html#cb974-17" aria-hidden="true" tabindex="-1"></a>                     <span class="at">ymin =</span> conf.low,</span>
<span id="cb974-18"><a href="linear-mixed-effects-models-2.html#cb974-18" aria-hidden="true" tabindex="-1"></a>                     <span class="at">ymax =</span> conf.high)) <span class="sc">+</span> </span>
<span id="cb974-19"><a href="linear-mixed-effects-models-2.html#cb974-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb974-20"><a href="linear-mixed-effects-models-2.html#cb974-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="18-linear_mixed_effects_models2_files/figure-html/unnamed-chunk-27-1.png" width="672" /><img src="18-linear_mixed_effects_models2_files/figure-html/unnamed-chunk-27-2.png" width="672" /></p>
</div>
<div id="checking-model-performance" class="section level4" number="18.3.6.2">
<h4><span class="header-section-number">18.3.6.2</span> Checking model performance</h4>
<div class="sourceCode" id="cb975"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb975-1"><a href="linear-mixed-effects-models-2.html#cb975-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lmer</span>(<span class="at">formula =</span> reaction <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> days <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> days <span class="sc">|</span> subject),</span>
<span id="cb975-2"><a href="linear-mixed-effects-models-2.html#cb975-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">data =</span> df.sleep) <span class="sc">%&gt;%</span> </span>
<span id="cb975-3"><a href="linear-mixed-effects-models-2.html#cb975-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">check_model</span>()</span></code></pre></div>
<p><img src="18-linear_mixed_effects_models2_files/figure-html/unnamed-chunk-28-1.png" width="672" />
## Simulating a linear mixed effects model</p>
<p>To generate some data for a linear mixed effects model with random intercepts, we do pretty much what we are used to doing when we generated data for a linear model. However, this time, we have an additional parameter that captures the variance in the intercepts between participants. So, we draw a separate (offset from the global) intercept for each participant from this distribution.</p>
<div class="sourceCode" id="cb976"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb976-1"><a href="linear-mixed-effects-models-2.html#cb976-1" aria-hidden="true" tabindex="-1"></a><span class="co"># make example reproducible </span></span>
<span id="cb976-2"><a href="linear-mixed-effects-models-2.html#cb976-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb976-3"><a href="linear-mixed-effects-models-2.html#cb976-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb976-4"><a href="linear-mixed-effects-models-2.html#cb976-4" aria-hidden="true" tabindex="-1"></a><span class="co"># parameters</span></span>
<span id="cb976-5"><a href="linear-mixed-effects-models-2.html#cb976-5" aria-hidden="true" tabindex="-1"></a>sample_size <span class="ot">=</span> <span class="dv">100</span></span>
<span id="cb976-6"><a href="linear-mixed-effects-models-2.html#cb976-6" aria-hidden="true" tabindex="-1"></a>b0 <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb976-7"><a href="linear-mixed-effects-models-2.html#cb976-7" aria-hidden="true" tabindex="-1"></a>b1 <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb976-8"><a href="linear-mixed-effects-models-2.html#cb976-8" aria-hidden="true" tabindex="-1"></a>sd_residual <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb976-9"><a href="linear-mixed-effects-models-2.html#cb976-9" aria-hidden="true" tabindex="-1"></a>sd_participant <span class="ot">=</span> <span class="fl">0.5</span> </span>
<span id="cb976-10"><a href="linear-mixed-effects-models-2.html#cb976-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb976-11"><a href="linear-mixed-effects-models-2.html#cb976-11" aria-hidden="true" tabindex="-1"></a><span class="co"># randomly draw intercepts for each participant</span></span>
<span id="cb976-12"><a href="linear-mixed-effects-models-2.html#cb976-12" aria-hidden="true" tabindex="-1"></a>intercepts <span class="ot">=</span> <span class="fu">rnorm</span>(sample_size, <span class="at">sd =</span> sd_participant)</span>
<span id="cb976-13"><a href="linear-mixed-effects-models-2.html#cb976-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb976-14"><a href="linear-mixed-effects-models-2.html#cb976-14" aria-hidden="true" tabindex="-1"></a><span class="co"># generate the data </span></span>
<span id="cb976-15"><a href="linear-mixed-effects-models-2.html#cb976-15" aria-hidden="true" tabindex="-1"></a>df.mixed <span class="ot">=</span> <span class="fu">tibble</span>(<span class="at">condition =</span> <span class="fu">rep</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>, <span class="at">each =</span> sample_size), </span>
<span id="cb976-16"><a href="linear-mixed-effects-models-2.html#cb976-16" aria-hidden="true" tabindex="-1"></a>                  <span class="at">participant =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>sample_size, <span class="dv">2</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb976-17"><a href="linear-mixed-effects-models-2.html#cb976-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(condition) <span class="sc">%&gt;%</span> </span>
<span id="cb976-18"><a href="linear-mixed-effects-models-2.html#cb976-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">value =</span> b0 <span class="sc">+</span> b1 <span class="sc">*</span> condition <span class="sc">+</span> intercepts <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="fu">n</span>(), <span class="at">sd =</span> sd_residual)) <span class="sc">%&gt;%</span> </span>
<span id="cb976-19"><a href="linear-mixed-effects-models-2.html#cb976-19" aria-hidden="true" tabindex="-1"></a>  ungroup <span class="sc">%&gt;%</span> </span>
<span id="cb976-20"><a href="linear-mixed-effects-models-2.html#cb976-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">condition =</span> <span class="fu">as.factor</span>(condition),</span>
<span id="cb976-21"><a href="linear-mixed-effects-models-2.html#cb976-21" aria-hidden="true" tabindex="-1"></a>         <span class="at">participant =</span> <span class="fu">as.factor</span>(participant))</span></code></pre></div>
<p>Let’s take a look at the simulated data set:</p>
<div class="sourceCode" id="cb977"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb977-1"><a href="linear-mixed-effects-models-2.html#cb977-1" aria-hidden="true" tabindex="-1"></a>df.mixed <span class="sc">%&gt;%</span> </span>
<span id="cb977-2"><a href="linear-mixed-effects-models-2.html#cb977-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(participant, condition, value) <span class="sc">%&gt;%</span> </span>
<span id="cb977-3"><a href="linear-mixed-effects-models-2.html#cb977-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(participant) <span class="sc">%&gt;%</span> </span>
<span id="cb977-4"><a href="linear-mixed-effects-models-2.html#cb977-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">8</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb977-5"><a href="linear-mixed-effects-models-2.html#cb977-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">digits =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb977-6"><a href="linear-mixed-effects-models-2.html#cb977-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="st">&quot;striped&quot;</span>,</span>
<span id="cb977-7"><a href="linear-mixed-effects-models-2.html#cb977-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">full_width =</span> F)</span></code></pre></div>
<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
participant
</th>
<th style="text-align:left;">
condition
</th>
<th style="text-align:right;">
value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
0.07
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
3.10
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
1.13
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
4.78
</td>
</tr>
<tr>
<td style="text-align:left;">
3
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
-0.33
</td>
</tr>
<tr>
<td style="text-align:left;">
3
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
4.17
</td>
</tr>
<tr>
<td style="text-align:left;">
4
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
1.96
</td>
</tr>
<tr>
<td style="text-align:left;">
4
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
3.47
</td>
</tr>
</tbody>
</table>
<p>Let’s fit a model to this data now and take a look at the summary output:</p>
<div class="sourceCode" id="cb978"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb978-1"><a href="linear-mixed-effects-models-2.html#cb978-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fit model</span></span>
<span id="cb978-2"><a href="linear-mixed-effects-models-2.html#cb978-2" aria-hidden="true" tabindex="-1"></a>fit.mixed <span class="ot">=</span> <span class="fu">lmer</span>(<span class="at">formula =</span> value <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> condition <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> participant),</span>
<span id="cb978-3"><a href="linear-mixed-effects-models-2.html#cb978-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> df.mixed)</span>
<span id="cb978-4"><a href="linear-mixed-effects-models-2.html#cb978-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb978-5"><a href="linear-mixed-effects-models-2.html#cb978-5" aria-hidden="true" tabindex="-1"></a>fit.mixed <span class="sc">%&gt;%</span> </span>
<span id="cb978-6"><a href="linear-mixed-effects-models-2.html#cb978-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code></pre></div>
<pre><code>Linear mixed model fit by REML. t-tests use Satterthwaite&#39;s method [
lmerModLmerTest]
Formula: value ~ 1 + condition + (1 | participant)
   Data: df.mixed

REML criterion at convergence: 606

Scaled residuals: 
     Min       1Q   Median       3Q      Max 
-2.53710 -0.62295 -0.04364  0.67035  2.19899 

Random effects:
 Groups      Name        Variance Std.Dev.
 participant (Intercept) 0.1607   0.4009  
 Residual                1.0427   1.0211  
Number of obs: 200, groups:  participant, 100

Fixed effects:
            Estimate Std. Error       df t value Pr(&gt;|t|)    
(Intercept)   1.0166     0.1097 194.5301   9.267   &lt;2e-16 ***
condition1    2.0675     0.1444  99.0000  14.317   &lt;2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Correlation of Fixed Effects:
           (Intr)
condition1 -0.658</code></pre>
<p>Let’s visualize the model’s predictions:</p>
<div class="sourceCode" id="cb980"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb980-1"><a href="linear-mixed-effects-models-2.html#cb980-1" aria-hidden="true" tabindex="-1"></a>fit.mixed <span class="sc">%&gt;%</span></span>
<span id="cb980-2"><a href="linear-mixed-effects-models-2.html#cb980-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">augment</span>() <span class="sc">%&gt;%</span></span>
<span id="cb980-3"><a href="linear-mixed-effects-models-2.html#cb980-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">%&gt;%</span></span>
<span id="cb980-4"><a href="linear-mixed-effects-models-2.html#cb980-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> .,</span>
<span id="cb980-5"><a href="linear-mixed-effects-models-2.html#cb980-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> condition,</span>
<span id="cb980-6"><a href="linear-mixed-effects-models-2.html#cb980-6" aria-hidden="true" tabindex="-1"></a>                       <span class="at">y =</span> value,</span>
<span id="cb980-7"><a href="linear-mixed-effects-models-2.html#cb980-7" aria-hidden="true" tabindex="-1"></a>                       <span class="at">group =</span> participant)) <span class="sc">+</span></span>
<span id="cb980-8"><a href="linear-mixed-effects-models-2.html#cb980-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb980-9"><a href="linear-mixed-effects-models-2.html#cb980-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb980-10"><a href="linear-mixed-effects-models-2.html#cb980-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> fitted),</span>
<span id="cb980-11"><a href="linear-mixed-effects-models-2.html#cb980-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb980-12"><a href="linear-mixed-effects-models-2.html#cb980-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> fitted),</span>
<span id="cb980-13"><a href="linear-mixed-effects-models-2.html#cb980-13" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="18-linear_mixed_effects_models2_files/figure-html/unnamed-chunk-32-1.png" width="672" /></p>
<p>Let’s simulate some data from this fitted model:</p>
<div class="sourceCode" id="cb981"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb981-1"><a href="linear-mixed-effects-models-2.html#cb981-1" aria-hidden="true" tabindex="-1"></a><span class="co"># simulated data </span></span>
<span id="cb981-2"><a href="linear-mixed-effects-models-2.html#cb981-2" aria-hidden="true" tabindex="-1"></a>fit.mixed <span class="sc">%&gt;%</span> </span>
<span id="cb981-3"><a href="linear-mixed-effects-models-2.html#cb981-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">simulate</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb981-4"><a href="linear-mixed-effects-models-2.html#cb981-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(df.mixed) <span class="sc">%&gt;%</span> </span>
<span id="cb981-5"><a href="linear-mixed-effects-models-2.html#cb981-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> .,</span>
<span id="cb981-6"><a href="linear-mixed-effects-models-2.html#cb981-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> condition,</span>
<span id="cb981-7"><a href="linear-mixed-effects-models-2.html#cb981-7" aria-hidden="true" tabindex="-1"></a>                       <span class="at">y =</span> sim_1,</span>
<span id="cb981-8"><a href="linear-mixed-effects-models-2.html#cb981-8" aria-hidden="true" tabindex="-1"></a>                       <span class="at">group =</span> participant)) <span class="sc">+</span></span>
<span id="cb981-9"><a href="linear-mixed-effects-models-2.html#cb981-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb981-10"><a href="linear-mixed-effects-models-2.html#cb981-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>)</span></code></pre></div>
<p><img src="18-linear_mixed_effects_models2_files/figure-html/unnamed-chunk-33-1.png" width="672" /></p>
<p>Even though we only fitted random intercepts in this model, when we simulate from the model, we get different slopes since, when simulating new data, the model takes our uncertainty in the residuals into account as well.</p>
<p>Let’s see whether fitting random intercepts was worth it in this case:</p>
<div class="sourceCode" id="cb982"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb982-1"><a href="linear-mixed-effects-models-2.html#cb982-1" aria-hidden="true" tabindex="-1"></a><span class="co"># using chisq test</span></span>
<span id="cb982-2"><a href="linear-mixed-effects-models-2.html#cb982-2" aria-hidden="true" tabindex="-1"></a>fit.compact <span class="ot">=</span> <span class="fu">lm</span>(<span class="at">formula =</span> value <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span>  condition,</span>
<span id="cb982-3"><a href="linear-mixed-effects-models-2.html#cb982-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> df.mixed)</span>
<span id="cb982-4"><a href="linear-mixed-effects-models-2.html#cb982-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb982-5"><a href="linear-mixed-effects-models-2.html#cb982-5" aria-hidden="true" tabindex="-1"></a>fit.augmented <span class="ot">=</span> <span class="fu">lmer</span>(<span class="at">formula =</span> value <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> condition <span class="sc">+</span>  (<span class="dv">1</span> <span class="sc">|</span> participant),</span>
<span id="cb982-6"><a href="linear-mixed-effects-models-2.html#cb982-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> df.mixed)</span>
<span id="cb982-7"><a href="linear-mixed-effects-models-2.html#cb982-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb982-8"><a href="linear-mixed-effects-models-2.html#cb982-8" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(fit.augmented, fit.compact)</span></code></pre></div>
<pre><code>refitting model(s) with ML (instead of REML)</code></pre>
<pre><code>Data: df.mixed
Models:
fit.compact: value ~ 1 + condition
fit.augmented: value ~ 1 + condition + (1 | participant)
              npar   AIC    BIC logLik deviance  Chisq Df Pr(&gt;Chisq)
fit.compact      3 608.6 618.49 -301.3    602.6                     
fit.augmented    4 608.8 621.99 -300.4    600.8 1.7999  1     0.1797</code></pre>
<p>Nope, it’s not worth it in this case. That said, even though having random intercepts does not increase the likelihood of the data given the model significantly, we should still include random intercepts to capture the dependence in the data.</p>
</div>
</div>
<div id="the-effect-of-outliers" class="section level3" number="18.3.7">
<h3><span class="header-section-number">18.3.7</span> The effect of outliers</h3>
<p>Let’s take 20 participants from our <code>df.mixed</code> data set, and make one of the participants be an outlier:</p>
<div class="sourceCode" id="cb985"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb985-1"><a href="linear-mixed-effects-models-2.html#cb985-1" aria-hidden="true" tabindex="-1"></a><span class="co"># let&#39;s make one outlier</span></span>
<span id="cb985-2"><a href="linear-mixed-effects-models-2.html#cb985-2" aria-hidden="true" tabindex="-1"></a>df.outlier <span class="ot">=</span> df.mixed <span class="sc">%&gt;%</span></span>
<span id="cb985-3"><a href="linear-mixed-effects-models-2.html#cb985-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">participant =</span> participant <span class="sc">%&gt;%</span> <span class="fu">as.character</span>() <span class="sc">%&gt;%</span> <span class="fu">as.numeric</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb985-4"><a href="linear-mixed-effects-models-2.html#cb985-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(participant <span class="sc">&lt;=</span> <span class="dv">20</span>) <span class="sc">%&gt;%</span></span>
<span id="cb985-5"><a href="linear-mixed-effects-models-2.html#cb985-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">ifelse</span>(participant <span class="sc">==</span> <span class="dv">20</span>, value <span class="sc">+</span> <span class="dv">30</span>, value),</span>
<span id="cb985-6"><a href="linear-mixed-effects-models-2.html#cb985-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">participant =</span> <span class="fu">as.factor</span>(participant))</span></code></pre></div>
<p>Let’s fit the model and look at the summary:</p>
<div class="sourceCode" id="cb986"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb986-1"><a href="linear-mixed-effects-models-2.html#cb986-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fit model</span></span>
<span id="cb986-2"><a href="linear-mixed-effects-models-2.html#cb986-2" aria-hidden="true" tabindex="-1"></a>fit.outlier <span class="ot">=</span> <span class="fu">lmer</span>(<span class="at">formula =</span> value <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> condition <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> participant),</span>
<span id="cb986-3"><a href="linear-mixed-effects-models-2.html#cb986-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> df.outlier)</span>
<span id="cb986-4"><a href="linear-mixed-effects-models-2.html#cb986-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb986-5"><a href="linear-mixed-effects-models-2.html#cb986-5" aria-hidden="true" tabindex="-1"></a>fit.outlier <span class="sc">%&gt;%</span> </span>
<span id="cb986-6"><a href="linear-mixed-effects-models-2.html#cb986-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code></pre></div>
<pre><code>Linear mixed model fit by REML. t-tests use Satterthwaite&#39;s method [
lmerModLmerTest]
Formula: value ~ 1 + condition + (1 | participant)
   Data: df.outlier

REML criterion at convergence: 192

Scaled residuals: 
     Min       1Q   Median       3Q      Max 
-1.44598 -0.48367  0.03043  0.44689  1.41232 

Random effects:
 Groups      Name        Variance Std.Dev.
 participant (Intercept) 45.1359  6.7183  
 Residual                 0.6738  0.8209  
Number of obs: 40, groups:  participant, 20

Fixed effects:
            Estimate Std. Error      df t value Pr(&gt;|t|)    
(Intercept)   2.7091     1.5134 19.2815   1.790   0.0892 .  
condition1    2.1512     0.2596 19.0000   8.287 9.89e-08 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Correlation of Fixed Effects:
           (Intr)
condition1 -0.086</code></pre>
<p>The variance for the participants’ intercepts has increased dramatically!</p>
<p>Let’s visualize the data together with the model’s predictions:</p>
<div class="sourceCode" id="cb988"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb988-1"><a href="linear-mixed-effects-models-2.html#cb988-1" aria-hidden="true" tabindex="-1"></a>fit.outlier <span class="sc">%&gt;%</span></span>
<span id="cb988-2"><a href="linear-mixed-effects-models-2.html#cb988-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">augment</span>() <span class="sc">%&gt;%</span></span>
<span id="cb988-3"><a href="linear-mixed-effects-models-2.html#cb988-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">%&gt;%</span></span>
<span id="cb988-4"><a href="linear-mixed-effects-models-2.html#cb988-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> .,</span>
<span id="cb988-5"><a href="linear-mixed-effects-models-2.html#cb988-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> condition,</span>
<span id="cb988-6"><a href="linear-mixed-effects-models-2.html#cb988-6" aria-hidden="true" tabindex="-1"></a>                       <span class="at">y =</span> value,</span>
<span id="cb988-7"><a href="linear-mixed-effects-models-2.html#cb988-7" aria-hidden="true" tabindex="-1"></a>                       <span class="at">group =</span> participant)) <span class="sc">+</span></span>
<span id="cb988-8"><a href="linear-mixed-effects-models-2.html#cb988-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb988-9"><a href="linear-mixed-effects-models-2.html#cb988-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb988-10"><a href="linear-mixed-effects-models-2.html#cb988-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> fitted),</span>
<span id="cb988-11"><a href="linear-mixed-effects-models-2.html#cb988-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb988-12"><a href="linear-mixed-effects-models-2.html#cb988-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> fitted),</span>
<span id="cb988-13"><a href="linear-mixed-effects-models-2.html#cb988-13" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="18-linear_mixed_effects_models2_files/figure-html/unnamed-chunk-37-1.png" width="672" /></p>
<p>The model is still able to capture the participants quite well. But note what its simulated data looks like now:</p>
<div class="sourceCode" id="cb989"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb989-1"><a href="linear-mixed-effects-models-2.html#cb989-1" aria-hidden="true" tabindex="-1"></a><span class="co"># simulated data from lmer with outlier</span></span>
<span id="cb989-2"><a href="linear-mixed-effects-models-2.html#cb989-2" aria-hidden="true" tabindex="-1"></a>fit.outlier <span class="sc">%&gt;%</span> </span>
<span id="cb989-3"><a href="linear-mixed-effects-models-2.html#cb989-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">simulate</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb989-4"><a href="linear-mixed-effects-models-2.html#cb989-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(df.outlier) <span class="sc">%&gt;%</span> </span>
<span id="cb989-5"><a href="linear-mixed-effects-models-2.html#cb989-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> .,</span>
<span id="cb989-6"><a href="linear-mixed-effects-models-2.html#cb989-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> condition,</span>
<span id="cb989-7"><a href="linear-mixed-effects-models-2.html#cb989-7" aria-hidden="true" tabindex="-1"></a>                       <span class="at">y =</span> sim_1,</span>
<span id="cb989-8"><a href="linear-mixed-effects-models-2.html#cb989-8" aria-hidden="true" tabindex="-1"></a>                       <span class="at">group =</span> participant)) <span class="sc">+</span></span>
<span id="cb989-9"><a href="linear-mixed-effects-models-2.html#cb989-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb989-10"><a href="linear-mixed-effects-models-2.html#cb989-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>)</span></code></pre></div>
<p><img src="18-linear_mixed_effects_models2_files/figure-html/unnamed-chunk-38-1.png" width="672" /></p>
<p>The simulated data doesn’t look like our original data. This is because one normal distribution is used to model the variance in the intercepts between participants.</p>
</div>
<div id="different-slopes" class="section level3" number="18.3.8">
<h3><span class="header-section-number">18.3.8</span> Different slopes</h3>
<p>Let’s generate data where the effect of condition is different for participants:</p>
<div class="sourceCode" id="cb990"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb990-1"><a href="linear-mixed-effects-models-2.html#cb990-1" aria-hidden="true" tabindex="-1"></a><span class="co"># make example reproducible </span></span>
<span id="cb990-2"><a href="linear-mixed-effects-models-2.html#cb990-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb990-3"><a href="linear-mixed-effects-models-2.html#cb990-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb990-4"><a href="linear-mixed-effects-models-2.html#cb990-4" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">20</span>)</span>
<span id="cb990-5"><a href="linear-mixed-effects-models-2.html#cb990-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb990-6"><a href="linear-mixed-effects-models-2.html#cb990-6" aria-hidden="true" tabindex="-1"></a>df.slopes <span class="ot">=</span> <span class="fu">tibble</span>(</span>
<span id="cb990-7"><a href="linear-mixed-effects-models-2.html#cb990-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">condition =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">each =</span> <span class="dv">20</span>), </span>
<span id="cb990-8"><a href="linear-mixed-effects-models-2.html#cb990-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">participant =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>, <span class="dv">2</span>),</span>
<span id="cb990-9"><a href="linear-mixed-effects-models-2.html#cb990-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">value =</span> <span class="fu">ifelse</span>(condition <span class="sc">==</span> <span class="dv">1</span>, tmp,</span>
<span id="cb990-10"><a href="linear-mixed-effects-models-2.html#cb990-10" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">mean</span>(tmp) <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">20</span>, <span class="at">sd =</span> <span class="fl">0.3</span>)) <span class="co"># regression to the mean</span></span>
<span id="cb990-11"><a href="linear-mixed-effects-models-2.html#cb990-11" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span> </span>
<span id="cb990-12"><a href="linear-mixed-effects-models-2.html#cb990-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">condition =</span> <span class="fu">as.factor</span>(condition),</span>
<span id="cb990-13"><a href="linear-mixed-effects-models-2.html#cb990-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">participant =</span> <span class="fu">as.factor</span>(participant))</span></code></pre></div>
<p>Let’s fit a model with random intercepts.</p>
<div class="sourceCode" id="cb991"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb991-1"><a href="linear-mixed-effects-models-2.html#cb991-1" aria-hidden="true" tabindex="-1"></a>fit.slopes <span class="ot">=</span> <span class="fu">lmer</span>(<span class="at">formula =</span> value <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> condition <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> participant),</span>
<span id="cb991-2"><a href="linear-mixed-effects-models-2.html#cb991-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> df.slopes)</span></code></pre></div>
<pre><code>boundary (singular) fit: see ?isSingular</code></pre>
<div class="sourceCode" id="cb993"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb993-1"><a href="linear-mixed-effects-models-2.html#cb993-1" aria-hidden="true" tabindex="-1"></a>fit.slopes <span class="sc">%&gt;%</span> <span class="fu">summary</span>()</span></code></pre></div>
<pre><code>Linear mixed model fit by REML. t-tests use Satterthwaite&#39;s method [
lmerModLmerTest]
Formula: value ~ 1 + condition + (1 | participant)
   Data: df.slopes

REML criterion at convergence: 83.6

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-3.5808 -0.3184  0.0130  0.4551  2.0913 

Random effects:
 Groups      Name        Variance Std.Dev.
 participant (Intercept) 0.0000   0.0000  
 Residual                0.4512   0.6717  
Number of obs: 40, groups:  participant, 20

Fixed effects:
             Estimate Std. Error        df t value Pr(&gt;|t|)
(Intercept)  0.190524   0.150197 38.000000   1.268    0.212
condition2  -0.001941   0.212411 38.000000  -0.009    0.993

Correlation of Fixed Effects:
           (Intr)
condition2 -0.707
optimizer (nloptwrap) convergence code: 0 (OK)
boundary (singular) fit: see ?isSingular</code></pre>
<p>Note how the summary says “singular fit,” and how the variance for random intercepts is 0. Here, fitting random intercepts did not help the model fit at all, so the lmer gave up …</p>
<p>How about fitting random slopes?</p>
<div class="sourceCode" id="cb995"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb995-1"><a href="linear-mixed-effects-models-2.html#cb995-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fit model</span></span>
<span id="cb995-2"><a href="linear-mixed-effects-models-2.html#cb995-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lmer</span>(<span class="at">formula =</span> value <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> condition <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> condition <span class="sc">|</span> participant),</span>
<span id="cb995-3"><a href="linear-mixed-effects-models-2.html#cb995-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">data =</span> df.slopes)</span></code></pre></div>
<p>This won’t work because the model has more parameters than there are data points. To fit random slopes, we need more than 2 observations per participants.</p>
</div>
<div id="simpsons-paradox" class="section level3" number="18.3.9">
<h3><span class="header-section-number">18.3.9</span> Simpson’s paradox</h3>
<p>Taking dependence in the data into account is extremely important. The Simpson’s paradox is an instructive example for what can go wrong when we ignore the dependence in the data.</p>
<p>Let’s start by simulating some data to demonstrate the paradox.</p>
<div class="sourceCode" id="cb996"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb996-1"><a href="linear-mixed-effects-models-2.html#cb996-1" aria-hidden="true" tabindex="-1"></a><span class="co"># make example reproducible </span></span>
<span id="cb996-2"><a href="linear-mixed-effects-models-2.html#cb996-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2</span>)</span>
<span id="cb996-3"><a href="linear-mixed-effects-models-2.html#cb996-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb996-4"><a href="linear-mixed-effects-models-2.html#cb996-4" aria-hidden="true" tabindex="-1"></a>n_participants <span class="ot">=</span> <span class="dv">20</span></span>
<span id="cb996-5"><a href="linear-mixed-effects-models-2.html#cb996-5" aria-hidden="true" tabindex="-1"></a>n_observations <span class="ot">=</span> <span class="dv">10</span></span>
<span id="cb996-6"><a href="linear-mixed-effects-models-2.html#cb996-6" aria-hidden="true" tabindex="-1"></a>slope <span class="ot">=</span> <span class="sc">-</span><span class="dv">10</span> </span>
<span id="cb996-7"><a href="linear-mixed-effects-models-2.html#cb996-7" aria-hidden="true" tabindex="-1"></a>sd_error <span class="ot">=</span> <span class="fl">0.4</span></span>
<span id="cb996-8"><a href="linear-mixed-effects-models-2.html#cb996-8" aria-hidden="true" tabindex="-1"></a>sd_participant <span class="ot">=</span> <span class="dv">5</span></span>
<span id="cb996-9"><a href="linear-mixed-effects-models-2.html#cb996-9" aria-hidden="true" tabindex="-1"></a>intercept <span class="ot">=</span> <span class="fu">rnorm</span>(n_participants, <span class="at">sd =</span> sd_participant) <span class="sc">%&gt;%</span> <span class="fu">sort</span>()</span>
<span id="cb996-10"><a href="linear-mixed-effects-models-2.html#cb996-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb996-11"><a href="linear-mixed-effects-models-2.html#cb996-11" aria-hidden="true" tabindex="-1"></a>df.simpson <span class="ot">=</span> <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">runif</span>(n_participants <span class="sc">*</span> n_observations, <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb996-12"><a href="linear-mixed-effects-models-2.html#cb996-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(x) <span class="sc">%&gt;%</span> </span>
<span id="cb996-13"><a href="linear-mixed-effects-models-2.html#cb996-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">intercept =</span> <span class="fu">rep</span>(intercept, <span class="at">each =</span> n_observations),</span>
<span id="cb996-14"><a href="linear-mixed-effects-models-2.html#cb996-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> intercept <span class="sc">+</span> x <span class="sc">*</span> slope <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="fu">n</span>(), <span class="at">sd =</span> sd_error),</span>
<span id="cb996-15"><a href="linear-mixed-effects-models-2.html#cb996-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">participant =</span> <span class="fu">factor</span>(intercept, <span class="at">labels =</span> <span class="dv">1</span><span class="sc">:</span>n_participants))</span></code></pre></div>
<p>Let’s visualize the overall relationship between <code>x</code> and <code>y</code> with a simple linear model.</p>
<div class="sourceCode" id="cb997"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb997-1"><a href="linear-mixed-effects-models-2.html#cb997-1" aria-hidden="true" tabindex="-1"></a><span class="co"># overall effect </span></span>
<span id="cb997-2"><a href="linear-mixed-effects-models-2.html#cb997-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df.simpson,</span>
<span id="cb997-3"><a href="linear-mixed-effects-models-2.html#cb997-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> x,</span>
<span id="cb997-4"><a href="linear-mixed-effects-models-2.html#cb997-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb997-5"><a href="linear-mixed-effects-models-2.html#cb997-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb997-6"><a href="linear-mixed-effects-models-2.html#cb997-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>,</span>
<span id="cb997-7"><a href="linear-mixed-effects-models-2.html#cb997-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">&quot;black&quot;</span>)</span></code></pre></div>
<p><img src="18-linear_mixed_effects_models2_files/figure-html/unnamed-chunk-43-1.png" width="672" /></p>
<p>As we see, overall, there is a positive relationship between <code>x</code> and <code>y</code>.</p>
<div class="sourceCode" id="cb998"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb998-1"><a href="linear-mixed-effects-models-2.html#cb998-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(<span class="at">formula =</span> y <span class="sc">~</span> x,</span>
<span id="cb998-2"><a href="linear-mixed-effects-models-2.html#cb998-2" aria-hidden="true" tabindex="-1"></a>   <span class="at">data =</span> df.simpson) <span class="sc">%&gt;%</span> </span>
<span id="cb998-3"><a href="linear-mixed-effects-models-2.html#cb998-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code></pre></div>
<pre><code>
Call:
lm(formula = y ~ x, data = df.simpson)

Residuals:
    Min      1Q  Median      3Q     Max 
-5.8731 -0.6362  0.2272  1.0051  2.6410 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  -7.1151     0.2107  -33.76   &lt;2e-16 ***
x             6.3671     0.3631   17.54   &lt;2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 1.55 on 198 degrees of freedom
Multiple R-squared:  0.6083,    Adjusted R-squared:  0.6064 
F-statistic: 307.5 on 1 and 198 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>And this relationship is significant.</p>
<p>Let’s take another look at the data use different colors for the different participants.</p>
<div class="sourceCode" id="cb1000"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1000-1"><a href="linear-mixed-effects-models-2.html#cb1000-1" aria-hidden="true" tabindex="-1"></a><span class="co"># effect by participant </span></span>
<span id="cb1000-2"><a href="linear-mixed-effects-models-2.html#cb1000-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df.simpson,</span>
<span id="cb1000-3"><a href="linear-mixed-effects-models-2.html#cb1000-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> x,</span>
<span id="cb1000-4"><a href="linear-mixed-effects-models-2.html#cb1000-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> y,</span>
<span id="cb1000-5"><a href="linear-mixed-effects-models-2.html#cb1000-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">color =</span> participant)) <span class="sc">+</span></span>
<span id="cb1000-6"><a href="linear-mixed-effects-models-2.html#cb1000-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb1000-7"><a href="linear-mixed-effects-models-2.html#cb1000-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>,</span>
<span id="cb1000-8"><a href="linear-mixed-effects-models-2.html#cb1000-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb1000-9"><a href="linear-mixed-effects-models-2.html#cb1000-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="18-linear_mixed_effects_models2_files/figure-html/unnamed-chunk-45-1.png" width="672" /></p>
<p>And let’s fit a different regression for each participant:</p>
<div class="sourceCode" id="cb1001"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1001-1"><a href="linear-mixed-effects-models-2.html#cb1001-1" aria-hidden="true" tabindex="-1"></a><span class="co"># effect by participant </span></span>
<span id="cb1001-2"><a href="linear-mixed-effects-models-2.html#cb1001-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df.simpson,</span>
<span id="cb1001-3"><a href="linear-mixed-effects-models-2.html#cb1001-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> x,</span>
<span id="cb1001-4"><a href="linear-mixed-effects-models-2.html#cb1001-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> y,</span>
<span id="cb1001-5"><a href="linear-mixed-effects-models-2.html#cb1001-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">color =</span> participant,</span>
<span id="cb1001-6"><a href="linear-mixed-effects-models-2.html#cb1001-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">group =</span> participant)) <span class="sc">+</span></span>
<span id="cb1001-7"><a href="linear-mixed-effects-models-2.html#cb1001-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb1001-8"><a href="linear-mixed-effects-models-2.html#cb1001-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>,</span>
<span id="cb1001-9"><a href="linear-mixed-effects-models-2.html#cb1001-9" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb1001-10"><a href="linear-mixed-effects-models-2.html#cb1001-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="18-linear_mixed_effects_models2_files/figure-html/unnamed-chunk-46-1.png" width="672" /></p>
<p>What this plot shows, is that for almost all individual participants, the relationship between <code>x</code> and <code>y</code> is negative. The different participants where along the <code>x</code> spectrum they are.</p>
<p>Let’s fit a linear mixed effects model with random intercepts:</p>
<div class="sourceCode" id="cb1002"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1002-1"><a href="linear-mixed-effects-models-2.html#cb1002-1" aria-hidden="true" tabindex="-1"></a>fit.lmer <span class="ot">=</span> <span class="fu">lmer</span>(<span class="at">formula =</span> y <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> x <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> participant),</span>
<span id="cb1002-2"><a href="linear-mixed-effects-models-2.html#cb1002-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">data =</span> df.simpson)</span>
<span id="cb1002-3"><a href="linear-mixed-effects-models-2.html#cb1002-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1002-4"><a href="linear-mixed-effects-models-2.html#cb1002-4" aria-hidden="true" tabindex="-1"></a>fit.lmer <span class="sc">%&gt;%</span> </span>
<span id="cb1002-5"><a href="linear-mixed-effects-models-2.html#cb1002-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code></pre></div>
<pre><code>Linear mixed model fit by REML. t-tests use Satterthwaite&#39;s method [
lmerModLmerTest]
Formula: y ~ 1 + x + (1 | participant)
   Data: df.simpson

REML criterion at convergence: 345.1

Scaled residuals: 
     Min       1Q   Median       3Q      Max 
-2.43394 -0.59687  0.04493  0.62694  2.68828 

Random effects:
 Groups      Name        Variance Std.Dev.
 participant (Intercept) 21.4898  4.6357  
 Residual                 0.1661  0.4075  
Number of obs: 200, groups:  participant, 20

Fixed effects:
            Estimate Std. Error       df t value Pr(&gt;|t|)    
(Intercept)  -0.1577     1.3230  22.4259  -0.119    0.906    
x            -7.6678     1.6572 141.6084  -4.627  8.3e-06 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Correlation of Fixed Effects:
  (Intr)
x -0.621</code></pre>
<p>As we can see, the fixed effect for <code>x</code> is now negative!</p>
<div class="sourceCode" id="cb1004"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1004-1"><a href="linear-mixed-effects-models-2.html#cb1004-1" aria-hidden="true" tabindex="-1"></a>fit.lmer <span class="sc">%&gt;%</span> </span>
<span id="cb1004-2"><a href="linear-mixed-effects-models-2.html#cb1004-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">augment</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1004-3"><a href="linear-mixed-effects-models-2.html#cb1004-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1004-4"><a href="linear-mixed-effects-models-2.html#cb1004-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> .,</span>
<span id="cb1004-5"><a href="linear-mixed-effects-models-2.html#cb1004-5" aria-hidden="true" tabindex="-1"></a>         <span class="fu">aes</span>(<span class="at">x =</span> x,</span>
<span id="cb1004-6"><a href="linear-mixed-effects-models-2.html#cb1004-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> y,</span>
<span id="cb1004-7"><a href="linear-mixed-effects-models-2.html#cb1004-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">group =</span> participant,</span>
<span id="cb1004-8"><a href="linear-mixed-effects-models-2.html#cb1004-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> participant)) <span class="sc">+</span></span>
<span id="cb1004-9"><a href="linear-mixed-effects-models-2.html#cb1004-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb1004-10"><a href="linear-mixed-effects-models-2.html#cb1004-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> fitted),</span>
<span id="cb1004-11"><a href="linear-mixed-effects-models-2.html#cb1004-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">1</span>,</span>
<span id="cb1004-12"><a href="linear-mixed-effects-models-2.html#cb1004-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb1004-13"><a href="linear-mixed-effects-models-2.html#cb1004-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="18-linear_mixed_effects_models2_files/figure-html/unnamed-chunk-48-1.png" width="672" /></p>
<p>Lesson learned: taking dependence into account is critical for drawing correct inferences!</p>
</div>
</div>
<div id="additional-resources-15" class="section level2" number="18.4">
<h2><span class="header-section-number">18.4</span> Additional resources</h2>
<div id="readings-1" class="section level3" number="18.4.1">
<h3><span class="header-section-number">18.4.1</span> Readings</h3>
<ul>
<li><a href="https://arxiv.org/pdf/1308.5499.pdf">Linear mixed effects models tutorial by Bodo Winter</a></li>
<li><a href="https://paulvanderlaken.com/2017/09/27/simpsons-paradox-two-hr-examples-with-r-code/">Simpson’s paradox</a></li>
<li><a href="https://www.tjmahr.com/plotting-partial-pooling-in-mixed-effects-models/">Tutorial on pooling</a></li>
</ul>
</div>
</div>
<div id="session-info-17" class="section level2" number="18.5">
<h2><span class="header-section-number">18.5</span> Session info</h2>
<p>Information about this R session including which version of R was used, and what packages were loaded.</p>
<div class="sourceCode" id="cb1005"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1005-1"><a href="linear-mixed-effects-models-2.html#cb1005-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span></code></pre></div>
<pre><code>R version 4.0.3 (2020-10-10)
Platform: x86_64-apple-darwin17.0 (64-bit)
Running under: macOS Catalina 10.15.7

Matrix products: default
BLAS:   /Library/Frameworks/R.framework/Versions/4.0/Resources/lib/libRblas.dylib
LAPACK: /Library/Frameworks/R.framework/Versions/4.0/Resources/lib/libRlapack.dylib

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
 [1] forcats_0.5.1       stringr_1.4.0       dplyr_1.0.4        
 [4] purrr_0.3.4         readr_1.4.0         tidyr_1.1.2        
 [7] tibble_3.0.6        ggplot2_3.3.3       tidyverse_1.3.0    
[10] see_0.6.2           performance_0.7.0.1 afex_0.28-1        
[13] lme4_1.1-26         Matrix_1.3-2        ggeffects_1.0.1    
[16] broom.mixed_0.2.6   janitor_2.1.0       kableExtra_1.3.1   
[19] knitr_1.31         

loaded via a namespace (and not attached):
 [1] TH.data_1.0-10      minqa_1.2.4         colorspace_2.0-0   
 [4] ellipsis_0.3.1      rio_0.5.16          ggridges_0.5.3     
 [7] sjlabelled_1.1.7    estimability_1.3    snakecase_0.11.0   
[10] parameters_0.12.0.1 fs_1.5.0            rstudioapi_0.13    
[13] farver_2.1.0        ggrepel_0.9.1       mvtnorm_1.1-1      
[16] lubridate_1.7.9.2   xml2_1.3.2          codetools_0.2-18   
[19] splines_4.0.3       jsonlite_1.7.2      nloptr_1.2.2.2     
[22] pbkrtest_0.5-0.1    broom_0.7.3         dbplyr_2.0.0       
[25] effectsize_0.4.3-1  compiler_4.0.3      httr_1.4.2         
[28] emmeans_1.5.3       backports_1.2.1     assertthat_0.2.1   
[31] cli_2.3.0           htmltools_0.5.1.1   tools_4.0.3        
[34] lmerTest_3.1-3      coda_0.19-4         gtable_0.3.0       
[37] glue_1.4.2          reshape2_1.4.4      Rcpp_1.0.6         
[40] carData_3.0-4       cellranger_1.1.0    vctrs_0.3.6        
[43] nlme_3.1-151        insight_0.13.1.1    xfun_0.21          
[46] ps_1.6.0            openxlsx_4.2.3      rvest_0.3.6        
[49] lifecycle_1.0.0     statmod_1.4.35      MASS_7.3-53        
[52] zoo_1.8-8           scales_1.1.1        hms_1.0.0          
[55] parallel_4.0.3      sandwich_3.0-0      TMB_1.7.18         
[58] yaml_2.2.1          curl_4.3            gridExtra_2.3      
[61] stringi_1.5.3       highr_0.8           bayestestR_0.8.3.1 
[64] boot_1.3-26         zip_2.1.1           rlang_0.4.10       
[67] pkgconfig_2.0.3     evaluate_0.14       lattice_0.20-41    
[70] labeling_0.4.2      tidyselect_1.1.0    plyr_1.8.6         
[73] magrittr_2.0.1      bookdown_0.21       R6_2.5.0           
[76] generics_0.1.0      multcomp_1.4-15     DBI_1.1.1          
[79] mgcv_1.8-33         withr_2.4.1         pillar_1.4.7       
[82] haven_2.3.1         foreign_0.8-81      survival_3.2-7     
[85] abind_1.4-5         modelr_0.1.8        crayon_1.4.1       
[88] car_3.0-10          rmarkdown_2.6       grid_4.0.3         
[91] readxl_1.3.1        data.table_1.13.6   reprex_1.0.0       
[94] digest_0.6.27       webshot_0.5.2       xtable_1.8-4       
[97] numDeriv_2016.8-1.1 munsell_0.5.0       viridisLite_0.3.0  </code></pre>
</div>
<div id="references-7" class="section level2" number="18.6">
<h2><span class="header-section-number">18.6</span> References</h2>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="linear-mixed-effects-models-1.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="linear-mixed-effects-models-3.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"],
"google": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/psych252/psych252book/edit/master/18-linear_mixed_effects_models2.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"toc_depth": 3,
"search": false
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
