<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 6 Power | Psych 710: Statistical Methods II</title>
  <meta name="description" content="Course notes for Psych 710." />
  <meta name="generator" content="bookdown 0.34 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 6 Power | Psych 710: Statistical Methods II" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Course notes for Psych 710." />
  <meta name="github-repo" content="SocialInteractionLab/psych710-notes" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 6 Power | Psych 710: Statistical Methods II" />
  
  <meta name="twitter:description" content="Course notes for Psych 710." />
  

<meta name="author" content="Robert Hawkins" />


<meta name="date" content="2024-01-20" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="linear-regression.html"/>
<link rel="next" href="linear-mixed-effects-models-1.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<script src="libs/viz-1.8.2/viz.js"></script>
<link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="libs/grViz-binding-1.0.10/grViz.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.31/datatables.js"></script>
<link href="libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Psych 252</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#course-homepage"><i class="fa fa-check"></i>Course homepage</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#license-and-citation"><i class="fa fa-check"></i>License and citation</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="probability.html"><a href="probability.html"><i class="fa fa-check"></i><b>1</b> Probability</a>
<ul>
<li class="chapter" data-level="1.1" data-path="probability.html"><a href="probability.html#load-packages-load-data-set-theme"><i class="fa fa-check"></i><b>1.1</b> Load packages, load data, set theme</a></li>
<li class="chapter" data-level="1.2" data-path="probability.html"><a href="probability.html#learning-goals"><i class="fa fa-check"></i><b>1.2</b> Learning goals</a></li>
<li class="chapter" data-level="1.3" data-path="probability.html"><a href="probability.html#counting"><i class="fa fa-check"></i><b>1.3</b> Counting</a></li>
<li class="chapter" data-level="1.4" data-path="probability.html"><a href="probability.html#sampling"><i class="fa fa-check"></i><b>1.4</b> Sampling</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="probability.html"><a href="probability.html#drawing-rows-from-a-data-frame"><i class="fa fa-check"></i><b>1.4.1</b> Drawing rows from a data frame</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="probability.html"><a href="probability.html#more-complex-counting-matching"><i class="fa fa-check"></i><b>1.5</b> More complex counting / matching</a></li>
<li class="chapter" data-level="1.6" data-path="probability.html"><a href="probability.html#conditional-probability"><i class="fa fa-check"></i><b>1.6</b> Conditional probability</a></li>
<li class="chapter" data-level="1.7" data-path="probability.html"><a href="probability.html#law-of-total-probability"><i class="fa fa-check"></i><b>1.7</b> Law of total probability</a></li>
<li class="chapter" data-level="1.8" data-path="probability.html"><a href="probability.html#additional-resources"><i class="fa fa-check"></i><b>1.8</b> Additional resources</a>
<ul>
<li class="chapter" data-level="1.8.1" data-path="probability.html"><a href="probability.html#cheatsheets"><i class="fa fa-check"></i><b>1.8.1</b> Cheatsheets</a></li>
<li class="chapter" data-level="1.8.2" data-path="probability.html"><a href="probability.html#books-and-chapters"><i class="fa fa-check"></i><b>1.8.2</b> Books and chapters</a></li>
<li class="chapter" data-level="1.8.3" data-path="probability.html"><a href="probability.html#misc"><i class="fa fa-check"></i><b>1.8.3</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="1.9" data-path="probability.html"><a href="probability.html#session-info"><i class="fa fa-check"></i><b>1.9</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="estimation.html"><a href="estimation.html"><i class="fa fa-check"></i><b>2</b> Estimation</a>
<ul>
<li class="chapter" data-level="2.1" data-path="estimation.html"><a href="estimation.html#load-packages-and-set-plotting-theme"><i class="fa fa-check"></i><b>2.1</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="2.2" data-path="estimation.html"><a href="estimation.html#working-with-distributions"><i class="fa fa-check"></i><b>2.2</b> Working with distributions</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="estimation.html"><a href="estimation.html#plotting-distributions"><i class="fa fa-check"></i><b>2.2.1</b> Plotting distributions</a></li>
<li class="chapter" data-level="2.2.2" data-path="estimation.html"><a href="estimation.html#sampling-from-distributions"><i class="fa fa-check"></i><b>2.2.2</b> Sampling from distributions</a></li>
<li class="chapter" data-level="2.2.3" data-path="estimation.html"><a href="estimation.html#understanding-density"><i class="fa fa-check"></i><b>2.2.3</b> Understanding <code>density()</code></a></li>
<li class="chapter" data-level="2.2.4" data-path="estimation.html"><a href="estimation.html#cumulative-probability-distributions"><i class="fa fa-check"></i><b>2.2.4</b> Cumulative probability distributions</a></li>
<li class="chapter" data-level="2.2.5" data-path="estimation.html"><a href="estimation.html#inverse-cumulative-distribution"><i class="fa fa-check"></i><b>2.2.5</b> Inverse cumulative distribution</a></li>
<li class="chapter" data-level="2.2.6" data-path="estimation.html"><a href="estimation.html#computing-probabilities"><i class="fa fa-check"></i><b>2.2.6</b> Computing probabilities</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="estimation.html"><a href="estimation.html#estimating-a-coin"><i class="fa fa-check"></i><b>2.3</b> Estimating a coin</a></li>
<li class="chapter" data-level="2.4" data-path="estimation.html"><a href="estimation.html#bayesian-inference-with-the-normal-distribution"><i class="fa fa-check"></i><b>2.4</b> Bayesian inference with the normal distribution</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="estimation.html"><a href="estimation.html#analytic-solution"><i class="fa fa-check"></i><b>2.4.1</b> Analytic solution</a></li>
<li class="chapter" data-level="2.4.2" data-path="estimation.html"><a href="estimation.html#solution-via-sampling"><i class="fa fa-check"></i><b>2.4.2</b> Solution via sampling</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="estimation.html"><a href="estimation.html#additional-resources-1"><i class="fa fa-check"></i><b>2.5</b> Additional resources</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="estimation.html"><a href="estimation.html#datacamp"><i class="fa fa-check"></i><b>2.5.1</b> Datacamp</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="estimation.html"><a href="estimation.html#session-info-1"><i class="fa fa-check"></i><b>2.6</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="modeling-data.html"><a href="modeling-data.html"><i class="fa fa-check"></i><b>3</b> Modeling data</a>
<ul>
<li class="chapter" data-level="3.1" data-path="modeling-data.html"><a href="modeling-data.html#load-packages-and-set-plotting-theme-1"><i class="fa fa-check"></i><b>3.1</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="3.2" data-path="modeling-data.html"><a href="modeling-data.html#modeling-data-1"><i class="fa fa-check"></i><b>3.2</b> Modeling data</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="modeling-data.html"><a href="modeling-data.html#simplicity-vs.-accuracy-trade-off"><i class="fa fa-check"></i><b>3.2.1</b> Simplicity vs. accuracy trade-off</a></li>
<li class="chapter" data-level="3.2.2" data-path="modeling-data.html"><a href="modeling-data.html#sampling-distributions-for-median-and-mean"><i class="fa fa-check"></i><b>3.2.2</b> Sampling distributions for median and mean</a></li>
<li class="chapter" data-level="3.2.3" data-path="modeling-data.html"><a href="modeling-data.html#residuals-need-to-be-normally-distributed-not-the-data-itself"><i class="fa fa-check"></i><b>3.2.3</b> Residuals need to be normally distributed, not the data itself</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="modeling-data.html"><a href="modeling-data.html#hypothesis-testing-one-sample-t-test"><i class="fa fa-check"></i><b>3.3</b> Hypothesis testing: “One-sample t-test”</a></li>
<li class="chapter" data-level="3.4" data-path="modeling-data.html"><a href="modeling-data.html#building-a-sampling-distribution-of-pre"><i class="fa fa-check"></i><b>3.4</b> Building a sampling distribution of PRE</a></li>
<li class="chapter" data-level="3.5" data-path="modeling-data.html"><a href="modeling-data.html#misc-1"><i class="fa fa-check"></i><b>3.5</b> Misc</a></li>
<li class="chapter" data-level="3.6" data-path="modeling-data.html"><a href="modeling-data.html#additional-resources-2"><i class="fa fa-check"></i><b>3.6</b> Additional resources</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="modeling-data.html"><a href="modeling-data.html#reading"><i class="fa fa-check"></i><b>3.6.1</b> Reading</a></li>
<li class="chapter" data-level="3.6.2" data-path="modeling-data.html"><a href="modeling-data.html#datacamp-1"><i class="fa fa-check"></i><b>3.6.2</b> Datacamp</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="modeling-data.html"><a href="modeling-data.html#session-info-2"><i class="fa fa-check"></i><b>3.7</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="inference.html"><a href="inference.html"><i class="fa fa-check"></i><b>4</b> Inference</a>
<ul>
<li class="chapter" data-level="4.1" data-path="inference.html"><a href="inference.html#load-packages-and-set-plotting-theme-2"><i class="fa fa-check"></i><b>4.1</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="4.2" data-path="inference.html"><a href="inference.html#making-statistical-inferences-frequentist-style"><i class="fa fa-check"></i><b>4.2</b> Making statistical inferences (frequentist style)</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="inference.html"><a href="inference.html#population-distribution"><i class="fa fa-check"></i><b>4.2.1</b> Population distribution</a></li>
<li class="chapter" data-level="4.2.2" data-path="inference.html"><a href="inference.html#distribution-of-a-single-sample"><i class="fa fa-check"></i><b>4.2.2</b> Distribution of a single sample</a></li>
<li class="chapter" data-level="4.2.3" data-path="inference.html"><a href="inference.html#the-sampling-distribution"><i class="fa fa-check"></i><b>4.2.3</b> The sampling distribution</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="inference.html"><a href="inference.html#understanding-p-values"><i class="fa fa-check"></i><b>4.3</b> Understanding p-values</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="inference.html"><a href="inference.html#permutation-test"><i class="fa fa-check"></i><b>4.3.1</b> Permutation test</a></li>
<li class="chapter" data-level="4.3.2" data-path="inference.html"><a href="inference.html#t-test-by-hand"><i class="fa fa-check"></i><b>4.3.2</b> t-test by hand</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="inference.html"><a href="inference.html#confidence-intervals"><i class="fa fa-check"></i><b>4.4</b> Confidence intervals</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="inference.html"><a href="inference.html#mean_cl_boot-explained"><i class="fa fa-check"></i><b>4.4.1</b> <code>mean_cl_boot()</code> explained</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="inference.html"><a href="inference.html#additional-resources-3"><i class="fa fa-check"></i><b>4.5</b> Additional resources</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="inference.html"><a href="inference.html#misc-2"><i class="fa fa-check"></i><b>4.5.1</b> Misc</a></li>
<li class="chapter" data-level="4.5.2" data-path="inference.html"><a href="inference.html#datacamp-2"><i class="fa fa-check"></i><b>4.5.2</b> Datacamp</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="inference.html"><a href="inference.html#session-info-3"><i class="fa fa-check"></i><b>4.6</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="linear-regression.html"><a href="linear-regression.html"><i class="fa fa-check"></i><b>5</b> Linear regression</a>
<ul>
<li class="chapter" data-level="5.1" data-path="linear-regression.html"><a href="linear-regression.html#learning-goals-1"><i class="fa fa-check"></i><b>5.1</b> Learning goals</a></li>
<li class="chapter" data-level="5.2" data-path="linear-regression.html"><a href="linear-regression.html#load-packages-and-set-plotting-theme-3"><i class="fa fa-check"></i><b>5.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="5.3" data-path="linear-regression.html"><a href="linear-regression.html#load-data-sets"><i class="fa fa-check"></i><b>5.3</b> Load data sets</a></li>
<li class="chapter" data-level="5.4" data-path="linear-regression.html"><a href="linear-regression.html#multiple-continuous-variables"><i class="fa fa-check"></i><b>5.4</b> Multiple continuous variables</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="linear-regression.html"><a href="linear-regression.html#explore-correlations"><i class="fa fa-check"></i><b>5.4.1</b> Explore correlations</a></li>
<li class="chapter" data-level="5.4.2" data-path="linear-regression.html"><a href="linear-regression.html#multipe-regression"><i class="fa fa-check"></i><b>5.4.2</b> Multipe regression</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="linear-regression.html"><a href="linear-regression.html#one-categorical-variable"><i class="fa fa-check"></i><b>5.5</b> One categorical variable</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="linear-regression.html"><a href="linear-regression.html#visualization-of-the-model-predictions"><i class="fa fa-check"></i><b>5.5.1</b> Visualization of the model predictions</a></li>
<li class="chapter" data-level="5.5.2" data-path="linear-regression.html"><a href="linear-regression.html#dummy-coding"><i class="fa fa-check"></i><b>5.5.2</b> Dummy coding</a></li>
<li class="chapter" data-level="5.5.3" data-path="linear-regression.html"><a href="linear-regression.html#reporting-the-results"><i class="fa fa-check"></i><b>5.5.3</b> Reporting the results</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="linear-regression.html"><a href="linear-regression.html#one-continuous-and-one-categorical-variable"><i class="fa fa-check"></i><b>5.6</b> One continuous and one categorical variable</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="linear-regression.html"><a href="linear-regression.html#visualization-of-the-model-predictions-1"><i class="fa fa-check"></i><b>5.6.1</b> Visualization of the model predictions</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="linear-regression.html"><a href="linear-regression.html#interactions"><i class="fa fa-check"></i><b>5.7</b> Interactions</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="linear-regression.html"><a href="linear-regression.html#visualization-1"><i class="fa fa-check"></i><b>5.7.1</b> Visualization</a></li>
<li class="chapter" data-level="5.7.2" data-path="linear-regression.html"><a href="linear-regression.html#hypothesis-test"><i class="fa fa-check"></i><b>5.7.2</b> Hypothesis test</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="linear-regression.html"><a href="linear-regression.html#additional-resources-4"><i class="fa fa-check"></i><b>5.8</b> Additional resources</a>
<ul>
<li class="chapter" data-level="5.8.1" data-path="linear-regression.html"><a href="linear-regression.html#datacamp-3"><i class="fa fa-check"></i><b>5.8.1</b> Datacamp</a></li>
<li class="chapter" data-level="5.8.2" data-path="linear-regression.html"><a href="linear-regression.html#misc-3"><i class="fa fa-check"></i><b>5.8.2</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="5.9" data-path="linear-regression.html"><a href="linear-regression.html#session-info-4"><i class="fa fa-check"></i><b>5.9</b> Session info</a></li>
<li class="chapter" data-level="5.10" data-path="linear-regression.html"><a href="linear-regression.html#references"><i class="fa fa-check"></i><b>5.10</b> References</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="power.html"><a href="power.html"><i class="fa fa-check"></i><b>6</b> Power</a>
<ul>
<li class="chapter" data-level="6.1" data-path="power.html"><a href="power.html#learning-goals-2"><i class="fa fa-check"></i><b>6.1</b> Learning goals</a></li>
<li class="chapter" data-level="6.2" data-path="power.html"><a href="power.html#load-packages-and-set-plotting-theme-4"><i class="fa fa-check"></i><b>6.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="6.3" data-path="power.html"><a href="power.html#load-data-sets-1"><i class="fa fa-check"></i><b>6.3</b> Load data sets</a></li>
<li class="chapter" data-level="6.4" data-path="power.html"><a href="power.html#decision-making"><i class="fa fa-check"></i><b>6.4</b> Decision-making</a></li>
<li class="chapter" data-level="6.5" data-path="power.html"><a href="power.html#effect-sizes"><i class="fa fa-check"></i><b>6.5</b> Effect sizes</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="power.html"><a href="power.html#cohens-d"><i class="fa fa-check"></i><b>6.5.1</b> Cohen’s d</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="power.html"><a href="power.html#determining-sample-size"><i class="fa fa-check"></i><b>6.6</b> Determining sample size</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="power.html"><a href="power.html#pwr-package"><i class="fa fa-check"></i><b>6.6.1</b> <code>pwr</code> package</a></li>
<li class="chapter" data-level="6.6.2" data-path="power.html"><a href="power.html#power-analysis"><i class="fa fa-check"></i><b>6.6.2</b> Power analysis</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="power.html"><a href="power.html#additional-resources-5"><i class="fa fa-check"></i><b>6.7</b> Additional resources</a>
<ul>
<li class="chapter" data-level="6.7.1" data-path="power.html"><a href="power.html#datacamp-4"><i class="fa fa-check"></i><b>6.7.1</b> Datacamp</a></li>
<li class="chapter" data-level="6.7.2" data-path="power.html"><a href="power.html#cheatsheets-1"><i class="fa fa-check"></i><b>6.7.2</b> Cheatsheets</a></li>
<li class="chapter" data-level="6.7.3" data-path="power.html"><a href="power.html#misc-4"><i class="fa fa-check"></i><b>6.7.3</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="6.8" data-path="power.html"><a href="power.html#session-info-5"><i class="fa fa-check"></i><b>6.8</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html"><i class="fa fa-check"></i><b>7</b> Linear mixed effects models 1</a>
<ul>
<li class="chapter" data-level="7.1" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html#learning-goals-3"><i class="fa fa-check"></i><b>7.1</b> Learning goals</a></li>
<li class="chapter" data-level="7.2" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html#load-packages-and-set-plotting-theme-5"><i class="fa fa-check"></i><b>7.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="7.3" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html#dependence"><i class="fa fa-check"></i><b>7.3</b> Dependence</a></li>
<li class="chapter" data-level="7.4" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html#additional-resources-6"><i class="fa fa-check"></i><b>7.4</b> Additional resources</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html#readings"><i class="fa fa-check"></i><b>7.4.1</b> Readings</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html#session-info-6"><i class="fa fa-check"></i><b>7.5</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html"><i class="fa fa-check"></i><b>8</b> Linear mixed effects models 2</a>
<ul>
<li class="chapter" data-level="8.1" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#learning-goals-4"><i class="fa fa-check"></i><b>8.1</b> Learning goals</a></li>
<li class="chapter" data-level="8.2" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#load-packages-and-set-plotting-theme-6"><i class="fa fa-check"></i><b>8.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="8.3" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#a-worked-example"><i class="fa fa-check"></i><b>8.3</b> A worked example</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#complete-pooling"><i class="fa fa-check"></i><b>8.3.1</b> Complete pooling</a></li>
<li class="chapter" data-level="8.3.2" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#no-pooling"><i class="fa fa-check"></i><b>8.3.2</b> No pooling</a></li>
<li class="chapter" data-level="8.3.3" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#partial-pooling"><i class="fa fa-check"></i><b>8.3.3</b> Partial pooling</a></li>
<li class="chapter" data-level="8.3.4" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#compare-results"><i class="fa fa-check"></i><b>8.3.4</b> Compare results</a></li>
<li class="chapter" data-level="8.3.5" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#getting-p-values"><i class="fa fa-check"></i><b>8.3.5</b> Getting p-values</a></li>
<li class="chapter" data-level="8.3.6" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#reporting-results"><i class="fa fa-check"></i><b>8.3.6</b> Reporting results</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#simulating-a-linear-mixed-effects-model"><i class="fa fa-check"></i><b>8.4</b> Simulating a linear mixed effects model</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#the-effect-of-outliers"><i class="fa fa-check"></i><b>8.4.1</b> The effect of outliers</a></li>
<li class="chapter" data-level="8.4.2" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#different-slopes"><i class="fa fa-check"></i><b>8.4.2</b> Different slopes</a></li>
<li class="chapter" data-level="8.4.3" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#simpsons-paradox"><i class="fa fa-check"></i><b>8.4.3</b> Simpson’s paradox</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#additional-resources-7"><i class="fa fa-check"></i><b>8.5</b> Additional resources</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#readings-1"><i class="fa fa-check"></i><b>8.5.1</b> Readings</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#session-info-7"><i class="fa fa-check"></i><b>8.6</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html"><i class="fa fa-check"></i><b>9</b> Linear mixed effects models 3</a>
<ul>
<li class="chapter" data-level="9.1" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#learning-goals-5"><i class="fa fa-check"></i><b>9.1</b> Learning goals</a></li>
<li class="chapter" data-level="9.2" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#load-packages-and-set-plotting-theme-7"><i class="fa fa-check"></i><b>9.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="9.3" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#load-data-sets-2"><i class="fa fa-check"></i><b>9.3</b> Load data sets</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#sleep-data"><i class="fa fa-check"></i><b>9.3.1</b> Sleep data</a></li>
<li class="chapter" data-level="9.3.2" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#reasoning-data"><i class="fa fa-check"></i><b>9.3.2</b> Reasoning data</a></li>
<li class="chapter" data-level="9.3.3" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#weight-loss-data"><i class="fa fa-check"></i><b>9.3.3</b> Weight loss data</a></li>
<li class="chapter" data-level="9.3.4" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#politness-data"><i class="fa fa-check"></i><b>9.3.4</b> Politness data</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#understanding-the-lmer-syntax"><i class="fa fa-check"></i><b>9.4</b> Understanding the lmer() syntax</a></li>
<li class="chapter" data-level="9.5" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#anova-vs.-lmer"><i class="fa fa-check"></i><b>9.5</b> ANOVA vs. Lmer</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#between-subjects-anova"><i class="fa fa-check"></i><b>9.5.1</b> Between subjects ANOVA</a></li>
<li class="chapter" data-level="9.5.2" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#repeated-measures-anova"><i class="fa fa-check"></i><b>9.5.2</b> Repeated-measures ANOVA</a></li>
<li class="chapter" data-level="9.5.3" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#mixed-anova"><i class="fa fa-check"></i><b>9.5.3</b> Mixed ANOVA</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#session-info-8"><i class="fa fa-check"></i><b>9.6</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html"><i class="fa fa-check"></i><b>10</b> Linear mixed effects models 4</a>
<ul>
<li class="chapter" data-level="10.1" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#learning-goals-6"><i class="fa fa-check"></i><b>10.1</b> Learning goals</a></li>
<li class="chapter" data-level="10.2" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#load-packages-and-set-plotting-theme-8"><i class="fa fa-check"></i><b>10.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="10.3" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#load-data-sets-3"><i class="fa fa-check"></i><b>10.3</b> Load data sets</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#sleep-data-1"><i class="fa fa-check"></i><b>10.3.1</b> Sleep data</a></li>
<li class="chapter" data-level="10.3.2" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#reasoning-data-1"><i class="fa fa-check"></i><b>10.3.2</b> Reasoning data</a></li>
<li class="chapter" data-level="10.3.3" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#weight-loss-data-1"><i class="fa fa-check"></i><b>10.3.3</b> Weight loss data</a></li>
<li class="chapter" data-level="10.3.4" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#politness-data-1"><i class="fa fa-check"></i><b>10.3.4</b> Politness data</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#follow-up-tests-with-emmeans"><i class="fa fa-check"></i><b>10.4</b> Follow-up tests with emmeans</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#sleep-study"><i class="fa fa-check"></i><b>10.4.1</b> Sleep study</a></li>
<li class="chapter" data-level="10.4.2" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#weight-loss-study"><i class="fa fa-check"></i><b>10.4.2</b> Weight loss study</a></li>
<li class="chapter" data-level="10.4.3" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#politeness-study"><i class="fa fa-check"></i><b>10.4.3</b> Politeness study</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#mixtures-of-participants"><i class="fa fa-check"></i><b>10.5</b> Mixtures of participants</a></li>
<li class="chapter" data-level="10.6" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#bootstrapping"><i class="fa fa-check"></i><b>10.6</b> Bootstrapping</a>
<ul>
<li class="chapter" data-level="10.6.1" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#linear-model"><i class="fa fa-check"></i><b>10.6.1</b> Linear model</a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#session-info-9"><i class="fa fa-check"></i><b>10.7</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="contrasts.html"><a href="contrasts.html"><i class="fa fa-check"></i><b>11</b> Contrasts</a>
<ul>
<li class="chapter" data-level="11.1" data-path="contrasts.html"><a href="contrasts.html#learning-goals-7"><i class="fa fa-check"></i><b>11.1</b> Learning goals</a></li>
<li class="chapter" data-level="11.2" data-path="contrasts.html"><a href="contrasts.html#load-packages-and-set-plotting-theme-9"><i class="fa fa-check"></i><b>11.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="11.3" data-path="contrasts.html"><a href="contrasts.html#load-data-sets-4"><i class="fa fa-check"></i><b>11.3</b> Load data sets</a></li>
<li class="chapter" data-level="11.4" data-path="contrasts.html"><a href="contrasts.html#one-way-anova"><i class="fa fa-check"></i><b>11.4</b> One-way ANOVA</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="contrasts.html"><a href="contrasts.html#visualization-2"><i class="fa fa-check"></i><b>11.4.1</b> Visualization</a></li>
<li class="chapter" data-level="11.4.2" data-path="contrasts.html"><a href="contrasts.html#model-fitting"><i class="fa fa-check"></i><b>11.4.2</b> Model fitting</a></li>
<li class="chapter" data-level="11.4.3" data-path="contrasts.html"><a href="contrasts.html#hypothesis-test-1"><i class="fa fa-check"></i><b>11.4.3</b> Hypothesis test</a></li>
<li class="chapter" data-level="11.4.4" data-path="contrasts.html"><a href="contrasts.html#visualize-the-models-predictions"><i class="fa fa-check"></i><b>11.4.4</b> Visualize the model’s predictions</a></li>
<li class="chapter" data-level="11.4.5" data-path="contrasts.html"><a href="contrasts.html#dummy-coding-1"><i class="fa fa-check"></i><b>11.4.5</b> Dummy coding</a></li>
<li class="chapter" data-level="11.4.6" data-path="contrasts.html"><a href="contrasts.html#follow-up-questions"><i class="fa fa-check"></i><b>11.4.6</b> Follow up questions</a></li>
<li class="chapter" data-level="11.4.7" data-path="contrasts.html"><a href="contrasts.html#variance-decomposition"><i class="fa fa-check"></i><b>11.4.7</b> Variance decomposition</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="contrasts.html"><a href="contrasts.html#two-way-anova"><i class="fa fa-check"></i><b>11.5</b> Two-way ANOVA</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="contrasts.html"><a href="contrasts.html#visualization-3"><i class="fa fa-check"></i><b>11.5.1</b> Visualization</a></li>
<li class="chapter" data-level="11.5.2" data-path="contrasts.html"><a href="contrasts.html#model-fitting-1"><i class="fa fa-check"></i><b>11.5.2</b> Model fitting</a></li>
<li class="chapter" data-level="11.5.3" data-path="contrasts.html"><a href="contrasts.html#interpreting-interactions"><i class="fa fa-check"></i><b>11.5.3</b> Interpreting interactions</a></li>
<li class="chapter" data-level="11.5.4" data-path="contrasts.html"><a href="contrasts.html#variance-decomposition-1"><i class="fa fa-check"></i><b>11.5.4</b> Variance decomposition</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="contrasts.html"><a href="contrasts.html#two-way-anova-with-interaction"><i class="fa fa-check"></i><b>11.6</b> Two-way ANOVA (with interaction)</a></li>
<li class="chapter" data-level="11.7" data-path="contrasts.html"><a href="contrasts.html#anova-with-unbalanced-design"><i class="fa fa-check"></i><b>11.7</b> ANOVA with unbalanced design</a></li>
<li class="chapter" data-level="11.8" data-path="contrasts.html"><a href="contrasts.html#interpreting-parameters-very-important"><i class="fa fa-check"></i><b>11.8</b> Interpreting parameters (very important!)</a></li>
<li class="chapter" data-level="11.9" data-path="contrasts.html"><a href="contrasts.html#linear-contrasts"><i class="fa fa-check"></i><b>11.9</b> Linear contrasts</a>
<ul>
<li class="chapter" data-level="11.9.1" data-path="contrasts.html"><a href="contrasts.html#hypothetical-data"><i class="fa fa-check"></i><b>11.9.1</b> Hypothetical data</a></li>
<li class="chapter" data-level="11.9.2" data-path="contrasts.html"><a href="contrasts.html#visualization-4"><i class="fa fa-check"></i><b>11.9.2</b> Visualization</a></li>
<li class="chapter" data-level="11.9.3" data-path="contrasts.html"><a href="contrasts.html#orthogonal-contrasts"><i class="fa fa-check"></i><b>11.9.3</b> Orthogonal contrasts</a></li>
<li class="chapter" data-level="11.9.4" data-path="contrasts.html"><a href="contrasts.html#post-hoc-tests"><i class="fa fa-check"></i><b>11.9.4</b> Post-hoc tests</a></li>
<li class="chapter" data-level="11.9.5" data-path="contrasts.html"><a href="contrasts.html#understanding-dummy-coding"><i class="fa fa-check"></i><b>11.9.5</b> Understanding dummy coding</a></li>
<li class="chapter" data-level="11.9.6" data-path="contrasts.html"><a href="contrasts.html#understanding-sum-coding"><i class="fa fa-check"></i><b>11.9.6</b> Understanding sum coding</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html"><i class="fa fa-check"></i><b>12</b> Generalized linear model</a>
<ul>
<li class="chapter" data-level="12.1" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#learning-goals-8"><i class="fa fa-check"></i><b>12.1</b> Learning goals</a></li>
<li class="chapter" data-level="12.2" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#load-packages-and-set-plotting-theme-10"><i class="fa fa-check"></i><b>12.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="12.3" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#load-data-set"><i class="fa fa-check"></i><b>12.3</b> Load data set</a></li>
<li class="chapter" data-level="12.4" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#logistic-regression"><i class="fa fa-check"></i><b>12.4</b> Logistic regression</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#interpreting-the-parameters"><i class="fa fa-check"></i><b>12.4.1</b> Interpreting the parameters</a></li>
<li class="chapter" data-level="12.4.2" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#binary-predictor"><i class="fa fa-check"></i><b>12.4.2</b> Binary predictor</a></li>
<li class="chapter" data-level="12.4.3" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#continuous-predictor"><i class="fa fa-check"></i><b>12.4.3</b> Continuous predictor</a></li>
<li class="chapter" data-level="12.4.4" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#several-predictors"><i class="fa fa-check"></i><b>12.4.4</b> Several predictors</a></li>
<li class="chapter" data-level="12.4.5" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#using-the-ggeffects-package"><i class="fa fa-check"></i><b>12.4.5</b> Using the “ggeffects” package</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#simulate-a-logistic-regression"><i class="fa fa-check"></i><b>12.5</b> Simulate a logistic regression</a>
<ul>
<li class="chapter" data-level="12.5.1" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#calculate-the-models-likelihood"><i class="fa fa-check"></i><b>12.5.1</b> Calculate the model’s likelihood</a></li>
</ul></li>
<li class="chapter" data-level="12.6" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#testing-hypotheses"><i class="fa fa-check"></i><b>12.6</b> Testing hypotheses</a></li>
<li class="chapter" data-level="12.7" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#logistic-mixed-effects-model"><i class="fa fa-check"></i><b>12.7</b> Logistic mixed effects model</a></li>
<li class="chapter" data-level="12.8" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#additional-information"><i class="fa fa-check"></i><b>12.8</b> Additional information</a>
<ul>
<li class="chapter" data-level="12.8.1" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#misc-5"><i class="fa fa-check"></i><b>12.8.1</b> Misc</a></li>
<li class="chapter" data-level="12.8.2" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#datacamp-5"><i class="fa fa-check"></i><b>12.8.2</b> Datacamp</a></li>
</ul></li>
<li class="chapter" data-level="12.9" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#session-info-10"><i class="fa fa-check"></i><b>12.9</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="model-comparison.html"><a href="model-comparison.html"><i class="fa fa-check"></i><b>13</b> Model comparison</a>
<ul>
<li class="chapter" data-level="13.1" data-path="model-comparison.html"><a href="model-comparison.html#learning-goals-9"><i class="fa fa-check"></i><b>13.1</b> Learning goals</a></li>
<li class="chapter" data-level="13.2" data-path="model-comparison.html"><a href="model-comparison.html#load-packages-and-set-plotting-theme-11"><i class="fa fa-check"></i><b>13.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="13.3" data-path="model-comparison.html"><a href="model-comparison.html#model-comparison-1"><i class="fa fa-check"></i><b>13.3</b> Model comparison</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="model-comparison.html"><a href="model-comparison.html#fitting-vs.-predicting"><i class="fa fa-check"></i><b>13.3.1</b> Fitting vs. predicting</a></li>
<li class="chapter" data-level="13.3.2" data-path="model-comparison.html"><a href="model-comparison.html#f-test"><i class="fa fa-check"></i><b>13.3.2</b> F-test</a></li>
<li class="chapter" data-level="13.3.3" data-path="model-comparison.html"><a href="model-comparison.html#cross-validation"><i class="fa fa-check"></i><b>13.3.3</b> Cross-validation</a></li>
<li class="chapter" data-level="13.3.4" data-path="model-comparison.html"><a href="model-comparison.html#bootstrap"><i class="fa fa-check"></i><b>13.3.4</b> Bootstrap</a></li>
<li class="chapter" data-level="13.3.5" data-path="model-comparison.html"><a href="model-comparison.html#aic-and-bic"><i class="fa fa-check"></i><b>13.3.5</b> AIC and BIC</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="model-comparison.html"><a href="model-comparison.html#additional-resources-8"><i class="fa fa-check"></i><b>13.4</b> Additional resources</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="model-comparison.html"><a href="model-comparison.html#datacamp-course"><i class="fa fa-check"></i><b>13.4.1</b> Datacamp course</a></li>
<li class="chapter" data-level="13.4.2" data-path="model-comparison.html"><a href="model-comparison.html#reading-1"><i class="fa fa-check"></i><b>13.4.2</b> Reading</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="model-comparison.html"><a href="model-comparison.html#session-info-11"><i class="fa fa-check"></i><b>13.5</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="bayesian-data-analysis-1.html"><a href="bayesian-data-analysis-1.html"><i class="fa fa-check"></i><b>14</b> Bayesian data analysis 1</a>
<ul>
<li class="chapter" data-level="14.1" data-path="bayesian-data-analysis-1.html"><a href="bayesian-data-analysis-1.html#learning-goals-10"><i class="fa fa-check"></i><b>14.1</b> Learning goals</a></li>
<li class="chapter" data-level="14.2" data-path="bayesian-data-analysis-1.html"><a href="bayesian-data-analysis-1.html#load-packages-and-set-plotting-theme-12"><i class="fa fa-check"></i><b>14.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="14.3" data-path="bayesian-data-analysis-1.html"><a href="bayesian-data-analysis-1.html#doing-bayesian-inference-by-hand"><i class="fa fa-check"></i><b>14.3</b> Doing Bayesian inference “by hand”</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="bayesian-data-analysis-1.html"><a href="bayesian-data-analysis-1.html#sequential-updating-based-on-the-beta-distribution"><i class="fa fa-check"></i><b>14.3.1</b> Sequential updating based on the Beta distribution</a></li>
<li class="chapter" data-level="14.3.2" data-path="bayesian-data-analysis-1.html"><a href="bayesian-data-analysis-1.html#coin-flip-example"><i class="fa fa-check"></i><b>14.3.2</b> Coin flip example</a></li>
<li class="chapter" data-level="14.3.3" data-path="bayesian-data-analysis-1.html"><a href="bayesian-data-analysis-1.html#bayesian-inference-by-discretization"><i class="fa fa-check"></i><b>14.3.3</b> Bayesian inference by discretization</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="bayesian-data-analysis-1.html"><a href="bayesian-data-analysis-1.html#doing-bayesian-inference-with-greta"><i class="fa fa-check"></i><b>14.4</b> Doing Bayesian inference with Greta</a>
<ul>
<li class="chapter" data-level="14.4.1" data-path="bayesian-data-analysis-1.html"><a href="bayesian-data-analysis-1.html#attitude-data-set"><i class="fa fa-check"></i><b>14.4.1</b> Attitude data set</a></li>
<li class="chapter" data-level="14.4.2" data-path="bayesian-data-analysis-1.html"><a href="bayesian-data-analysis-1.html#frequentist-analysis"><i class="fa fa-check"></i><b>14.4.2</b> Frequentist analysis</a></li>
<li class="chapter" data-level="14.4.3" data-path="bayesian-data-analysis-1.html"><a href="bayesian-data-analysis-1.html#bayesian-regression"><i class="fa fa-check"></i><b>14.4.3</b> Bayesian regression</a></li>
</ul></li>
<li class="chapter" data-level="14.5" data-path="bayesian-data-analysis-1.html"><a href="bayesian-data-analysis-1.html#additional-resources-9"><i class="fa fa-check"></i><b>14.5</b> Additional resources</a>
<ul>
<li class="chapter" data-level="14.5.1" data-path="bayesian-data-analysis-1.html"><a href="bayesian-data-analysis-1.html#books-and-chapters-1"><i class="fa fa-check"></i><b>14.5.1</b> Books and chapters</a></li>
</ul></li>
<li class="chapter" data-level="14.6" data-path="bayesian-data-analysis-1.html"><a href="bayesian-data-analysis-1.html#session-info-12"><i class="fa fa-check"></i><b>14.6</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html"><i class="fa fa-check"></i><b>15</b> Bayesian data analysis 2</a>
<ul>
<li class="chapter" data-level="15.1" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#learning-goals-11"><i class="fa fa-check"></i><b>15.1</b> Learning goals</a></li>
<li class="chapter" data-level="15.2" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#load-packages-and-set-plotting-theme-13"><i class="fa fa-check"></i><b>15.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="15.3" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#load-data-sets-5"><i class="fa fa-check"></i><b>15.3</b> Load data sets</a></li>
<li class="chapter" data-level="15.4" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#poker"><i class="fa fa-check"></i><b>15.4</b> Poker</a>
<ul>
<li class="chapter" data-level="15.4.1" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#visualize-the-data"><i class="fa fa-check"></i><b>15.4.1</b> 1. Visualize the data</a></li>
<li class="chapter" data-level="15.4.2" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#specify-and-fit-the-model"><i class="fa fa-check"></i><b>15.4.2</b> 2. Specify and fit the model</a></li>
<li class="chapter" data-level="15.4.3" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#model-evaluation"><i class="fa fa-check"></i><b>15.4.3</b> 3. Model evaluation</a></li>
<li class="chapter" data-level="15.4.4" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#interpret-the-model-parameters"><i class="fa fa-check"></i><b>15.4.4</b> 4. Interpret the model parameters</a></li>
<li class="chapter" data-level="15.4.5" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#test-specific-hypotheses"><i class="fa fa-check"></i><b>15.4.5</b> 5. Test specific hypotheses</a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#sleep-study-1"><i class="fa fa-check"></i><b>15.5</b> Sleep study</a>
<ul>
<li class="chapter" data-level="15.5.1" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#visualize-the-data-1"><i class="fa fa-check"></i><b>15.5.1</b> 1. Visualize the data</a></li>
<li class="chapter" data-level="15.5.2" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#specify-and-fit-the-model-1"><i class="fa fa-check"></i><b>15.5.2</b> 2. Specify and fit the model</a></li>
<li class="chapter" data-level="15.5.3" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#model-evaluation-1"><i class="fa fa-check"></i><b>15.5.3</b> 3. Model evaluation</a></li>
<li class="chapter" data-level="15.5.4" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#interpret-the-parameters"><i class="fa fa-check"></i><b>15.5.4</b> 4. Interpret the parameters</a></li>
<li class="chapter" data-level="15.5.5" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#test-specific-hypotheses-1"><i class="fa fa-check"></i><b>15.5.5</b> 5. Test specific hypotheses</a></li>
<li class="chapter" data-level="15.5.6" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#report-results"><i class="fa fa-check"></i><b>15.5.6</b> 6. Report results</a></li>
</ul></li>
<li class="chapter" data-level="15.6" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#titanic-study"><i class="fa fa-check"></i><b>15.6</b> Titanic study</a>
<ul>
<li class="chapter" data-level="15.6.1" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#visualize-the-data-2"><i class="fa fa-check"></i><b>15.6.1</b> 1. Visualize the data</a></li>
<li class="chapter" data-level="15.6.2" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#specify-and-fit-the-model-2"><i class="fa fa-check"></i><b>15.6.2</b> 2. Specify and fit the model</a></li>
<li class="chapter" data-level="15.6.3" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#model-evaluation-2"><i class="fa fa-check"></i><b>15.6.3</b> 3. Model evaluation</a></li>
<li class="chapter" data-level="15.6.4" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#interpret-the-parameters-1"><i class="fa fa-check"></i><b>15.6.4</b> 4. Interpret the parameters</a></li>
<li class="chapter" data-level="15.6.5" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#test-specific-hypotheses-2"><i class="fa fa-check"></i><b>15.6.5</b> 5. Test specific hypotheses</a></li>
<li class="chapter" data-level="15.6.6" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#report-results-1"><i class="fa fa-check"></i><b>15.6.6</b> 6. Report results</a></li>
</ul></li>
<li class="chapter" data-level="15.7" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#politeness-data"><i class="fa fa-check"></i><b>15.7</b> Politeness data</a>
<ul>
<li class="chapter" data-level="15.7.1" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#visualize-the-data-3"><i class="fa fa-check"></i><b>15.7.1</b> 1. Visualize the data</a></li>
<li class="chapter" data-level="15.7.2" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#specify-and-fit-the-model-3"><i class="fa fa-check"></i><b>15.7.2</b> 2. Specify and fit the model</a></li>
<li class="chapter" data-level="15.7.3" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#test-specific-hypotheses-3"><i class="fa fa-check"></i><b>15.7.3</b> 5. Test specific hypotheses</a></li>
</ul></li>
<li class="chapter" data-level="15.8" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#additional-resources-10"><i class="fa fa-check"></i><b>15.8</b> Additional resources</a></li>
<li class="chapter" data-level="15.9" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#session-info-13"><i class="fa fa-check"></i><b>15.9</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html"><i class="fa fa-check"></i><b>16</b> Bayesian data analysis 3</a>
<ul>
<li class="chapter" data-level="16.1" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#learning-goals-12"><i class="fa fa-check"></i><b>16.1</b> Learning goals</a></li>
<li class="chapter" data-level="16.2" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#load-packages-and-set-plotting-theme-14"><i class="fa fa-check"></i><b>16.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="16.3" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#evidence-for-the-null-hypothesis"><i class="fa fa-check"></i><b>16.3</b> Evidence for the null hypothesis</a>
<ul>
<li class="chapter" data-level="16.3.1" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#bayes-factor-1"><i class="fa fa-check"></i><b>16.3.1</b> Bayes factor</a></li>
<li class="chapter" data-level="16.3.2" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#loo"><i class="fa fa-check"></i><b>16.3.2</b> LOO</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#dealing-with-heteroscedasticity"><i class="fa fa-check"></i><b>16.4</b> Dealing with heteroscedasticity</a>
<ul>
<li class="chapter" data-level="16.4.1" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#visualize-the-data-4"><i class="fa fa-check"></i><b>16.4.1</b> Visualize the data</a></li>
<li class="chapter" data-level="16.4.2" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#frequentist-analysis-4"><i class="fa fa-check"></i><b>16.4.2</b> Frequentist analysis</a></li>
<li class="chapter" data-level="16.4.3" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#bayesian-analysis-3"><i class="fa fa-check"></i><b>16.4.3</b> Bayesian analysis</a></li>
</ul></li>
<li class="chapter" data-level="16.5" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#zero-one-inflated-beta-binomial-model"><i class="fa fa-check"></i><b>16.5</b> Zero-one inflated beta binomial model</a></li>
<li class="chapter" data-level="16.6" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#ordinal-regression"><i class="fa fa-check"></i><b>16.6</b> Ordinal regression</a>
<ul>
<li class="chapter" data-level="16.6.1" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#ordinal-regression-assuming-equal-variance"><i class="fa fa-check"></i><b>16.6.1</b> Ordinal regression (assuming equal variance)</a></li>
<li class="chapter" data-level="16.6.2" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#gaussian-regression-assuming-equal-variance"><i class="fa fa-check"></i><b>16.6.2</b> Gaussian regression (assuming equal variance)</a></li>
<li class="chapter" data-level="16.6.3" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#oridnal-regression-unequal-variance"><i class="fa fa-check"></i><b>16.6.3</b> Oridnal regression (unequal variance)</a></li>
<li class="chapter" data-level="16.6.4" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#gaussian-regression-unequal-variance"><i class="fa fa-check"></i><b>16.6.4</b> Gaussian regression (unequal variance)</a></li>
<li class="chapter" data-level="16.6.5" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#model-comparison-2"><i class="fa fa-check"></i><b>16.6.5</b> Model comparison</a></li>
</ul></li>
<li class="chapter" data-level="16.7" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#additional-resources-11"><i class="fa fa-check"></i><b>16.7</b> Additional resources</a></li>
<li class="chapter" data-level="16.8" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#session-info-14"><i class="fa fa-check"></i><b>16.8</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="appendix-a-visualization.html"><a href="appendix-a-visualization.html"><i class="fa fa-check"></i><b>17</b> Appendix A: Visualization</a>
<ul>
<li class="chapter" data-level="17.1" data-path="appendix-a-visualization.html"><a href="appendix-a-visualization.html#learning-goals-13"><i class="fa fa-check"></i><b>17.1</b> Learning goals</a></li>
<li class="chapter" data-level="17.2" data-path="appendix-a-visualization.html"><a href="appendix-a-visualization.html#load-packages"><i class="fa fa-check"></i><b>17.2</b> Load packages</a></li>
<li class="chapter" data-level="17.3" data-path="appendix-a-visualization.html"><a href="appendix-a-visualization.html#why-visualize-data"><i class="fa fa-check"></i><b>17.3</b> Why visualize data?</a></li>
<li class="chapter" data-level="17.4" data-path="appendix-a-visualization.html"><a href="appendix-a-visualization.html#some-basics"><i class="fa fa-check"></i><b>17.4</b> Some basics</a>
<ul>
<li class="chapter" data-level="17.4.1" data-path="appendix-a-visualization.html"><a href="appendix-a-visualization.html#setting-up-rstudio"><i class="fa fa-check"></i><b>17.4.1</b> Setting up RStudio</a></li>
<li class="chapter" data-level="17.4.2" data-path="appendix-a-visualization.html"><a href="appendix-a-visualization.html#getting-help"><i class="fa fa-check"></i><b>17.4.2</b> Getting help</a></li>
<li class="chapter" data-level="17.4.3" data-path="appendix-a-visualization.html"><a href="appendix-a-visualization.html#r-markdown-infos"><i class="fa fa-check"></i><b>17.4.3</b> R Markdown infos</a></li>
<li class="chapter" data-level="17.4.4" data-path="appendix-a-visualization.html"><a href="appendix-a-visualization.html#helpful-keyboard-shortcuts"><i class="fa fa-check"></i><b>17.4.4</b> Helpful keyboard shortcuts</a></li>
</ul></li>
<li class="chapter" data-level="17.5" data-path="appendix-a-visualization.html"><a href="appendix-a-visualization.html#data-visualization"><i class="fa fa-check"></i><b>17.5</b> Data visualization</a>
<ul>
<li class="chapter" data-level="17.5.1" data-path="appendix-a-visualization.html"><a href="appendix-a-visualization.html#setting-up-a-plot"><i class="fa fa-check"></i><b>17.5.1</b> Setting up a plot</a></li>
<li class="chapter" data-level="17.5.2" data-path="appendix-a-visualization.html"><a href="appendix-a-visualization.html#bar-plot"><i class="fa fa-check"></i><b>17.5.2</b> Bar plot</a></li>
<li class="chapter" data-level="17.5.3" data-path="appendix-a-visualization.html"><a href="appendix-a-visualization.html#setting-the-default-plot-theme"><i class="fa fa-check"></i><b>17.5.3</b> Setting the default plot theme</a></li>
<li class="chapter" data-level="17.5.4" data-path="appendix-a-visualization.html"><a href="appendix-a-visualization.html#scatter-plot"><i class="fa fa-check"></i><b>17.5.4</b> Scatter plot</a></li>
<li class="chapter" data-level="17.5.5" data-path="appendix-a-visualization.html"><a href="appendix-a-visualization.html#line-plot"><i class="fa fa-check"></i><b>17.5.5</b> Line plot</a></li>
<li class="chapter" data-level="17.5.6" data-path="appendix-a-visualization.html"><a href="appendix-a-visualization.html#adding-error-bars"><i class="fa fa-check"></i><b>17.5.6</b> Adding error bars</a></li>
<li class="chapter" data-level="17.5.7" data-path="appendix-a-visualization.html"><a href="appendix-a-visualization.html#order-matters"><i class="fa fa-check"></i><b>17.5.7</b> Order matters</a></li>
<li class="chapter" data-level="17.5.8" data-path="appendix-a-visualization.html"><a href="appendix-a-visualization.html#grouping-data"><i class="fa fa-check"></i><b>17.5.8</b> Grouping data</a></li>
<li class="chapter" data-level="17.5.9" data-path="appendix-a-visualization.html"><a href="appendix-a-visualization.html#making-facets"><i class="fa fa-check"></i><b>17.5.9</b> Making facets</a></li>
<li class="chapter" data-level="17.5.10" data-path="appendix-a-visualization.html"><a href="appendix-a-visualization.html#global-local-and-setting-aes"><i class="fa fa-check"></i><b>17.5.10</b> Global, local, and setting <code>aes()</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="18" data-path="visualization-2-1.html"><a href="visualization-2-1.html"><i class="fa fa-check"></i><b>18</b> Visualization 2</a>
<ul>
<li class="chapter" data-level="18.1" data-path="visualization-2-1.html"><a href="visualization-2-1.html#learning-objectives"><i class="fa fa-check"></i><b>18.1</b> Learning objectives</a></li>
<li class="chapter" data-level="18.2" data-path="visualization-2-1.html"><a href="visualization-2-1.html#install-and-load-packages-load-data-set-theme"><i class="fa fa-check"></i><b>18.2</b> Install and load packages, load data, set theme</a></li>
<li class="chapter" data-level="18.3" data-path="visualization-2-1.html"><a href="visualization-2-1.html#overview-of-different-plot-types-for-different-things"><i class="fa fa-check"></i><b>18.3</b> Overview of different plot types for different things</a>
<ul>
<li class="chapter" data-level="18.3.1" data-path="visualization-2-1.html"><a href="visualization-2-1.html#proportions"><i class="fa fa-check"></i><b>18.3.1</b> Proportions</a></li>
<li class="chapter" data-level="18.3.2" data-path="visualization-2-1.html"><a href="visualization-2-1.html#comparisons"><i class="fa fa-check"></i><b>18.3.2</b> Comparisons</a></li>
<li class="chapter" data-level="18.3.3" data-path="visualization-2-1.html"><a href="visualization-2-1.html#relationships"><i class="fa fa-check"></i><b>18.3.3</b> Relationships</a></li>
<li class="chapter" data-level="18.3.4" data-path="visualization-2-1.html"><a href="visualization-2-1.html#temporal-data"><i class="fa fa-check"></i><b>18.3.4</b> Temporal data</a></li>
</ul></li>
<li class="chapter" data-level="18.4" data-path="visualization-2-1.html"><a href="visualization-2-1.html#customizing-plots"><i class="fa fa-check"></i><b>18.4</b> Customizing plots</a>
<ul>
<li class="chapter" data-level="18.4.1" data-path="visualization-2-1.html"><a href="visualization-2-1.html#anatomy-of-a-ggplot"><i class="fa fa-check"></i><b>18.4.1</b> Anatomy of a <code>ggplot</code></a></li>
<li class="chapter" data-level="18.4.2" data-path="visualization-2-1.html"><a href="visualization-2-1.html#changing-the-order-of-things"><i class="fa fa-check"></i><b>18.4.2</b> Changing the order of things</a></li>
<li class="chapter" data-level="18.4.3" data-path="visualization-2-1.html"><a href="visualization-2-1.html#dealing-with-legends"><i class="fa fa-check"></i><b>18.4.3</b> Dealing with legends</a></li>
<li class="chapter" data-level="18.4.4" data-path="visualization-2-1.html"><a href="visualization-2-1.html#choosing-good-colors"><i class="fa fa-check"></i><b>18.4.4</b> Choosing good colors</a></li>
<li class="chapter" data-level="18.4.5" data-path="visualization-2-1.html"><a href="visualization-2-1.html#customizing-themes"><i class="fa fa-check"></i><b>18.4.5</b> Customizing themes</a></li>
</ul></li>
<li class="chapter" data-level="18.5" data-path="visualization-2-1.html"><a href="visualization-2-1.html#saving-plots"><i class="fa fa-check"></i><b>18.5</b> Saving plots</a></li>
<li class="chapter" data-level="18.6" data-path="visualization-2-1.html"><a href="visualization-2-1.html#creating-figure-panels"><i class="fa fa-check"></i><b>18.6</b> Creating figure panels</a></li>
<li class="chapter" data-level="18.7" data-path="visualization-2-1.html"><a href="visualization-2-1.html#peeking-behind-the-scenes"><i class="fa fa-check"></i><b>18.7</b> Peeking behind the scenes</a></li>
<li class="chapter" data-level="18.8" data-path="visualization-2-1.html"><a href="visualization-2-1.html#making-animations"><i class="fa fa-check"></i><b>18.8</b> Making animations</a></li>
<li class="chapter" data-level="18.9" data-path="visualization-2-1.html"><a href="visualization-2-1.html#shiny-apps"><i class="fa fa-check"></i><b>18.9</b> Shiny apps</a></li>
<li class="chapter" data-level="18.10" data-path="visualization-2-1.html"><a href="visualization-2-1.html#defining-snippets"><i class="fa fa-check"></i><b>18.10</b> Defining snippets</a></li>
<li class="chapter" data-level="18.11" data-path="visualization-2-1.html"><a href="visualization-2-1.html#additional-resources-12"><i class="fa fa-check"></i><b>18.11</b> Additional resources</a>
<ul>
<li class="chapter" data-level="18.11.1" data-path="visualization-2-1.html"><a href="visualization-2-1.html#cheatsheets-2"><i class="fa fa-check"></i><b>18.11.1</b> Cheatsheets</a></li>
<li class="chapter" data-level="18.11.2" data-path="visualization-2-1.html"><a href="visualization-2-1.html#datacamp-courses"><i class="fa fa-check"></i><b>18.11.2</b> Datacamp courses</a></li>
<li class="chapter" data-level="18.11.3" data-path="visualization-2-1.html"><a href="visualization-2-1.html#books-and-chapters-2"><i class="fa fa-check"></i><b>18.11.3</b> Books and chapters</a></li>
<li class="chapter" data-level="18.11.4" data-path="visualization-2-1.html"><a href="visualization-2-1.html#misc-6"><i class="fa fa-check"></i><b>18.11.4</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="18.12" data-path="visualization-2-1.html"><a href="visualization-2-1.html#session-info-15"><i class="fa fa-check"></i><b>18.12</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="appendix-b-data-wrangling.html"><a href="appendix-b-data-wrangling.html"><i class="fa fa-check"></i><b>19</b> Appendix B: Data wrangling</a>
<ul>
<li class="chapter" data-level="19.1" data-path="appendix-b-data-wrangling.html"><a href="appendix-b-data-wrangling.html#learning-goals-14"><i class="fa fa-check"></i><b>19.1</b> Learning goals</a></li>
<li class="chapter" data-level="19.2" data-path="appendix-b-data-wrangling.html"><a href="appendix-b-data-wrangling.html#load-packages-1"><i class="fa fa-check"></i><b>19.2</b> Load packages</a></li>
<li class="chapter" data-level="19.3" data-path="appendix-b-data-wrangling.html"><a href="appendix-b-data-wrangling.html#some-r-basics"><i class="fa fa-check"></i><b>19.3</b> Some R basics</a>
<ul>
<li class="chapter" data-level="19.3.1" data-path="appendix-b-data-wrangling.html"><a href="appendix-b-data-wrangling.html#modes"><i class="fa fa-check"></i><b>19.3.1</b> Modes</a></li>
<li class="chapter" data-level="19.3.2" data-path="appendix-b-data-wrangling.html"><a href="appendix-b-data-wrangling.html#data-types"><i class="fa fa-check"></i><b>19.3.2</b> Data types</a></li>
<li class="chapter" data-level="19.3.3" data-path="appendix-b-data-wrangling.html"><a href="appendix-b-data-wrangling.html#operators"><i class="fa fa-check"></i><b>19.3.3</b> Operators</a></li>
<li class="chapter" data-level="19.3.4" data-path="appendix-b-data-wrangling.html"><a href="appendix-b-data-wrangling.html#control-flow"><i class="fa fa-check"></i><b>19.3.4</b> Control flow</a></li>
<li class="chapter" data-level="19.3.5" data-path="appendix-b-data-wrangling.html"><a href="appendix-b-data-wrangling.html#functions"><i class="fa fa-check"></i><b>19.3.5</b> Functions</a></li>
<li class="chapter" data-level="19.3.6" data-path="appendix-b-data-wrangling.html"><a href="appendix-b-data-wrangling.html#the-pipe-operator"><i class="fa fa-check"></i><b>19.3.6</b> The pipe operator <code>%&gt;%</code></a></li>
</ul></li>
<li class="chapter" data-level="19.4" data-path="appendix-b-data-wrangling.html"><a href="appendix-b-data-wrangling.html#a-quick-note-on-naming-things"><i class="fa fa-check"></i><b>19.4</b> A quick note on naming things</a></li>
<li class="chapter" data-level="19.5" data-path="appendix-b-data-wrangling.html"><a href="appendix-b-data-wrangling.html#looking-at-data"><i class="fa fa-check"></i><b>19.5</b> Looking at data</a>
<ul>
<li class="chapter" data-level="19.5.1" data-path="appendix-b-data-wrangling.html"><a href="appendix-b-data-wrangling.html#head"><i class="fa fa-check"></i><b>19.5.1</b> <code>head()</code></a></li>
<li class="chapter" data-level="19.5.2" data-path="appendix-b-data-wrangling.html"><a href="appendix-b-data-wrangling.html#glimpse"><i class="fa fa-check"></i><b>19.5.2</b> <code>glimpse()</code></a></li>
<li class="chapter" data-level="19.5.3" data-path="appendix-b-data-wrangling.html"><a href="appendix-b-data-wrangling.html#distinct"><i class="fa fa-check"></i><b>19.5.3</b> <code>distinct()</code></a></li>
<li class="chapter" data-level="19.5.4" data-path="appendix-b-data-wrangling.html"><a href="appendix-b-data-wrangling.html#count"><i class="fa fa-check"></i><b>19.5.4</b> <code>count()</code></a></li>
<li class="chapter" data-level="19.5.5" data-path="appendix-b-data-wrangling.html"><a href="appendix-b-data-wrangling.html#datatable"><i class="fa fa-check"></i><b>19.5.5</b> <code>datatable()</code></a></li>
<li class="chapter" data-level="19.5.6" data-path="appendix-b-data-wrangling.html"><a href="appendix-b-data-wrangling.html#other-tools-for-taking-a-quick-look-at-data"><i class="fa fa-check"></i><b>19.5.6</b> Other tools for taking a quick look at data</a></li>
</ul></li>
<li class="chapter" data-level="19.6" data-path="appendix-b-data-wrangling.html"><a href="appendix-b-data-wrangling.html#wrangling-data"><i class="fa fa-check"></i><b>19.6</b> Wrangling data</a>
<ul>
<li class="chapter" data-level="19.6.1" data-path="appendix-b-data-wrangling.html"><a href="appendix-b-data-wrangling.html#filter"><i class="fa fa-check"></i><b>19.6.1</b> <code>filter()</code></a></li>
<li class="chapter" data-level="19.6.2" data-path="appendix-b-data-wrangling.html"><a href="appendix-b-data-wrangling.html#arrange"><i class="fa fa-check"></i><b>19.6.2</b> <code>arrange()</code></a></li>
<li class="chapter" data-level="19.6.3" data-path="appendix-b-data-wrangling.html"><a href="appendix-b-data-wrangling.html#rename"><i class="fa fa-check"></i><b>19.6.3</b> <code>rename()</code></a></li>
<li class="chapter" data-level="19.6.4" data-path="appendix-b-data-wrangling.html"><a href="appendix-b-data-wrangling.html#relocate"><i class="fa fa-check"></i><b>19.6.4</b> <code>relocate()</code></a></li>
<li class="chapter" data-level="19.6.5" data-path="appendix-b-data-wrangling.html"><a href="appendix-b-data-wrangling.html#select"><i class="fa fa-check"></i><b>19.6.5</b> <code>select()</code></a></li>
<li class="chapter" data-level="19.6.6" data-path="appendix-b-data-wrangling.html"><a href="appendix-b-data-wrangling.html#practice-2"><i class="fa fa-check"></i><b>19.6.6</b> Practice 2</a></li>
<li class="chapter" data-level="19.6.7" data-path="appendix-b-data-wrangling.html"><a href="appendix-b-data-wrangling.html#mutate"><i class="fa fa-check"></i><b>19.6.7</b> <code>mutate()</code></a></li>
<li class="chapter" data-level="19.6.8" data-path="appendix-b-data-wrangling.html"><a href="appendix-b-data-wrangling.html#practice-3"><i class="fa fa-check"></i><b>19.6.8</b> Practice 3</a></li>
<li class="chapter" data-level="19.6.9" data-path="appendix-b-data-wrangling.html"><a href="appendix-b-data-wrangling.html#summarizing-data"><i class="fa fa-check"></i><b>19.6.9</b> Summarizing data</a></li>
<li class="chapter" data-level="19.6.10" data-path="appendix-b-data-wrangling.html"><a href="appendix-b-data-wrangling.html#reshaping-data"><i class="fa fa-check"></i><b>19.6.10</b> Reshaping data</a></li>
<li class="chapter" data-level="19.6.11" data-path="appendix-b-data-wrangling.html"><a href="appendix-b-data-wrangling.html#joining-multiple-data-frames"><i class="fa fa-check"></i><b>19.6.11</b> Joining multiple data frames</a></li>
<li class="chapter" data-level="19.6.12" data-path="appendix-b-data-wrangling.html"><a href="appendix-b-data-wrangling.html#dealing-with-missing-data"><i class="fa fa-check"></i><b>19.6.12</b> Dealing with missing data</a></li>
</ul></li>
<li class="chapter" data-level="19.7" data-path="appendix-b-data-wrangling.html"><a href="appendix-b-data-wrangling.html#reading-in-data"><i class="fa fa-check"></i><b>19.7</b> Reading in data</a>
<ul>
<li class="chapter" data-level="19.7.1" data-path="appendix-b-data-wrangling.html"><a href="appendix-b-data-wrangling.html#csv"><i class="fa fa-check"></i><b>19.7.1</b> csv</a></li>
<li class="chapter" data-level="19.7.2" data-path="appendix-b-data-wrangling.html"><a href="appendix-b-data-wrangling.html#rdata"><i class="fa fa-check"></i><b>19.7.2</b> RData</a></li>
</ul></li>
<li class="chapter" data-level="19.8" data-path="appendix-b-data-wrangling.html"><a href="appendix-b-data-wrangling.html#saving-data"><i class="fa fa-check"></i><b>19.8</b> Saving data</a>
<ul>
<li class="chapter" data-level="19.8.1" data-path="appendix-b-data-wrangling.html"><a href="appendix-b-data-wrangling.html#csv-1"><i class="fa fa-check"></i><b>19.8.1</b> csv</a></li>
<li class="chapter" data-level="19.8.2" data-path="appendix-b-data-wrangling.html"><a href="appendix-b-data-wrangling.html#rdata-1"><i class="fa fa-check"></i><b>19.8.2</b> RData</a></li>
</ul></li>
<li class="chapter" data-level="19.9" data-path="appendix-b-data-wrangling.html"><a href="appendix-b-data-wrangling.html#additional-resources-13"><i class="fa fa-check"></i><b>19.9</b> Additional resources</a>
<ul>
<li class="chapter" data-level="19.9.1" data-path="appendix-b-data-wrangling.html"><a href="appendix-b-data-wrangling.html#cheatsheets-3"><i class="fa fa-check"></i><b>19.9.1</b> Cheatsheets</a></li>
<li class="chapter" data-level="19.9.2" data-path="appendix-b-data-wrangling.html"><a href="appendix-b-data-wrangling.html#data-camp-courses"><i class="fa fa-check"></i><b>19.9.2</b> Data camp courses</a></li>
<li class="chapter" data-level="19.9.3" data-path="appendix-b-data-wrangling.html"><a href="appendix-b-data-wrangling.html#books-and-chapters-3"><i class="fa fa-check"></i><b>19.9.3</b> Books and chapters</a></li>
</ul></li>
<li class="chapter" data-level="19.10" data-path="appendix-b-data-wrangling.html"><a href="appendix-b-data-wrangling.html#session-info-16"><i class="fa fa-check"></i><b>19.10</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="model-assumptions.html"><a href="model-assumptions.html"><i class="fa fa-check"></i><b>20</b> Model assumptions</a>
<ul>
<li class="chapter" data-level="20.1" data-path="model-assumptions.html"><a href="model-assumptions.html#learning-goals-15"><i class="fa fa-check"></i><b>20.1</b> Learning goals</a></li>
<li class="chapter" data-level="20.2" data-path="model-assumptions.html"><a href="model-assumptions.html#load-packages-and-set-plotting-theme-15"><i class="fa fa-check"></i><b>20.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="20.3" data-path="model-assumptions.html"><a href="model-assumptions.html#model-assumptions-and-what-to-do-if-they-are-violated"><i class="fa fa-check"></i><b>20.3</b> Model assumptions and what to do if they are violated</a>
<ul>
<li class="chapter" data-level="20.3.1" data-path="model-assumptions.html"><a href="model-assumptions.html#influential-data-points"><i class="fa fa-check"></i><b>20.3.1</b> Influential data points</a></li>
<li class="chapter" data-level="20.3.2" data-path="model-assumptions.html"><a href="model-assumptions.html#linear-and-additive"><i class="fa fa-check"></i><b>20.3.2</b> Linear and additive</a></li>
<li class="chapter" data-level="20.3.3" data-path="model-assumptions.html"><a href="model-assumptions.html#normally-distributed-residuals"><i class="fa fa-check"></i><b>20.3.3</b> Normally distributed residuals</a></li>
<li class="chapter" data-level="20.3.4" data-path="model-assumptions.html"><a href="model-assumptions.html#non-parametric-tests"><i class="fa fa-check"></i><b>20.3.4</b> Non-parametric tests</a></li>
<li class="chapter" data-level="20.3.5" data-path="model-assumptions.html"><a href="model-assumptions.html#bootstrapping-regressions"><i class="fa fa-check"></i><b>20.3.5</b> Bootstrapping regressions</a></li>
</ul></li>
<li class="chapter" data-level="20.4" data-path="model-assumptions.html"><a href="model-assumptions.html#additional-resources-14"><i class="fa fa-check"></i><b>20.4</b> Additional resources</a></li>
<li class="chapter" data-level="20.5" data-path="model-assumptions.html"><a href="model-assumptions.html#session-info-17"><i class="fa fa-check"></i><b>20.5</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="reporting-statistics.html"><a href="reporting-statistics.html"><i class="fa fa-check"></i><b>21</b> Reporting statistics</a>
<ul>
<li class="chapter" data-level="21.1" data-path="reporting-statistics.html"><a href="reporting-statistics.html#general-advice"><i class="fa fa-check"></i><b>21.1</b> General advice</a>
<ul>
<li class="chapter" data-level="21.1.1" data-path="reporting-statistics.html"><a href="reporting-statistics.html#make-good-figures"><i class="fa fa-check"></i><b>21.1.1</b> Make good figures!</a></li>
<li class="chapter" data-level="21.1.2" data-path="reporting-statistics.html"><a href="reporting-statistics.html#use-statistical-models-to-answer-concrete-research-questions."><i class="fa fa-check"></i><b>21.1.2</b> Use statistical models to answer concrete research questions.</a></li>
<li class="chapter" data-level="21.1.3" data-path="reporting-statistics.html"><a href="reporting-statistics.html#illustrate-the-uncertainty-in-your-statistical-inferences."><i class="fa fa-check"></i><b>21.1.3</b> Illustrate the uncertainty in your statistical inferences.</a></li>
<li class="chapter" data-level="21.1.4" data-path="reporting-statistics.html"><a href="reporting-statistics.html#report-effect-sizes."><i class="fa fa-check"></i><b>21.1.4</b> Report effect sizes.</a></li>
<li class="chapter" data-level="21.1.5" data-path="reporting-statistics.html"><a href="reporting-statistics.html#reporting-statistical-results-using-rmarkdown"><i class="fa fa-check"></i><b>21.1.5</b> Reporting statistical results using RMarkdown</a></li>
</ul></li>
<li class="chapter" data-level="21.2" data-path="reporting-statistics.html"><a href="reporting-statistics.html#some-concrete-example"><i class="fa fa-check"></i><b>21.2</b> Some concrete example</a>
<ul>
<li class="chapter" data-level="21.2.1" data-path="reporting-statistics.html"><a href="reporting-statistics.html#frequentist-statistics"><i class="fa fa-check"></i><b>21.2.1</b> Frequentist statistics</a></li>
</ul></li>
<li class="chapter" data-level="21.3" data-path="reporting-statistics.html"><a href="reporting-statistics.html#additional-resources-15"><i class="fa fa-check"></i><b>21.3</b> Additional resources</a>
<ul>
<li class="chapter" data-level="21.3.1" data-path="reporting-statistics.html"><a href="reporting-statistics.html#misc-7"><i class="fa fa-check"></i><b>21.3.1</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="21.4" data-path="reporting-statistics.html"><a href="reporting-statistics.html#session-info-18"><i class="fa fa-check"></i><b>21.4</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="cheatsheets-4.html"><a href="cheatsheets-4.html"><i class="fa fa-check"></i><b>22</b> Cheatsheets</a>
<ul>
<li class="chapter" data-level="22.1" data-path="cheatsheets-4.html"><a href="cheatsheets-4.html#statistics"><i class="fa fa-check"></i><b>22.1</b> Statistics</a></li>
<li class="chapter" data-level="22.2" data-path="cheatsheets-4.html"><a href="cheatsheets-4.html#r"><i class="fa fa-check"></i><b>22.2</b> R</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references-1.html"><a href="references-1.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Psych 710: Statistical Methods II</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="power" class="section level1 hasAnchor" number="6">
<h1><span class="header-section-number">Chapter 6</span> Power<a href="power.html#power" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="learning-goals-2" class="section level2 hasAnchor" number="6.1">
<h2><span class="header-section-number">6.1</span> Learning goals<a href="power.html#learning-goals-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>Making decisions based on statistical inference.</li>
<li>The concept of statistical power.</li>
<li>Calculating power.</li>
<li>Common effect size measures.</li>
<li>Determining sample size via simulation.
<ul>
<li>Understanding <code>map()</code> and its children.</li>
<li>Understanding <code>nest()</code> and <code>unnest()</code>.</li>
</ul></li>
</ul>
</div>
<div id="load-packages-and-set-plotting-theme-4" class="section level2 hasAnchor" number="6.2">
<h2><span class="header-section-number">6.2</span> Load packages and set plotting theme<a href="power.html#load-packages-and-set-plotting-theme-4" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb214"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb214-1"><a href="power.html#cb214-1" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;knitr&quot;</span>)      <span class="co"># for knitting RMarkdown </span></span>
<span id="cb214-2"><a href="power.html#cb214-2" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;kableExtra&quot;</span>) <span class="co"># for making nice tables</span></span>
<span id="cb214-3"><a href="power.html#cb214-3" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;broom&quot;</span>)      <span class="co"># for tidying up model fits</span></span>
<span id="cb214-4"><a href="power.html#cb214-4" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;magrittr&quot;</span>)   <span class="co"># for going all in with the pipe</span></span>
<span id="cb214-5"><a href="power.html#cb214-5" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;effectsize&quot;</span>) <span class="co"># for computing effect size measures</span></span>
<span id="cb214-6"><a href="power.html#cb214-6" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;pwr&quot;</span>)        <span class="co"># for power calculations</span></span>
<span id="cb214-7"><a href="power.html#cb214-7" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;tidyverse&quot;</span>)  <span class="co"># for wrangling, plotting, etc. </span></span></code></pre></div>
<pre><code>## Warning: package &#39;ggplot2&#39; was built under R version 4.3.1</code></pre>
<pre><code>## Warning: package &#39;dplyr&#39; was built under R version 4.3.1</code></pre>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb217-1"><a href="power.html#cb217-1" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_classic</span>() <span class="sc">+</span> <span class="co">#set the theme </span></span>
<span id="cb217-2"><a href="power.html#cb217-2" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>))) <span class="co">#set the default text size</span></span>
<span id="cb217-3"><a href="power.html#cb217-3" tabindex="-1"></a></span>
<span id="cb217-4"><a href="power.html#cb217-4" tabindex="-1"></a><span class="co"># markdown settings for rendered code chunks </span></span>
<span id="cb217-5"><a href="power.html#cb217-5" tabindex="-1"></a>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">comment =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb217-6"><a href="power.html#cb217-6" tabindex="-1"></a>               <span class="at">fig.show =</span> <span class="st">&quot;hold&quot;</span>)</span>
<span id="cb217-7"><a href="power.html#cb217-7" tabindex="-1"></a></span>
<span id="cb217-8"><a href="power.html#cb217-8" tabindex="-1"></a><span class="co"># suppress summary warnings </span></span>
<span id="cb217-9"><a href="power.html#cb217-9" tabindex="-1"></a><span class="fu">options</span>(<span class="at">dplyr.summarise.inform =</span> F)</span></code></pre></div>
</div>
<div id="load-data-sets-1" class="section level2 hasAnchor" number="6.3">
<h2><span class="header-section-number">6.3</span> Load data sets<a href="power.html#load-data-sets-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb218-1"><a href="power.html#cb218-1" tabindex="-1"></a>df.poker <span class="ot">=</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/poker.csv&quot;</span>)</span></code></pre></div>
</div>
<div id="decision-making" class="section level2 hasAnchor" number="6.4">
<h2><span class="header-section-number">6.4</span> Decision-making<a href="power.html#decision-making" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Figures to illustrate power:</p>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb219-1"><a href="power.html#cb219-1" tabindex="-1"></a>mu0 <span class="ot">=</span> <span class="dv">10</span></span>
<span id="cb219-2"><a href="power.html#cb219-2" tabindex="-1"></a>mu1 <span class="ot">=</span> <span class="dv">18</span></span>
<span id="cb219-3"><a href="power.html#cb219-3" tabindex="-1"></a><span class="co"># mu0 = 8</span></span>
<span id="cb219-4"><a href="power.html#cb219-4" tabindex="-1"></a><span class="co"># mu1 = 20</span></span>
<span id="cb219-5"><a href="power.html#cb219-5" tabindex="-1"></a><span class="co"># sd0 = 3</span></span>
<span id="cb219-6"><a href="power.html#cb219-6" tabindex="-1"></a><span class="co"># sd1 = 3</span></span>
<span id="cb219-7"><a href="power.html#cb219-7" tabindex="-1"></a>sd0 <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb219-8"><a href="power.html#cb219-8" tabindex="-1"></a>sd1 <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb219-9"><a href="power.html#cb219-9" tabindex="-1"></a>alpha <span class="ot">=</span> <span class="fl">0.05</span></span>
<span id="cb219-10"><a href="power.html#cb219-10" tabindex="-1"></a><span class="co"># alpha = 0.01</span></span>
<span id="cb219-11"><a href="power.html#cb219-11" tabindex="-1"></a></span>
<span id="cb219-12"><a href="power.html#cb219-12" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">30</span>)),</span>
<span id="cb219-13"><a href="power.html#cb219-13" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> x)) <span class="sc">+</span> </span>
<span id="cb219-14"><a href="power.html#cb219-14" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> <span class="st">&quot;dnorm&quot;</span>,</span>
<span id="cb219-15"><a href="power.html#cb219-15" tabindex="-1"></a>                <span class="at">size =</span> <span class="dv">1</span>,</span>
<span id="cb219-16"><a href="power.html#cb219-16" tabindex="-1"></a>                <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>,</span>
<span id="cb219-17"><a href="power.html#cb219-17" tabindex="-1"></a>                <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> mu0,</span>
<span id="cb219-18"><a href="power.html#cb219-18" tabindex="-1"></a>                            <span class="at">sd =</span> sd0)) <span class="sc">+</span></span>
<span id="cb219-19"><a href="power.html#cb219-19" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> <span class="st">&quot;dnorm&quot;</span>,</span>
<span id="cb219-20"><a href="power.html#cb219-20" tabindex="-1"></a>                <span class="at">size =</span> <span class="dv">1</span>,</span>
<span id="cb219-21"><a href="power.html#cb219-21" tabindex="-1"></a>                <span class="at">color =</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb219-22"><a href="power.html#cb219-22" tabindex="-1"></a>                <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> mu1,</span>
<span id="cb219-23"><a href="power.html#cb219-23" tabindex="-1"></a>                            <span class="at">sd =</span> sd1)) <span class="sc">+</span></span>
<span id="cb219-24"><a href="power.html#cb219-24" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> <span class="st">&quot;dnorm&quot;</span>,</span>
<span id="cb219-25"><a href="power.html#cb219-25" tabindex="-1"></a>                <span class="at">geom =</span> <span class="st">&quot;area&quot;</span>,</span>
<span id="cb219-26"><a href="power.html#cb219-26" tabindex="-1"></a>                <span class="at">size =</span> <span class="dv">1</span>,</span>
<span id="cb219-27"><a href="power.html#cb219-27" tabindex="-1"></a>                <span class="at">fill =</span> <span class="st">&quot;blue&quot;</span>,</span>
<span id="cb219-28"><a href="power.html#cb219-28" tabindex="-1"></a>                <span class="at">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb219-29"><a href="power.html#cb219-29" tabindex="-1"></a>                <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> mu0,</span>
<span id="cb219-30"><a href="power.html#cb219-30" tabindex="-1"></a>                            <span class="at">sd =</span> sd0),</span>
<span id="cb219-31"><a href="power.html#cb219-31" tabindex="-1"></a>                <span class="at">xlim =</span> <span class="fu">c</span>(<span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>alpha, <span class="at">mean =</span> mu0, <span class="at">sd =</span> sd0), <span class="dv">20</span>)) <span class="sc">+</span></span>
<span id="cb219-32"><a href="power.html#cb219-32" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> <span class="st">&quot;dnorm&quot;</span>,</span>
<span id="cb219-33"><a href="power.html#cb219-33" tabindex="-1"></a>                <span class="at">geom =</span> <span class="st">&quot;area&quot;</span>,</span>
<span id="cb219-34"><a href="power.html#cb219-34" tabindex="-1"></a>                <span class="at">size =</span> <span class="dv">1</span>,</span>
<span id="cb219-35"><a href="power.html#cb219-35" tabindex="-1"></a>                <span class="at">fill =</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb219-36"><a href="power.html#cb219-36" tabindex="-1"></a>                <span class="at">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb219-37"><a href="power.html#cb219-37" tabindex="-1"></a>                <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> mu1,</span>
<span id="cb219-38"><a href="power.html#cb219-38" tabindex="-1"></a>                            <span class="at">sd =</span> sd1),</span>
<span id="cb219-39"><a href="power.html#cb219-39" tabindex="-1"></a>                <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">c</span>(<span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>alpha, <span class="at">mean =</span> mu0, <span class="at">sd =</span> sd0)))) <span class="sc">+</span></span>
<span id="cb219-40"><a href="power.html#cb219-40" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>alpha, <span class="at">mean =</span> mu0, <span class="at">sd =</span> sd0),</span>
<span id="cb219-41"><a href="power.html#cb219-41" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb219-42"><a href="power.html#cb219-42" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">expand =</span> F)</span></code></pre></div>
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead.
This warning is displayed once every 8 hours.
Call `lifecycle::last_lifecycle_warnings()` to see where this warning was generated.</code></pre>
<pre><code>Warning: Computation failed in `stat_function()`
Caused by error in `fun()`:
! could not find function &quot;fun&quot;</code></pre>
<pre><code>Warning: Computation failed in `stat_function()`
Caused by error in `fun()`:
! could not find function &quot;fun&quot;</code></pre>
<pre><code>Warning: Computation failed in `stat_function()`
Caused by error in `fun()`:
! could not find function &quot;fun&quot;</code></pre>
<pre><code>Warning: Computation failed in `stat_function()`
Caused by error in `fun()`:
! could not find function &quot;fun&quot;</code></pre>
<p><img src="06-power_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
</div>
<div id="effect-sizes" class="section level2 hasAnchor" number="6.5">
<h2><span class="header-section-number">6.5</span> Effect sizes<a href="power.html#effect-sizes" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="cohens-d" class="section level3 hasAnchor" number="6.5.1">
<h3><span class="header-section-number">6.5.1</span> Cohen’s d<a href="power.html#cohens-d" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Cohen’s <span class="math inline">\(d\)</span> is defined as:</p>
<p><span class="math display">\[
d = \frac{\overline y_1 - \overline y_2}{s_p}
\]</span></p>
<p>where</p>
<p><span class="math display">\[
s_p = \sqrt\frac{(n_1-1)s_1^2 + (n_2-1)s_2^2}{n_1 + n_2 - 2}
\]</span></p>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb225-1"><a href="power.html#cb225-1" tabindex="-1"></a><span class="co"># using the effectsize package </span></span>
<span id="cb225-2"><a href="power.html#cb225-2" tabindex="-1"></a><span class="fu">cohens_d</span>(<span class="at">x =</span> balance <span class="sc">~</span> skill,</span>
<span id="cb225-3"><a href="power.html#cb225-3" tabindex="-1"></a>         <span class="at">data =</span> df.poker)</span></code></pre></div>
<pre><code>Cohen&#39;s d |        95% CI
-------------------------
0.14      | [-0.08, 0.37]

- Estimated using pooled SD.</code></pre>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb227-1"><a href="power.html#cb227-1" tabindex="-1"></a><span class="co"># compute by hand</span></span>
<span id="cb227-2"><a href="power.html#cb227-2" tabindex="-1"></a>df.cohen <span class="ot">=</span> df.poker <span class="sc">%&gt;%</span> </span>
<span id="cb227-3"><a href="power.html#cb227-3" tabindex="-1"></a>  <span class="fu">group_by</span>(skill) <span class="sc">%&gt;%</span> </span>
<span id="cb227-4"><a href="power.html#cb227-4" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean =</span> <span class="fu">mean</span>(balance),</span>
<span id="cb227-5"><a href="power.html#cb227-5" tabindex="-1"></a>            <span class="at">var =</span> <span class="fu">var</span>(balance),</span>
<span id="cb227-6"><a href="power.html#cb227-6" tabindex="-1"></a>            <span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb227-7"><a href="power.html#cb227-7" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb227-8"><a href="power.html#cb227-8" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> skill,</span>
<span id="cb227-9"><a href="power.html#cb227-9" tabindex="-1"></a>              <span class="at">values_from =</span> <span class="fu">c</span>(mean, var, n),</span>
<span id="cb227-10"><a href="power.html#cb227-10" tabindex="-1"></a>              <span class="at">names_sep =</span> <span class="st">&quot;&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb227-11"><a href="power.html#cb227-11" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sp =</span> <span class="fu">sqrt</span>(((n1 <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> var1 <span class="sc">+</span> (n2 <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> var2) <span class="sc">/</span> (n1 <span class="sc">+</span> n2 <span class="sc">-</span> <span class="dv">2</span>)),</span>
<span id="cb227-12"><a href="power.html#cb227-12" tabindex="-1"></a>         <span class="at">d =</span> <span class="fu">abs</span>(mean1 <span class="sc">-</span> mean2) <span class="sc">/</span> sp)</span>
<span id="cb227-13"><a href="power.html#cb227-13" tabindex="-1"></a></span>
<span id="cb227-14"><a href="power.html#cb227-14" tabindex="-1"></a><span class="fu">print</span>(df.cohen)</span></code></pre></div>
<pre><code># A tibble: 1 × 8
  mean1 mean2  var1  var2    n1    n2    sp     d
  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt;
1  10.1  9.41  20.3  30.3   150   150  5.03 0.144</code></pre>
</div>
</div>
<div id="determining-sample-size" class="section level2 hasAnchor" number="6.6">
<h2><span class="header-section-number">6.6</span> Determining sample size<a href="power.html#determining-sample-size" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>One way to determine sample size is by using the <code>pwr</code> package. While this packages is very convenient, we cannot compute power for all the hypotheses that we might be interested in testing.</p>
<div id="pwr-package" class="section level3 hasAnchor" number="6.6.1">
<h3><span class="header-section-number">6.6.1</span> <code>pwr</code> package<a href="power.html#pwr-package" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>pwr</code> package has a number of functions that we can use do determine the desired sample size for different experimental designs. Check out this vignette <a href="https://cran.r-project.org/web/packages/pwr/vignettes/pwr-vignette.html">here</a> for more information.</p>
<div id="binomial-test" class="section level4 hasAnchor" number="6.6.1.1">
<h4><span class="header-section-number">6.6.1.1</span> Binomial test<a href="power.html#binomial-test" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>We can determine what sample size we need for a Binomial test that compares two different proportions like so:</p>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb229-1"><a href="power.html#cb229-1" tabindex="-1"></a><span class="fu">pwr.p.test</span>(<span class="at">h =</span> <span class="fu">ES.h</span>(<span class="at">p1 =</span> <span class="fl">0.75</span>, <span class="at">p2 =</span> <span class="fl">0.50</span>), </span>
<span id="cb229-2"><a href="power.html#cb229-2" tabindex="-1"></a>           <span class="at">sig.level =</span> <span class="fl">0.05</span>, </span>
<span id="cb229-3"><a href="power.html#cb229-3" tabindex="-1"></a>           <span class="at">power =</span> <span class="fl">0.80</span>, </span>
<span id="cb229-4"><a href="power.html#cb229-4" tabindex="-1"></a>           <span class="at">alternative =</span> <span class="st">&quot;greater&quot;</span>)</span></code></pre></div>
<pre><code>
     proportion power calculation for binomial distribution (arcsine transformation) 

              h = 0.5235988
              n = 22.55126
      sig.level = 0.05
          power = 0.8
    alternative = greater</code></pre>
<p>The <code>pwr.p.test()</code> function wants the effect size h as an argument which we can compute via the <code>ES.h()</code> function that takes two proportions as arguments. I then further defined the desired significance level, power, and whether the test is one-sided or two-sided.</p>
<p>To have an 80% chance of detecting a difference between a proportion of <code>p1 = 0.75</code> and <code>p2 = 0.50</code>, we would need to run a study with 23 participants.</p>
<p>We can use the <code>plot()</code> function to illustrate what power we would get for different sample sizes.</p>
<div class="sourceCode" id="cb231"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb231-1"><a href="power.html#cb231-1" tabindex="-1"></a><span class="fu">pwr.p.test</span>(<span class="at">h =</span> <span class="fu">ES.h</span>(<span class="at">p1 =</span> <span class="fl">0.75</span>, <span class="at">p2 =</span> <span class="fl">0.50</span>), </span>
<span id="cb231-2"><a href="power.html#cb231-2" tabindex="-1"></a>           <span class="at">sig.level =</span> <span class="fl">0.05</span>, </span>
<span id="cb231-3"><a href="power.html#cb231-3" tabindex="-1"></a>           <span class="at">power =</span> <span class="fl">0.80</span>, </span>
<span id="cb231-4"><a href="power.html#cb231-4" tabindex="-1"></a>           <span class="at">alternative =</span> <span class="st">&quot;greater&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb231-5"><a href="power.html#cb231-5" tabindex="-1"></a>  <span class="fu">plot</span>()</span></code></pre></div>
<p><img src="06-power_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<p>Notice that this is a ggplot object, so we could tweak it further if we’d like to, like so:</p>
<div class="sourceCode" id="cb232"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb232-1"><a href="power.html#cb232-1" tabindex="-1"></a><span class="fu">pwr.p.test</span>(<span class="at">h =</span> <span class="fu">ES.h</span>(<span class="at">p1 =</span> <span class="fl">0.75</span>, <span class="at">p2 =</span> <span class="fl">0.50</span>), </span>
<span id="cb232-2"><a href="power.html#cb232-2" tabindex="-1"></a>           <span class="at">sig.level =</span> <span class="fl">0.05</span>, </span>
<span id="cb232-3"><a href="power.html#cb232-3" tabindex="-1"></a>           <span class="at">power =</span> <span class="fl">0.80</span>, </span>
<span id="cb232-4"><a href="power.html#cb232-4" tabindex="-1"></a>           <span class="at">alternative =</span> <span class="st">&quot;greater&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb232-5"><a href="power.html#cb232-5" tabindex="-1"></a>  <span class="fu">plot</span>() <span class="sc">+</span> </span>
<span id="cb232-6"><a href="power.html#cb232-6" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.5</span>,</span>
<span id="cb232-7"><a href="power.html#cb232-7" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="dv">2</span>,</span>
<span id="cb232-8"><a href="power.html#cb232-8" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb232-9"><a href="power.html#cb232-9" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>))</span></code></pre></div>
<p><img src="06-power_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
</div>
<div id="t-test-two-independent-samples" class="section level4 hasAnchor" number="6.6.1.2">
<h4><span class="header-section-number">6.6.1.2</span> t-test (two independent samples)<a href="power.html#t-test-two-independent-samples" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Here is how we could calculate the desired sample size for a t-test with two independent samples.</p>
<div class="sourceCode" id="cb233"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb233-1"><a href="power.html#cb233-1" tabindex="-1"></a><span class="fu">pwr.t.test</span>(<span class="at">d =</span> <span class="fl">0.3</span>,</span>
<span id="cb233-2"><a href="power.html#cb233-2" tabindex="-1"></a>           <span class="at">power =</span> <span class="fl">0.8</span>,</span>
<span id="cb233-3"><a href="power.html#cb233-3" tabindex="-1"></a>           <span class="at">type =</span> <span class="st">&quot;two.sample&quot;</span>,</span>
<span id="cb233-4"><a href="power.html#cb233-4" tabindex="-1"></a>           <span class="at">alternative =</span> <span class="st">&quot;two.sided&quot;</span>)</span></code></pre></div>
<pre><code>
     Two-sample t test power calculation 

              n = 175.3847
              d = 0.3
      sig.level = 0.05
          power = 0.8
    alternative = two.sided

NOTE: n is number in *each* group</code></pre>
<p>So, to achieve a power of 0.8 for an effect size of d = 0.3, we would need to have 176 participants in each condition!</p>
</div>
</div>
<div id="power-analysis" class="section level3 hasAnchor" number="6.6.2">
<h3><span class="header-section-number">6.6.2</span> Power analysis<a href="power.html#power-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>While the <code>pwr</code> package works great for relatively simple designs, it quickly reaches its limits. For example, you may be interested in the sample size required to achieve adequate power for detecting an interaction, or for a specific linear contrast.</p>
<p>Luckily, there is a very flexible approach to determining sample size: via simulation!</p>
<div id="the-general-recipe" class="section level4 hasAnchor" number="6.6.2.1">
<h4><span class="header-section-number">6.6.2.1</span> The general recipe<a href="power.html#the-general-recipe" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li>assume: significance level, n, effect size</li>
<li>simulate a large number of data sets of size n with the specified effect size</li>
<li>for each data set, run a statistical test to calculate the p-value</li>
<li>determine the probability of rejecting the H0 (given that H1 is true)</li>
</ul>
</div>
<div id="using-map-and-list-columns" class="section level4 hasAnchor" number="6.6.2.2">
<h4><span class="header-section-number">6.6.2.2</span> Using <code>map()</code> and list columns<a href="power.html#using-map-and-list-columns" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div id="understanding-map" class="section level5 hasAnchor" number="6.6.2.2.1">
<h5><span class="header-section-number">6.6.2.2.1</span> Understanding <code>map()</code><a href="power.html#understanding-map" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p><code>map()</code> is a powerful family of functions that’s part of the <code>purrr</code> package (which is included in the <code>tidyverse</code>, so we don’t have to load it separately). Using <code>map()</code> allows us to avoid nasty for-loops!</p>
<p>Let’s take a look at the help function.</p>
<div class="sourceCode" id="cb235"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb235-1"><a href="power.html#cb235-1" tabindex="-1"></a><span class="fu">help</span>(map)</span></code></pre></div>
<p>As the help function says, <code>map()</code> allows us to apply a function to each element of a vector. Here is a simple example:</p>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb236-1"><a href="power.html#cb236-1" tabindex="-1"></a><span class="fu">map</span>(<span class="at">.x =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">.f =</span> <span class="sc">~</span> .x<span class="sc">^</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>[[1]]
[1] 1

[[2]]
[1] 4

[[3]]
[1] 9</code></pre>
<p>I’ve passed the vector of numbers <code>.x = 1:3</code> to <code>map()</code>, and then applied the anonymous function <code>.f = ~ .x^2</code> to each of the elements in that vector.</p>
<blockquote>
<p>Always make sure to use the <code>~</code> for defining anonymous functions!</p>
</blockquote>
<p>As with many R functions, you can achieve the same outcome in many different ways. Here are a number of ways to do the same thing:</p>
<pre><code>[1] &quot;Is tmp1 identical to tmp2? TRUE&quot;</code></pre>
<pre><code>[1] &quot;Is tmp2 identical to tmp3? TRUE&quot;</code></pre>
<div id="understanding-maps-children" class="section level6 hasAnchor" number="6.6.2.2.1.1">
<h6><span class="header-section-number">6.6.2.2.1.1</span> Understanding <code>map()</code>’s children<a href="power.html#understanding-maps-children" class="anchor-section" aria-label="Anchor link to header"></a></h6>
<p>Notice that the output of <code>map()</code> is a list.</p>
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb240-1"><a href="power.html#cb240-1" tabindex="-1"></a><span class="fu">map</span>(<span class="at">.x =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">.f =</span> <span class="sc">~</span> .x<span class="sc">^</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>[[1]]
[1] 1

[[2]]
[1] 4

[[3]]
[1] 9</code></pre>
<p>The <code>map()</code> function has many children that differ in what they output. For example, <code>map_dbl()</code> outputs a numeric vector instead of a list.</p>
<div class="sourceCode" id="cb242"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb242-1"><a href="power.html#cb242-1" tabindex="-1"></a><span class="fu">map_dbl</span>(<span class="at">.x =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">.f =</span> <span class="sc">~</span> .x<span class="sc">^</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>[1] 1 4 9</code></pre>
<p>And <code>map_lgl()</code> returns logical values.</p>
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb244-1"><a href="power.html#cb244-1" tabindex="-1"></a><span class="fu">map_lgl</span>(<span class="at">.x =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">.f =</span> <span class="sc">~</span> .x <span class="sc">==</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>[1]  TRUE FALSE FALSE</code></pre>
<p>We can also return data frames by using either <code>map_dfr()</code> which binds data frames by row, or <code>map_dfc()</code> which binds data frames by column. Here is an example:</p>
<div class="sourceCode" id="cb246"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb246-1"><a href="power.html#cb246-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb246-2"><a href="power.html#cb246-2" tabindex="-1"></a></span>
<span id="cb246-3"><a href="power.html#cb246-3" tabindex="-1"></a><span class="co"># function to create a data frame </span></span>
<span id="cb246-4"><a href="power.html#cb246-4" tabindex="-1"></a>fun_make_df <span class="ot">=</span> <span class="cf">function</span>(x){</span>
<span id="cb246-5"><a href="power.html#cb246-5" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">number =</span> x,</span>
<span id="cb246-6"><a href="power.html#cb246-6" tabindex="-1"></a>         <span class="at">group =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>),</span>
<span id="cb246-7"><a href="power.html#cb246-7" tabindex="-1"></a>                        <span class="at">size =</span> <span class="dv">3</span>,</span>
<span id="cb246-8"><a href="power.html#cb246-8" tabindex="-1"></a>                        <span class="at">replace =</span> T),</span>
<span id="cb246-9"><a href="power.html#cb246-9" tabindex="-1"></a>         <span class="at">value =</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">3</span>))</span>
<span id="cb246-10"><a href="power.html#cb246-10" tabindex="-1"></a>}</span>
<span id="cb246-11"><a href="power.html#cb246-11" tabindex="-1"></a></span>
<span id="cb246-12"><a href="power.html#cb246-12" tabindex="-1"></a><span class="co"># bind data frames by row </span></span>
<span id="cb246-13"><a href="power.html#cb246-13" tabindex="-1"></a><span class="fu">map_dfr</span>(<span class="at">.x =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, </span>
<span id="cb246-14"><a href="power.html#cb246-14" tabindex="-1"></a>        <span class="at">.f =</span> <span class="sc">~</span> <span class="fu">fun_make_df</span>(.))</span></code></pre></div>
<pre><code># A tibble: 9 × 3
  number group  value
   &lt;int&gt; &lt;chr&gt;  &lt;dbl&gt;
1      1 A      1.33 
2      1 B      1.27 
3      1 A      0.415
4      2 B      0.487
5      2 A      0.738
6      2 A      0.576
7      3 B     -0.799
8      3 A     -1.15 
9      3 A     -0.289</code></pre>
<p>A nice use-case of the <code>map_dfr()</code> function can be to read in a number of csv files from individual participants into one larger data frame. Let’s simulate some data first, and save the data of each participant as a separate csv file (using <code>map()</code> of course).</p>
<div class="sourceCode" id="cb248"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb248-1"><a href="power.html#cb248-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb248-2"><a href="power.html#cb248-2" tabindex="-1"></a></span>
<span id="cb248-3"><a href="power.html#cb248-3" tabindex="-1"></a>fun_simulate_csv <span class="ot">=</span> <span class="cf">function</span>(x){</span>
<span id="cb248-4"><a href="power.html#cb248-4" tabindex="-1"></a>  n_observations <span class="ot">=</span> <span class="fu">sample</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">6</span>, <span class="at">size =</span> <span class="dv">1</span>)</span>
<span id="cb248-5"><a href="power.html#cb248-5" tabindex="-1"></a>  df <span class="ot">=</span> <span class="fu">tibble</span>(<span class="at">age =</span> <span class="fu">sample</span>(<span class="dv">18</span><span class="sc">:</span><span class="dv">99</span>, <span class="at">size =</span> n_observations),</span>
<span id="cb248-6"><a href="power.html#cb248-6" tabindex="-1"></a>              <span class="at">responses =</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n_observations, <span class="at">mean =</span> <span class="dv">100</span>, <span class="at">sd =</span> <span class="dv">10</span>))</span>
<span id="cb248-7"><a href="power.html#cb248-7" tabindex="-1"></a>  <span class="fu">write_csv</span>(df, <span class="at">file =</span> <span class="fu">str_c</span>(<span class="st">&quot;data/participant&quot;</span>, x, <span class="st">&quot;.csv&quot;</span>))</span>
<span id="cb248-8"><a href="power.html#cb248-8" tabindex="-1"></a>}</span>
<span id="cb248-9"><a href="power.html#cb248-9" tabindex="-1"></a></span>
<span id="cb248-10"><a href="power.html#cb248-10" tabindex="-1"></a><span class="fu">map</span>(<span class="at">.x =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, </span>
<span id="cb248-11"><a href="power.html#cb248-11" tabindex="-1"></a>    <span class="at">.f =</span> <span class="sc">~</span> <span class="fu">fun_simulate_csv</span>(.))</span></code></pre></div>
<pre><code>[[1]]
# A tibble: 3 × 2
    age responses
  &lt;int&gt;     &lt;dbl&gt;
1    85      91.6
2    56     116. 
3    18     103. 

[[2]]
# A tibble: 5 × 2
    age responses
  &lt;int&gt;     &lt;dbl&gt;
1    68     115. 
2    38     104. 
3    71      93.8
4    91      77.9
5    24     111. 

[[3]]
# A tibble: 4 × 2
    age responses
  &lt;int&gt;     &lt;dbl&gt;
1    61      106.
2    96      109.
3    50      108.
4    52      101.</code></pre>
<p>Now, let’s read in the data from the three participants and combine it into a single data frame.</p>
<div class="sourceCode" id="cb250"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb250-1"><a href="power.html#cb250-1" tabindex="-1"></a><span class="fu">map_dfr</span>(<span class="at">.x =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,</span>
<span id="cb250-2"><a href="power.html#cb250-2" tabindex="-1"></a>        <span class="at">.f =</span> <span class="sc">~</span> <span class="fu">read_csv</span>(<span class="fu">str_c</span>(<span class="st">&quot;data/participant&quot;</span>, .x, <span class="st">&quot;.csv&quot;</span>)),</span>
<span id="cb250-3"><a href="power.html#cb250-3" tabindex="-1"></a>        <span class="at">.id =</span> <span class="st">&quot;participant&quot;</span>)</span></code></pre></div>
<pre><code># A tibble: 12 × 3
   participant   age responses
   &lt;chr&gt;       &lt;dbl&gt;     &lt;dbl&gt;
 1 1              85      91.6
 2 1              56     116. 
 3 1              18     103. 
 4 2              68     115. 
 5 2              38     104. 
 6 2              71      93.8
 7 2              91      77.9
 8 2              24     111. 
 9 3              61     106. 
10 3              96     109. 
11 3              50     108. 
12 3              52     101. </code></pre>
<p>Notice how I used the <code>.id =</code> argument of the function to add a <code>participant</code> column to my data frame in this case.</p>
</div>
<div id="use-map2-for-functions-with-more-than-one-input" class="section level6 hasAnchor" number="6.6.2.2.1.2">
<h6><span class="header-section-number">6.6.2.2.1.2</span> Use <code>map2()</code> for functions with more than one input<a href="power.html#use-map2-for-functions-with-more-than-one-input" class="anchor-section" aria-label="Anchor link to header"></a></h6>
<p>If you have a function with more than one input, <code>map2()</code> is your friend. Here is a silly example:</p>
<div class="sourceCode" id="cb252"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb252-1"><a href="power.html#cb252-1" tabindex="-1"></a><span class="fu">map2_dbl</span>(<span class="at">.x =</span> <span class="fu">c</span>(<span class="fl">1.23</span>, <span class="fl">2.13</span>, <span class="fl">5.32</span>),</span>
<span id="cb252-2"><a href="power.html#cb252-2" tabindex="-1"></a>         <span class="at">.y =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>),</span>
<span id="cb252-3"><a href="power.html#cb252-3" tabindex="-1"></a>         <span class="at">.f =</span> <span class="sc">~</span> <span class="fu">round</span>(.x, <span class="at">digits =</span> .y))</span></code></pre></div>
<pre><code>[1] 1.00 2.10 5.32</code></pre>
<p>Here, I took the vector of numbers <code>.x</code> and rounded it to a different number of digits according to what I’ve specified it <code>.y</code>.
The same works with data frames, too, like so:</p>
<div class="sourceCode" id="cb254"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb254-1"><a href="power.html#cb254-1" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="fl">1.23</span>, <span class="fl">2.13</span>, <span class="fl">5.32</span>),</span>
<span id="cb254-2"><a href="power.html#cb254-2" tabindex="-1"></a>       <span class="at">n =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb254-3"><a href="power.html#cb254-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rounded =</span> <span class="fu">map2_dbl</span>(<span class="at">.x =</span> x,</span>
<span id="cb254-4"><a href="power.html#cb254-4" tabindex="-1"></a>                            <span class="at">.y =</span> n,</span>
<span id="cb254-5"><a href="power.html#cb254-5" tabindex="-1"></a>                            <span class="at">.f =</span> <span class="sc">~</span> <span class="fu">round</span>(.x, <span class="at">digits =</span> .y)))</span></code></pre></div>
<pre><code># A tibble: 3 × 3
      x     n rounded
  &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;
1  1.23     0    1   
2  2.13     1    2.1 
3  5.32     2    5.32</code></pre>
</div>
<div id="use-pmap-to-go-all-out-i.e.-for-functions-with-more-than-two-arguments" class="section level6 hasAnchor" number="6.6.2.2.1.3">
<h6><span class="header-section-number">6.6.2.2.1.3</span> Use pmap() to go all out (i.e. for functions with more than two arguments)<a href="power.html#use-pmap-to-go-all-out-i.e.-for-functions-with-more-than-two-arguments" class="anchor-section" aria-label="Anchor link to header"></a></h6>
<p><code>pmap()</code> is your friend for functions that have more than two arguments. Here is an example:</p>
<div class="sourceCode" id="cb256"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb256-1"><a href="power.html#cb256-1" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>),</span>
<span id="cb256-2"><a href="power.html#cb256-2" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">23</span>, <span class="dv">12</span>, <span class="dv">1</span>),</span>
<span id="cb256-3"><a href="power.html#cb256-3" tabindex="-1"></a>       <span class="at">z =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">4</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb256-4"><a href="power.html#cb256-4" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">result =</span> <span class="fu">pmap_dbl</span>(<span class="at">.l =</span> ., </span>
<span id="cb256-5"><a href="power.html#cb256-5" tabindex="-1"></a>                           <span class="at">.f =</span> <span class="sc">~</span> ..<span class="dv">1</span> <span class="sc">*</span> ..<span class="dv">2</span> <span class="sc">+</span> ..<span class="dv">3</span>))</span></code></pre></div>
<pre><code># A tibble: 3 × 4
      x     y     z result
  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
1     1    23     4     27
2     2    12     5     29
3     3     1     4      7</code></pre>
<p>Notice than when using more than two arguments, we refer to each function argument with ..1, ..2, ..3, etc.</p>
</div>
<div id="practice-1-having-fun-with-map" class="section level6 hasAnchor" number="6.6.2.2.1.4">
<h6><span class="header-section-number">6.6.2.2.1.4</span> Practice 1 – Having fun with <code>map()</code><a href="power.html#practice-1-having-fun-with-map" class="anchor-section" aria-label="Anchor link to header"></a></h6>
<p>Use the <code>map2_dbl()</code> function to create a new variable in this data frame that’s the maximum of each row across columns <code>a</code> and <code>b</code>.</p>
<div class="sourceCode" id="cb258"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb258-1"><a href="power.html#cb258-1" tabindex="-1"></a>df.practice <span class="ot">=</span> <span class="fu">tibble</span>(<span class="at">a =</span> <span class="fu">c</span>(<span class="dv">12</span>, <span class="dv">14</span>, <span class="dv">52</span>, <span class="dv">23</span>, <span class="dv">23</span>),</span>
<span id="cb258-2"><a href="power.html#cb258-2" tabindex="-1"></a>                     <span class="at">b =</span> <span class="fu">c</span>(<span class="dv">29</span>, <span class="dv">12</span>, <span class="dv">4</span>, <span class="dv">48</span>, <span class="dv">37</span>))</span>
<span id="cb258-3"><a href="power.html#cb258-3" tabindex="-1"></a><span class="co"># write your code here </span></span></code></pre></div>
<p>For the fast ones: For each row in the data frame, write a function that calculates the mean of columns <code>a</code> and <code>b</code>, and the rounds to the number of digits specified in column <code>d</code>.</p>
<div class="sourceCode" id="cb259"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb259-1"><a href="power.html#cb259-1" tabindex="-1"></a>df.practice <span class="ot">=</span> <span class="fu">tibble</span>(<span class="at">a =</span> <span class="fu">c</span>(<span class="fl">12.123</span>, <span class="fl">53.234</span>, <span class="fl">23.324</span>, <span class="fl">54.232</span>, <span class="fl">12.454</span>),</span>
<span id="cb259-2"><a href="power.html#cb259-2" tabindex="-1"></a>                     <span class="at">b =</span> <span class="fu">c</span>(<span class="fl">12.456</span>, <span class="fl">23.234</span>, <span class="fl">6.736</span>, <span class="fl">3.346</span>, <span class="fl">7.232</span>),</span>
<span id="cb259-3"><a href="power.html#cb259-3" tabindex="-1"></a>                     <span class="at">d =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">1</span>))</span>
<span id="cb259-4"><a href="power.html#cb259-4" tabindex="-1"></a><span class="co"># write your code here</span></span></code></pre></div>
</div>
</div>
<div id="list-columns" class="section level5 hasAnchor" number="6.6.2.2.2">
<h5><span class="header-section-number">6.6.2.2.2</span> List columns<a href="power.html#list-columns" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p><code>map()</code> becomes particularly powerful when combined with list columns. List columns allow you to put data frames into a column of your data frame. For example, you can do something like this:</p>
<div class="sourceCode" id="cb260"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb260-1"><a href="power.html#cb260-1" tabindex="-1"></a>df.data <span class="ot">=</span> <span class="fu">tibble</span>(<span class="at">participant =</span> <span class="dv">1</span>, </span>
<span id="cb260-2"><a href="power.html#cb260-2" tabindex="-1"></a>                 <span class="at">age =</span> <span class="dv">23</span>,</span>
<span id="cb260-3"><a href="power.html#cb260-3" tabindex="-1"></a>                 <span class="at">data =</span> <span class="fu">list</span>(<span class="fu">tibble</span>(<span class="at">trial =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>),</span>
<span id="cb260-4"><a href="power.html#cb260-4" tabindex="-1"></a>                                    <span class="at">response =</span> <span class="fu">c</span>(<span class="dv">23</span>, <span class="dv">95</span>, <span class="dv">37</span>))))</span>
<span id="cb260-5"><a href="power.html#cb260-5" tabindex="-1"></a></span>
<span id="cb260-6"><a href="power.html#cb260-6" tabindex="-1"></a><span class="fu">print</span>(df.data)</span></code></pre></div>
<pre><code># A tibble: 1 × 3
  participant   age data            
        &lt;dbl&gt; &lt;dbl&gt; &lt;list&gt;          
1           1    23 &lt;tibble [3 × 2]&gt;</code></pre>
<p>We could access what’s in this data column like so</p>
<div class="sourceCode" id="cb262"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb262-1"><a href="power.html#cb262-1" tabindex="-1"></a>df.data <span class="sc">%&gt;%</span> </span>
<span id="cb262-2"><a href="power.html#cb262-2" tabindex="-1"></a>  <span class="fu">pluck</span>(<span class="st">&quot;data&quot;</span>, <span class="dv">1</span>)</span></code></pre></div>
<pre><code># A tibble: 3 × 2
  trial response
  &lt;dbl&gt;    &lt;dbl&gt;
1     1       23
2     2       95
3     3       37</code></pre>
<div id="unnest" class="section level6 hasAnchor" number="6.6.2.2.2.1">
<h6><span class="header-section-number">6.6.2.2.2.1</span> <code>unnest()</code><a href="power.html#unnest" class="anchor-section" aria-label="Anchor link to header"></a></h6>
<p>For getting data frames out of list columns, we can use the <code>unnest()</code> function.</p>
<div class="sourceCode" id="cb264"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb264-1"><a href="power.html#cb264-1" tabindex="-1"></a>df.data <span class="sc">%&gt;%</span> </span>
<span id="cb264-2"><a href="power.html#cb264-2" tabindex="-1"></a>  <span class="fu">unnest</span>(<span class="at">cols =</span> data)</span></code></pre></div>
<pre><code># A tibble: 3 × 4
  participant   age trial response
        &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;
1           1    23     1       23
2           1    23     2       95
3           1    23     3       37</code></pre>
</div>
<div id="nest" class="section level6 hasAnchor" number="6.6.2.2.2.2">
<h6><span class="header-section-number">6.6.2.2.2.2</span> <code>nest()</code><a href="power.html#nest" class="anchor-section" aria-label="Anchor link to header"></a></h6>
<p>We can use the <code>nest()</code> function to create list columns. <code>nest()</code> works particularly well in combination with <code>group_by()</code>. For example, here I’m created three separate data sets where the size of each data set is determined by the <code>x</code> column.</p>
<div class="sourceCode" id="cb266"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb266-1"><a href="power.html#cb266-1" tabindex="-1"></a><span class="co"># original data frame </span></span>
<span id="cb266-2"><a href="power.html#cb266-2" tabindex="-1"></a>df.data <span class="ot">=</span> <span class="fu">tibble</span>(<span class="at">participant =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>),</span>
<span id="cb266-3"><a href="power.html#cb266-3" tabindex="-1"></a>                 <span class="at">response1 =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>,</span>
<span id="cb266-4"><a href="power.html#cb266-4" tabindex="-1"></a>                 <span class="at">response2 =</span> <span class="dv">6</span><span class="sc">:</span><span class="dv">1</span>)</span>
<span id="cb266-5"><a href="power.html#cb266-5" tabindex="-1"></a><span class="fu">print</span>(df.data)</span></code></pre></div>
<pre><code># A tibble: 6 × 3
  participant response1 response2
        &lt;dbl&gt;     &lt;int&gt;     &lt;int&gt;
1           1         1         6
2           1         2         5
3           1         3         4
4           2         4         3
5           2         5         2
6           3         6         1</code></pre>
<div class="sourceCode" id="cb268"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb268-1"><a href="power.html#cb268-1" tabindex="-1"></a><span class="co"># nested data frame </span></span>
<span id="cb268-2"><a href="power.html#cb268-2" tabindex="-1"></a>df.data <span class="ot">=</span> df.data <span class="sc">%&gt;%</span> </span>
<span id="cb268-3"><a href="power.html#cb268-3" tabindex="-1"></a>  <span class="fu">group_by</span>(participant) <span class="sc">%&gt;%</span> </span>
<span id="cb268-4"><a href="power.html#cb268-4" tabindex="-1"></a>  <span class="fu">nest</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb268-5"><a href="power.html#cb268-5" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb268-6"><a href="power.html#cb268-6" tabindex="-1"></a></span>
<span id="cb268-7"><a href="power.html#cb268-7" tabindex="-1"></a><span class="fu">print</span>(df.data)</span></code></pre></div>
<pre><code># A tibble: 3 × 2
  participant data            
        &lt;dbl&gt; &lt;list&gt;          
1           1 &lt;tibble [3 × 2]&gt;
2           2 &lt;tibble [2 × 2]&gt;
3           3 &lt;tibble [1 × 2]&gt;</code></pre>
<div class="sourceCode" id="cb270"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb270-1"><a href="power.html#cb270-1" tabindex="-1"></a><span class="co"># and back to the original data frame  </span></span>
<span id="cb270-2"><a href="power.html#cb270-2" tabindex="-1"></a>df.data <span class="ot">=</span> df.data <span class="sc">%&gt;%</span> </span>
<span id="cb270-3"><a href="power.html#cb270-3" tabindex="-1"></a>  <span class="fu">unnest</span>(<span class="at">cols =</span> data)</span>
<span id="cb270-4"><a href="power.html#cb270-4" tabindex="-1"></a><span class="fu">print</span>(df.data)</span></code></pre></div>
<pre><code># A tibble: 6 × 3
  participant response1 response2
        &lt;dbl&gt;     &lt;int&gt;     &lt;int&gt;
1           1         1         6
2           1         2         5
3           1         3         4
4           2         4         3
5           2         5         2
6           3         6         1</code></pre>
<p>And, of course, I can use unnest() to get back to my original data frame.</p>
</div>
</div>
<div id="combining-nest-and-map" class="section level5 hasAnchor" number="6.6.2.2.3">
<h5><span class="header-section-number">6.6.2.2.3</span> Combining <code>nest()</code> and <code>map()</code><a href="power.html#combining-nest-and-map" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p><code>nest()</code> and <code>map()</code> unfold their power together when it comes to fitting models. For example, consider that you want to fit a separate linear to subests of your data. Here is how you can do that using <code>nest()</code> and <code>map()</code>.</p>
<p>I’ll demonstrate via the infamous <code>mtcars</code> data set that comes with R.</p>
<div class="sourceCode" id="cb272"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb272-1"><a href="power.html#cb272-1" tabindex="-1"></a>mtcars <span class="sc">%&gt;%</span> </span>
<span id="cb272-2"><a href="power.html#cb272-2" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">10</span>)</span></code></pre></div>
<pre><code>                   mpg cyl  disp  hp drat    wt  qsec vs am gear carb
Mazda RX4         21.0   6 160.0 110 3.90 2.620 16.46  0  1    4    4
Mazda RX4 Wag     21.0   6 160.0 110 3.90 2.875 17.02  0  1    4    4
Datsun 710        22.8   4 108.0  93 3.85 2.320 18.61  1  1    4    1
Hornet 4 Drive    21.4   6 258.0 110 3.08 3.215 19.44  1  0    3    1
Hornet Sportabout 18.7   8 360.0 175 3.15 3.440 17.02  0  0    3    2
Valiant           18.1   6 225.0 105 2.76 3.460 20.22  1  0    3    1
Duster 360        14.3   8 360.0 245 3.21 3.570 15.84  0  0    3    4
Merc 240D         24.4   4 146.7  62 3.69 3.190 20.00  1  0    4    2
Merc 230          22.8   4 140.8  95 3.92 3.150 22.90  1  0    4    2
Merc 280          19.2   6 167.6 123 3.92 3.440 18.30  1  0    4    4</code></pre>
<p>What I want to do is to fit separate regression models predicting <code>mpg</code> (miles per gallon) as a function of <code>wt</code> (the car’s weight) for cars with different numbers of cylinders. Here is how that works.</p>
<div class="sourceCode" id="cb274"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb274-1"><a href="power.html#cb274-1" tabindex="-1"></a>df.data <span class="ot">=</span> mtcars <span class="sc">%&gt;%</span></span>
<span id="cb274-2"><a href="power.html#cb274-2" tabindex="-1"></a>  <span class="fu">group_by</span>(cyl) <span class="sc">%&gt;%</span> </span>
<span id="cb274-3"><a href="power.html#cb274-3" tabindex="-1"></a>  <span class="fu">nest</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb274-4"><a href="power.html#cb274-4" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">fit =</span> <span class="fu">map</span>(<span class="at">.x =</span> data,</span>
<span id="cb274-5"><a href="power.html#cb274-5" tabindex="-1"></a>                   <span class="at">.f =</span> <span class="sc">~</span> <span class="fu">lm</span>(<span class="at">formula =</span> mpg <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> wt,</span>
<span id="cb274-6"><a href="power.html#cb274-6" tabindex="-1"></a>                             <span class="at">data =</span> .)))</span></code></pre></div>
<p>I first grouped by the <code>cyl</code> (the number of cylinders), used <code>nest()</code> to put the rest of the data into a list column, and then used <code>mutate()</code> to run a separate linear model on each data set and saved the modle result into the <code>fit</code> column.</p>
<p>With some more wrangling, I could, for example, extract the coefficients of each model like so:</p>
<div class="sourceCode" id="cb275"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb275-1"><a href="power.html#cb275-1" tabindex="-1"></a>mtcars <span class="sc">%&gt;%</span></span>
<span id="cb275-2"><a href="power.html#cb275-2" tabindex="-1"></a>  <span class="fu">group_by</span>(cyl) <span class="sc">%&gt;%</span> </span>
<span id="cb275-3"><a href="power.html#cb275-3" tabindex="-1"></a>  <span class="fu">nest</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb275-4"><a href="power.html#cb275-4" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">fit =</span> <span class="fu">map</span>(<span class="at">.x =</span> data, </span>
<span id="cb275-5"><a href="power.html#cb275-5" tabindex="-1"></a>                   <span class="at">.f =</span> <span class="sc">~</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> wt, <span class="at">data =</span> .)),</span>
<span id="cb275-6"><a href="power.html#cb275-6" tabindex="-1"></a>         <span class="at">coef =</span> <span class="fu">map</span>(<span class="at">.x =</span> fit, </span>
<span id="cb275-7"><a href="power.html#cb275-7" tabindex="-1"></a>                    <span class="at">.f =</span> <span class="sc">~</span> <span class="fu">tidy</span>(.))) <span class="sc">%&gt;%</span> </span>
<span id="cb275-8"><a href="power.html#cb275-8" tabindex="-1"></a>  <span class="fu">unnest</span>(<span class="at">cols =</span> coef) <span class="sc">%&gt;%</span> </span>
<span id="cb275-9"><a href="power.html#cb275-9" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(data, fit))</span></code></pre></div>
<pre><code># A tibble: 6 × 6
# Groups:   cyl [3]
    cyl term        estimate std.error statistic    p.value
  &lt;dbl&gt; &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;
1     6 (Intercept)    28.4      4.18       6.79 0.00105   
2     6 wt             -2.78     1.33      -2.08 0.0918    
3     4 (Intercept)    39.6      4.35       9.10 0.00000777
4     4 wt             -5.65     1.85      -3.05 0.0137    
5     8 (Intercept)    23.9      3.01       7.94 0.00000405
6     8 wt             -2.19     0.739     -2.97 0.0118    </code></pre>
<p>Voila! A data frame that contains the coefficients for each of the three models.</p>
<p>Base R has a number of functions like <code>apply()</code>, <code>sapply()</code>, <code>lapply()</code>, etc. that do similar things to <code>map()</code>. However, the <code>map()</code> family of functions works very well with the rest of the <code>tidyverse</code>, that’s why we’ll use it.</p>
</div>
</div>
<div id="power-analysis-via-simulation" class="section level4 hasAnchor" number="6.6.2.3">
<h4><span class="header-section-number">6.6.2.3</span> Power analysis via simulation<a href="power.html#power-analysis-via-simulation" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>So, after this long detour via <code>map()</code>, list columns, <code>nest()</code>, and <code>unnest()</code>, we can finally start doing some power analysis via simulation, yay!</p>
<div id="simulating-the-binomial-test" class="section level5 hasAnchor" number="6.6.2.3.1">
<h5><span class="header-section-number">6.6.2.3.1</span> Simulating the Binomial test<a href="power.html#simulating-the-binomial-test" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Let’s start with the Binomial test that we played around with above. We want to use simulation to determine the sample size we need to have an 80% of detecting a difference between two proportions p = 0.75 and p = 0.5.</p>
<p>I’ll first do it step by step, and then afterwards put all the code in one place together</p>
<div id="step-by-step" class="section level6 hasAnchor" number="6.6.2.3.1.1">
<h6><span class="header-section-number">6.6.2.3.1.1</span> Step by step<a href="power.html#step-by-step" class="anchor-section" aria-label="Anchor link to header"></a></h6>
<p>Here is how we would go about this. First, I’ll set up a simulation grid.</p>
<div class="sourceCode" id="cb277"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb277-1"><a href="power.html#cb277-1" tabindex="-1"></a><span class="co"># number of simulations</span></span>
<span id="cb277-2"><a href="power.html#cb277-2" tabindex="-1"></a>n_simulations <span class="ot">=</span> <span class="dv">10</span></span>
<span id="cb277-3"><a href="power.html#cb277-3" tabindex="-1"></a></span>
<span id="cb277-4"><a href="power.html#cb277-4" tabindex="-1"></a><span class="co"># set up simulation grid </span></span>
<span id="cb277-5"><a href="power.html#cb277-5" tabindex="-1"></a>df.power <span class="ot">=</span> <span class="fu">expand_grid</span>(<span class="at">n =</span> <span class="fu">seq</span>(<span class="dv">10</span>, <span class="dv">40</span>, <span class="dv">2</span>),</span>
<span id="cb277-6"><a href="power.html#cb277-6" tabindex="-1"></a>                       <span class="at">simulation =</span> <span class="dv">1</span><span class="sc">:</span>n_simulations,</span>
<span id="cb277-7"><a href="power.html#cb277-7" tabindex="-1"></a>                       <span class="at">p =</span> <span class="fl">0.75</span>) <span class="sc">%&gt;%</span></span>
<span id="cb277-8"><a href="power.html#cb277-8" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">index =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>(),</span>
<span id="cb277-9"><a href="power.html#cb277-9" tabindex="-1"></a>         <span class="at">.before =</span> n) <span class="co"># add an index column</span></span>
<span id="cb277-10"><a href="power.html#cb277-10" tabindex="-1"></a></span>
<span id="cb277-11"><a href="power.html#cb277-11" tabindex="-1"></a>df.power</span></code></pre></div>
<pre><code># A tibble: 160 × 4
   index     n simulation     p
   &lt;int&gt; &lt;dbl&gt;      &lt;int&gt; &lt;dbl&gt;
 1     1    10          1  0.75
 2     2    10          2  0.75
 3     3    10          3  0.75
 4     4    10          4  0.75
 5     5    10          5  0.75
 6     6    10          6  0.75
 7     7    10          7  0.75
 8     8    10          8  0.75
 9     9    10          9  0.75
10    10    10         10  0.75
# ℹ 150 more rows</code></pre>
<p>The <code>expand_grid()</code> function creates a data frame that contains all the combinations of the variables.</p>
<p>Now, let’s generate data according to our hypothesis.</p>
<div class="sourceCode" id="cb279"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb279-1"><a href="power.html#cb279-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb279-2"><a href="power.html#cb279-2" tabindex="-1"></a></span>
<span id="cb279-3"><a href="power.html#cb279-3" tabindex="-1"></a>df.power <span class="ot">=</span> df.power <span class="sc">%&gt;%</span> </span>
<span id="cb279-4"><a href="power.html#cb279-4" tabindex="-1"></a>  <span class="fu">group_by</span>(index, n, simulation) <span class="sc">%&gt;%</span> </span>
<span id="cb279-5"><a href="power.html#cb279-5" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">response =</span> <span class="fu">rbinom</span>(<span class="at">n =</span> <span class="dv">1</span>,</span>
<span id="cb279-6"><a href="power.html#cb279-6" tabindex="-1"></a>                           <span class="at">size =</span> n,</span>
<span id="cb279-7"><a href="power.html#cb279-7" tabindex="-1"></a>                           <span class="at">prob =</span> p))</span>
<span id="cb279-8"><a href="power.html#cb279-8" tabindex="-1"></a></span>
<span id="cb279-9"><a href="power.html#cb279-9" tabindex="-1"></a>df.power</span></code></pre></div>
<pre><code># A tibble: 160 × 5
# Groups:   index, n, simulation [160]
   index     n simulation     p response
   &lt;int&gt; &lt;dbl&gt;      &lt;int&gt; &lt;dbl&gt;    &lt;int&gt;
 1     1    10          1  0.75        8
 2     2    10          2  0.75        8
 3     3    10          3  0.75        7
 4     4    10          4  0.75        6
 5     5    10          5  0.75        9
 6     6    10          6  0.75        6
 7     7    10          7  0.75        5
 8     8    10          8  0.75        7
 9     9    10          9  0.75        7
10    10    10         10  0.75        9
# ℹ 150 more rows</code></pre>
<p>The <code>response</code> variable now contains samples from the sample size <code>n</code> according to the probability specified in <code>p</code>. Now it’s time for <code>group_by()</code> and <code>nest()</code> because we want to calculate the p-value for observing this response if in fact the null hypothesis was true (i.e. p = 0.5).</p>
<div class="sourceCode" id="cb281"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb281-1"><a href="power.html#cb281-1" tabindex="-1"></a>df.power <span class="ot">=</span> df.power <span class="sc">%&gt;%</span> <span class="co"># generate random data</span></span>
<span id="cb281-2"><a href="power.html#cb281-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">fit =</span> <span class="fu">map2</span>(<span class="at">.x =</span> response,</span>
<span id="cb281-3"><a href="power.html#cb281-3" tabindex="-1"></a>                    <span class="at">.y =</span> n,</span>
<span id="cb281-4"><a href="power.html#cb281-4" tabindex="-1"></a>                    <span class="at">.f =</span> <span class="sc">~</span> <span class="fu">binom.test</span>(<span class="at">x =</span> .x, <span class="co"># define formula</span></span>
<span id="cb281-5"><a href="power.html#cb281-5" tabindex="-1"></a>                                      <span class="at">n =</span> .y,</span>
<span id="cb281-6"><a href="power.html#cb281-6" tabindex="-1"></a>                                      <span class="at">p =</span> <span class="fl">0.5</span>,</span>
<span id="cb281-7"><a href="power.html#cb281-7" tabindex="-1"></a>                                      <span class="at">alternative =</span> <span class="st">&quot;two.sided&quot;</span>)))</span>
<span id="cb281-8"><a href="power.html#cb281-8" tabindex="-1"></a>df.power</span></code></pre></div>
<pre><code># A tibble: 160 × 6
# Groups:   index, n, simulation [160]
   index     n simulation     p response fit    
   &lt;int&gt; &lt;dbl&gt;      &lt;int&gt; &lt;dbl&gt;    &lt;int&gt; &lt;list&gt; 
 1     1    10          1  0.75        8 &lt;htest&gt;
 2     2    10          2  0.75        8 &lt;htest&gt;
 3     3    10          3  0.75        7 &lt;htest&gt;
 4     4    10          4  0.75        6 &lt;htest&gt;
 5     5    10          5  0.75        9 &lt;htest&gt;
 6     6    10          6  0.75        6 &lt;htest&gt;
 7     7    10          7  0.75        5 &lt;htest&gt;
 8     8    10          8  0.75        7 &lt;htest&gt;
 9     9    10          9  0.75        7 &lt;htest&gt;
10    10    10         10  0.75        9 &lt;htest&gt;
# ℹ 150 more rows</code></pre>
<p>Now that we’ve fitted a bunch of binomial models, we only need to get at the p-values. Again, we can use the <code>tidy()</code> function from the <code>broom</code> package for help, like so:</p>
<div class="sourceCode" id="cb283"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb283-1"><a href="power.html#cb283-1" tabindex="-1"></a>df.power <span class="ot">=</span> df.power <span class="sc">%&gt;%</span> </span>
<span id="cb283-2"><a href="power.html#cb283-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">coef =</span> <span class="fu">map</span>(<span class="at">.x =</span> fit,</span>
<span id="cb283-3"><a href="power.html#cb283-3" tabindex="-1"></a>                    <span class="at">.f =</span> <span class="sc">~</span> <span class="fu">tidy</span>(.))) <span class="sc">%&gt;%</span> </span>
<span id="cb283-4"><a href="power.html#cb283-4" tabindex="-1"></a>  <span class="fu">select</span>(simulation, p, index, coef) <span class="sc">%&gt;%</span> </span>
<span id="cb283-5"><a href="power.html#cb283-5" tabindex="-1"></a>  <span class="fu">unnest</span>(<span class="at">cols =</span> coef) <span class="sc">%&gt;%</span> </span>
<span id="cb283-6"><a href="power.html#cb283-6" tabindex="-1"></a>  <span class="fu">select</span>(index, n, simulation, p.value)</span></code></pre></div>
<pre><code>Adding missing grouping variables: `n`</code></pre>
<div class="sourceCode" id="cb285"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb285-1"><a href="power.html#cb285-1" tabindex="-1"></a>df.power</span></code></pre></div>
<pre><code># A tibble: 160 × 4
# Groups:   index, n, simulation [160]
   index     n simulation p.value
   &lt;int&gt; &lt;dbl&gt;      &lt;int&gt;   &lt;dbl&gt;
 1     1    10          1  0.109 
 2     2    10          2  0.109 
 3     3    10          3  0.344 
 4     4    10          4  0.754 
 5     5    10          5  0.0215
 6     6    10          6  0.754 
 7     7    10          7  1     
 8     8    10          8  0.344 
 9     9    10          9  0.344 
10    10    10         10  0.0215
# ℹ 150 more rows</code></pre>
<p>Finally, all that’s left is to calculate power by looking at the proportion of times in which we rejected the null hypothesis.</p>
<div class="sourceCode" id="cb287"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb287-1"><a href="power.html#cb287-1" tabindex="-1"></a>df.power <span class="sc">%&gt;%</span> </span>
<span id="cb287-2"><a href="power.html#cb287-2" tabindex="-1"></a>  <span class="fu">group_by</span>(n) <span class="sc">%&gt;%</span> </span>
<span id="cb287-3"><a href="power.html#cb287-3" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">power =</span> <span class="fu">sum</span>(p.value <span class="sc">&lt;</span> <span class="fl">0.05</span>) <span class="sc">/</span> <span class="fu">n</span>())</span></code></pre></div>
<pre><code># A tibble: 16 × 2
       n power
   &lt;dbl&gt; &lt;dbl&gt;
 1    10   0.2
 2    12   0.4
 3    14   0.4
 4    16   0.2
 5    18   0.2
 6    20   0.8
 7    22   0.6
 8    24   0.5
 9    26   0.7
10    28   0.6
11    30   0.8
12    32   0.9
13    34   0.9
14    36   0.8
15    38   1  
16    40   1  </code></pre>
<p>Notice here that the power values fluctuate quite a bit. This is because we only ran 10 simulations for each sample size. To have more robust results, we need to increase the number of simulations.</p>
<p>But first, let’s make a plot that visualizes what we found:</p>
<div class="sourceCode" id="cb289"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb289-1"><a href="power.html#cb289-1" tabindex="-1"></a>df.plot <span class="ot">=</span> df.power <span class="sc">%&gt;%</span> </span>
<span id="cb289-2"><a href="power.html#cb289-2" tabindex="-1"></a>  <span class="fu">group_by</span>(n) <span class="sc">%&gt;%</span> </span>
<span id="cb289-3"><a href="power.html#cb289-3" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">power =</span> <span class="fu">sum</span>(p.value <span class="sc">&lt;</span> <span class="fl">0.05</span>) <span class="sc">/</span> <span class="fu">n</span>())</span>
<span id="cb289-4"><a href="power.html#cb289-4" tabindex="-1"></a></span>
<span id="cb289-5"><a href="power.html#cb289-5" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df.plot, </span>
<span id="cb289-6"><a href="power.html#cb289-6" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> n, <span class="at">y =</span> power)) <span class="sc">+</span></span>
<span id="cb289-7"><a href="power.html#cb289-7" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.1</span>),</span>
<span id="cb289-8"><a href="power.html#cb289-8" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="dv">2</span>,</span>
<span id="cb289-9"><a href="power.html#cb289-9" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">&quot;gray50&quot;</span>,</span>
<span id="cb289-10"><a href="power.html#cb289-10" tabindex="-1"></a>             <span class="at">size =</span> <span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb289-11"><a href="power.html#cb289-11" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;loess&quot;</span>,</span>
<span id="cb289-12"><a href="power.html#cb289-12" tabindex="-1"></a>              <span class="at">formula =</span> <span class="st">&quot;y ~ x&quot;</span>) <span class="sc">+</span></span>
<span id="cb289-13"><a href="power.html#cb289-13" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="06-power_files/figure-html/unnamed-chunk-36-1.png" width="672" /></p>
<p>As expected, the power increases with the sample size n. </p>
</div>
<div id="all-in-one" class="section level6 hasAnchor" number="6.6.2.3.1.2">
<h6><span class="header-section-number">6.6.2.3.1.2</span> All in one<a href="power.html#all-in-one" class="anchor-section" aria-label="Anchor link to header"></a></h6>
<p>Here is a slightly different way to run the same simulation we just did before in one go:</p>
<div class="sourceCode" id="cb290"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb290-1"><a href="power.html#cb290-1" tabindex="-1"></a><span class="co"># make reproducible </span></span>
<span id="cb290-2"><a href="power.html#cb290-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb290-3"><a href="power.html#cb290-3" tabindex="-1"></a></span>
<span id="cb290-4"><a href="power.html#cb290-4" tabindex="-1"></a><span class="co"># number of simulations</span></span>
<span id="cb290-5"><a href="power.html#cb290-5" tabindex="-1"></a>n_simulations <span class="ot">=</span> <span class="dv">5</span></span>
<span id="cb290-6"><a href="power.html#cb290-6" tabindex="-1"></a></span>
<span id="cb290-7"><a href="power.html#cb290-7" tabindex="-1"></a><span class="co"># run simulation </span></span>
<span id="cb290-8"><a href="power.html#cb290-8" tabindex="-1"></a><span class="fu">expand_grid</span>(<span class="at">n =</span> <span class="fu">seq</span>(<span class="dv">10</span>, <span class="dv">40</span>, <span class="dv">2</span>),</span>
<span id="cb290-9"><a href="power.html#cb290-9" tabindex="-1"></a>            <span class="at">simulation =</span> <span class="dv">1</span><span class="sc">:</span>n_simulations,</span>
<span id="cb290-10"><a href="power.html#cb290-10" tabindex="-1"></a>            <span class="at">p =</span> <span class="fl">0.75</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb290-11"><a href="power.html#cb290-11" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">index =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>(),</span>
<span id="cb290-12"><a href="power.html#cb290-12" tabindex="-1"></a>         <span class="at">.before =</span> n) <span class="sc">%&gt;%</span> </span>
<span id="cb290-13"><a href="power.html#cb290-13" tabindex="-1"></a>  <span class="fu">group_by</span>(index, n, p, simulation) <span class="sc">%&gt;%</span> </span>
<span id="cb290-14"><a href="power.html#cb290-14" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">response =</span> <span class="fu">rbinom</span>(<span class="at">n =</span> <span class="dv">1</span>,</span>
<span id="cb290-15"><a href="power.html#cb290-15" tabindex="-1"></a>                           <span class="at">size =</span> n,</span>
<span id="cb290-16"><a href="power.html#cb290-16" tabindex="-1"></a>                           <span class="at">prob =</span> p),</span>
<span id="cb290-17"><a href="power.html#cb290-17" tabindex="-1"></a>         <span class="at">p.value =</span> <span class="fu">binom.test</span>(<span class="at">x =</span> response,</span>
<span id="cb290-18"><a href="power.html#cb290-18" tabindex="-1"></a>                              <span class="at">n =</span> n,</span>
<span id="cb290-19"><a href="power.html#cb290-19" tabindex="-1"></a>                              <span class="at">p =</span> <span class="fl">0.5</span>,</span>
<span id="cb290-20"><a href="power.html#cb290-20" tabindex="-1"></a>                              <span class="at">alternative =</span> <span class="st">&quot;two.sided&quot;</span>)<span class="sc">$</span>p.value) <span class="sc">%&gt;%</span> </span>
<span id="cb290-21"><a href="power.html#cb290-21" tabindex="-1"></a>  <span class="fu">group_by</span>(n, p) <span class="sc">%&gt;%</span> </span>
<span id="cb290-22"><a href="power.html#cb290-22" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">power =</span> <span class="fu">sum</span>(p.value <span class="sc">&lt;</span> <span class="fl">0.05</span>) <span class="sc">/</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb290-23"><a href="power.html#cb290-23" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code></pre></div>
<pre><code># A tibble: 16 × 3
       n     p power
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1    10  0.75   0.2
 2    12  0.75   0.2
 3    14  0.75   0.4
 4    16  0.75   0.2
 5    18  0.75   0.6
 6    20  0.75   0.8
 7    22  0.75   0.6
 8    24  0.75   0.4
 9    26  0.75   0.6
10    28  0.75   0.8
11    30  0.75   0.8
12    32  0.75   1  
13    34  0.75   0.8
14    36  0.75   0.8
15    38  0.75   1  
16    40  0.75   0.8</code></pre>
<p>And another time with a larger sample size, and also for two different alternative hypotheses: p1 = 0.75, and p2 = 0.9.</p>
<div class="sourceCode" id="cb292"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb292-1"><a href="power.html#cb292-1" tabindex="-1"></a><span class="co"># make reproducible </span></span>
<span id="cb292-2"><a href="power.html#cb292-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb292-3"><a href="power.html#cb292-3" tabindex="-1"></a></span>
<span id="cb292-4"><a href="power.html#cb292-4" tabindex="-1"></a><span class="co"># number of simulations</span></span>
<span id="cb292-5"><a href="power.html#cb292-5" tabindex="-1"></a>n_simulations <span class="ot">=</span> <span class="dv">100</span></span>
<span id="cb292-6"><a href="power.html#cb292-6" tabindex="-1"></a></span>
<span id="cb292-7"><a href="power.html#cb292-7" tabindex="-1"></a><span class="co"># run simulation </span></span>
<span id="cb292-8"><a href="power.html#cb292-8" tabindex="-1"></a>df.power <span class="ot">=</span> <span class="fu">expand_grid</span>(<span class="at">n =</span> <span class="fu">seq</span>(<span class="dv">10</span>, <span class="dv">40</span>, <span class="dv">2</span>),</span>
<span id="cb292-9"><a href="power.html#cb292-9" tabindex="-1"></a>                       <span class="at">simulation =</span> <span class="dv">1</span><span class="sc">:</span>n_simulations,</span>
<span id="cb292-10"><a href="power.html#cb292-10" tabindex="-1"></a>                       <span class="at">p =</span> <span class="fu">c</span>(<span class="fl">0.75</span>, <span class="fl">0.9</span>)) <span class="sc">%&gt;%</span> <span class="co"># added another hypothesis here </span></span>
<span id="cb292-11"><a href="power.html#cb292-11" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">index =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>(),</span>
<span id="cb292-12"><a href="power.html#cb292-12" tabindex="-1"></a>         <span class="at">.before =</span> n) <span class="sc">%&gt;%</span> </span>
<span id="cb292-13"><a href="power.html#cb292-13" tabindex="-1"></a>  <span class="fu">group_by</span>(index, n, simulation) <span class="sc">%&gt;%</span></span>
<span id="cb292-14"><a href="power.html#cb292-14" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">response =</span> <span class="fu">rbinom</span>(<span class="at">n =</span> <span class="dv">1</span>,</span>
<span id="cb292-15"><a href="power.html#cb292-15" tabindex="-1"></a>                           <span class="at">size =</span> n,</span>
<span id="cb292-16"><a href="power.html#cb292-16" tabindex="-1"></a>                           <span class="at">prob =</span> p)) <span class="sc">%&gt;%</span> </span>
<span id="cb292-17"><a href="power.html#cb292-17" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb292-18"><a href="power.html#cb292-18" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">fit =</span> <span class="fu">map2</span>(<span class="at">.x =</span> response,</span>
<span id="cb292-19"><a href="power.html#cb292-19" tabindex="-1"></a>                    <span class="at">.y =</span> n,</span>
<span id="cb292-20"><a href="power.html#cb292-20" tabindex="-1"></a>                    <span class="at">.f =</span> <span class="sc">~</span> <span class="fu">binom.test</span>(<span class="at">x =</span> .x,</span>
<span id="cb292-21"><a href="power.html#cb292-21" tabindex="-1"></a>                                      <span class="at">n =</span> .y,</span>
<span id="cb292-22"><a href="power.html#cb292-22" tabindex="-1"></a>                                      <span class="at">p =</span> <span class="fl">0.5</span>,</span>
<span id="cb292-23"><a href="power.html#cb292-23" tabindex="-1"></a>                                      <span class="at">alternative =</span> <span class="st">&quot;two.sided&quot;</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb292-24"><a href="power.html#cb292-24" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">coef =</span> <span class="fu">map</span>(<span class="at">.x =</span> fit,</span>
<span id="cb292-25"><a href="power.html#cb292-25" tabindex="-1"></a>                    <span class="at">.f =</span> <span class="sc">~</span> <span class="fu">tidy</span>(.))) <span class="sc">%&gt;%</span> </span>
<span id="cb292-26"><a href="power.html#cb292-26" tabindex="-1"></a>  <span class="fu">unnest</span>(<span class="at">cols =</span> coef) <span class="sc">%&gt;%</span> </span>
<span id="cb292-27"><a href="power.html#cb292-27" tabindex="-1"></a>  <span class="fu">select</span>(index, n, p, p.value) <span class="sc">%&gt;%</span> </span>
<span id="cb292-28"><a href="power.html#cb292-28" tabindex="-1"></a>  <span class="fu">group_by</span>(n, p) <span class="sc">%&gt;%</span> </span>
<span id="cb292-29"><a href="power.html#cb292-29" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">power =</span> <span class="fu">sum</span>(p.value <span class="sc">&lt;</span> <span class="fl">0.05</span>) <span class="sc">/</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb292-30"><a href="power.html#cb292-30" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb292-31"><a href="power.html#cb292-31" tabindex="-1"></a></span>
<span id="cb292-32"><a href="power.html#cb292-32" tabindex="-1"></a><span class="co"># visualize results</span></span>
<span id="cb292-33"><a href="power.html#cb292-33" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df.power, </span>
<span id="cb292-34"><a href="power.html#cb292-34" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> n,</span>
<span id="cb292-35"><a href="power.html#cb292-35" tabindex="-1"></a>                     <span class="at">y =</span> power,</span>
<span id="cb292-36"><a href="power.html#cb292-36" tabindex="-1"></a>                     <span class="at">fill =</span> <span class="fu">as.factor</span>(p),</span>
<span id="cb292-37"><a href="power.html#cb292-37" tabindex="-1"></a>                     <span class="at">group =</span> p)) <span class="sc">+</span></span>
<span id="cb292-38"><a href="power.html#cb292-38" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.1</span>),</span>
<span id="cb292-39"><a href="power.html#cb292-39" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="dv">2</span>,</span>
<span id="cb292-40"><a href="power.html#cb292-40" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">&quot;gray50&quot;</span>,</span>
<span id="cb292-41"><a href="power.html#cb292-41" tabindex="-1"></a>             <span class="at">size =</span> <span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb292-42"><a href="power.html#cb292-42" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;loess&quot;</span>,</span>
<span id="cb292-43"><a href="power.html#cb292-43" tabindex="-1"></a>              <span class="at">formula =</span> <span class="st">&quot;y ~ x&quot;</span>,</span>
<span id="cb292-44"><a href="power.html#cb292-44" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb292-45"><a href="power.html#cb292-45" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>) <span class="sc">+</span></span>
<span id="cb292-46"><a href="power.html#cb292-46" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">&quot;alternative&quot;</span>) <span class="sc">+</span></span>
<span id="cb292-47"><a href="power.html#cb292-47" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">reverse =</span> T))</span></code></pre></div>
<p><img src="06-power_files/figure-html/unnamed-chunk-38-1.png" width="672" /></p>
</div>
</div>
<div id="simulating-an-independent-samples-t-test" class="section level5 hasAnchor" number="6.6.2.3.2">
<h5><span class="header-section-number">6.6.2.3.2</span> Simulating an independent samples t-test<a href="power.html#simulating-an-independent-samples-t-test" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Let’s simulate data for an independent samples t-test. To do so, we need to make some assumptions about what we expect the distribution of the data to look like. Here, I assume that we get normally distributed data with some mean and standard deviation.</p>
<p>The procedure will be very similar to the Binomial test above. The only thing that changes really is how we generate the data (and then some small wrangling differences).</p>
<p>Let’s say that we collected the following pilot data set:</p>
<div class="sourceCode" id="cb293"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb293-1"><a href="power.html#cb293-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb293-2"><a href="power.html#cb293-2" tabindex="-1"></a></span>
<span id="cb293-3"><a href="power.html#cb293-3" tabindex="-1"></a><span class="co"># parameters</span></span>
<span id="cb293-4"><a href="power.html#cb293-4" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">10</span> </span>
<span id="cb293-5"><a href="power.html#cb293-5" tabindex="-1"></a>mean1 <span class="ot">=</span> <span class="dv">10</span> </span>
<span id="cb293-6"><a href="power.html#cb293-6" tabindex="-1"></a>sd1 <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb293-7"><a href="power.html#cb293-7" tabindex="-1"></a>mean2 <span class="ot">=</span> <span class="dv">11</span></span>
<span id="cb293-8"><a href="power.html#cb293-8" tabindex="-1"></a>sd2 <span class="ot">=</span> <span class="dv">3</span></span>
<span id="cb293-9"><a href="power.html#cb293-9" tabindex="-1"></a></span>
<span id="cb293-10"><a href="power.html#cb293-10" tabindex="-1"></a>df.ttest <span class="ot">=</span> <span class="fu">tibble</span>(<span class="at">group1 =</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n,</span>
<span id="cb293-11"><a href="power.html#cb293-11" tabindex="-1"></a>                                 <span class="at">mean =</span> mean1,</span>
<span id="cb293-12"><a href="power.html#cb293-12" tabindex="-1"></a>                                 <span class="at">sd =</span> sd1),</span>
<span id="cb293-13"><a href="power.html#cb293-13" tabindex="-1"></a>                  <span class="at">group2 =</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n,</span>
<span id="cb293-14"><a href="power.html#cb293-14" tabindex="-1"></a>                                 <span class="at">mean =</span> mean2,</span>
<span id="cb293-15"><a href="power.html#cb293-15" tabindex="-1"></a>                                 <span class="at">sd =</span> sd2)) <span class="sc">%&gt;%</span> </span>
<span id="cb293-16"><a href="power.html#cb293-16" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">everything</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb293-17"><a href="power.html#cb293-17" tabindex="-1"></a>  <span class="fu">arrange</span>(name)</span></code></pre></div>
<p>The two groups in our sample don’t differ significantly from each other.</p>
<div class="sourceCode" id="cb294"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb294-1"><a href="power.html#cb294-1" tabindex="-1"></a><span class="co"># visualize the data </span></span>
<span id="cb294-2"><a href="power.html#cb294-2" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df.ttest,</span>
<span id="cb294-3"><a href="power.html#cb294-3" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> name,</span>
<span id="cb294-4"><a href="power.html#cb294-4" tabindex="-1"></a>                     <span class="at">y =</span> value)) <span class="sc">+</span> </span>
<span id="cb294-5"><a href="power.html#cb294-5" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> <span class="st">&quot;mean_cl_boot&quot;</span>)</span>
<span id="cb294-6"><a href="power.html#cb294-6" tabindex="-1"></a></span>
<span id="cb294-7"><a href="power.html#cb294-7" tabindex="-1"></a><span class="co"># compute a t-test</span></span>
<span id="cb294-8"><a href="power.html#cb294-8" tabindex="-1"></a><span class="fu">t.test</span>(<span class="at">formula =</span> value <span class="sc">~</span> name, </span>
<span id="cb294-9"><a href="power.html#cb294-9" tabindex="-1"></a>         <span class="at">data =</span> df.ttest)</span></code></pre></div>
<pre><code>
    Welch Two Sample t-test

data:  value by name
t = -1.3135, df = 13.035, p-value = 0.2117
alternative hypothesis: true difference in means between group group1 and group group2 is not equal to 0
95 percent confidence interval:
 -3.9191375  0.9548788
sample estimates:
mean in group group1 mean in group group2 
            10.26441             11.74653 </code></pre>
<p><img src="06-power_files/figure-html/unnamed-chunk-40-1.png" width="672" /></p>
<p>Let’s calculate what the effect size was in our sample. Remember that Cohen’s d is defined as</p>
<p><span class="math display">\[d = \frac{\lvert\overline y_1 - \overline y_2\rvert}{s_p}\]</span></p>
<p>where</p>
<p><span class="math display">\[s_p = \sqrt\frac{(n_1-1)s_1^2 + (n_2-1)s_2^2}{n_1 + n_2 - 2}\]</span></p>
<p>In our sample, the effect size Cohen’s d was:</p>
<div class="sourceCode" id="cb296"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb296-1"><a href="power.html#cb296-1" tabindex="-1"></a>df.sample <span class="ot">=</span> df.ttest <span class="sc">%&gt;%</span> </span>
<span id="cb296-2"><a href="power.html#cb296-2" tabindex="-1"></a>  <span class="fu">group_by</span>(name) <span class="sc">%&gt;%</span> </span>
<span id="cb296-3"><a href="power.html#cb296-3" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean =</span> <span class="fu">mean</span>(value),</span>
<span id="cb296-4"><a href="power.html#cb296-4" tabindex="-1"></a>            <span class="at">sd =</span> <span class="fu">sd</span>(value),</span>
<span id="cb296-5"><a href="power.html#cb296-5" tabindex="-1"></a>            <span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb296-6"><a href="power.html#cb296-6" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb296-7"><a href="power.html#cb296-7" tabindex="-1"></a></span>
<span id="cb296-8"><a href="power.html#cb296-8" tabindex="-1"></a><span class="co"># compute the pooled standard deviation </span></span>
<span id="cb296-9"><a href="power.html#cb296-9" tabindex="-1"></a>sp <span class="ot">=</span> <span class="fu">sqrt</span>(((df.sample<span class="sc">$</span>n[<span class="dv">1</span>] <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> df.sample<span class="sc">$</span>sd[<span class="dv">1</span>]<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> (df.sample<span class="sc">$</span>n[<span class="dv">2</span>] <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> </span>
<span id="cb296-10"><a href="power.html#cb296-10" tabindex="-1"></a>             df.sample<span class="sc">$</span>sd[<span class="dv">2</span>]<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> (df.sample<span class="sc">$</span>n[<span class="dv">1</span>] <span class="sc">+</span> df.sample<span class="sc">$</span>n[<span class="dv">2</span>] <span class="sc">-</span> <span class="dv">2</span>))</span>
<span id="cb296-11"><a href="power.html#cb296-11" tabindex="-1"></a></span>
<span id="cb296-12"><a href="power.html#cb296-12" tabindex="-1"></a>d <span class="ot">=</span> <span class="fu">abs</span>(df.sample<span class="sc">$</span>mean[<span class="dv">1</span>] <span class="sc">-</span> df.sample<span class="sc">$</span>mean[<span class="dv">2</span>]) <span class="sc">/</span> sp</span>
<span id="cb296-13"><a href="power.html#cb296-13" tabindex="-1"></a></span>
<span id="cb296-14"><a href="power.html#cb296-14" tabindex="-1"></a>d</span></code></pre></div>
<pre><code>[1] 0.5874251</code></pre>
<p>Let’s double check that we got it right:</p>
<div class="sourceCode" id="cb298"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb298-1"><a href="power.html#cb298-1" tabindex="-1"></a><span class="fu">cohens_d</span>(<span class="at">x =</span> value <span class="sc">~</span> name, </span>
<span id="cb298-2"><a href="power.html#cb298-2" tabindex="-1"></a>         <span class="at">data =</span> df.ttest)</span></code></pre></div>
<pre><code>Cohen&#39;s d |        95% CI
-------------------------
-0.59     | [-1.48, 0.32]

- Estimated using pooled SD.</code></pre>
<p>We did!</p>
<p>So let’s now calculate the means and standard deviations based on our pilot data and run a power analysis to determine how many participants we would need, to have an 80% chance of rejecting the null hypothesis for the estimated effect size.</p>
<div class="sourceCode" id="cb300"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb300-1"><a href="power.html#cb300-1" tabindex="-1"></a><span class="co"># make reproducible </span></span>
<span id="cb300-2"><a href="power.html#cb300-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb300-3"><a href="power.html#cb300-3" tabindex="-1"></a></span>
<span id="cb300-4"><a href="power.html#cb300-4" tabindex="-1"></a><span class="co"># parameters </span></span>
<span id="cb300-5"><a href="power.html#cb300-5" tabindex="-1"></a>mean1 <span class="ot">=</span> df.sample<span class="sc">$</span>mean[<span class="dv">1</span>]</span>
<span id="cb300-6"><a href="power.html#cb300-6" tabindex="-1"></a>mean2 <span class="ot">=</span> df.sample<span class="sc">$</span>mean[<span class="dv">2</span>]</span>
<span id="cb300-7"><a href="power.html#cb300-7" tabindex="-1"></a>sd1 <span class="ot">=</span> df.sample<span class="sc">$</span>sd[<span class="dv">1</span>]</span>
<span id="cb300-8"><a href="power.html#cb300-8" tabindex="-1"></a>sd2 <span class="ot">=</span> df.sample<span class="sc">$</span>sd[<span class="dv">2</span>]</span>
<span id="cb300-9"><a href="power.html#cb300-9" tabindex="-1"></a></span>
<span id="cb300-10"><a href="power.html#cb300-10" tabindex="-1"></a><span class="co"># number of simulations</span></span>
<span id="cb300-11"><a href="power.html#cb300-11" tabindex="-1"></a>n_simulations <span class="ot">=</span> <span class="dv">10</span></span>
<span id="cb300-12"><a href="power.html#cb300-12" tabindex="-1"></a><span class="co"># n_simulations = 100</span></span>
<span id="cb300-13"><a href="power.html#cb300-13" tabindex="-1"></a></span>
<span id="cb300-14"><a href="power.html#cb300-14" tabindex="-1"></a><span class="co"># run simulation </span></span>
<span id="cb300-15"><a href="power.html#cb300-15" tabindex="-1"></a>df.power2 <span class="ot">=</span> <span class="fu">expand_grid</span>(<span class="at">n =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">10</span>, <span class="at">to =</span> <span class="dv">60</span>, <span class="at">by =</span> <span class="dv">5</span>),</span>
<span id="cb300-16"><a href="power.html#cb300-16" tabindex="-1"></a>                        <span class="at">simulation =</span> <span class="dv">1</span><span class="sc">:</span>n_simulations) <span class="sc">%&gt;%</span></span>
<span id="cb300-17"><a href="power.html#cb300-17" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">index =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>(),</span>
<span id="cb300-18"><a href="power.html#cb300-18" tabindex="-1"></a>         <span class="at">.before =</span> n) <span class="sc">%&gt;%</span> </span>
<span id="cb300-19"><a href="power.html#cb300-19" tabindex="-1"></a>  <span class="fu">group_by</span>(index, n, simulation) <span class="sc">%&gt;%</span> </span>
<span id="cb300-20"><a href="power.html#cb300-20" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">data =</span> <span class="fu">list</span>(<span class="fu">tibble</span>(<span class="at">group1 =</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n,</span>
<span id="cb300-21"><a href="power.html#cb300-21" tabindex="-1"></a>                                           <span class="at">mean =</span> mean1,</span>
<span id="cb300-22"><a href="power.html#cb300-22" tabindex="-1"></a>                                           <span class="at">sd =</span> sd1),</span>
<span id="cb300-23"><a href="power.html#cb300-23" tabindex="-1"></a>                            <span class="at">group2 =</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n,</span>
<span id="cb300-24"><a href="power.html#cb300-24" tabindex="-1"></a>                                           <span class="at">mean =</span> mean2,</span>
<span id="cb300-25"><a href="power.html#cb300-25" tabindex="-1"></a>                                           <span class="at">sd =</span> sd2)) <span class="sc">%&gt;%</span> </span>
<span id="cb300-26"><a href="power.html#cb300-26" tabindex="-1"></a>                       <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">everything</span>()))) <span class="sc">%&gt;%</span> </span>
<span id="cb300-27"><a href="power.html#cb300-27" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">fit =</span> <span class="fu">map</span>(<span class="at">.x =</span> data,</span>
<span id="cb300-28"><a href="power.html#cb300-28" tabindex="-1"></a>                   <span class="at">.f =</span> <span class="sc">~</span> <span class="fu">lm</span>(<span class="at">formula =</span> value <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> name,</span>
<span id="cb300-29"><a href="power.html#cb300-29" tabindex="-1"></a>                             <span class="at">data =</span> .)),</span>
<span id="cb300-30"><a href="power.html#cb300-30" tabindex="-1"></a>         <span class="at">parameters =</span> <span class="fu">map</span>(<span class="at">.x =</span> fit,</span>
<span id="cb300-31"><a href="power.html#cb300-31" tabindex="-1"></a>                          <span class="at">.f =</span> <span class="sc">~</span> <span class="fu">tidy</span>(.))) <span class="sc">%&gt;%</span></span>
<span id="cb300-32"><a href="power.html#cb300-32" tabindex="-1"></a>  <span class="fu">select</span>(index, n, simulation,  parameters) <span class="sc">%&gt;%</span> </span>
<span id="cb300-33"><a href="power.html#cb300-33" tabindex="-1"></a>  <span class="fu">unnest</span>(<span class="at">cols =</span> parameters) <span class="sc">%&gt;%</span> </span>
<span id="cb300-34"><a href="power.html#cb300-34" tabindex="-1"></a>  <span class="fu">filter</span>(term <span class="sc">!=</span> <span class="st">&quot;(Intercept)&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb300-35"><a href="power.html#cb300-35" tabindex="-1"></a>  <span class="fu">select</span>(index, n, simulation, p.value) <span class="sc">%&gt;%</span> </span>
<span id="cb300-36"><a href="power.html#cb300-36" tabindex="-1"></a>  <span class="fu">group_by</span>(n) <span class="sc">%&gt;%</span> </span>
<span id="cb300-37"><a href="power.html#cb300-37" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">power =</span> <span class="fu">sum</span>(p.value <span class="sc">&lt;</span> <span class="fl">0.05</span>) <span class="sc">/</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb300-38"><a href="power.html#cb300-38" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb300-39"><a href="power.html#cb300-39" tabindex="-1"></a></span>
<span id="cb300-40"><a href="power.html#cb300-40" tabindex="-1"></a><span class="co"># visualize results</span></span>
<span id="cb300-41"><a href="power.html#cb300-41" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df.power2, </span>
<span id="cb300-42"><a href="power.html#cb300-42" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> n,</span>
<span id="cb300-43"><a href="power.html#cb300-43" tabindex="-1"></a>                     <span class="at">y =</span> power)) <span class="sc">+</span></span>
<span id="cb300-44"><a href="power.html#cb300-44" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.1</span>),</span>
<span id="cb300-45"><a href="power.html#cb300-45" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="dv">2</span>,</span>
<span id="cb300-46"><a href="power.html#cb300-46" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">&quot;gray50&quot;</span>,</span>
<span id="cb300-47"><a href="power.html#cb300-47" tabindex="-1"></a>             <span class="at">size =</span> <span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb300-48"><a href="power.html#cb300-48" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;loess&quot;</span>,</span>
<span id="cb300-49"><a href="power.html#cb300-49" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb300-50"><a href="power.html#cb300-50" tabindex="-1"></a>              <span class="at">formula =</span> <span class="st">&quot;y ~ x&quot;</span>) <span class="sc">+</span></span>
<span id="cb300-51"><a href="power.html#cb300-51" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>) <span class="sc">+</span> </span>
<span id="cb300-52"><a href="power.html#cb300-52" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">10</span>, <span class="dv">60</span>, <span class="dv">10</span>),</span>
<span id="cb300-53"><a href="power.html#cb300-53" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">seq</span>(<span class="dv">10</span>, <span class="dv">60</span>, <span class="dv">10</span>)) <span class="sc">+</span> </span>
<span id="cb300-54"><a href="power.html#cb300-54" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.1</span>),</span>
<span id="cb300-55"><a href="power.html#cb300-55" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.1</span>))</span></code></pre></div>
<p><img src="06-power_files/figure-html/unnamed-chunk-43-1.png" width="672" /></p>
<p>Let’s compare to what we’d get from the <code>pwr</code> package.</p>
<div class="sourceCode" id="cb301"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb301-1"><a href="power.html#cb301-1" tabindex="-1"></a><span class="fu">pwr.t.test</span>(<span class="at">d =</span> <span class="fl">0.5874251</span>,</span>
<span id="cb301-2"><a href="power.html#cb301-2" tabindex="-1"></a>           <span class="at">power =</span> <span class="fl">0.8</span>,</span>
<span id="cb301-3"><a href="power.html#cb301-3" tabindex="-1"></a>           <span class="at">type =</span> <span class="st">&quot;two.sample&quot;</span>,</span>
<span id="cb301-4"><a href="power.html#cb301-4" tabindex="-1"></a>           <span class="at">alternative =</span> <span class="st">&quot;two.sided&quot;</span>)</span></code></pre></div>
<pre><code>
     Two-sample t test power calculation 

              n = 46.4718
              d = 0.5874251
      sig.level = 0.05
          power = 0.8
    alternative = two.sided

NOTE: n is number in *each* group</code></pre>
<p>Looks pretty similar!</p>
</div>
<div id="practice-2-simulation-of-an-interaction-effect" class="section level5 hasAnchor" number="6.6.2.3.3">
<h5><span class="header-section-number">6.6.2.3.3</span> Practice 2 – Simulation of an interaction effect<a href="power.html#practice-2-simulation-of-an-interaction-effect" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Try to run a simulation to determine how many participants you would need to have an 80% chance of rejecting the null hypothesis that there is no interaction based on the following pilot data set:</p>
<div class="sourceCode" id="cb303"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb303-1"><a href="power.html#cb303-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb303-2"><a href="power.html#cb303-2" tabindex="-1"></a><span class="co"># population parameters </span></span>
<span id="cb303-3"><a href="power.html#cb303-3" tabindex="-1"></a>b0 <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb303-4"><a href="power.html#cb303-4" tabindex="-1"></a>b1 <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb303-5"><a href="power.html#cb303-5" tabindex="-1"></a>b2 <span class="ot">=</span> <span class="dv">3</span></span>
<span id="cb303-6"><a href="power.html#cb303-6" tabindex="-1"></a>b1_2 <span class="ot">=</span> <span class="sc">-</span><span class="dv">2</span></span>
<span id="cb303-7"><a href="power.html#cb303-7" tabindex="-1"></a>sd <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb303-8"><a href="power.html#cb303-8" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">10</span> </span>
<span id="cb303-9"><a href="power.html#cb303-9" tabindex="-1"></a></span>
<span id="cb303-10"><a href="power.html#cb303-10" tabindex="-1"></a>df.linear <span class="ot">=</span> <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">runif</span>(<span class="at">n =</span> n),</span>
<span id="cb303-11"><a href="power.html#cb303-11" tabindex="-1"></a>                   <span class="at">y =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">each =</span> n<span class="sc">/</span><span class="dv">2</span>),</span>
<span id="cb303-12"><a href="power.html#cb303-12" tabindex="-1"></a>                   <span class="at">z =</span> b0 <span class="sc">+</span> b1 <span class="sc">*</span> x <span class="sc">+</span> b2 <span class="sc">*</span> y <span class="sc">+</span> b1_2 <span class="sc">*</span> x <span class="sc">*</span> y <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">sd =</span> sd))</span></code></pre></div>
<p>Let’s visualize the pilot data first:</p>
<div class="sourceCode" id="cb304"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb304-1"><a href="power.html#cb304-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df.linear,</span>
<span id="cb304-2"><a href="power.html#cb304-2" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> x,</span>
<span id="cb304-3"><a href="power.html#cb304-3" tabindex="-1"></a>                     <span class="at">y =</span> z,</span>
<span id="cb304-4"><a href="power.html#cb304-4" tabindex="-1"></a>                     <span class="at">group =</span> y,</span>
<span id="cb304-5"><a href="power.html#cb304-5" tabindex="-1"></a>                     <span class="at">fill =</span> <span class="fu">as.factor</span>(y),</span>
<span id="cb304-6"><a href="power.html#cb304-6" tabindex="-1"></a>                     <span class="at">color =</span> <span class="fu">as.factor</span>(y))) <span class="sc">+</span> </span>
<span id="cb304-7"><a href="power.html#cb304-7" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>,</span>
<span id="cb304-8"><a href="power.html#cb304-8" tabindex="-1"></a>              <span class="at">se =</span> F,</span>
<span id="cb304-9"><a href="power.html#cb304-9" tabindex="-1"></a>              <span class="at">show.legend =</span> F) <span class="sc">+</span></span>
<span id="cb304-10"><a href="power.html#cb304-10" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>,</span>
<span id="cb304-11"><a href="power.html#cb304-11" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb304-12"><a href="power.html#cb304-12" tabindex="-1"></a>             <span class="at">show.legend =</span> F)</span></code></pre></div>
<p><img src="06-power_files/figure-html/unnamed-chunk-46-1.png" width="672" /></p>
<p>Let’s estimate the parameters based on our sample:</p>
<div class="sourceCode" id="cb305"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb305-1"><a href="power.html#cb305-1" tabindex="-1"></a><span class="co"># parameter estimates for the coefficients based on the sample </span></span>
<span id="cb305-2"><a href="power.html#cb305-2" tabindex="-1"></a>b <span class="ot">=</span> <span class="fu">lm</span>(<span class="at">formula =</span> z <span class="sc">~</span> x <span class="sc">*</span> y,</span>
<span id="cb305-3"><a href="power.html#cb305-3" tabindex="-1"></a>   <span class="at">data =</span> df.linear) <span class="sc">%&gt;%</span> </span>
<span id="cb305-4"><a href="power.html#cb305-4" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb305-5"><a href="power.html#cb305-5" tabindex="-1"></a>  <span class="fu">select</span>(term, estimate, p.value)</span>
<span id="cb305-6"><a href="power.html#cb305-6" tabindex="-1"></a></span>
<span id="cb305-7"><a href="power.html#cb305-7" tabindex="-1"></a><span class="co"># parameter estimate of the residual standard deviation </span></span>
<span id="cb305-8"><a href="power.html#cb305-8" tabindex="-1"></a>sigma <span class="ot">=</span> <span class="fu">lm</span>(<span class="at">formula =</span> z <span class="sc">~</span> x <span class="sc">*</span> y,</span>
<span id="cb305-9"><a href="power.html#cb305-9" tabindex="-1"></a>           <span class="at">data =</span> df.linear) <span class="sc">%&gt;%</span> </span>
<span id="cb305-10"><a href="power.html#cb305-10" tabindex="-1"></a>  <span class="fu">glance</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb305-11"><a href="power.html#cb305-11" tabindex="-1"></a>  <span class="fu">pull</span>(sigma)</span></code></pre></div>
<p>Run a power analysis to see how many participants you would need to have an 80% of rejecting the null hypothesis that there is no interaction. Use the parameter estimates (the beta coefficients and the standard deviation of the residuals <code>sigma</code>) based on your pilot data to simulate new data.</p>
<p>Here is the strategy:</p>
<ul>
<li>Try to closely emulate what we’ve been doing for the independent samples t-test above.</li>
<li>However, this time, we have a different way of generating the data (namely by using the regression equation: <span class="math inline">\(z \sim b_0 + b_1 \cdot x + b_2 \cdot y + b_{1\_2} \cdot x \cdot y + e)\)</span>, where <span class="math inline">\(e \sim N(0, \sigma)\)</span>.</li>
<li>Fit the model first to extract the estimates for the beta coefficients, and the standard deviation of the residuals <code>sigma</code>.</li>
<li>Then use these parameters to generate new data assuming that <code>x</code> is a continuous predictor between 0 and 1 (<code>x = runif(n = n)</code>) and <code>y</code> is a binary, dummy-coded variable (<code>y = rep(c(0, 1), each = n/2)</code>).</li>
<li>Extract the coefficients of each model fit, and check whether the interaction is significant.</li>
<li>Make a plot that shows how power changes with the sample size n. </li>
</ul>
<div class="sourceCode" id="cb306"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb306-1"><a href="power.html#cb306-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb306-2"><a href="power.html#cb306-2" tabindex="-1"></a><span class="co"># write your code here </span></span></code></pre></div>
<p>Run the same power analysis this time assuming the ground truth parameters from the population (rather than the parameters that we’ve estimated from the sample).</p>
<div class="sourceCode" id="cb307"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb307-1"><a href="power.html#cb307-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb307-2"><a href="power.html#cb307-2" tabindex="-1"></a><span class="co"># write your code here </span></span></code></pre></div>
</div>
</div>
</div>
</div>
<div id="additional-resources-5" class="section level2 hasAnchor" number="6.7">
<h2><span class="header-section-number">6.7</span> Additional resources<a href="power.html#additional-resources-5" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="datacamp-4" class="section level3 hasAnchor" number="6.7.1">
<h3><span class="header-section-number">6.7.1</span> Datacamp<a href="power.html#datacamp-4" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><a href="https://www.datacamp.com/courses/foundations-of-functional-programming-with-purrr">Functional programming with purrr</a></li>
</ul>
</div>
<div id="cheatsheets-1" class="section level3 hasAnchor" number="6.7.2">
<h3><span class="header-section-number">6.7.2</span> Cheatsheets<a href="power.html#cheatsheets-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><a href="figures/purrr.pdf">purrr</a></li>
</ul>
</div>
<div id="misc-4" class="section level3 hasAnchor" number="6.7.3">
<h3><span class="header-section-number">6.7.3</span> Misc<a href="power.html#misc-4" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><a href="https://lakens.github.io/statistical_inferences/08-samplesizejustification.html">Sample size justification</a></li>
<li><a href="https://matthewbjane.quarto.pub/">Guide to reporting effect sizes and confidence intervals</a></li>
<li><a href="https://cran.r-project.org/web/packages/pwr/vignettes/pwr-vignette.html">Getting started with <code>pwr</code></a></li>
<li><a href="https://rpsychologist.com/d3/NHST/">Visualize power</a></li>
<li><a href="https://www.frontiersin.org/articles/10.3389/fpsyg.2013.00863/full">Calculating and reporting effect sizes to facilitate cumulative science: a practical primer for t-tests and ANOVAs</a></li>
<li><a href="https://emoriebeck.github.io/R-tutorials/purrr/">purrr tutorial</a></li>
<li><a href="https://cran.r-project.org/web/packages/simr/index.html">simr</a>: R Package for running power analysis for generalized linear mixed effects models.</li>
<li><a href="https://cran.r-project.org/web/packages/simglm/index.html">simglm</a>: Alternative R package for running power analysis via simulation.</li>
<li><a href="https://nccih.nih.gov/grants/whatnccihfunds/pilot_studies">cautionary tale about using pilot studies for power calculations</a></li>
</ul>
</div>
</div>
<div id="session-info-5" class="section level2 hasAnchor" number="6.8">
<h2><span class="header-section-number">6.8</span> Session info<a href="power.html#session-info-5" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Information about this R session including which version of R was used, and what packages were loaded.</p>
<div class="sourceCode" id="cb308"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb308-1"><a href="power.html#cb308-1" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span></code></pre></div>
<pre><code>R version 4.3.0 (2023-04-21)
Platform: aarch64-apple-darwin20 (64-bit)
Running under: macOS 14.1.1

Matrix products: default
BLAS:   /Library/Frameworks/R.framework/Versions/4.3-arm64/Resources/lib/libRblas.0.dylib 
LAPACK: /Library/Frameworks/R.framework/Versions/4.3-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.11.0

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

time zone: America/Chicago
tzcode source: internal

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
 [1] lubridate_1.9.2  forcats_1.0.0    stringr_1.5.0    dplyr_1.1.4     
 [5] purrr_1.0.2      readr_2.1.4      tidyr_1.3.0      tibble_3.2.1    
 [9] ggplot2_3.4.4    tidyverse_2.0.0  pwr_1.3-0        effectsize_0.8.6
[13] magrittr_2.0.3   broom_1.0.5      kableExtra_1.3.4 knitr_1.42      

loaded via a namespace (and not attached):
 [1] tidyselect_1.2.0   viridisLite_0.4.2  farver_2.1.1       fastmap_1.1.1     
 [5] bayestestR_0.13.1  digest_0.6.31      rpart_4.1.19       estimability_1.4.1
 [9] timechange_0.2.0   lifecycle_1.0.3    cluster_2.1.4      compiler_4.3.0    
[13] rlang_1.1.1        Hmisc_5.1-1        sass_0.4.6         tools_4.3.0       
[17] utf8_1.2.3         yaml_2.3.7         data.table_1.14.8  htmlwidgets_1.6.2 
[21] labeling_0.4.2     bit_4.0.5          xml2_1.3.4         withr_2.5.0       
[25] foreign_0.8-84     nnet_7.3-18        grid_4.3.0         datawizard_0.9.1  
[29] fansi_1.0.4        xtable_1.8-4       colorspace_2.1-0   emmeans_1.9.0     
[33] scales_1.3.0       insight_0.19.7     cli_3.6.1          mvtnorm_1.2-3     
[37] rmarkdown_2.21     crayon_1.5.2       generics_0.1.3     rstudioapi_0.14   
[41] httr_1.4.6         tzdb_0.4.0         parameters_0.21.3  cachem_1.0.8      
[45] splines_4.3.0      rvest_1.0.3        parallel_4.3.0     base64enc_0.1-3   
[49] vctrs_0.6.5        webshot_0.5.4      Matrix_1.6-4       jsonlite_1.8.4    
[53] bookdown_0.34      hms_1.1.3          bit64_4.0.5        htmlTable_2.4.2   
[57] Formula_1.2-5      systemfonts_1.0.4  jquerylib_0.1.4    glue_1.6.2        
[61] stringi_1.7.12     gtable_0.3.3       munsell_0.5.0      pillar_1.9.0      
[65] htmltools_0.5.5    R6_2.5.1           vroom_1.6.3        evaluate_0.21     
[69] lattice_0.21-8     highr_0.10         backports_1.4.1    bslib_0.4.2       
[73] checkmate_2.2.0    svglite_2.1.1      coda_0.19-4        gridExtra_2.3     
[77] nlme_3.1-162       mgcv_1.8-42        xfun_0.39          pkgconfig_2.0.3   </code></pre>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="linear-regression.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="linear-mixed-effects-models-1.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"],
"google": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/psych252/psych252book/edit/master/06-power.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": false,
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"toc_depth": 3
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
