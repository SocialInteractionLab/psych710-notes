<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 13 Generalized linear model | Psych 710: Statistical Methods II</title>
  <meta name="description" content="Course notes for Psych 710." />
  <meta name="generator" content="bookdown 0.34 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 13 Generalized linear model | Psych 710: Statistical Methods II" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Course notes for Psych 710." />
  <meta name="github-repo" content="SocialInteractionLab/psych710-notes" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 13 Generalized linear model | Psych 710: Statistical Methods II" />
  
  <meta name="twitter:description" content="Course notes for Psych 710." />
  

<meta name="author" content="Robert Hawkins" />


<meta name="date" content="2024-01-09" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="linear-mixed-effects-models-4.html"/>
<link rel="next" href="bayesian-data-analysis-1.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<script src="libs/viz-1.8.2/viz.js"></script>
<link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="libs/grViz-binding-1.0.10/grViz.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.31/datatables.js"></script>
<link href="libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Psych 252</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#course-homepage"><i class="fa fa-check"></i>Course homepage</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#license-and-citation"><i class="fa fa-check"></i>License and citation</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="probability-and-causality.html"><a href="probability-and-causality.html"><i class="fa fa-check"></i><b>1</b> Probability and causality</a>
<ul>
<li class="chapter" data-level="1.1" data-path="probability-and-causality.html"><a href="probability-and-causality.html#load-packages-load-data-set-theme"><i class="fa fa-check"></i><b>1.1</b> Load packages, load data, set theme</a></li>
<li class="chapter" data-level="1.2" data-path="probability-and-causality.html"><a href="probability-and-causality.html#counting"><i class="fa fa-check"></i><b>1.2</b> Counting</a></li>
<li class="chapter" data-level="1.3" data-path="probability-and-causality.html"><a href="probability-and-causality.html#the-random-secretary"><i class="fa fa-check"></i><b>1.3</b> The random secretary</a></li>
<li class="chapter" data-level="1.4" data-path="probability-and-causality.html"><a href="probability-and-causality.html#flipping-a-coin-many-times"><i class="fa fa-check"></i><b>1.4</b> Flipping a coin many times</a></li>
<li class="chapter" data-level="1.5" data-path="probability-and-causality.html"><a href="probability-and-causality.html#clue-guide-to-probability"><i class="fa fa-check"></i><b>1.5</b> Clue guide to probability</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="probability-and-causality.html"><a href="probability-and-causality.html#conditional-probability"><i class="fa fa-check"></i><b>1.5.1</b> Conditional probability</a></li>
<li class="chapter" data-level="1.5.2" data-path="probability-and-causality.html"><a href="probability-and-causality.html#law-of-total-probability"><i class="fa fa-check"></i><b>1.5.2</b> Law of total probability</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="probability-and-causality.html"><a href="probability-and-causality.html#probability-operations"><i class="fa fa-check"></i><b>1.6</b> Probability operations</a></li>
<li class="chapter" data-level="1.7" data-path="probability-and-causality.html"><a href="probability-and-causality.html#bayesian-reasoning-explained"><i class="fa fa-check"></i><b>1.7</b> Bayesian reasoning explained</a></li>
<li class="chapter" data-level="1.8" data-path="probability-and-causality.html"><a href="probability-and-causality.html#getting-bayes-right-matters"><i class="fa fa-check"></i><b>1.8</b> Getting Bayes right matters</a>
<ul>
<li class="chapter" data-level="1.8.1" data-path="probability-and-causality.html"><a href="probability-and-causality.html#bayesian-reasoning-example"><i class="fa fa-check"></i><b>1.8.1</b> Bayesian reasoning example</a></li>
<li class="chapter" data-level="1.8.2" data-path="probability-and-causality.html"><a href="probability-and-causality.html#bayesian-reasoning-example-covid-rapid-test"><i class="fa fa-check"></i><b>1.8.2</b> Bayesian reasoning example (COVID rapid test)</a></li>
<li class="chapter" data-level="1.8.3" data-path="probability-and-causality.html"><a href="probability-and-causality.html#most-people-in-the-hospital-are-vaccinated"><i class="fa fa-check"></i><b>1.8.3</b> Most people in the hospital are vaccinated</a></li>
</ul></li>
<li class="chapter" data-level="1.9" data-path="probability-and-causality.html"><a href="probability-and-causality.html#building-a-bayesis"><i class="fa fa-check"></i><b>1.9</b> Building a Bayesis</a>
<ul>
<li class="chapter" data-level="1.9.1" data-path="probability-and-causality.html"><a href="probability-and-causality.html#dice-example"><i class="fa fa-check"></i><b>1.9.1</b> Dice example</a></li>
</ul></li>
<li class="chapter" data-level="1.10" data-path="probability-and-causality.html"><a href="probability-and-causality.html#additional-resources"><i class="fa fa-check"></i><b>1.10</b> Additional resources</a>
<ul>
<li class="chapter" data-level="1.10.1" data-path="probability-and-causality.html"><a href="probability-and-causality.html#cheatsheets"><i class="fa fa-check"></i><b>1.10.1</b> Cheatsheets</a></li>
<li class="chapter" data-level="1.10.2" data-path="probability-and-causality.html"><a href="probability-and-causality.html#books-and-chapters"><i class="fa fa-check"></i><b>1.10.2</b> Books and chapters</a></li>
<li class="chapter" data-level="1.10.3" data-path="probability-and-causality.html"><a href="probability-and-causality.html#misc"><i class="fa fa-check"></i><b>1.10.3</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="1.11" data-path="probability-and-causality.html"><a href="probability-and-causality.html#session-info"><i class="fa fa-check"></i><b>1.11</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="simulation-1.html"><a href="simulation-1.html"><i class="fa fa-check"></i><b>2</b> Simulation 1</a>
<ul>
<li class="chapter" data-level="2.1" data-path="simulation-1.html"><a href="simulation-1.html#load-packages-and-set-plotting-theme"><i class="fa fa-check"></i><b>2.1</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="2.2" data-path="simulation-1.html"><a href="simulation-1.html#sampling"><i class="fa fa-check"></i><b>2.2</b> Sampling</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="simulation-1.html"><a href="simulation-1.html#drawing-numbers-from-a-vector"><i class="fa fa-check"></i><b>2.2.1</b> Drawing numbers from a vector</a></li>
<li class="chapter" data-level="2.2.2" data-path="simulation-1.html"><a href="simulation-1.html#drawing-rows-from-a-data-frame"><i class="fa fa-check"></i><b>2.2.2</b> Drawing rows from a data frame</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="simulation-1.html"><a href="simulation-1.html#working-with-distributions"><i class="fa fa-check"></i><b>2.3</b> Working with distributions</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="simulation-1.html"><a href="simulation-1.html#plotting-distributions"><i class="fa fa-check"></i><b>2.3.1</b> Plotting distributions</a></li>
<li class="chapter" data-level="2.3.2" data-path="simulation-1.html"><a href="simulation-1.html#sampling-from-distributions"><i class="fa fa-check"></i><b>2.3.2</b> Sampling from distributions</a></li>
<li class="chapter" data-level="2.3.3" data-path="simulation-1.html"><a href="simulation-1.html#understanding-density"><i class="fa fa-check"></i><b>2.3.3</b> Understanding <code>density()</code></a></li>
<li class="chapter" data-level="2.3.4" data-path="simulation-1.html"><a href="simulation-1.html#cumulative-probability-distribution"><i class="fa fa-check"></i><b>2.3.4</b> Cumulative probability distribution</a></li>
<li class="chapter" data-level="2.3.5" data-path="simulation-1.html"><a href="simulation-1.html#inverse-cumulative-distribution"><i class="fa fa-check"></i><b>2.3.5</b> Inverse cumulative distribution</a></li>
<li class="chapter" data-level="2.3.6" data-path="simulation-1.html"><a href="simulation-1.html#computing-probabilities"><i class="fa fa-check"></i><b>2.3.6</b> Computing probabilities</a></li>
<li class="chapter" data-level="2.3.7" data-path="simulation-1.html"><a href="simulation-1.html#make-the-plot"><i class="fa fa-check"></i><b>2.3.7</b> Make the plot</a></li>
<li class="chapter" data-level="2.3.8" data-path="simulation-1.html"><a href="simulation-1.html#analytic-solutions"><i class="fa fa-check"></i><b>2.3.8</b> Analytic solutions</a></li>
<li class="chapter" data-level="2.3.9" data-path="simulation-1.html"><a href="simulation-1.html#sampling-solution"><i class="fa fa-check"></i><b>2.3.9</b> Sampling solution</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="simulation-1.html"><a href="simulation-1.html#bayesian-inference-with-the-normal-distribution"><i class="fa fa-check"></i><b>2.4</b> Bayesian inference with the normal distribution</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="simulation-1.html"><a href="simulation-1.html#analytic-solution"><i class="fa fa-check"></i><b>2.4.1</b> Analytic solution</a></li>
<li class="chapter" data-level="2.4.2" data-path="simulation-1.html"><a href="simulation-1.html#solution-via-sampling"><i class="fa fa-check"></i><b>2.4.2</b> Solution via sampling</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="simulation-1.html"><a href="simulation-1.html#additional-resources-1"><i class="fa fa-check"></i><b>2.5</b> Additional resources</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="simulation-1.html"><a href="simulation-1.html#datacamp"><i class="fa fa-check"></i><b>2.5.1</b> Datacamp</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="simulation-1.html"><a href="simulation-1.html#session-info-1"><i class="fa fa-check"></i><b>2.6</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="modeling-data.html"><a href="modeling-data.html"><i class="fa fa-check"></i><b>3</b> Modeling data</a>
<ul>
<li class="chapter" data-level="3.1" data-path="modeling-data.html"><a href="modeling-data.html#load-packages-and-set-plotting-theme-1"><i class="fa fa-check"></i><b>3.1</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="3.2" data-path="modeling-data.html"><a href="modeling-data.html#modeling-data-1"><i class="fa fa-check"></i><b>3.2</b> Modeling data</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="modeling-data.html"><a href="modeling-data.html#simplicity-vs.-accuracy-trade-off"><i class="fa fa-check"></i><b>3.2.1</b> Simplicity vs. accuracy trade-off</a></li>
<li class="chapter" data-level="3.2.2" data-path="modeling-data.html"><a href="modeling-data.html#sampling-distributions-for-median-and-mean"><i class="fa fa-check"></i><b>3.2.2</b> Sampling distributions for median and mean</a></li>
<li class="chapter" data-level="3.2.3" data-path="modeling-data.html"><a href="modeling-data.html#residuals-need-to-be-normally-distributed-not-the-data-itself"><i class="fa fa-check"></i><b>3.2.3</b> Residuals need to be normally distributed, not the data itself</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="modeling-data.html"><a href="modeling-data.html#hypothesis-testing-one-sample-t-test"><i class="fa fa-check"></i><b>3.3</b> Hypothesis testing: “One-sample t-test”</a></li>
<li class="chapter" data-level="3.4" data-path="modeling-data.html"><a href="modeling-data.html#building-a-sampling-distribution-of-pre"><i class="fa fa-check"></i><b>3.4</b> Building a sampling distribution of PRE</a></li>
<li class="chapter" data-level="3.5" data-path="modeling-data.html"><a href="modeling-data.html#misc-1"><i class="fa fa-check"></i><b>3.5</b> Misc</a></li>
<li class="chapter" data-level="3.6" data-path="modeling-data.html"><a href="modeling-data.html#additional-resources-2"><i class="fa fa-check"></i><b>3.6</b> Additional resources</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="modeling-data.html"><a href="modeling-data.html#reading"><i class="fa fa-check"></i><b>3.6.1</b> Reading</a></li>
<li class="chapter" data-level="3.6.2" data-path="modeling-data.html"><a href="modeling-data.html#datacamp-1"><i class="fa fa-check"></i><b>3.6.2</b> Datacamp</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="modeling-data.html"><a href="modeling-data.html#session-info-2"><i class="fa fa-check"></i><b>3.7</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="simulation-2.html"><a href="simulation-2.html"><i class="fa fa-check"></i><b>4</b> Simulation 2</a>
<ul>
<li class="chapter" data-level="4.1" data-path="simulation-2.html"><a href="simulation-2.html#load-packages-and-set-plotting-theme-2"><i class="fa fa-check"></i><b>4.1</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="4.2" data-path="simulation-2.html"><a href="simulation-2.html#making-statistical-inferences-frequentist-style"><i class="fa fa-check"></i><b>4.2</b> Making statistical inferences (frequentist style)</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="simulation-2.html"><a href="simulation-2.html#population-distribution"><i class="fa fa-check"></i><b>4.2.1</b> Population distribution</a></li>
<li class="chapter" data-level="4.2.2" data-path="simulation-2.html"><a href="simulation-2.html#distribution-of-a-single-sample"><i class="fa fa-check"></i><b>4.2.2</b> Distribution of a single sample</a></li>
<li class="chapter" data-level="4.2.3" data-path="simulation-2.html"><a href="simulation-2.html#the-sampling-distribution"><i class="fa fa-check"></i><b>4.2.3</b> The sampling distribution</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="simulation-2.html"><a href="simulation-2.html#understanding-p-values"><i class="fa fa-check"></i><b>4.3</b> Understanding p-values</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="simulation-2.html"><a href="simulation-2.html#permutation-test"><i class="fa fa-check"></i><b>4.3.1</b> Permutation test</a></li>
<li class="chapter" data-level="4.3.2" data-path="simulation-2.html"><a href="simulation-2.html#t-test-by-hand"><i class="fa fa-check"></i><b>4.3.2</b> t-test by hand</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="simulation-2.html"><a href="simulation-2.html#confidence-intervals"><i class="fa fa-check"></i><b>4.4</b> Confidence intervals</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="simulation-2.html"><a href="simulation-2.html#mean_cl_boot-explained"><i class="fa fa-check"></i><b>4.4.1</b> <code>mean_cl_boot()</code> explained</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="simulation-2.html"><a href="simulation-2.html#additional-resources-3"><i class="fa fa-check"></i><b>4.5</b> Additional resources</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="simulation-2.html"><a href="simulation-2.html#misc-2"><i class="fa fa-check"></i><b>4.5.1</b> Misc</a></li>
<li class="chapter" data-level="4.5.2" data-path="simulation-2.html"><a href="simulation-2.html#datacamp-2"><i class="fa fa-check"></i><b>4.5.2</b> Datacamp</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="simulation-2.html"><a href="simulation-2.html#session-info-3"><i class="fa fa-check"></i><b>4.6</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="linear-model-2.html"><a href="linear-model-2.html"><i class="fa fa-check"></i><b>5</b> Linear model 2</a>
<ul>
<li class="chapter" data-level="5.1" data-path="linear-model-2.html"><a href="linear-model-2.html#learning-goals"><i class="fa fa-check"></i><b>5.1</b> Learning goals</a></li>
<li class="chapter" data-level="5.2" data-path="linear-model-2.html"><a href="linear-model-2.html#load-packages-and-set-plotting-theme-3"><i class="fa fa-check"></i><b>5.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="5.3" data-path="linear-model-2.html"><a href="linear-model-2.html#load-data-sets"><i class="fa fa-check"></i><b>5.3</b> Load data sets</a></li>
<li class="chapter" data-level="5.4" data-path="linear-model-2.html"><a href="linear-model-2.html#multiple-continuous-variables"><i class="fa fa-check"></i><b>5.4</b> Multiple continuous variables</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="linear-model-2.html"><a href="linear-model-2.html#explore-correlations"><i class="fa fa-check"></i><b>5.4.1</b> Explore correlations</a></li>
<li class="chapter" data-level="5.4.2" data-path="linear-model-2.html"><a href="linear-model-2.html#multipe-regression"><i class="fa fa-check"></i><b>5.4.2</b> Multipe regression</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="linear-model-2.html"><a href="linear-model-2.html#one-categorical-variable"><i class="fa fa-check"></i><b>5.5</b> One categorical variable</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="linear-model-2.html"><a href="linear-model-2.html#visualization-of-the-model-predictions"><i class="fa fa-check"></i><b>5.5.1</b> Visualization of the model predictions</a></li>
<li class="chapter" data-level="5.5.2" data-path="linear-model-2.html"><a href="linear-model-2.html#dummy-coding"><i class="fa fa-check"></i><b>5.5.2</b> Dummy coding</a></li>
<li class="chapter" data-level="5.5.3" data-path="linear-model-2.html"><a href="linear-model-2.html#reporting-the-results"><i class="fa fa-check"></i><b>5.5.3</b> Reporting the results</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="linear-model-2.html"><a href="linear-model-2.html#one-continuous-and-one-categorical-variable"><i class="fa fa-check"></i><b>5.6</b> One continuous and one categorical variable</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="linear-model-2.html"><a href="linear-model-2.html#visualization-of-the-model-predictions-1"><i class="fa fa-check"></i><b>5.6.1</b> Visualization of the model predictions</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="linear-model-2.html"><a href="linear-model-2.html#interactions"><i class="fa fa-check"></i><b>5.7</b> Interactions</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="linear-model-2.html"><a href="linear-model-2.html#visualization-1"><i class="fa fa-check"></i><b>5.7.1</b> Visualization</a></li>
<li class="chapter" data-level="5.7.2" data-path="linear-model-2.html"><a href="linear-model-2.html#hypothesis-test"><i class="fa fa-check"></i><b>5.7.2</b> Hypothesis test</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="linear-model-2.html"><a href="linear-model-2.html#additional-resources-4"><i class="fa fa-check"></i><b>5.8</b> Additional resources</a>
<ul>
<li class="chapter" data-level="5.8.1" data-path="linear-model-2.html"><a href="linear-model-2.html#datacamp-3"><i class="fa fa-check"></i><b>5.8.1</b> Datacamp</a></li>
<li class="chapter" data-level="5.8.2" data-path="linear-model-2.html"><a href="linear-model-2.html#misc-3"><i class="fa fa-check"></i><b>5.8.2</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="5.9" data-path="linear-model-2.html"><a href="linear-model-2.html#session-info-4"><i class="fa fa-check"></i><b>5.9</b> Session info</a></li>
<li class="chapter" data-level="5.10" data-path="linear-model-2.html"><a href="linear-model-2.html#references"><i class="fa fa-check"></i><b>5.10</b> References</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="linear-model-3.html"><a href="linear-model-3.html"><i class="fa fa-check"></i><b>6</b> Linear model 3</a>
<ul>
<li class="chapter" data-level="6.1" data-path="linear-model-3.html"><a href="linear-model-3.html#learning-goals-1"><i class="fa fa-check"></i><b>6.1</b> Learning goals</a></li>
<li class="chapter" data-level="6.2" data-path="linear-model-3.html"><a href="linear-model-3.html#load-packages-and-set-plotting-theme-4"><i class="fa fa-check"></i><b>6.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="6.3" data-path="linear-model-3.html"><a href="linear-model-3.html#load-data-sets-1"><i class="fa fa-check"></i><b>6.3</b> Load data sets</a></li>
<li class="chapter" data-level="6.4" data-path="linear-model-3.html"><a href="linear-model-3.html#one-way-anova"><i class="fa fa-check"></i><b>6.4</b> One-way ANOVA</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="linear-model-3.html"><a href="linear-model-3.html#visualization-2"><i class="fa fa-check"></i><b>6.4.1</b> Visualization</a></li>
<li class="chapter" data-level="6.4.2" data-path="linear-model-3.html"><a href="linear-model-3.html#model-fitting"><i class="fa fa-check"></i><b>6.4.2</b> Model fitting</a></li>
<li class="chapter" data-level="6.4.3" data-path="linear-model-3.html"><a href="linear-model-3.html#hypothesis-test-1"><i class="fa fa-check"></i><b>6.4.3</b> Hypothesis test</a></li>
<li class="chapter" data-level="6.4.4" data-path="linear-model-3.html"><a href="linear-model-3.html#visualize-the-models-predictions"><i class="fa fa-check"></i><b>6.4.4</b> Visualize the model’s predictions</a></li>
<li class="chapter" data-level="6.4.5" data-path="linear-model-3.html"><a href="linear-model-3.html#dummy-coding-1"><i class="fa fa-check"></i><b>6.4.5</b> Dummy coding</a></li>
<li class="chapter" data-level="6.4.6" data-path="linear-model-3.html"><a href="linear-model-3.html#follow-up-questions"><i class="fa fa-check"></i><b>6.4.6</b> Follow up questions</a></li>
<li class="chapter" data-level="6.4.7" data-path="linear-model-3.html"><a href="linear-model-3.html#variance-decomposition"><i class="fa fa-check"></i><b>6.4.7</b> Variance decomposition</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="linear-model-3.html"><a href="linear-model-3.html#two-way-anova"><i class="fa fa-check"></i><b>6.5</b> Two-way ANOVA</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="linear-model-3.html"><a href="linear-model-3.html#visualization-3"><i class="fa fa-check"></i><b>6.5.1</b> Visualization</a></li>
<li class="chapter" data-level="6.5.2" data-path="linear-model-3.html"><a href="linear-model-3.html#model-fitting-1"><i class="fa fa-check"></i><b>6.5.2</b> Model fitting</a></li>
<li class="chapter" data-level="6.5.3" data-path="linear-model-3.html"><a href="linear-model-3.html#interpreting-interactions"><i class="fa fa-check"></i><b>6.5.3</b> Interpreting interactions</a></li>
<li class="chapter" data-level="6.5.4" data-path="linear-model-3.html"><a href="linear-model-3.html#variance-decomposition-1"><i class="fa fa-check"></i><b>6.5.4</b> Variance decomposition</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="linear-model-3.html"><a href="linear-model-3.html#two-way-anova-with-interaction"><i class="fa fa-check"></i><b>6.6</b> Two-way ANOVA (with interaction)</a></li>
<li class="chapter" data-level="6.7" data-path="linear-model-3.html"><a href="linear-model-3.html#anova-with-unbalanced-design"><i class="fa fa-check"></i><b>6.7</b> ANOVA with unbalanced design</a></li>
<li class="chapter" data-level="6.8" data-path="linear-model-3.html"><a href="linear-model-3.html#interpreting-parameters-very-important"><i class="fa fa-check"></i><b>6.8</b> Interpreting parameters (very important!)</a></li>
<li class="chapter" data-level="6.9" data-path="linear-model-3.html"><a href="linear-model-3.html#linear-contrasts"><i class="fa fa-check"></i><b>6.9</b> Linear contrasts</a>
<ul>
<li class="chapter" data-level="6.9.1" data-path="linear-model-3.html"><a href="linear-model-3.html#hypothetical-data"><i class="fa fa-check"></i><b>6.9.1</b> Hypothetical data</a></li>
<li class="chapter" data-level="6.9.2" data-path="linear-model-3.html"><a href="linear-model-3.html#visualization-4"><i class="fa fa-check"></i><b>6.9.2</b> Visualization</a></li>
<li class="chapter" data-level="6.9.3" data-path="linear-model-3.html"><a href="linear-model-3.html#orthogonal-contrasts"><i class="fa fa-check"></i><b>6.9.3</b> Orthogonal contrasts</a></li>
<li class="chapter" data-level="6.9.4" data-path="linear-model-3.html"><a href="linear-model-3.html#post-hoc-tests"><i class="fa fa-check"></i><b>6.9.4</b> Post-hoc tests</a></li>
<li class="chapter" data-level="6.9.5" data-path="linear-model-3.html"><a href="linear-model-3.html#understanding-dummy-coding"><i class="fa fa-check"></i><b>6.9.5</b> Understanding dummy coding</a></li>
<li class="chapter" data-level="6.9.6" data-path="linear-model-3.html"><a href="linear-model-3.html#understanding-sum-coding"><i class="fa fa-check"></i><b>6.9.6</b> Understanding sum coding</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="power-analysis.html"><a href="power-analysis.html"><i class="fa fa-check"></i><b>7</b> Power analysis</a>
<ul>
<li class="chapter" data-level="7.1" data-path="power-analysis.html"><a href="power-analysis.html#learning-goals-2"><i class="fa fa-check"></i><b>7.1</b> Learning goals</a></li>
<li class="chapter" data-level="7.2" data-path="power-analysis.html"><a href="power-analysis.html#load-packages-and-set-plotting-theme-5"><i class="fa fa-check"></i><b>7.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="7.3" data-path="power-analysis.html"><a href="power-analysis.html#load-data-sets-2"><i class="fa fa-check"></i><b>7.3</b> Load data sets</a></li>
<li class="chapter" data-level="7.4" data-path="power-analysis.html"><a href="power-analysis.html#decision-making"><i class="fa fa-check"></i><b>7.4</b> Decision-making</a></li>
<li class="chapter" data-level="7.5" data-path="power-analysis.html"><a href="power-analysis.html#effect-sizes"><i class="fa fa-check"></i><b>7.5</b> Effect sizes</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="power-analysis.html"><a href="power-analysis.html#cohens-d"><i class="fa fa-check"></i><b>7.5.1</b> Cohen’s d</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="power-analysis.html"><a href="power-analysis.html#determining-sample-size"><i class="fa fa-check"></i><b>7.6</b> Determining sample size</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="power-analysis.html"><a href="power-analysis.html#pwr-package"><i class="fa fa-check"></i><b>7.6.1</b> <code>pwr</code> package</a></li>
<li class="chapter" data-level="7.6.2" data-path="power-analysis.html"><a href="power-analysis.html#power-analysis-1"><i class="fa fa-check"></i><b>7.6.2</b> Power analysis</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="power-analysis.html"><a href="power-analysis.html#additional-resources-5"><i class="fa fa-check"></i><b>7.7</b> Additional resources</a>
<ul>
<li class="chapter" data-level="7.7.1" data-path="power-analysis.html"><a href="power-analysis.html#datacamp-4"><i class="fa fa-check"></i><b>7.7.1</b> Datacamp</a></li>
<li class="chapter" data-level="7.7.2" data-path="power-analysis.html"><a href="power-analysis.html#cheatsheets-1"><i class="fa fa-check"></i><b>7.7.2</b> Cheatsheets</a></li>
<li class="chapter" data-level="7.7.3" data-path="power-analysis.html"><a href="power-analysis.html#misc-4"><i class="fa fa-check"></i><b>7.7.3</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="7.8" data-path="power-analysis.html"><a href="power-analysis.html#session-info-5"><i class="fa fa-check"></i><b>7.8</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="model-comparison.html"><a href="model-comparison.html"><i class="fa fa-check"></i><b>8</b> Model comparison</a>
<ul>
<li class="chapter" data-level="8.1" data-path="model-comparison.html"><a href="model-comparison.html#learning-goals-3"><i class="fa fa-check"></i><b>8.1</b> Learning goals</a></li>
<li class="chapter" data-level="8.2" data-path="model-comparison.html"><a href="model-comparison.html#load-packages-and-set-plotting-theme-6"><i class="fa fa-check"></i><b>8.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="8.3" data-path="model-comparison.html"><a href="model-comparison.html#model-comparison-1"><i class="fa fa-check"></i><b>8.3</b> Model comparison</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="model-comparison.html"><a href="model-comparison.html#fitting-vs.-predicting"><i class="fa fa-check"></i><b>8.3.1</b> Fitting vs. predicting</a></li>
<li class="chapter" data-level="8.3.2" data-path="model-comparison.html"><a href="model-comparison.html#f-test"><i class="fa fa-check"></i><b>8.3.2</b> F-test</a></li>
<li class="chapter" data-level="8.3.3" data-path="model-comparison.html"><a href="model-comparison.html#cross-validation"><i class="fa fa-check"></i><b>8.3.3</b> Cross-validation</a></li>
<li class="chapter" data-level="8.3.4" data-path="model-comparison.html"><a href="model-comparison.html#bootstrap"><i class="fa fa-check"></i><b>8.3.4</b> Bootstrap</a></li>
<li class="chapter" data-level="8.3.5" data-path="model-comparison.html"><a href="model-comparison.html#aic-and-bic"><i class="fa fa-check"></i><b>8.3.5</b> AIC and BIC</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="model-comparison.html"><a href="model-comparison.html#additional-resources-6"><i class="fa fa-check"></i><b>8.4</b> Additional resources</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="model-comparison.html"><a href="model-comparison.html#datacamp-course"><i class="fa fa-check"></i><b>8.4.1</b> Datacamp course</a></li>
<li class="chapter" data-level="8.4.2" data-path="model-comparison.html"><a href="model-comparison.html#reading-1"><i class="fa fa-check"></i><b>8.4.2</b> Reading</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="model-comparison.html"><a href="model-comparison.html#session-info-6"><i class="fa fa-check"></i><b>8.5</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html"><i class="fa fa-check"></i><b>9</b> Linear mixed effects models 1</a>
<ul>
<li class="chapter" data-level="9.1" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html#learning-goals-4"><i class="fa fa-check"></i><b>9.1</b> Learning goals</a></li>
<li class="chapter" data-level="9.2" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html#load-packages-and-set-plotting-theme-7"><i class="fa fa-check"></i><b>9.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="9.3" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html#dependence"><i class="fa fa-check"></i><b>9.3</b> Dependence</a></li>
<li class="chapter" data-level="9.4" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html#additional-resources-7"><i class="fa fa-check"></i><b>9.4</b> Additional resources</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html#readings"><i class="fa fa-check"></i><b>9.4.1</b> Readings</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html#session-info-7"><i class="fa fa-check"></i><b>9.5</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html"><i class="fa fa-check"></i><b>10</b> Linear mixed effects models 2</a>
<ul>
<li class="chapter" data-level="10.1" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#learning-goals-5"><i class="fa fa-check"></i><b>10.1</b> Learning goals</a></li>
<li class="chapter" data-level="10.2" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#load-packages-and-set-plotting-theme-8"><i class="fa fa-check"></i><b>10.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="10.3" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#a-worked-example"><i class="fa fa-check"></i><b>10.3</b> A worked example</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#complete-pooling"><i class="fa fa-check"></i><b>10.3.1</b> Complete pooling</a></li>
<li class="chapter" data-level="10.3.2" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#no-pooling"><i class="fa fa-check"></i><b>10.3.2</b> No pooling</a></li>
<li class="chapter" data-level="10.3.3" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#partial-pooling"><i class="fa fa-check"></i><b>10.3.3</b> Partial pooling</a></li>
<li class="chapter" data-level="10.3.4" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#compare-results"><i class="fa fa-check"></i><b>10.3.4</b> Compare results</a></li>
<li class="chapter" data-level="10.3.5" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#getting-p-values"><i class="fa fa-check"></i><b>10.3.5</b> Getting p-values</a></li>
<li class="chapter" data-level="10.3.6" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#reporting-results"><i class="fa fa-check"></i><b>10.3.6</b> Reporting results</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#simulating-a-linear-mixed-effects-model"><i class="fa fa-check"></i><b>10.4</b> Simulating a linear mixed effects model</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#the-effect-of-outliers"><i class="fa fa-check"></i><b>10.4.1</b> The effect of outliers</a></li>
<li class="chapter" data-level="10.4.2" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#different-slopes"><i class="fa fa-check"></i><b>10.4.2</b> Different slopes</a></li>
<li class="chapter" data-level="10.4.3" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#simpsons-paradox"><i class="fa fa-check"></i><b>10.4.3</b> Simpson’s paradox</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#additional-resources-8"><i class="fa fa-check"></i><b>10.5</b> Additional resources</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#readings-1"><i class="fa fa-check"></i><b>10.5.1</b> Readings</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#session-info-8"><i class="fa fa-check"></i><b>10.6</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html"><i class="fa fa-check"></i><b>11</b> Linear mixed effects models 3</a>
<ul>
<li class="chapter" data-level="11.1" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#learning-goals-6"><i class="fa fa-check"></i><b>11.1</b> Learning goals</a></li>
<li class="chapter" data-level="11.2" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#load-packages-and-set-plotting-theme-9"><i class="fa fa-check"></i><b>11.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="11.3" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#load-data-sets-3"><i class="fa fa-check"></i><b>11.3</b> Load data sets</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#sleep-data"><i class="fa fa-check"></i><b>11.3.1</b> Sleep data</a></li>
<li class="chapter" data-level="11.3.2" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#reasoning-data"><i class="fa fa-check"></i><b>11.3.2</b> Reasoning data</a></li>
<li class="chapter" data-level="11.3.3" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#weight-loss-data"><i class="fa fa-check"></i><b>11.3.3</b> Weight loss data</a></li>
<li class="chapter" data-level="11.3.4" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#politness-data"><i class="fa fa-check"></i><b>11.3.4</b> Politness data</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#understanding-the-lmer-syntax"><i class="fa fa-check"></i><b>11.4</b> Understanding the lmer() syntax</a></li>
<li class="chapter" data-level="11.5" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#anova-vs.-lmer"><i class="fa fa-check"></i><b>11.5</b> ANOVA vs. Lmer</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#between-subjects-anova"><i class="fa fa-check"></i><b>11.5.1</b> Between subjects ANOVA</a></li>
<li class="chapter" data-level="11.5.2" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#repeated-measures-anova"><i class="fa fa-check"></i><b>11.5.2</b> Repeated-measures ANOVA</a></li>
<li class="chapter" data-level="11.5.3" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#mixed-anova"><i class="fa fa-check"></i><b>11.5.3</b> Mixed ANOVA</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#session-info-9"><i class="fa fa-check"></i><b>11.6</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html"><i class="fa fa-check"></i><b>12</b> Linear mixed effects models 4</a>
<ul>
<li class="chapter" data-level="12.1" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#learning-goals-7"><i class="fa fa-check"></i><b>12.1</b> Learning goals</a></li>
<li class="chapter" data-level="12.2" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#load-packages-and-set-plotting-theme-10"><i class="fa fa-check"></i><b>12.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="12.3" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#load-data-sets-4"><i class="fa fa-check"></i><b>12.3</b> Load data sets</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#sleep-data-1"><i class="fa fa-check"></i><b>12.3.1</b> Sleep data</a></li>
<li class="chapter" data-level="12.3.2" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#reasoning-data-1"><i class="fa fa-check"></i><b>12.3.2</b> Reasoning data</a></li>
<li class="chapter" data-level="12.3.3" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#weight-loss-data-1"><i class="fa fa-check"></i><b>12.3.3</b> Weight loss data</a></li>
<li class="chapter" data-level="12.3.4" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#politness-data-1"><i class="fa fa-check"></i><b>12.3.4</b> Politness data</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#follow-up-tests-with-emmeans"><i class="fa fa-check"></i><b>12.4</b> Follow-up tests with emmeans</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#sleep-study"><i class="fa fa-check"></i><b>12.4.1</b> Sleep study</a></li>
<li class="chapter" data-level="12.4.2" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#weight-loss-study"><i class="fa fa-check"></i><b>12.4.2</b> Weight loss study</a></li>
<li class="chapter" data-level="12.4.3" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#politeness-study"><i class="fa fa-check"></i><b>12.4.3</b> Politeness study</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#mixtures-of-participants"><i class="fa fa-check"></i><b>12.5</b> Mixtures of participants</a></li>
<li class="chapter" data-level="12.6" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#bootstrapping"><i class="fa fa-check"></i><b>12.6</b> Bootstrapping</a>
<ul>
<li class="chapter" data-level="12.6.1" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#linear-model"><i class="fa fa-check"></i><b>12.6.1</b> Linear model</a></li>
</ul></li>
<li class="chapter" data-level="12.7" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#session-info-10"><i class="fa fa-check"></i><b>12.7</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html"><i class="fa fa-check"></i><b>13</b> Generalized linear model</a>
<ul>
<li class="chapter" data-level="13.1" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#learning-goals-8"><i class="fa fa-check"></i><b>13.1</b> Learning goals</a></li>
<li class="chapter" data-level="13.2" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#load-packages-and-set-plotting-theme-11"><i class="fa fa-check"></i><b>13.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="13.3" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#load-data-set"><i class="fa fa-check"></i><b>13.3</b> Load data set</a></li>
<li class="chapter" data-level="13.4" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#logistic-regression"><i class="fa fa-check"></i><b>13.4</b> Logistic regression</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#interpreting-the-parameters"><i class="fa fa-check"></i><b>13.4.1</b> Interpreting the parameters</a></li>
<li class="chapter" data-level="13.4.2" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#binary-predictor"><i class="fa fa-check"></i><b>13.4.2</b> Binary predictor</a></li>
<li class="chapter" data-level="13.4.3" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#continuous-predictor"><i class="fa fa-check"></i><b>13.4.3</b> Continuous predictor</a></li>
<li class="chapter" data-level="13.4.4" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#several-predictors"><i class="fa fa-check"></i><b>13.4.4</b> Several predictors</a></li>
<li class="chapter" data-level="13.4.5" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#using-the-ggeffects-package"><i class="fa fa-check"></i><b>13.4.5</b> Using the “ggeffects” package</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#simulate-a-logistic-regression"><i class="fa fa-check"></i><b>13.5</b> Simulate a logistic regression</a>
<ul>
<li class="chapter" data-level="13.5.1" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#calculate-the-models-likelihood"><i class="fa fa-check"></i><b>13.5.1</b> Calculate the model’s likelihood</a></li>
</ul></li>
<li class="chapter" data-level="13.6" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#testing-hypotheses"><i class="fa fa-check"></i><b>13.6</b> Testing hypotheses</a></li>
<li class="chapter" data-level="13.7" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#logistic-mixed-effects-model"><i class="fa fa-check"></i><b>13.7</b> Logistic mixed effects model</a></li>
<li class="chapter" data-level="13.8" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#additional-information"><i class="fa fa-check"></i><b>13.8</b> Additional information</a>
<ul>
<li class="chapter" data-level="13.8.1" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#misc-5"><i class="fa fa-check"></i><b>13.8.1</b> Misc</a></li>
<li class="chapter" data-level="13.8.2" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#datacamp-5"><i class="fa fa-check"></i><b>13.8.2</b> Datacamp</a></li>
</ul></li>
<li class="chapter" data-level="13.9" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#session-info-11"><i class="fa fa-check"></i><b>13.9</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="bayesian-data-analysis-1.html"><a href="bayesian-data-analysis-1.html"><i class="fa fa-check"></i><b>14</b> Bayesian data analysis 1</a>
<ul>
<li class="chapter" data-level="14.1" data-path="bayesian-data-analysis-1.html"><a href="bayesian-data-analysis-1.html#learning-goals-9"><i class="fa fa-check"></i><b>14.1</b> Learning goals</a></li>
<li class="chapter" data-level="14.2" data-path="bayesian-data-analysis-1.html"><a href="bayesian-data-analysis-1.html#load-packages-and-set-plotting-theme-12"><i class="fa fa-check"></i><b>14.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="14.3" data-path="bayesian-data-analysis-1.html"><a href="bayesian-data-analysis-1.html#doing-bayesian-inference-by-hand"><i class="fa fa-check"></i><b>14.3</b> Doing Bayesian inference “by hand”</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="bayesian-data-analysis-1.html"><a href="bayesian-data-analysis-1.html#sequential-updating-based-on-the-beta-distribution"><i class="fa fa-check"></i><b>14.3.1</b> Sequential updating based on the Beta distribution</a></li>
<li class="chapter" data-level="14.3.2" data-path="bayesian-data-analysis-1.html"><a href="bayesian-data-analysis-1.html#coin-flip-example"><i class="fa fa-check"></i><b>14.3.2</b> Coin flip example</a></li>
<li class="chapter" data-level="14.3.3" data-path="bayesian-data-analysis-1.html"><a href="bayesian-data-analysis-1.html#bayesian-inference-by-discretization"><i class="fa fa-check"></i><b>14.3.3</b> Bayesian inference by discretization</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="bayesian-data-analysis-1.html"><a href="bayesian-data-analysis-1.html#doing-bayesian-inference-with-greta"><i class="fa fa-check"></i><b>14.4</b> Doing Bayesian inference with Greta</a>
<ul>
<li class="chapter" data-level="14.4.1" data-path="bayesian-data-analysis-1.html"><a href="bayesian-data-analysis-1.html#attitude-data-set"><i class="fa fa-check"></i><b>14.4.1</b> Attitude data set</a></li>
<li class="chapter" data-level="14.4.2" data-path="bayesian-data-analysis-1.html"><a href="bayesian-data-analysis-1.html#frequentist-analysis"><i class="fa fa-check"></i><b>14.4.2</b> Frequentist analysis</a></li>
<li class="chapter" data-level="14.4.3" data-path="bayesian-data-analysis-1.html"><a href="bayesian-data-analysis-1.html#bayesian-regression"><i class="fa fa-check"></i><b>14.4.3</b> Bayesian regression</a></li>
</ul></li>
<li class="chapter" data-level="14.5" data-path="bayesian-data-analysis-1.html"><a href="bayesian-data-analysis-1.html#additional-resources-9"><i class="fa fa-check"></i><b>14.5</b> Additional resources</a>
<ul>
<li class="chapter" data-level="14.5.1" data-path="bayesian-data-analysis-1.html"><a href="bayesian-data-analysis-1.html#books-and-chapters-1"><i class="fa fa-check"></i><b>14.5.1</b> Books and chapters</a></li>
</ul></li>
<li class="chapter" data-level="14.6" data-path="bayesian-data-analysis-1.html"><a href="bayesian-data-analysis-1.html#session-info-12"><i class="fa fa-check"></i><b>14.6</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html"><i class="fa fa-check"></i><b>15</b> Bayesian data analysis 2</a>
<ul>
<li class="chapter" data-level="15.1" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#learning-goals-10"><i class="fa fa-check"></i><b>15.1</b> Learning goals</a></li>
<li class="chapter" data-level="15.2" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#load-packages-and-set-plotting-theme-13"><i class="fa fa-check"></i><b>15.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="15.3" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#load-data-sets-5"><i class="fa fa-check"></i><b>15.3</b> Load data sets</a></li>
<li class="chapter" data-level="15.4" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#poker"><i class="fa fa-check"></i><b>15.4</b> Poker</a>
<ul>
<li class="chapter" data-level="15.4.1" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#visualize-the-data"><i class="fa fa-check"></i><b>15.4.1</b> 1. Visualize the data</a></li>
<li class="chapter" data-level="15.4.2" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#specify-and-fit-the-model"><i class="fa fa-check"></i><b>15.4.2</b> 2. Specify and fit the model</a></li>
<li class="chapter" data-level="15.4.3" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#model-evaluation"><i class="fa fa-check"></i><b>15.4.3</b> 3. Model evaluation</a></li>
<li class="chapter" data-level="15.4.4" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#interpret-the-model-parameters"><i class="fa fa-check"></i><b>15.4.4</b> 4. Interpret the model parameters</a></li>
<li class="chapter" data-level="15.4.5" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#test-specific-hypotheses"><i class="fa fa-check"></i><b>15.4.5</b> 5. Test specific hypotheses</a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#sleep-study-1"><i class="fa fa-check"></i><b>15.5</b> Sleep study</a>
<ul>
<li class="chapter" data-level="15.5.1" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#visualize-the-data-1"><i class="fa fa-check"></i><b>15.5.1</b> 1. Visualize the data</a></li>
<li class="chapter" data-level="15.5.2" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#specify-and-fit-the-model-1"><i class="fa fa-check"></i><b>15.5.2</b> 2. Specify and fit the model</a></li>
<li class="chapter" data-level="15.5.3" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#model-evaluation-1"><i class="fa fa-check"></i><b>15.5.3</b> 3. Model evaluation</a></li>
<li class="chapter" data-level="15.5.4" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#interpret-the-parameters"><i class="fa fa-check"></i><b>15.5.4</b> 4. Interpret the parameters</a></li>
<li class="chapter" data-level="15.5.5" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#test-specific-hypotheses-1"><i class="fa fa-check"></i><b>15.5.5</b> 5. Test specific hypotheses</a></li>
<li class="chapter" data-level="15.5.6" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#report-results"><i class="fa fa-check"></i><b>15.5.6</b> 6. Report results</a></li>
</ul></li>
<li class="chapter" data-level="15.6" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#titanic-study"><i class="fa fa-check"></i><b>15.6</b> Titanic study</a>
<ul>
<li class="chapter" data-level="15.6.1" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#visualize-the-data-2"><i class="fa fa-check"></i><b>15.6.1</b> 1. Visualize the data</a></li>
<li class="chapter" data-level="15.6.2" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#specify-and-fit-the-model-2"><i class="fa fa-check"></i><b>15.6.2</b> 2. Specify and fit the model</a></li>
<li class="chapter" data-level="15.6.3" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#model-evaluation-2"><i class="fa fa-check"></i><b>15.6.3</b> 3. Model evaluation</a></li>
<li class="chapter" data-level="15.6.4" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#interpret-the-parameters-1"><i class="fa fa-check"></i><b>15.6.4</b> 4. Interpret the parameters</a></li>
<li class="chapter" data-level="15.6.5" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#test-specific-hypotheses-2"><i class="fa fa-check"></i><b>15.6.5</b> 5. Test specific hypotheses</a></li>
<li class="chapter" data-level="15.6.6" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#report-results-1"><i class="fa fa-check"></i><b>15.6.6</b> 6. Report results</a></li>
</ul></li>
<li class="chapter" data-level="15.7" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#politeness-data"><i class="fa fa-check"></i><b>15.7</b> Politeness data</a>
<ul>
<li class="chapter" data-level="15.7.1" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#visualize-the-data-3"><i class="fa fa-check"></i><b>15.7.1</b> 1. Visualize the data</a></li>
<li class="chapter" data-level="15.7.2" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#specify-and-fit-the-model-3"><i class="fa fa-check"></i><b>15.7.2</b> 2. Specify and fit the model</a></li>
<li class="chapter" data-level="15.7.3" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#test-specific-hypotheses-3"><i class="fa fa-check"></i><b>15.7.3</b> 5. Test specific hypotheses</a></li>
</ul></li>
<li class="chapter" data-level="15.8" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#additional-resources-10"><i class="fa fa-check"></i><b>15.8</b> Additional resources</a></li>
<li class="chapter" data-level="15.9" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#session-info-13"><i class="fa fa-check"></i><b>15.9</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html"><i class="fa fa-check"></i><b>16</b> Bayesian data analysis 3</a>
<ul>
<li class="chapter" data-level="16.1" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#learning-goals-11"><i class="fa fa-check"></i><b>16.1</b> Learning goals</a></li>
<li class="chapter" data-level="16.2" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#load-packages-and-set-plotting-theme-14"><i class="fa fa-check"></i><b>16.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="16.3" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#evidence-for-the-null-hypothesis"><i class="fa fa-check"></i><b>16.3</b> Evidence for the null hypothesis</a>
<ul>
<li class="chapter" data-level="16.3.1" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#bayes-factor-1"><i class="fa fa-check"></i><b>16.3.1</b> Bayes factor</a></li>
<li class="chapter" data-level="16.3.2" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#loo"><i class="fa fa-check"></i><b>16.3.2</b> LOO</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#dealing-with-heteroscedasticity"><i class="fa fa-check"></i><b>16.4</b> Dealing with heteroscedasticity</a>
<ul>
<li class="chapter" data-level="16.4.1" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#visualize-the-data-4"><i class="fa fa-check"></i><b>16.4.1</b> Visualize the data</a></li>
<li class="chapter" data-level="16.4.2" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#frequentist-analysis-4"><i class="fa fa-check"></i><b>16.4.2</b> Frequentist analysis</a></li>
<li class="chapter" data-level="16.4.3" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#bayesian-analysis-3"><i class="fa fa-check"></i><b>16.4.3</b> Bayesian analysis</a></li>
</ul></li>
<li class="chapter" data-level="16.5" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#zero-one-inflated-beta-binomial-model"><i class="fa fa-check"></i><b>16.5</b> Zero-one inflated beta binomial model</a></li>
<li class="chapter" data-level="16.6" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#ordinal-regression"><i class="fa fa-check"></i><b>16.6</b> Ordinal regression</a>
<ul>
<li class="chapter" data-level="16.6.1" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#ordinal-regression-assuming-equal-variance"><i class="fa fa-check"></i><b>16.6.1</b> Ordinal regression (assuming equal variance)</a></li>
<li class="chapter" data-level="16.6.2" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#gaussian-regression-assuming-equal-variance"><i class="fa fa-check"></i><b>16.6.2</b> Gaussian regression (assuming equal variance)</a></li>
<li class="chapter" data-level="16.6.3" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#oridnal-regression-unequal-variance"><i class="fa fa-check"></i><b>16.6.3</b> Oridnal regression (unequal variance)</a></li>
<li class="chapter" data-level="16.6.4" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#gaussian-regression-unequal-variance"><i class="fa fa-check"></i><b>16.6.4</b> Gaussian regression (unequal variance)</a></li>
<li class="chapter" data-level="16.6.5" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#model-comparison-2"><i class="fa fa-check"></i><b>16.6.5</b> Model comparison</a></li>
</ul></li>
<li class="chapter" data-level="16.7" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#additional-resources-11"><i class="fa fa-check"></i><b>16.7</b> Additional resources</a></li>
<li class="chapter" data-level="16.8" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#session-info-14"><i class="fa fa-check"></i><b>16.8</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="model-assumptions.html"><a href="model-assumptions.html"><i class="fa fa-check"></i><b>17</b> Model assumptions</a>
<ul>
<li class="chapter" data-level="17.1" data-path="model-assumptions.html"><a href="model-assumptions.html#learning-goals-12"><i class="fa fa-check"></i><b>17.1</b> Learning goals</a></li>
<li class="chapter" data-level="17.2" data-path="model-assumptions.html"><a href="model-assumptions.html#load-packages-and-set-plotting-theme-15"><i class="fa fa-check"></i><b>17.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="17.3" data-path="model-assumptions.html"><a href="model-assumptions.html#model-assumptions-and-what-to-do-if-they-are-violated"><i class="fa fa-check"></i><b>17.3</b> Model assumptions and what to do if they are violated</a>
<ul>
<li class="chapter" data-level="17.3.1" data-path="model-assumptions.html"><a href="model-assumptions.html#influential-data-points"><i class="fa fa-check"></i><b>17.3.1</b> Influential data points</a></li>
<li class="chapter" data-level="17.3.2" data-path="model-assumptions.html"><a href="model-assumptions.html#linear-and-additive"><i class="fa fa-check"></i><b>17.3.2</b> Linear and additive</a></li>
<li class="chapter" data-level="17.3.3" data-path="model-assumptions.html"><a href="model-assumptions.html#normally-distributed-residuals"><i class="fa fa-check"></i><b>17.3.3</b> Normally distributed residuals</a></li>
<li class="chapter" data-level="17.3.4" data-path="model-assumptions.html"><a href="model-assumptions.html#non-parametric-tests"><i class="fa fa-check"></i><b>17.3.4</b> Non-parametric tests</a></li>
<li class="chapter" data-level="17.3.5" data-path="model-assumptions.html"><a href="model-assumptions.html#bootstrapping-regressions"><i class="fa fa-check"></i><b>17.3.5</b> Bootstrapping regressions</a></li>
</ul></li>
<li class="chapter" data-level="17.4" data-path="model-assumptions.html"><a href="model-assumptions.html#additional-resources-12"><i class="fa fa-check"></i><b>17.4</b> Additional resources</a></li>
<li class="chapter" data-level="17.5" data-path="model-assumptions.html"><a href="model-assumptions.html#session-info-15"><i class="fa fa-check"></i><b>17.5</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="reporting-statistics.html"><a href="reporting-statistics.html"><i class="fa fa-check"></i><b>18</b> Reporting statistics</a>
<ul>
<li class="chapter" data-level="18.1" data-path="reporting-statistics.html"><a href="reporting-statistics.html#general-advice"><i class="fa fa-check"></i><b>18.1</b> General advice</a>
<ul>
<li class="chapter" data-level="18.1.1" data-path="reporting-statistics.html"><a href="reporting-statistics.html#make-good-figures"><i class="fa fa-check"></i><b>18.1.1</b> Make good figures!</a></li>
<li class="chapter" data-level="18.1.2" data-path="reporting-statistics.html"><a href="reporting-statistics.html#use-statistical-models-to-answer-concrete-research-questions."><i class="fa fa-check"></i><b>18.1.2</b> Use statistical models to answer concrete research questions.</a></li>
<li class="chapter" data-level="18.1.3" data-path="reporting-statistics.html"><a href="reporting-statistics.html#illustrate-the-uncertainty-in-your-statistical-inferences."><i class="fa fa-check"></i><b>18.1.3</b> Illustrate the uncertainty in your statistical inferences.</a></li>
<li class="chapter" data-level="18.1.4" data-path="reporting-statistics.html"><a href="reporting-statistics.html#report-effect-sizes."><i class="fa fa-check"></i><b>18.1.4</b> Report effect sizes.</a></li>
<li class="chapter" data-level="18.1.5" data-path="reporting-statistics.html"><a href="reporting-statistics.html#reporting-statistical-results-using-rmarkdown"><i class="fa fa-check"></i><b>18.1.5</b> Reporting statistical results using RMarkdown</a></li>
</ul></li>
<li class="chapter" data-level="18.2" data-path="reporting-statistics.html"><a href="reporting-statistics.html#some-concrete-example"><i class="fa fa-check"></i><b>18.2</b> Some concrete example</a>
<ul>
<li class="chapter" data-level="18.2.1" data-path="reporting-statistics.html"><a href="reporting-statistics.html#frequentist-statistics"><i class="fa fa-check"></i><b>18.2.1</b> Frequentist statistics</a></li>
</ul></li>
<li class="chapter" data-level="18.3" data-path="reporting-statistics.html"><a href="reporting-statistics.html#additional-resources-13"><i class="fa fa-check"></i><b>18.3</b> Additional resources</a>
<ul>
<li class="chapter" data-level="18.3.1" data-path="reporting-statistics.html"><a href="reporting-statistics.html#misc-6"><i class="fa fa-check"></i><b>18.3.1</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="18.4" data-path="reporting-statistics.html"><a href="reporting-statistics.html#session-info-16"><i class="fa fa-check"></i><b>18.4</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="cheatsheets-2.html"><a href="cheatsheets-2.html"><i class="fa fa-check"></i><b>19</b> Cheatsheets</a>
<ul>
<li class="chapter" data-level="19.1" data-path="cheatsheets-2.html"><a href="cheatsheets-2.html#statistics"><i class="fa fa-check"></i><b>19.1</b> Statistics</a></li>
<li class="chapter" data-level="19.2" data-path="cheatsheets-2.html"><a href="cheatsheets-2.html#r"><i class="fa fa-check"></i><b>19.2</b> R</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references-1.html"><a href="references-1.html"><i class="fa fa-check"></i>References</a></li>
<li class="chapter" data-level="20" data-path="visualization-1-1.html"><a href="visualization-1-1.html"><i class="fa fa-check"></i><b>20</b> Visualization 1</a>
<ul>
<li class="chapter" data-level="20.1" data-path="visualization-1-1.html"><a href="visualization-1-1.html#learning-goals-13"><i class="fa fa-check"></i><b>20.1</b> Learning goals</a></li>
<li class="chapter" data-level="20.2" data-path="visualization-1-1.html"><a href="visualization-1-1.html#load-packages"><i class="fa fa-check"></i><b>20.2</b> Load packages</a></li>
<li class="chapter" data-level="20.3" data-path="visualization-1-1.html"><a href="visualization-1-1.html#why-visualize-data"><i class="fa fa-check"></i><b>20.3</b> Why visualize data?</a></li>
<li class="chapter" data-level="20.4" data-path="visualization-1-1.html"><a href="visualization-1-1.html#some-basics"><i class="fa fa-check"></i><b>20.4</b> Some basics</a>
<ul>
<li class="chapter" data-level="20.4.1" data-path="visualization-1-1.html"><a href="visualization-1-1.html#setting-up-rstudio"><i class="fa fa-check"></i><b>20.4.1</b> Setting up RStudio</a></li>
<li class="chapter" data-level="20.4.2" data-path="visualization-1-1.html"><a href="visualization-1-1.html#getting-help"><i class="fa fa-check"></i><b>20.4.2</b> Getting help</a></li>
<li class="chapter" data-level="20.4.3" data-path="visualization-1-1.html"><a href="visualization-1-1.html#r-markdown-infos"><i class="fa fa-check"></i><b>20.4.3</b> R Markdown infos</a></li>
<li class="chapter" data-level="20.4.4" data-path="visualization-1-1.html"><a href="visualization-1-1.html#helpful-keyboard-shortcuts"><i class="fa fa-check"></i><b>20.4.4</b> Helpful keyboard shortcuts</a></li>
</ul></li>
<li class="chapter" data-level="20.5" data-path="visualization-1-1.html"><a href="visualization-1-1.html#data-visualization"><i class="fa fa-check"></i><b>20.5</b> Data visualization</a>
<ul>
<li class="chapter" data-level="20.5.1" data-path="visualization-1-1.html"><a href="visualization-1-1.html#setting-up-a-plot"><i class="fa fa-check"></i><b>20.5.1</b> Setting up a plot</a></li>
<li class="chapter" data-level="20.5.2" data-path="visualization-1-1.html"><a href="visualization-1-1.html#bar-plot"><i class="fa fa-check"></i><b>20.5.2</b> Bar plot</a></li>
<li class="chapter" data-level="20.5.3" data-path="visualization-1-1.html"><a href="visualization-1-1.html#setting-the-default-plot-theme"><i class="fa fa-check"></i><b>20.5.3</b> Setting the default plot theme</a></li>
<li class="chapter" data-level="20.5.4" data-path="visualization-1-1.html"><a href="visualization-1-1.html#scatter-plot"><i class="fa fa-check"></i><b>20.5.4</b> Scatter plot</a></li>
<li class="chapter" data-level="20.5.5" data-path="visualization-1-1.html"><a href="visualization-1-1.html#line-plot"><i class="fa fa-check"></i><b>20.5.5</b> Line plot</a></li>
<li class="chapter" data-level="20.5.6" data-path="visualization-1-1.html"><a href="visualization-1-1.html#adding-error-bars"><i class="fa fa-check"></i><b>20.5.6</b> Adding error bars</a></li>
<li class="chapter" data-level="20.5.7" data-path="visualization-1-1.html"><a href="visualization-1-1.html#order-matters"><i class="fa fa-check"></i><b>20.5.7</b> Order matters</a></li>
<li class="chapter" data-level="20.5.8" data-path="visualization-1-1.html"><a href="visualization-1-1.html#grouping-data"><i class="fa fa-check"></i><b>20.5.8</b> Grouping data</a></li>
<li class="chapter" data-level="20.5.9" data-path="visualization-1-1.html"><a href="visualization-1-1.html#making-facets"><i class="fa fa-check"></i><b>20.5.9</b> Making facets</a></li>
<li class="chapter" data-level="20.5.10" data-path="visualization-1-1.html"><a href="visualization-1-1.html#global-local-and-setting-aes"><i class="fa fa-check"></i><b>20.5.10</b> Global, local, and setting <code>aes()</code></a></li>
</ul></li>
<li class="chapter" data-level="20.6" data-path="visualization-1-1.html"><a href="visualization-1-1.html#additional-resources-14"><i class="fa fa-check"></i><b>20.6</b> Additional resources</a>
<ul>
<li class="chapter" data-level="20.6.1" data-path="visualization-1-1.html"><a href="visualization-1-1.html#cheatsheets-3"><i class="fa fa-check"></i><b>20.6.1</b> Cheatsheets</a></li>
<li class="chapter" data-level="20.6.2" data-path="visualization-1-1.html"><a href="visualization-1-1.html#datacamp-courses"><i class="fa fa-check"></i><b>20.6.2</b> Datacamp courses</a></li>
<li class="chapter" data-level="20.6.3" data-path="visualization-1-1.html"><a href="visualization-1-1.html#books-and-chapters-2"><i class="fa fa-check"></i><b>20.6.3</b> Books and chapters</a></li>
<li class="chapter" data-level="20.6.4" data-path="visualization-1-1.html"><a href="visualization-1-1.html#misc-7"><i class="fa fa-check"></i><b>20.6.4</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="20.7" data-path="visualization-1-1.html"><a href="visualization-1-1.html#session-info-17"><i class="fa fa-check"></i><b>20.7</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="visualization-2-1.html"><a href="visualization-2-1.html"><i class="fa fa-check"></i><b>21</b> Visualization 2</a>
<ul>
<li class="chapter" data-level="21.1" data-path="visualization-2-1.html"><a href="visualization-2-1.html#learning-objectives"><i class="fa fa-check"></i><b>21.1</b> Learning objectives</a></li>
<li class="chapter" data-level="21.2" data-path="visualization-2-1.html"><a href="visualization-2-1.html#install-and-load-packages-load-data-set-theme"><i class="fa fa-check"></i><b>21.2</b> Install and load packages, load data, set theme</a></li>
<li class="chapter" data-level="21.3" data-path="visualization-2-1.html"><a href="visualization-2-1.html#overview-of-different-plot-types-for-different-things"><i class="fa fa-check"></i><b>21.3</b> Overview of different plot types for different things</a>
<ul>
<li class="chapter" data-level="21.3.1" data-path="visualization-2-1.html"><a href="visualization-2-1.html#proportions"><i class="fa fa-check"></i><b>21.3.1</b> Proportions</a></li>
<li class="chapter" data-level="21.3.2" data-path="visualization-2-1.html"><a href="visualization-2-1.html#comparisons"><i class="fa fa-check"></i><b>21.3.2</b> Comparisons</a></li>
<li class="chapter" data-level="21.3.3" data-path="visualization-2-1.html"><a href="visualization-2-1.html#relationships"><i class="fa fa-check"></i><b>21.3.3</b> Relationships</a></li>
<li class="chapter" data-level="21.3.4" data-path="visualization-2-1.html"><a href="visualization-2-1.html#temporal-data"><i class="fa fa-check"></i><b>21.3.4</b> Temporal data</a></li>
</ul></li>
<li class="chapter" data-level="21.4" data-path="visualization-2-1.html"><a href="visualization-2-1.html#customizing-plots"><i class="fa fa-check"></i><b>21.4</b> Customizing plots</a>
<ul>
<li class="chapter" data-level="21.4.1" data-path="visualization-2-1.html"><a href="visualization-2-1.html#anatomy-of-a-ggplot"><i class="fa fa-check"></i><b>21.4.1</b> Anatomy of a <code>ggplot</code></a></li>
<li class="chapter" data-level="21.4.2" data-path="visualization-2-1.html"><a href="visualization-2-1.html#changing-the-order-of-things"><i class="fa fa-check"></i><b>21.4.2</b> Changing the order of things</a></li>
<li class="chapter" data-level="21.4.3" data-path="visualization-2-1.html"><a href="visualization-2-1.html#dealing-with-legends"><i class="fa fa-check"></i><b>21.4.3</b> Dealing with legends</a></li>
<li class="chapter" data-level="21.4.4" data-path="visualization-2-1.html"><a href="visualization-2-1.html#choosing-good-colors"><i class="fa fa-check"></i><b>21.4.4</b> Choosing good colors</a></li>
<li class="chapter" data-level="21.4.5" data-path="visualization-2-1.html"><a href="visualization-2-1.html#customizing-themes"><i class="fa fa-check"></i><b>21.4.5</b> Customizing themes</a></li>
</ul></li>
<li class="chapter" data-level="21.5" data-path="visualization-2-1.html"><a href="visualization-2-1.html#saving-plots"><i class="fa fa-check"></i><b>21.5</b> Saving plots</a></li>
<li class="chapter" data-level="21.6" data-path="visualization-2-1.html"><a href="visualization-2-1.html#creating-figure-panels"><i class="fa fa-check"></i><b>21.6</b> Creating figure panels</a></li>
<li class="chapter" data-level="21.7" data-path="visualization-2-1.html"><a href="visualization-2-1.html#peeking-behind-the-scenes"><i class="fa fa-check"></i><b>21.7</b> Peeking behind the scenes</a></li>
<li class="chapter" data-level="21.8" data-path="visualization-2-1.html"><a href="visualization-2-1.html#making-animations"><i class="fa fa-check"></i><b>21.8</b> Making animations</a></li>
<li class="chapter" data-level="21.9" data-path="visualization-2-1.html"><a href="visualization-2-1.html#shiny-apps"><i class="fa fa-check"></i><b>21.9</b> Shiny apps</a></li>
<li class="chapter" data-level="21.10" data-path="visualization-2-1.html"><a href="visualization-2-1.html#defining-snippets"><i class="fa fa-check"></i><b>21.10</b> Defining snippets</a></li>
<li class="chapter" data-level="21.11" data-path="visualization-2-1.html"><a href="visualization-2-1.html#additional-resources-15"><i class="fa fa-check"></i><b>21.11</b> Additional resources</a>
<ul>
<li class="chapter" data-level="21.11.1" data-path="visualization-2-1.html"><a href="visualization-2-1.html#cheatsheets-4"><i class="fa fa-check"></i><b>21.11.1</b> Cheatsheets</a></li>
<li class="chapter" data-level="21.11.2" data-path="visualization-2-1.html"><a href="visualization-2-1.html#data-camp-courses"><i class="fa fa-check"></i><b>21.11.2</b> Data camp courses</a></li>
<li class="chapter" data-level="21.11.3" data-path="visualization-2-1.html"><a href="visualization-2-1.html#books-and-chapters-3"><i class="fa fa-check"></i><b>21.11.3</b> Books and chapters</a></li>
<li class="chapter" data-level="21.11.4" data-path="visualization-2-1.html"><a href="visualization-2-1.html#misc-8"><i class="fa fa-check"></i><b>21.11.4</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="21.12" data-path="visualization-2-1.html"><a href="visualization-2-1.html#session-info-18"><i class="fa fa-check"></i><b>21.12</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html"><i class="fa fa-check"></i><b>22</b> Data wrangling 1</a>
<ul>
<li class="chapter" data-level="22.1" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#learning-goals-14"><i class="fa fa-check"></i><b>22.1</b> Learning goals</a></li>
<li class="chapter" data-level="22.2" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#load-packages-1"><i class="fa fa-check"></i><b>22.2</b> Load packages</a></li>
<li class="chapter" data-level="22.3" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#some-r-basics"><i class="fa fa-check"></i><b>22.3</b> Some R basics</a>
<ul>
<li class="chapter" data-level="22.3.1" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#modes"><i class="fa fa-check"></i><b>22.3.1</b> Modes</a></li>
<li class="chapter" data-level="22.3.2" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#data-types"><i class="fa fa-check"></i><b>22.3.2</b> Data types</a></li>
<li class="chapter" data-level="22.3.3" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#operators"><i class="fa fa-check"></i><b>22.3.3</b> Operators</a></li>
<li class="chapter" data-level="22.3.4" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#control-flow"><i class="fa fa-check"></i><b>22.3.4</b> Control flow</a></li>
<li class="chapter" data-level="22.3.5" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#functions"><i class="fa fa-check"></i><b>22.3.5</b> Functions</a></li>
<li class="chapter" data-level="22.3.6" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#the-pipe-operator"><i class="fa fa-check"></i><b>22.3.6</b> The pipe operator <code>%&gt;%</code></a></li>
</ul></li>
<li class="chapter" data-level="22.4" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#a-quick-note-on-naming-things"><i class="fa fa-check"></i><b>22.4</b> A quick note on naming things</a></li>
<li class="chapter" data-level="22.5" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#looking-at-data"><i class="fa fa-check"></i><b>22.5</b> Looking at data</a>
<ul>
<li class="chapter" data-level="22.5.1" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#head"><i class="fa fa-check"></i><b>22.5.1</b> <code>head()</code></a></li>
<li class="chapter" data-level="22.5.2" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#glimpse"><i class="fa fa-check"></i><b>22.5.2</b> <code>glimpse()</code></a></li>
<li class="chapter" data-level="22.5.3" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#distinct"><i class="fa fa-check"></i><b>22.5.3</b> <code>distinct()</code></a></li>
<li class="chapter" data-level="22.5.4" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#count"><i class="fa fa-check"></i><b>22.5.4</b> <code>count()</code></a></li>
<li class="chapter" data-level="22.5.5" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#datatable"><i class="fa fa-check"></i><b>22.5.5</b> <code>datatable()</code></a></li>
<li class="chapter" data-level="22.5.6" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#other-tools-for-taking-a-quick-look-at-data"><i class="fa fa-check"></i><b>22.5.6</b> Other tools for taking a quick look at data</a></li>
</ul></li>
<li class="chapter" data-level="22.6" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#wrangling-data"><i class="fa fa-check"></i><b>22.6</b> Wrangling data</a>
<ul>
<li class="chapter" data-level="22.6.1" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#filter"><i class="fa fa-check"></i><b>22.6.1</b> <code>filter()</code></a></li>
<li class="chapter" data-level="22.6.2" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#arrange"><i class="fa fa-check"></i><b>22.6.2</b> <code>arrange()</code></a></li>
<li class="chapter" data-level="22.6.3" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#rename"><i class="fa fa-check"></i><b>22.6.3</b> <code>rename()</code></a></li>
<li class="chapter" data-level="22.6.4" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#relocate"><i class="fa fa-check"></i><b>22.6.4</b> <code>relocate()</code></a></li>
<li class="chapter" data-level="22.6.5" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#select"><i class="fa fa-check"></i><b>22.6.5</b> <code>select()</code></a></li>
<li class="chapter" data-level="22.6.6" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#practice-2"><i class="fa fa-check"></i><b>22.6.6</b> Practice 2</a></li>
<li class="chapter" data-level="22.6.7" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#mutate"><i class="fa fa-check"></i><b>22.6.7</b> <code>mutate()</code></a></li>
<li class="chapter" data-level="22.6.8" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#practice-3"><i class="fa fa-check"></i><b>22.6.8</b> Practice 3</a></li>
</ul></li>
<li class="chapter" data-level="22.7" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#additional-resources-16"><i class="fa fa-check"></i><b>22.7</b> Additional resources</a>
<ul>
<li class="chapter" data-level="22.7.1" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#cheatsheets-5"><i class="fa fa-check"></i><b>22.7.1</b> Cheatsheets</a></li>
<li class="chapter" data-level="22.7.2" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#data-camp-courses-1"><i class="fa fa-check"></i><b>22.7.2</b> Data camp courses</a></li>
<li class="chapter" data-level="22.7.3" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#books-and-chapters-4"><i class="fa fa-check"></i><b>22.7.3</b> Books and chapters</a></li>
</ul></li>
<li class="chapter" data-level="22.8" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#session-info-19"><i class="fa fa-check"></i><b>22.8</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html"><i class="fa fa-check"></i><b>23</b> Data wrangling 2</a>
<ul>
<li class="chapter" data-level="23.1" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#learning-goals-15"><i class="fa fa-check"></i><b>23.1</b> Learning goals</a></li>
<li class="chapter" data-level="23.2" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#load-packages-2"><i class="fa fa-check"></i><b>23.2</b> Load packages</a></li>
<li class="chapter" data-level="23.3" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#settings"><i class="fa fa-check"></i><b>23.3</b> Settings</a></li>
<li class="chapter" data-level="23.4" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#wrangling-data-continued"><i class="fa fa-check"></i><b>23.4</b> Wrangling data (continued)</a>
<ul>
<li class="chapter" data-level="23.4.1" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#summarizing-data"><i class="fa fa-check"></i><b>23.4.1</b> Summarizing data</a></li>
<li class="chapter" data-level="23.4.2" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#reshaping-data"><i class="fa fa-check"></i><b>23.4.2</b> Reshaping data</a></li>
<li class="chapter" data-level="23.4.3" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#joining-multiple-data-frames"><i class="fa fa-check"></i><b>23.4.3</b> Joining multiple data frames</a></li>
<li class="chapter" data-level="23.4.4" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#dealing-with-missing-data"><i class="fa fa-check"></i><b>23.4.4</b> Dealing with missing data</a></li>
</ul></li>
<li class="chapter" data-level="23.5" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#reading-in-data"><i class="fa fa-check"></i><b>23.5</b> Reading in data</a>
<ul>
<li class="chapter" data-level="23.5.1" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#csv"><i class="fa fa-check"></i><b>23.5.1</b> csv</a></li>
<li class="chapter" data-level="23.5.2" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#rdata"><i class="fa fa-check"></i><b>23.5.2</b> RData</a></li>
</ul></li>
<li class="chapter" data-level="23.6" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#saving-data"><i class="fa fa-check"></i><b>23.6</b> Saving data</a>
<ul>
<li class="chapter" data-level="23.6.1" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#csv-1"><i class="fa fa-check"></i><b>23.6.1</b> csv</a></li>
<li class="chapter" data-level="23.6.2" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#rdata-1"><i class="fa fa-check"></i><b>23.6.2</b> RData</a></li>
</ul></li>
<li class="chapter" data-level="23.7" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#additional-resources-17"><i class="fa fa-check"></i><b>23.7</b> Additional resources</a>
<ul>
<li class="chapter" data-level="23.7.1" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#cheatsheets-6"><i class="fa fa-check"></i><b>23.7.1</b> Cheatsheets</a></li>
<li class="chapter" data-level="23.7.2" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#data-camp-courses-2"><i class="fa fa-check"></i><b>23.7.2</b> Data camp courses</a></li>
<li class="chapter" data-level="23.7.3" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#books-and-chapters-5"><i class="fa fa-check"></i><b>23.7.3</b> Books and chapters</a></li>
<li class="chapter" data-level="23.7.4" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#tutorials"><i class="fa fa-check"></i><b>23.7.4</b> Tutorials</a></li>
</ul></li>
<li class="chapter" data-level="23.8" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#session-info-20"><i class="fa fa-check"></i><b>23.8</b> Session info</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Psych 710: Statistical Methods II</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="generalized-linear-model" class="section level1 hasAnchor" number="13">
<h1><span class="header-section-number">Chapter 13</span> Generalized linear model<a href="generalized-linear-model.html#generalized-linear-model" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="learning-goals-8" class="section level2 hasAnchor" number="13.1">
<h2><span class="header-section-number">13.1</span> Learning goals<a href="generalized-linear-model.html#learning-goals-8" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>Logistic regression.</li>
<li>Logit transform.</li>
<li>Fitting a logistic regression in R.</li>
<li>Visualizing and interpreting model predictions.</li>
<li>Simulating data from a logistic regression.</li>
<li>Assessing model fit.</li>
<li>Testing hypotheses.</li>
<li>Reporting results.</li>
<li>Mixed effects logistic regression.</li>
</ul>
</div>
<div id="load-packages-and-set-plotting-theme-11" class="section level2 hasAnchor" number="13.2">
<h2><span class="header-section-number">13.2</span> Load packages and set plotting theme<a href="generalized-linear-model.html#load-packages-and-set-plotting-theme-11" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb690"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb690-1"><a href="generalized-linear-model.html#cb690-1" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;knitr&quot;</span>)      <span class="co"># for knitting RMarkdown </span></span>
<span id="cb690-2"><a href="generalized-linear-model.html#cb690-2" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;titanic&quot;</span>)    <span class="co"># titanic dataset</span></span>
<span id="cb690-3"><a href="generalized-linear-model.html#cb690-3" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;kableExtra&quot;</span>) <span class="co"># for making nice tables</span></span>
<span id="cb690-4"><a href="generalized-linear-model.html#cb690-4" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;janitor&quot;</span>)    <span class="co"># for cleaning column names</span></span>
<span id="cb690-5"><a href="generalized-linear-model.html#cb690-5" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;broom&quot;</span>)      <span class="co"># for tidying up linear models </span></span>
<span id="cb690-6"><a href="generalized-linear-model.html#cb690-6" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;lme4&quot;</span>)       <span class="co"># for linear mixed effects models</span></span></code></pre></div>
<pre><code>## Warning: package &#39;lme4&#39; was built under R version 4.3.1</code></pre>
<pre><code>## Warning: package &#39;Matrix&#39; was built under R version 4.3.1</code></pre>
<div class="sourceCode" id="cb693"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb693-1"><a href="generalized-linear-model.html#cb693-1" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;boot&quot;</span>)       <span class="co"># for bootstrapping (also has an inverse logit function)</span></span>
<span id="cb693-2"><a href="generalized-linear-model.html#cb693-2" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;ggeffects&quot;</span>)  <span class="co"># for showing effects in linear, generalized linear, and other models</span></span></code></pre></div>
<pre><code>## Warning: package &#39;ggeffects&#39; was built under R version 4.3.1</code></pre>
<div class="sourceCode" id="cb695"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb695-1"><a href="generalized-linear-model.html#cb695-1" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;afex&quot;</span>)       <span class="co"># for significance testing of mixed effects models </span></span>
<span id="cb695-2"><a href="generalized-linear-model.html#cb695-2" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;emmeans&quot;</span>)    <span class="co"># for the joint_tests() function</span></span></code></pre></div>
<pre><code>## Warning: package &#39;emmeans&#39; was built under R version 4.3.1</code></pre>
<div class="sourceCode" id="cb697"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb697-1"><a href="generalized-linear-model.html#cb697-1" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;tidyverse&quot;</span>)  <span class="co"># for wrangling, plotting, etc. </span></span></code></pre></div>
<pre><code>## Warning: package &#39;ggplot2&#39; was built under R version 4.3.1</code></pre>
<pre><code>## Warning: package &#39;dplyr&#39; was built under R version 4.3.1</code></pre>
<div class="sourceCode" id="cb700"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb700-1"><a href="generalized-linear-model.html#cb700-1" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_classic</span>() <span class="sc">+</span> <span class="co">#set the theme </span></span>
<span id="cb700-2"><a href="generalized-linear-model.html#cb700-2" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>))) <span class="co">#set the default text size</span></span>
<span id="cb700-3"><a href="generalized-linear-model.html#cb700-3" tabindex="-1"></a></span>
<span id="cb700-4"><a href="generalized-linear-model.html#cb700-4" tabindex="-1"></a>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">comment =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb700-5"><a href="generalized-linear-model.html#cb700-5" tabindex="-1"></a>               <span class="at">fig.show =</span> <span class="st">&quot;hold&quot;</span>)</span></code></pre></div>
</div>
<div id="load-data-set" class="section level2 hasAnchor" number="13.3">
<h2><span class="header-section-number">13.3</span> Load data set<a href="generalized-linear-model.html#load-data-set" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb701"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb701-1"><a href="generalized-linear-model.html#cb701-1" tabindex="-1"></a>df.titanic <span class="ot">=</span> titanic_train <span class="sc">%&gt;%</span> </span>
<span id="cb701-2"><a href="generalized-linear-model.html#cb701-2" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb701-3"><a href="generalized-linear-model.html#cb701-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sex =</span> <span class="fu">as.factor</span>(sex))</span></code></pre></div>
<p>Let’s take a quick look at the data:</p>
<div class="sourceCode" id="cb702"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb702-1"><a href="generalized-linear-model.html#cb702-1" tabindex="-1"></a>df.titanic <span class="sc">%&gt;%</span> </span>
<span id="cb702-2"><a href="generalized-linear-model.html#cb702-2" tabindex="-1"></a>  <span class="fu">glimpse</span>()</span></code></pre></div>
<pre><code>Rows: 891
Columns: 12
$ passenger_id &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17…
$ survived     &lt;int&gt; 0, 1, 1, 1, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 1, 0, 1, 0, …
$ pclass       &lt;int&gt; 3, 1, 3, 1, 3, 3, 1, 3, 3, 2, 3, 1, 3, 3, 3, 2, 3, 2, 3, …
$ name         &lt;chr&gt; &quot;Braund, Mr. Owen Harris&quot;, &quot;Cumings, Mrs. John Bradley (F…
$ sex          &lt;fct&gt; male, female, female, female, male, male, male, male, fem…
$ age          &lt;dbl&gt; 22, 38, 26, 35, 35, NA, 54, 2, 27, 14, 4, 58, 20, 39, 14,…
$ sib_sp       &lt;int&gt; 1, 1, 0, 1, 0, 0, 0, 3, 0, 1, 1, 0, 0, 1, 0, 0, 4, 0, 1, …
$ parch        &lt;int&gt; 0, 0, 0, 0, 0, 0, 0, 1, 2, 0, 1, 0, 0, 5, 0, 0, 1, 0, 0, …
$ ticket       &lt;chr&gt; &quot;A/5 21171&quot;, &quot;PC 17599&quot;, &quot;STON/O2. 3101282&quot;, &quot;113803&quot;, &quot;3…
$ fare         &lt;dbl&gt; 7.2500, 71.2833, 7.9250, 53.1000, 8.0500, 8.4583, 51.8625…
$ cabin        &lt;chr&gt; &quot;&quot;, &quot;C85&quot;, &quot;&quot;, &quot;C123&quot;, &quot;&quot;, &quot;&quot;, &quot;E46&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;G6&quot;, &quot;…
$ embarked     &lt;chr&gt; &quot;S&quot;, &quot;C&quot;, &quot;S&quot;, &quot;S&quot;, &quot;S&quot;, &quot;Q&quot;, &quot;S&quot;, &quot;S&quot;, &quot;S&quot;, &quot;C&quot;, &quot;S&quot;, &quot;S…</code></pre>
<div class="sourceCode" id="cb704"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb704-1"><a href="generalized-linear-model.html#cb704-1" tabindex="-1"></a><span class="co"># Table of the first 10 entries</span></span>
<span id="cb704-2"><a href="generalized-linear-model.html#cb704-2" tabindex="-1"></a>df.titanic <span class="sc">%&gt;%</span> </span>
<span id="cb704-3"><a href="generalized-linear-model.html#cb704-3" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">10</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb704-4"><a href="generalized-linear-model.html#cb704-4" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">digits =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb704-5"><a href="generalized-linear-model.html#cb704-5" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="st">&quot;striped&quot;</span>,</span>
<span id="cb704-6"><a href="generalized-linear-model.html#cb704-6" tabindex="-1"></a>                <span class="at">full_width =</span> F)</span></code></pre></div>
<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
passenger_id
</th>
<th style="text-align:right;">
survived
</th>
<th style="text-align:right;">
pclass
</th>
<th style="text-align:left;">
name
</th>
<th style="text-align:left;">
sex
</th>
<th style="text-align:right;">
age
</th>
<th style="text-align:right;">
sib_sp
</th>
<th style="text-align:right;">
parch
</th>
<th style="text-align:left;">
ticket
</th>
<th style="text-align:right;">
fare
</th>
<th style="text-align:left;">
cabin
</th>
<th style="text-align:left;">
embarked
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
Braund, Mr. Owen Harris
</td>
<td style="text-align:left;">
male
</td>
<td style="text-align:right;">
22
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
A/5 21171
</td>
<td style="text-align:right;">
7.25
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
S
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
Cumings, Mrs. John Bradley (Florence Briggs Thayer)
</td>
<td style="text-align:left;">
female
</td>
<td style="text-align:right;">
38
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
PC 17599
</td>
<td style="text-align:right;">
71.28
</td>
<td style="text-align:left;">
C85
</td>
<td style="text-align:left;">
C
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
Heikkinen, Miss. Laina
</td>
<td style="text-align:left;">
female
</td>
<td style="text-align:right;">
26
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
STON/O2. 3101282
</td>
<td style="text-align:right;">
7.92
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
S
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
Futrelle, Mrs. Jacques Heath (Lily May Peel)
</td>
<td style="text-align:left;">
female
</td>
<td style="text-align:right;">
35
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
113803
</td>
<td style="text-align:right;">
53.10
</td>
<td style="text-align:left;">
C123
</td>
<td style="text-align:left;">
S
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
Allen, Mr. William Henry
</td>
<td style="text-align:left;">
male
</td>
<td style="text-align:right;">
35
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
373450
</td>
<td style="text-align:right;">
8.05
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
S
</td>
</tr>
<tr>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
Moran, Mr. James
</td>
<td style="text-align:left;">
male
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
330877
</td>
<td style="text-align:right;">
8.46
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
Q
</td>
</tr>
<tr>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
McCarthy, Mr. Timothy J
</td>
<td style="text-align:left;">
male
</td>
<td style="text-align:right;">
54
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
17463
</td>
<td style="text-align:right;">
51.86
</td>
<td style="text-align:left;">
E46
</td>
<td style="text-align:left;">
S
</td>
</tr>
<tr>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
Palsson, Master. Gosta Leonard
</td>
<td style="text-align:left;">
male
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
349909
</td>
<td style="text-align:right;">
21.08
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
S
</td>
</tr>
<tr>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
Johnson, Mrs. Oscar W (Elisabeth Vilhelmina Berg)
</td>
<td style="text-align:left;">
female
</td>
<td style="text-align:right;">
27
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
347742
</td>
<td style="text-align:right;">
11.13
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
S
</td>
</tr>
<tr>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Nasser, Mrs. Nicholas (Adele Achem)
</td>
<td style="text-align:left;">
female
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
237736
</td>
<td style="text-align:right;">
30.07
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
C
</td>
</tr>
</tbody>
</table>
</div>
<div id="logistic-regression" class="section level2 hasAnchor" number="13.4">
<h2><span class="header-section-number">13.4</span> Logistic regression<a href="generalized-linear-model.html#logistic-regression" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Let’s see if we can predict whether or not a passenger survived based on the price of their ticket.</p>
<p>Let’s run a simple regression first:</p>
<div class="sourceCode" id="cb705"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb705-1"><a href="generalized-linear-model.html#cb705-1" tabindex="-1"></a><span class="co"># fit a linear model </span></span>
<span id="cb705-2"><a href="generalized-linear-model.html#cb705-2" tabindex="-1"></a>fit.lm <span class="ot">=</span> <span class="fu">lm</span>(<span class="at">formula =</span> survived <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> fare,</span>
<span id="cb705-3"><a href="generalized-linear-model.html#cb705-3" tabindex="-1"></a>            <span class="at">data =</span> df.titanic)</span>
<span id="cb705-4"><a href="generalized-linear-model.html#cb705-4" tabindex="-1"></a></span>
<span id="cb705-5"><a href="generalized-linear-model.html#cb705-5" tabindex="-1"></a><span class="co"># summarize the results</span></span>
<span id="cb705-6"><a href="generalized-linear-model.html#cb705-6" tabindex="-1"></a>fit.lm <span class="sc">%&gt;%</span> </span>
<span id="cb705-7"><a href="generalized-linear-model.html#cb705-7" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code></pre></div>
<pre><code>
Call:
lm(formula = survived ~ 1 + fare, data = df.titanic)

Residuals:
    Min      1Q  Median      3Q     Max 
-0.9653 -0.3391 -0.3222  0.6044  0.6973 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 0.3026994  0.0187849  16.114  &lt; 2e-16 ***
fare        0.0025195  0.0003174   7.939 6.12e-15 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 0.4705 on 889 degrees of freedom
Multiple R-squared:  0.06621,   Adjusted R-squared:  0.06516 
F-statistic: 63.03 on 1 and 889 DF,  p-value: 6.12e-15</code></pre>
<p>Look’s like <code>fare</code> is a significant predictor of whether or not a person survived. Let’s visualize the model’s predictions:</p>
<div class="sourceCode" id="cb707"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb707-1"><a href="generalized-linear-model.html#cb707-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df.titanic,</span>
<span id="cb707-2"><a href="generalized-linear-model.html#cb707-2" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> fare,</span>
<span id="cb707-3"><a href="generalized-linear-model.html#cb707-3" tabindex="-1"></a>                     <span class="at">y =</span> survived)) <span class="sc">+</span> </span>
<span id="cb707-4"><a href="generalized-linear-model.html#cb707-4" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>) <span class="sc">+</span> </span>
<span id="cb707-5"><a href="generalized-linear-model.html#cb707-5" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb707-6"><a href="generalized-linear-model.html#cb707-6" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;survived&quot;</span>)</span></code></pre></div>
<p><img src="13-generalized_linear_model_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<p>This doesn’t look good! The model predicts intermediate values of <code>survived</code> (which doesn’t make sense given that a person either survived or didn’t survive). Furthermore, the model predicts values greater than 1 for fares greather than ~ 300.</p>
<p>Let’s run a logistic regression instead.</p>
<div class="sourceCode" id="cb708"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb708-1"><a href="generalized-linear-model.html#cb708-1" tabindex="-1"></a><span class="co"># fit a logistic regression </span></span>
<span id="cb708-2"><a href="generalized-linear-model.html#cb708-2" tabindex="-1"></a>fit.glm <span class="ot">=</span> <span class="fu">glm</span>(<span class="at">formula =</span> survived <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> fare,</span>
<span id="cb708-3"><a href="generalized-linear-model.html#cb708-3" tabindex="-1"></a>              <span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>,</span>
<span id="cb708-4"><a href="generalized-linear-model.html#cb708-4" tabindex="-1"></a>              <span class="at">data =</span> df.titanic)</span>
<span id="cb708-5"><a href="generalized-linear-model.html#cb708-5" tabindex="-1"></a></span>
<span id="cb708-6"><a href="generalized-linear-model.html#cb708-6" tabindex="-1"></a>fit.glm <span class="sc">%&gt;%</span> </span>
<span id="cb708-7"><a href="generalized-linear-model.html#cb708-7" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code></pre></div>
<pre><code>
Call:
glm(formula = survived ~ 1 + fare, family = &quot;binomial&quot;, data = df.titanic)

Coefficients:
             Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) -0.941330   0.095129  -9.895  &lt; 2e-16 ***
fare         0.015197   0.002232   6.810 9.79e-12 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 1186.7  on 890  degrees of freedom
Residual deviance: 1117.6  on 889  degrees of freedom
AIC: 1121.6

Number of Fisher Scoring iterations: 4</code></pre>
<p>And let’s visualize the predictions of the logistic regression:</p>
<div class="sourceCode" id="cb710"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb710-1"><a href="generalized-linear-model.html#cb710-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df.titanic,</span>
<span id="cb710-2"><a href="generalized-linear-model.html#cb710-2" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> fare,</span>
<span id="cb710-3"><a href="generalized-linear-model.html#cb710-3" tabindex="-1"></a>                     <span class="at">y =</span> survived)) <span class="sc">+</span> </span>
<span id="cb710-4"><a href="generalized-linear-model.html#cb710-4" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;glm&quot;</span>,</span>
<span id="cb710-5"><a href="generalized-linear-model.html#cb710-5" tabindex="-1"></a>              <span class="at">method.args =</span> <span class="fu">list</span>(<span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>)) <span class="sc">+</span></span>
<span id="cb710-6"><a href="generalized-linear-model.html#cb710-6" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb710-7"><a href="generalized-linear-model.html#cb710-7" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;p(survived)&quot;</span>)</span></code></pre></div>
<p><img src="13-generalized_linear_model_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<p>Much better! Note that we’ve changed the interpretation of our dependent variable. We are now predicting the <em>probability that a person survived</em> based on their fare. The model now only predicts values between 0 and 1. To achieve this, we apply a logit transform to the outcome variable like so:</p>
<p><span class="math display">\[
\ln(\frac{\pi_i}{1-\pi_i}) = b_0 + b_1 \cdot X_i + e_i
\]</span>
where <span class="math inline">\(\pi_i\)</span> is the probability of passenger <span class="math inline">\(i\)</span> having survived. Importantly, this affects our interpretation of the model parameters. They are now defined in log-odds, and can apply an inverse logit transformation to turn this back into a probability:</p>
<p>With</p>
<p><span class="math display">\[
\pi = P(Y = 1)
\]</span>
and the logit transformation</p>
<p><span class="math display">\[
\ln(\frac{\pi}{1-\pi}) = V,
\]</span>
where <span class="math inline">\(V\)</span> is just a placeholder for our linear model formula, we can go back to <span class="math inline">\(\pi\)</span> through the inverse logit transformation like so:</p>
<p><span class="math display">\[
\pi = \frac{e^V}{1 + e^V}
\]</span>
In R, we can use <code>log(x)</code> to calculate the natural logarithm <span class="math inline">\(\ln(x)\)</span>, and <code>exp(x)</code> to calculate <code>e^x</code>.</p>
<div id="interpreting-the-parameters" class="section level3 hasAnchor" number="13.4.1">
<h3><span class="header-section-number">13.4.1</span> Interpreting the parameters<a href="generalized-linear-model.html#interpreting-the-parameters" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb711"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb711-1"><a href="generalized-linear-model.html#cb711-1" tabindex="-1"></a>fit.glm <span class="sc">%&gt;%</span> </span>
<span id="cb711-2"><a href="generalized-linear-model.html#cb711-2" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code></pre></div>
<pre><code>
Call:
glm(formula = survived ~ 1 + fare, family = &quot;binomial&quot;, data = df.titanic)

Coefficients:
             Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) -0.941330   0.095129  -9.895  &lt; 2e-16 ***
fare         0.015197   0.002232   6.810 9.79e-12 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 1186.7  on 890  degrees of freedom
Residual deviance: 1117.6  on 889  degrees of freedom
AIC: 1121.6

Number of Fisher Scoring iterations: 4</code></pre>
<p>The estimate for the intercept and fare are in log-odds.</p>
<p>Let’s take a look at the linear model’s predictions in log-odds space.</p>
<div class="sourceCode" id="cb713"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb713-1"><a href="generalized-linear-model.html#cb713-1" tabindex="-1"></a>df.plot <span class="ot">=</span> fit.glm <span class="sc">%&gt;%</span> </span>
<span id="cb713-2"><a href="generalized-linear-model.html#cb713-2" tabindex="-1"></a>  <span class="fu">augment</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb713-3"><a href="generalized-linear-model.html#cb713-3" tabindex="-1"></a>  <span class="fu">clean_names</span>()</span>
<span id="cb713-4"><a href="generalized-linear-model.html#cb713-4" tabindex="-1"></a></span>
<span id="cb713-5"><a href="generalized-linear-model.html#cb713-5" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df.plot,</span>
<span id="cb713-6"><a href="generalized-linear-model.html#cb713-6" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> fare,</span>
<span id="cb713-7"><a href="generalized-linear-model.html#cb713-7" tabindex="-1"></a>                     <span class="at">y =</span> fitted)) <span class="sc">+</span> </span>
<span id="cb713-8"><a href="generalized-linear-model.html#cb713-8" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code></pre></div>
<p><img src="13-generalized_linear_model_files/figure-html/unnamed-chunk-11-1.png" width="672" />
Nice, looks like a good old linear model. But what’s the y-axis here? It’s in log-odds (buh!). This is difficult to interpret. Let’s transform the y-axis back to probabilities to make it easier to see what’s going on.</p>
<div class="sourceCode" id="cb714"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb714-1"><a href="generalized-linear-model.html#cb714-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df.plot,</span>
<span id="cb714-2"><a href="generalized-linear-model.html#cb714-2" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> fare,</span>
<span id="cb714-3"><a href="generalized-linear-model.html#cb714-3" tabindex="-1"></a>                     <span class="at">y =</span> <span class="fu">inv.logit</span>(fitted))) <span class="sc">+</span> </span>
<span id="cb714-4"><a href="generalized-linear-model.html#cb714-4" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code></pre></div>
<p><img src="13-generalized_linear_model_files/figure-html/unnamed-chunk-12-1.png" width="672" />
Great! Now the y-axis is back in probability space. We used the inverse logit function <code>inv.logit()</code> to transfer to log-odds back into probabilities.</p>
<p>Let’s check what the intercept of our model is in probability space:</p>
<div class="sourceCode" id="cb715"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb715-1"><a href="generalized-linear-model.html#cb715-1" tabindex="-1"></a>fit.glm <span class="sc">%&gt;%</span> </span>
<span id="cb715-2"><a href="generalized-linear-model.html#cb715-2" tabindex="-1"></a>  <span class="fu">pluck</span>(coefficients, <span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb715-3"><a href="generalized-linear-model.html#cb715-3" tabindex="-1"></a>  <span class="fu">inv.logit</span>()</span></code></pre></div>
<pre><code>[1] 0.2806318</code></pre>
<p>Here, we see that the intercept is <span class="math inline">\(p = 0.28\)</span>. That is, the predicted chance of survival for someone who didn’t pay any fare at all is 28% according to the model. Interpreting the slope is a little more tricky. Let’s look at a situation first where we have a binary predictor.</p>
<div id="logit-transform" class="section level4 hasAnchor" number="13.4.1.1">
<h4><span class="header-section-number">13.4.1.1</span> Logit transform<a href="generalized-linear-model.html#logit-transform" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Here is a visualization of what the odds and log odds transformation look like.</p>
<div class="sourceCode" id="cb717"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb717-1"><a href="generalized-linear-model.html#cb717-1" tabindex="-1"></a><span class="co"># going from probabilities to odds (ranges from 0 to +infinity)</span></span>
<span id="cb717-2"><a href="generalized-linear-model.html#cb717-2" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.1</span>)),</span>
<span id="cb717-3"><a href="generalized-linear-model.html#cb717-3" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> x)) <span class="sc">+</span> </span>
<span id="cb717-4"><a href="generalized-linear-model.html#cb717-4" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> <span class="sc">~</span> .<span class="sc">/</span>(<span class="dv">1</span> <span class="sc">-</span> .),</span>
<span id="cb717-5"><a href="generalized-linear-model.html#cb717-5" tabindex="-1"></a>                <span class="at">size =</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead.
This warning is displayed once every 8 hours.
Call `lifecycle::last_lifecycle_warnings()` to see where this warning was generated.</code></pre>
<div class="sourceCode" id="cb719"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb719-1"><a href="generalized-linear-model.html#cb719-1" tabindex="-1"></a><span class="co"># going from probabilities to log odds (ranges from -infinity to +infinity)</span></span>
<span id="cb719-2"><a href="generalized-linear-model.html#cb719-2" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.1</span>)),</span>
<span id="cb719-3"><a href="generalized-linear-model.html#cb719-3" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> x)) <span class="sc">+</span> </span>
<span id="cb719-4"><a href="generalized-linear-model.html#cb719-4" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> <span class="sc">~</span> <span class="fu">log</span>(.<span class="sc">/</span>(<span class="dv">1</span> <span class="sc">-</span> .)),</span>
<span id="cb719-5"><a href="generalized-linear-model.html#cb719-5" tabindex="-1"></a>                <span class="at">size =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="13-generalized_linear_model_files/figure-html/unnamed-chunk-14-1.png" width="672" /><img src="13-generalized_linear_model_files/figure-html/unnamed-chunk-14-2.png" width="672" /></p>
</div>
</div>
<div id="binary-predictor" class="section level3 hasAnchor" number="13.4.2">
<h3><span class="header-section-number">13.4.2</span> Binary predictor<a href="generalized-linear-model.html#binary-predictor" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let’s see whether the probability of survival differed between male and female passengers.</p>
<div class="sourceCode" id="cb720"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb720-1"><a href="generalized-linear-model.html#cb720-1" tabindex="-1"></a>fit.glm2 <span class="ot">=</span> <span class="fu">glm</span>(<span class="at">formula =</span> survived <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> sex,</span>
<span id="cb720-2"><a href="generalized-linear-model.html#cb720-2" tabindex="-1"></a>               <span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>,</span>
<span id="cb720-3"><a href="generalized-linear-model.html#cb720-3" tabindex="-1"></a>               <span class="at">data =</span> df.titanic)</span>
<span id="cb720-4"><a href="generalized-linear-model.html#cb720-4" tabindex="-1"></a></span>
<span id="cb720-5"><a href="generalized-linear-model.html#cb720-5" tabindex="-1"></a>fit.glm2 <span class="sc">%&gt;%</span> </span>
<span id="cb720-6"><a href="generalized-linear-model.html#cb720-6" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code></pre></div>
<pre><code>
Call:
glm(formula = survived ~ 1 + sex, family = &quot;binomial&quot;, data = df.titanic)

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)   1.0566     0.1290   8.191 2.58e-16 ***
sexmale      -2.5137     0.1672 -15.036  &lt; 2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 1186.7  on 890  degrees of freedom
Residual deviance:  917.8  on 889  degrees of freedom
AIC: 921.8

Number of Fisher Scoring iterations: 4</code></pre>
<p>It looks like it did! Let’s visualize:</p>
<div class="sourceCode" id="cb722"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb722-1"><a href="generalized-linear-model.html#cb722-1" tabindex="-1"></a>df.titanic <span class="sc">%&gt;%</span> </span>
<span id="cb722-2"><a href="generalized-linear-model.html#cb722-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">survived =</span> <span class="fu">factor</span>(survived, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;died&quot;</span>, <span class="st">&quot;survived&quot;</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb722-3"><a href="generalized-linear-model.html#cb722-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> .,</span>
<span id="cb722-4"><a href="generalized-linear-model.html#cb722-4" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> sex,</span>
<span id="cb722-5"><a href="generalized-linear-model.html#cb722-5" tabindex="-1"></a>                       <span class="at">fill =</span> survived)) <span class="sc">+</span></span>
<span id="cb722-6"><a href="generalized-linear-model.html#cb722-6" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">&quot;fill&quot;</span>,</span>
<span id="cb722-7"><a href="generalized-linear-model.html#cb722-7" tabindex="-1"></a>           <span class="at">color =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb722-8"><a href="generalized-linear-model.html#cb722-8" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;Set1&quot;</span>)  <span class="sc">+</span></span>
<span id="cb722-9"><a href="generalized-linear-model.html#cb722-9" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb722-10"><a href="generalized-linear-model.html#cb722-10" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb722-11"><a href="generalized-linear-model.html#cb722-11" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;probability&quot;</span>)</span></code></pre></div>
<p><img src="13-generalized_linear_model_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<p>And let’s interpret the parameters by applying the inverse logit transform. To get the prediction for female passengers we get</p>
<p><span class="math display">\[
\widehat{\ln(\frac{\pi_i}{1-\pi_i})} = b_0 + b_1 \cdot \text{sex}_i = b_0 + b_1 \cdot 0 = b_0
\]</span>
since we dummy coded the predictor and female is our reference category. To get the predicted probability of survival for women we do the logit transform:</p>
<p><span class="math display">\[
\pi = \frac{e^{b_0}}{1 + e^{b_0}}
\]</span>
The predicted probability is:</p>
<div class="sourceCode" id="cb723"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb723-1"><a href="generalized-linear-model.html#cb723-1" tabindex="-1"></a>fit.glm2 <span class="sc">%&gt;%</span> </span>
<span id="cb723-2"><a href="generalized-linear-model.html#cb723-2" tabindex="-1"></a>  <span class="fu">pluck</span>(coefficients, <span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb723-3"><a href="generalized-linear-model.html#cb723-3" tabindex="-1"></a>  <span class="fu">inv.logit</span>()</span></code></pre></div>
<pre><code>[1] 0.7420382</code></pre>
<p>To get the prediction for male passengers we have:</p>
<p><span class="math display">\[
\widehat{\ln(\frac{\pi_i}{1-\pi_i})} = b_0 + b_1 \cdot \text{sex}_i = b_0 + b_1 \cdot 1 = b_0 + b_1
\]</span>
Applying the logit transform like so</p>
<p><span class="math display">\[
\pi = \frac{e^{b_0 + b_1}}{1 + e^{b_0 + b_1}}
\]</span></p>
<p>The predicted probability of male passengers surviving is:</p>
<div class="sourceCode" id="cb725"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb725-1"><a href="generalized-linear-model.html#cb725-1" tabindex="-1"></a>fit.glm2 <span class="sc">%&gt;%</span> </span>
<span id="cb725-2"><a href="generalized-linear-model.html#cb725-2" tabindex="-1"></a>  <span class="fu">pluck</span>(coefficients) <span class="sc">%&gt;%</span> </span>
<span id="cb725-3"><a href="generalized-linear-model.html#cb725-3" tabindex="-1"></a>  <span class="fu">sum</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb725-4"><a href="generalized-linear-model.html#cb725-4" tabindex="-1"></a>  <span class="fu">inv.logit</span>()</span></code></pre></div>
<pre><code>[1] 0.1889081</code></pre>
<p>Here is the same information in a table:</p>
<div class="sourceCode" id="cb727"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb727-1"><a href="generalized-linear-model.html#cb727-1" tabindex="-1"></a>df.titanic <span class="sc">%&gt;%</span> </span>
<span id="cb727-2"><a href="generalized-linear-model.html#cb727-2" tabindex="-1"></a>  <span class="fu">count</span>(sex, survived) <span class="sc">%&gt;%</span> </span>
<span id="cb727-3"><a href="generalized-linear-model.html#cb727-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p =</span> n <span class="sc">/</span> <span class="fu">sum</span>(n)) <span class="sc">%&gt;%</span> </span>
<span id="cb727-4"><a href="generalized-linear-model.html#cb727-4" tabindex="-1"></a>  <span class="fu">group_by</span>(sex) <span class="sc">%&gt;%</span> </span>
<span id="cb727-5"><a href="generalized-linear-model.html#cb727-5" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">p(survived|sex)</span><span class="st">`</span> <span class="ot">=</span> p <span class="sc">/</span> <span class="fu">sum</span>(p))</span></code></pre></div>
<pre><code># A tibble: 4 × 5
# Groups:   sex [2]
  sex    survived     n      p `p(survived|sex)`
  &lt;fct&gt;     &lt;int&gt; &lt;int&gt;  &lt;dbl&gt;             &lt;dbl&gt;
1 female        0    81 0.0909             0.258
2 female        1   233 0.262              0.742
3 male          0   468 0.525              0.811
4 male          1   109 0.122              0.189</code></pre>
</div>
<div id="continuous-predictor" class="section level3 hasAnchor" number="13.4.3">
<h3><span class="header-section-number">13.4.3</span> Continuous predictor<a href="generalized-linear-model.html#continuous-predictor" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To interpret the predictions when a continuous predictor is involved, it’s easiest to consider a few concrete cases. Here, I use the <code>augment()</code> function from the “broom” package to get the model’s predictions for some values of interest:</p>
<div class="sourceCode" id="cb729"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb729-1"><a href="generalized-linear-model.html#cb729-1" tabindex="-1"></a>fit.glm <span class="sc">%&gt;%</span> </span>
<span id="cb729-2"><a href="generalized-linear-model.html#cb729-2" tabindex="-1"></a>  <span class="fu">augment</span>(<span class="at">newdata =</span> <span class="fu">tibble</span>(<span class="at">fare =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">500</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb729-3"><a href="generalized-linear-model.html#cb729-3" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb729-4"><a href="generalized-linear-model.html#cb729-4" tabindex="-1"></a>  <span class="fu">select</span>(fare, <span class="at">prediction =</span> fitted) <span class="sc">%&gt;%</span> </span>
<span id="cb729-5"><a href="generalized-linear-model.html#cb729-5" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">p(survival)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">inv.logit</span>(prediction))</span></code></pre></div>
<pre><code># A tibble: 5 × 3
   fare prediction `p(survival)`
  &lt;dbl&gt;      &lt;dbl&gt;         &lt;dbl&gt;
1     0     -0.941         0.281
2    10     -0.789         0.312
3    50     -0.181         0.455
4   100      0.578         0.641
5   500      6.66          0.999</code></pre>
</div>
<div id="several-predictors" class="section level3 hasAnchor" number="13.4.4">
<h3><span class="header-section-number">13.4.4</span> Several predictors<a href="generalized-linear-model.html#several-predictors" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let’s fit a logistic regression that predicts the probability of survival based both on the passenger’s sex and what fare they paid (allowing for an interaction of the two predictors):</p>
<div class="sourceCode" id="cb731"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb731-1"><a href="generalized-linear-model.html#cb731-1" tabindex="-1"></a>fit.glm3 <span class="ot">=</span> <span class="fu">glm</span>(<span class="at">formula =</span> survived <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> sex <span class="sc">*</span> fare,</span>
<span id="cb731-2"><a href="generalized-linear-model.html#cb731-2" tabindex="-1"></a>               <span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>,</span>
<span id="cb731-3"><a href="generalized-linear-model.html#cb731-3" tabindex="-1"></a>               <span class="at">data =</span> df.titanic)</span>
<span id="cb731-4"><a href="generalized-linear-model.html#cb731-4" tabindex="-1"></a></span>
<span id="cb731-5"><a href="generalized-linear-model.html#cb731-5" tabindex="-1"></a>fit.glm3 <span class="sc">%&gt;%</span> </span>
<span id="cb731-6"><a href="generalized-linear-model.html#cb731-6" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code></pre></div>
<pre><code>
Call:
glm(formula = survived ~ 1 + sex * fare, family = &quot;binomial&quot;, 
    data = df.titanic)

Coefficients:
              Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)   0.408428   0.189999   2.150 0.031584 *  
sexmale      -2.099345   0.230291  -9.116  &lt; 2e-16 ***
fare          0.019878   0.005372   3.701 0.000215 ***
sexmale:fare -0.011617   0.005934  -1.958 0.050252 .  
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 1186.66  on 890  degrees of freedom
Residual deviance:  879.85  on 887  degrees of freedom
AIC: 887.85

Number of Fisher Scoring iterations: 5</code></pre>
<p>Make sure not to interpret the significance test on the coefficients here as main effects. Based on this summary table, you cannot say whether there is a significant difference between male vs. female passenger in their probability of survival. What coefficient for <code>sexmale</code> captures is whether there is a significant difference between male and female passengers who paid a fare of 0. That is, it’s the predicted difference between the reference category (female) and the other category (male) when all other predictors are 0.</p>
<p>Let’s visualize the model predictions:</p>
<div class="sourceCode" id="cb733"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb733-1"><a href="generalized-linear-model.html#cb733-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df.titanic,</span>
<span id="cb733-2"><a href="generalized-linear-model.html#cb733-2" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> fare,</span>
<span id="cb733-3"><a href="generalized-linear-model.html#cb733-3" tabindex="-1"></a>                     <span class="at">y =</span> survived,</span>
<span id="cb733-4"><a href="generalized-linear-model.html#cb733-4" tabindex="-1"></a>                     <span class="at">color =</span> sex)) <span class="sc">+</span></span>
<span id="cb733-5"><a href="generalized-linear-model.html#cb733-5" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.1</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb733-6"><a href="generalized-linear-model.html#cb733-6" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;glm&quot;</span>,</span>
<span id="cb733-7"><a href="generalized-linear-model.html#cb733-7" tabindex="-1"></a>              <span class="at">method.args =</span> <span class="fu">list</span>(<span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>),</span>
<span id="cb733-8"><a href="generalized-linear-model.html#cb733-8" tabindex="-1"></a>              <span class="at">alpha =</span> <span class="fl">0.2</span>,</span>
<span id="cb733-9"><a href="generalized-linear-model.html#cb733-9" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">fill =</span> sex)) <span class="sc">+</span></span>
<span id="cb733-10"><a href="generalized-linear-model.html#cb733-10" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;Set1&quot;</span>)</span></code></pre></div>
<p><img src="13-generalized_linear_model_files/figure-html/unnamed-chunk-22-1.png" width="672" />
Just for kicks, to get a better sense for what the interaction looks like, here is the visualization in log-odds space:</p>
<div class="sourceCode" id="cb734"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb734-1"><a href="generalized-linear-model.html#cb734-1" tabindex="-1"></a>fit.glm3 <span class="sc">%&gt;%</span> </span>
<span id="cb734-2"><a href="generalized-linear-model.html#cb734-2" tabindex="-1"></a>  <span class="fu">augment</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb734-3"><a href="generalized-linear-model.html#cb734-3" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb734-4"><a href="generalized-linear-model.html#cb734-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> .,</span>
<span id="cb734-5"><a href="generalized-linear-model.html#cb734-5" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> fare,</span>
<span id="cb734-6"><a href="generalized-linear-model.html#cb734-6" tabindex="-1"></a>                       <span class="at">color =</span> sex,</span>
<span id="cb734-7"><a href="generalized-linear-model.html#cb734-7" tabindex="-1"></a>                       <span class="at">y =</span> fitted)) <span class="sc">+</span> </span>
<span id="cb734-8"><a href="generalized-linear-model.html#cb734-8" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb734-9"><a href="generalized-linear-model.html#cb734-9" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;Set1&quot;</span>)</span></code></pre></div>
<p><img src="13-generalized_linear_model_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<p>Let’s see how large the difference between genders is once we take into account how much each person paid for the fair:</p>
<div class="sourceCode" id="cb735"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb735-1"><a href="generalized-linear-model.html#cb735-1" tabindex="-1"></a><span class="fu">ggpredict</span>(fit.glm3,</span>
<span id="cb735-2"><a href="generalized-linear-model.html#cb735-2" tabindex="-1"></a>          <span class="at">terms =</span> <span class="fu">c</span>(<span class="st">&quot;sex&quot;</span>))</span></code></pre></div>
<pre><code># Predicted probabilities of survived

sex    | Predicted |       95% CI
---------------------------------
female |      0.74 | [0.69, 0.79]
male   |      0.19 | [0.16, 0.23]

Adjusted for:
* fare = 32.20</code></pre>
<p>We notice that there is one outlier who was male and paid a $500 fare (or maybe this is a mistake in the data entry?!). Let’s remove this outlier and see what happens:</p>
<div class="sourceCode" id="cb737"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb737-1"><a href="generalized-linear-model.html#cb737-1" tabindex="-1"></a>fit.glm3_no_outlier <span class="ot">=</span> <span class="fu">glm</span>(<span class="at">formula =</span> survived <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> sex <span class="sc">*</span> fare,</span>
<span id="cb737-2"><a href="generalized-linear-model.html#cb737-2" tabindex="-1"></a>                          <span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>,</span>
<span id="cb737-3"><a href="generalized-linear-model.html#cb737-3" tabindex="-1"></a>                          <span class="at">data =</span> df.titanic <span class="sc">%&gt;%</span> </span>
<span id="cb737-4"><a href="generalized-linear-model.html#cb737-4" tabindex="-1"></a>                            <span class="fu">filter</span>(fare <span class="sc">&lt;</span> <span class="dv">500</span>))</span>
<span id="cb737-5"><a href="generalized-linear-model.html#cb737-5" tabindex="-1"></a></span>
<span id="cb737-6"><a href="generalized-linear-model.html#cb737-6" tabindex="-1"></a>fit.glm3_no_outlier <span class="sc">%&gt;%</span> </span>
<span id="cb737-7"><a href="generalized-linear-model.html#cb737-7" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code></pre></div>
<pre><code>
Call:
glm(formula = survived ~ 1 + sex * fare, family = &quot;binomial&quot;, 
    data = df.titanic %&gt;% filter(fare &lt; 500))

Coefficients:
              Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)   0.408436   0.190019   2.149 0.031598 *  
sexmale      -2.085344   0.232260  -8.979  &lt; 2e-16 ***
fare          0.019878   0.005373   3.699 0.000216 ***
sexmale:fare -0.012178   0.006066  -2.008 0.044688 *  
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 1180.89  on 887  degrees of freedom
Residual deviance:  879.51  on 884  degrees of freedom
AIC: 887.51

Number of Fisher Scoring iterations: 5</code></pre>
<div class="sourceCode" id="cb739"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb739-1"><a href="generalized-linear-model.html#cb739-1" tabindex="-1"></a>df.titanic <span class="sc">%&gt;%</span> </span>
<span id="cb739-2"><a href="generalized-linear-model.html#cb739-2" tabindex="-1"></a>  <span class="fu">filter</span>(fare <span class="sc">&lt;</span> <span class="dv">500</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb739-3"><a href="generalized-linear-model.html#cb739-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sex =</span> <span class="fu">as.factor</span>(sex)) <span class="sc">%&gt;%</span> </span>
<span id="cb739-4"><a href="generalized-linear-model.html#cb739-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> .,</span>
<span id="cb739-5"><a href="generalized-linear-model.html#cb739-5" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> fare,</span>
<span id="cb739-6"><a href="generalized-linear-model.html#cb739-6" tabindex="-1"></a>                       <span class="at">y =</span> survived,</span>
<span id="cb739-7"><a href="generalized-linear-model.html#cb739-7" tabindex="-1"></a>                       <span class="at">color =</span> sex)) <span class="sc">+</span></span>
<span id="cb739-8"><a href="generalized-linear-model.html#cb739-8" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.1</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb739-9"><a href="generalized-linear-model.html#cb739-9" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">&quot;glm&quot;</span>,</span>
<span id="cb739-10"><a href="generalized-linear-model.html#cb739-10" tabindex="-1"></a>              <span class="at">method.args =</span> <span class="fu">list</span>(<span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>),</span>
<span id="cb739-11"><a href="generalized-linear-model.html#cb739-11" tabindex="-1"></a>              <span class="at">alpha =</span> <span class="fl">0.2</span>,</span>
<span id="cb739-12"><a href="generalized-linear-model.html#cb739-12" tabindex="-1"></a>              <span class="at">fullrange =</span> T,</span>
<span id="cb739-13"><a href="generalized-linear-model.html#cb739-13" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">fill =</span> sex)) <span class="sc">+</span></span>
<span id="cb739-14"><a href="generalized-linear-model.html#cb739-14" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;Set1&quot;</span>) <span class="sc">+</span></span>
<span id="cb739-15"><a href="generalized-linear-model.html#cb739-15" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">500</span>))</span></code></pre></div>
<p><img src="13-generalized_linear_model_files/figure-html/unnamed-chunk-25-1.png" width="672" /></p>
<p>There is still a clear difference between female and male passengers, but the prediction for male passengers has changed a bit. Let’s look at a concrete example:</p>
<div class="sourceCode" id="cb740"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb740-1"><a href="generalized-linear-model.html#cb740-1" tabindex="-1"></a><span class="co"># with the outlier: </span></span>
<span id="cb740-2"><a href="generalized-linear-model.html#cb740-2" tabindex="-1"></a></span>
<span id="cb740-3"><a href="generalized-linear-model.html#cb740-3" tabindex="-1"></a><span class="co"># predicted probability of survival for a male passenger who paid $200 for their fare </span></span>
<span id="cb740-4"><a href="generalized-linear-model.html#cb740-4" tabindex="-1"></a><span class="fu">inv.logit</span>(fit.glm3<span class="sc">$</span>coefficients[<span class="dv">1</span>] <span class="sc">+</span> fit.glm3<span class="sc">$</span>coefficients[<span class="dv">2</span>] <span class="sc">+</span> </span>
<span id="cb740-5"><a href="generalized-linear-model.html#cb740-5" tabindex="-1"></a>            fit.glm3<span class="sc">$</span>coefficients[<span class="dv">3</span>] <span class="sc">*</span> <span class="dv">200</span> <span class="sc">+</span> fit.glm3<span class="sc">$</span>coefficients[<span class="dv">4</span>] <span class="sc">*</span> <span class="dv">200</span>)</span></code></pre></div>
<pre><code>(Intercept) 
  0.4903402 </code></pre>
<div class="sourceCode" id="cb742"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb742-1"><a href="generalized-linear-model.html#cb742-1" tabindex="-1"></a><span class="co"># without the outlier: </span></span>
<span id="cb742-2"><a href="generalized-linear-model.html#cb742-2" tabindex="-1"></a></span>
<span id="cb742-3"><a href="generalized-linear-model.html#cb742-3" tabindex="-1"></a><span class="co"># predicted probability of survival for a male passenger who paid $200 for their fare </span></span>
<span id="cb742-4"><a href="generalized-linear-model.html#cb742-4" tabindex="-1"></a><span class="fu">inv.logit</span>(fit.glm3_no_outlier<span class="sc">$</span>coefficients[<span class="dv">1</span>] <span class="sc">+</span> </span>
<span id="cb742-5"><a href="generalized-linear-model.html#cb742-5" tabindex="-1"></a>            fit.glm3_no_outlier<span class="sc">$</span>coefficients[<span class="dv">2</span>] <span class="sc">+</span> </span>
<span id="cb742-6"><a href="generalized-linear-model.html#cb742-6" tabindex="-1"></a>            fit.glm3_no_outlier<span class="sc">$</span>coefficients[<span class="dv">3</span>] <span class="sc">*</span> <span class="dv">200</span> <span class="sc">+</span> </span>
<span id="cb742-7"><a href="generalized-linear-model.html#cb742-7" tabindex="-1"></a>            fit.glm3_no_outlier<span class="sc">$</span>coefficients[<span class="dv">4</span>] <span class="sc">*</span> <span class="dv">200</span>)</span></code></pre></div>
<pre><code>(Intercept) 
  0.4658284 </code></pre>
<p>With the outlier removed, the predicted probability of survival for a male passenger who paid $200 decreases from 49% to 47%.</p>
</div>
<div id="using-the-ggeffects-package" class="section level3 hasAnchor" number="13.4.5">
<h3><span class="header-section-number">13.4.5</span> Using the “ggeffects” package<a href="generalized-linear-model.html#using-the-ggeffects-package" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The “ggeffects” package helps with the interpretation of the results. It applies the inverse logit transform for us, and shows the predictions for a range of cases.</p>
<div class="sourceCode" id="cb744"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb744-1"><a href="generalized-linear-model.html#cb744-1" tabindex="-1"></a><span class="co"># show effects </span></span>
<span id="cb744-2"><a href="generalized-linear-model.html#cb744-2" tabindex="-1"></a><span class="fu">ggeffect</span>(<span class="at">model =</span> fit.glm,</span>
<span id="cb744-3"><a href="generalized-linear-model.html#cb744-3" tabindex="-1"></a>         <span class="at">terms =</span> <span class="st">&quot;fare [1, 100, 200, 300, 400, 500]&quot;</span>)</span></code></pre></div>
<pre><code># Predicted probabilities of survived

fare | Predicted |       95% CI
-------------------------------
   1 |      0.28 | [0.25, 0.32]
 100 |      0.64 | [0.56, 0.72]
 200 |      0.89 | [0.79, 0.95]
 300 |      0.97 | [0.92, 0.99]
 400 |      0.99 | [0.97, 1.00]
 500 |      1.00 | [0.99, 1.00]</code></pre>
<p>I’ve used the <code>[]</code> construction to specify for what values of the predictor <code>fare</code>, I’d like get the predicted values. Here, the prediction is marginalized across both women and men.</p>
<p>We can also get a plot of the model predictions like so:</p>
<div class="sourceCode" id="cb746"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb746-1"><a href="generalized-linear-model.html#cb746-1" tabindex="-1"></a><span class="fu">ggeffect</span>(<span class="at">model =</span> fit.glm,</span>
<span id="cb746-2"><a href="generalized-linear-model.html#cb746-2" tabindex="-1"></a>         <span class="at">terms =</span> <span class="st">&quot;fare [1, 100, 200, 300, 400, 500]&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb746-3"><a href="generalized-linear-model.html#cb746-3" tabindex="-1"></a>  <span class="fu">plot</span>()</span></code></pre></div>
<p><img src="13-generalized_linear_model_files/figure-html/unnamed-chunk-28-1.png" width="672" /></p>
<p>And, we can also get the predicted probability of survival for sex marginalized over the fare, using the model which included both sex and fare, as well as its interaction as predictors.</p>
<div class="sourceCode" id="cb747"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb747-1"><a href="generalized-linear-model.html#cb747-1" tabindex="-1"></a><span class="fu">ggeffect</span>(<span class="at">model =</span> fit.glm3,</span>
<span id="cb747-2"><a href="generalized-linear-model.html#cb747-2" tabindex="-1"></a>         <span class="at">terms =</span> <span class="st">&quot;sex&quot;</span>)</span></code></pre></div>
<pre><code># Predicted probabilities of survived

sex    | Predicted |       95% CI
---------------------------------
female |      0.74 | [0.69, 0.79]
male   |      0.19 | [0.16, 0.23]</code></pre>
<p>Finally, we can ask for predictions for specific combinations of our predictor variables, by using the <code>ggpredict()</code> function.</p>
<div class="sourceCode" id="cb749"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb749-1"><a href="generalized-linear-model.html#cb749-1" tabindex="-1"></a><span class="fu">ggpredict</span>(<span class="at">model =</span> fit.glm3,</span>
<span id="cb749-2"><a href="generalized-linear-model.html#cb749-2" tabindex="-1"></a>          <span class="at">terms =</span> <span class="fu">c</span>(<span class="st">&quot;sex&quot;</span>, <span class="st">&quot;fare [200]&quot;</span>))</span></code></pre></div>
<pre><code># Predicted probabilities of survived

sex    | Predicted |       95% CI
---------------------------------
female |      0.99 | [0.93, 1.00]
male   |      0.49 | [0.29, 0.70]</code></pre>
<p>The example above, shows the predicted probability of survival for male vs. female passengers, assuming that they paid 200 for the fare.</p>
</div>
</div>
<div id="simulate-a-logistic-regression" class="section level2 hasAnchor" number="13.5">
<h2><span class="header-section-number">13.5</span> Simulate a logistic regression<a href="generalized-linear-model.html#simulate-a-logistic-regression" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>As always, to better understand a statistical modeling procedure, it’s helpful to simulate data from the assumed data-generating process, fit the model, and see whether we can reconstruct the parameters.</p>
<div class="sourceCode" id="cb751"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb751-1"><a href="generalized-linear-model.html#cb751-1" tabindex="-1"></a><span class="co"># make example reproducible </span></span>
<span id="cb751-2"><a href="generalized-linear-model.html#cb751-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb751-3"><a href="generalized-linear-model.html#cb751-3" tabindex="-1"></a></span>
<span id="cb751-4"><a href="generalized-linear-model.html#cb751-4" tabindex="-1"></a><span class="co"># set parameters </span></span>
<span id="cb751-5"><a href="generalized-linear-model.html#cb751-5" tabindex="-1"></a>sample_size <span class="ot">=</span> <span class="dv">1000</span> </span>
<span id="cb751-6"><a href="generalized-linear-model.html#cb751-6" tabindex="-1"></a>b0 <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb751-7"><a href="generalized-linear-model.html#cb751-7" tabindex="-1"></a>b1 <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb751-8"><a href="generalized-linear-model.html#cb751-8" tabindex="-1"></a><span class="co"># b1 = 8</span></span>
<span id="cb751-9"><a href="generalized-linear-model.html#cb751-9" tabindex="-1"></a></span>
<span id="cb751-10"><a href="generalized-linear-model.html#cb751-10" tabindex="-1"></a><span class="co"># generate data </span></span>
<span id="cb751-11"><a href="generalized-linear-model.html#cb751-11" tabindex="-1"></a>df.data <span class="ot">=</span> <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">rnorm</span>(<span class="at">n =</span> sample_size),</span>
<span id="cb751-12"><a href="generalized-linear-model.html#cb751-12" tabindex="-1"></a>                 <span class="at">y =</span> b0 <span class="sc">+</span> b1 <span class="sc">*</span> x,</span>
<span id="cb751-13"><a href="generalized-linear-model.html#cb751-13" tabindex="-1"></a>                 <span class="at">p =</span> <span class="fu">inv.logit</span>(y)) <span class="sc">%&gt;%</span> </span>
<span id="cb751-14"><a href="generalized-linear-model.html#cb751-14" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">response =</span> <span class="fu">rbinom</span>(<span class="fu">n</span>(), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">p =</span> p))</span>
<span id="cb751-15"><a href="generalized-linear-model.html#cb751-15" tabindex="-1"></a></span>
<span id="cb751-16"><a href="generalized-linear-model.html#cb751-16" tabindex="-1"></a><span class="co"># fit model </span></span>
<span id="cb751-17"><a href="generalized-linear-model.html#cb751-17" tabindex="-1"></a>fit <span class="ot">=</span> <span class="fu">glm</span>(<span class="at">formula =</span> response <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> x,</span>
<span id="cb751-18"><a href="generalized-linear-model.html#cb751-18" tabindex="-1"></a>          <span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>,</span>
<span id="cb751-19"><a href="generalized-linear-model.html#cb751-19" tabindex="-1"></a>          <span class="at">data =</span> df.data)</span>
<span id="cb751-20"><a href="generalized-linear-model.html#cb751-20" tabindex="-1"></a></span>
<span id="cb751-21"><a href="generalized-linear-model.html#cb751-21" tabindex="-1"></a><span class="co"># model summary </span></span>
<span id="cb751-22"><a href="generalized-linear-model.html#cb751-22" tabindex="-1"></a>fit <span class="sc">%&gt;%</span> </span>
<span id="cb751-23"><a href="generalized-linear-model.html#cb751-23" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code></pre></div>
<pre><code>
Call:
glm(formula = response ~ 1 + x, family = &quot;binomial&quot;, data = df.data)

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) -0.06214    0.06918  -0.898    0.369    
x            0.92905    0.07937  11.705   &lt;2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 1385.4  on 999  degrees of freedom
Residual deviance: 1209.6  on 998  degrees of freedom
AIC: 1213.6

Number of Fisher Scoring iterations: 3</code></pre>
<div class="sourceCode" id="cb753"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb753-1"><a href="generalized-linear-model.html#cb753-1" tabindex="-1"></a>df.data <span class="sc">%&gt;%</span> </span>
<span id="cb753-2"><a href="generalized-linear-model.html#cb753-2" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">10</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb753-3"><a href="generalized-linear-model.html#cb753-3" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">digits =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb753-4"><a href="generalized-linear-model.html#cb753-4" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="st">&quot;striped&quot;</span>,</span>
<span id="cb753-5"><a href="generalized-linear-model.html#cb753-5" tabindex="-1"></a>                <span class="at">full_width =</span> F)</span></code></pre></div>
<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
x
</th>
<th style="text-align:right;">
y
</th>
<th style="text-align:right;">
p
</th>
<th style="text-align:right;">
response
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
-0.63
</td>
<td style="text-align:right;">
-0.63
</td>
<td style="text-align:right;">
0.35
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:right;">
0.18
</td>
<td style="text-align:right;">
0.18
</td>
<td style="text-align:right;">
0.55
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
-0.84
</td>
<td style="text-align:right;">
-0.84
</td>
<td style="text-align:right;">
0.30
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:right;">
1.60
</td>
<td style="text-align:right;">
1.60
</td>
<td style="text-align:right;">
0.83
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:right;">
0.33
</td>
<td style="text-align:right;">
0.33
</td>
<td style="text-align:right;">
0.58
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:right;">
-0.82
</td>
<td style="text-align:right;">
-0.82
</td>
<td style="text-align:right;">
0.31
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
0.49
</td>
<td style="text-align:right;">
0.49
</td>
<td style="text-align:right;">
0.62
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:right;">
0.74
</td>
<td style="text-align:right;">
0.74
</td>
<td style="text-align:right;">
0.68
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:right;">
0.58
</td>
<td style="text-align:right;">
0.58
</td>
<td style="text-align:right;">
0.64
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:right;">
-0.31
</td>
<td style="text-align:right;">
-0.31
</td>
<td style="text-align:right;">
0.42
</td>
<td style="text-align:right;">
0
</td>
</tr>
</tbody>
</table>
<p>Nice! The inferred estimates are very close to the parameter values we used to simulate the data.</p>
<p>Let’s visualize the result:</p>
<div class="sourceCode" id="cb754"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb754-1"><a href="generalized-linear-model.html#cb754-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df.data,</span>
<span id="cb754-2"><a href="generalized-linear-model.html#cb754-2" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> x,</span>
<span id="cb754-3"><a href="generalized-linear-model.html#cb754-3" tabindex="-1"></a>                     <span class="at">y =</span> response)) <span class="sc">+</span> </span>
<span id="cb754-4"><a href="generalized-linear-model.html#cb754-4" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;glm&quot;</span>,</span>
<span id="cb754-5"><a href="generalized-linear-model.html#cb754-5" tabindex="-1"></a>              <span class="at">method.args =</span> <span class="fu">list</span>(<span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb754-6"><a href="generalized-linear-model.html#cb754-6" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb754-7"><a href="generalized-linear-model.html#cb754-7" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;p(response)&quot;</span>)</span></code></pre></div>
<p><img src="13-generalized_linear_model_files/figure-html/unnamed-chunk-32-1.png" width="672" /></p>
<div id="calculate-the-models-likelihood" class="section level3 hasAnchor" number="13.5.1">
<h3><span class="header-section-number">13.5.1</span> Calculate the model’s likelihood<a href="generalized-linear-model.html#calculate-the-models-likelihood" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To calculate the likelihood of the data for a given logistic model, we look at the actual response, and the probability of the predicted response, and then determine the likelihood of the observation assuming a Bernoulli process. To get the overall likelihood of the data, we then multiply the likelihood of each data point (or take the logs first and then the sum to get the log-likelihood).</p>
<p>This table illustrate the steps involved:</p>
<div class="sourceCode" id="cb755"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb755-1"><a href="generalized-linear-model.html#cb755-1" tabindex="-1"></a>fit <span class="sc">%&gt;%</span> </span>
<span id="cb755-2"><a href="generalized-linear-model.html#cb755-2" tabindex="-1"></a>  <span class="fu">augment</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb755-3"><a href="generalized-linear-model.html#cb755-3" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb755-4"><a href="generalized-linear-model.html#cb755-4" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p =</span> <span class="fu">inv.logit</span>(fitted)) <span class="sc">%&gt;%</span> </span>
<span id="cb755-5"><a href="generalized-linear-model.html#cb755-5" tabindex="-1"></a>  <span class="fu">select</span>(response, p) <span class="sc">%&gt;%</span> </span>
<span id="cb755-6"><a href="generalized-linear-model.html#cb755-6" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p_response =</span> <span class="fu">ifelse</span>(response <span class="sc">==</span> <span class="dv">1</span>, p, <span class="dv">1</span><span class="sc">-</span>p),</span>
<span id="cb755-7"><a href="generalized-linear-model.html#cb755-7" tabindex="-1"></a>         <span class="at">log_p =</span> <span class="fu">log</span>(p_response)) <span class="sc">%&gt;%</span> </span>
<span id="cb755-8"><a href="generalized-linear-model.html#cb755-8" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">`</span><span class="at">p(Y = 1)</span><span class="st">`</span> <span class="ot">=</span> p, <span class="st">`</span><span class="at">p(Y = response)</span><span class="st">`</span> <span class="ot">=</span> p_response,</span>
<span id="cb755-9"><a href="generalized-linear-model.html#cb755-9" tabindex="-1"></a>         <span class="st">`</span><span class="at">log(p(Y = response))</span><span class="st">`</span> <span class="ot">=</span> log_p)</span></code></pre></div>
<pre><code># A tibble: 1,000 × 4
   response `p(Y = 1)` `p(Y = response)` `log(p(Y = response))`
      &lt;int&gt;      &lt;dbl&gt;             &lt;dbl&gt;                  &lt;dbl&gt;
 1        1      0.344             0.344                 -1.07 
 2        0      0.527             0.473                 -0.749
 3        1      0.302             0.302                 -1.20 
 4        1      0.805             0.805                 -0.217
 5        1      0.561             0.561                 -0.579
 6        0      0.305             0.695                 -0.364
 7        1      0.596             0.596                 -0.517
 8        1      0.651             0.651                 -0.429
 9        1      0.616             0.616                 -0.484
10        0      0.414             0.586                 -0.535
# ℹ 990 more rows</code></pre>
<p>Let’s calculate the log-likelihood by hand:</p>
<div class="sourceCode" id="cb757"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb757-1"><a href="generalized-linear-model.html#cb757-1" tabindex="-1"></a>fit <span class="sc">%&gt;%</span> </span>
<span id="cb757-2"><a href="generalized-linear-model.html#cb757-2" tabindex="-1"></a>  <span class="fu">augment</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb757-3"><a href="generalized-linear-model.html#cb757-3" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb757-4"><a href="generalized-linear-model.html#cb757-4" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p =</span> <span class="fu">inv.logit</span>(fitted),</span>
<span id="cb757-5"><a href="generalized-linear-model.html#cb757-5" tabindex="-1"></a>         <span class="at">log_likelihood =</span> response <span class="sc">*</span> <span class="fu">log</span>(p) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">-</span> response) <span class="sc">*</span> <span class="fu">log</span>(<span class="dv">1</span> <span class="sc">-</span> p)) <span class="sc">%&gt;%</span> </span>
<span id="cb757-6"><a href="generalized-linear-model.html#cb757-6" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">log_likelihood =</span> <span class="fu">sum</span>(log_likelihood))</span></code></pre></div>
<pre><code># A tibble: 1 × 1
  log_likelihood
           &lt;dbl&gt;
1          -605.</code></pre>
<p>And compare it with the model summary</p>
<div class="sourceCode" id="cb759"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb759-1"><a href="generalized-linear-model.html#cb759-1" tabindex="-1"></a>fit <span class="sc">%&gt;%</span> </span>
<span id="cb759-2"><a href="generalized-linear-model.html#cb759-2" tabindex="-1"></a>  <span class="fu">glance</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb759-3"><a href="generalized-linear-model.html#cb759-3" tabindex="-1"></a>  <span class="fu">select</span>(logLik, AIC, BIC)</span></code></pre></div>
<pre><code># A tibble: 1 × 3
  logLik   AIC   BIC
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1  -605. 1214. 1223.</code></pre>
<p>We’re getting the same result – neat! Now we know how the likelihood of the data is calculated for a logistic regression model.</p>
</div>
</div>
<div id="testing-hypotheses" class="section level2 hasAnchor" number="13.6">
<h2><span class="header-section-number">13.6</span> Testing hypotheses<a href="generalized-linear-model.html#testing-hypotheses" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>To test hypotheses, we can use our good old model comparison approach:</p>
<div class="sourceCode" id="cb761"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb761-1"><a href="generalized-linear-model.html#cb761-1" tabindex="-1"></a><span class="co"># fit compact model</span></span>
<span id="cb761-2"><a href="generalized-linear-model.html#cb761-2" tabindex="-1"></a>fit.compact <span class="ot">=</span> <span class="fu">glm</span>(<span class="at">formula =</span> survived <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> fare,</span>
<span id="cb761-3"><a href="generalized-linear-model.html#cb761-3" tabindex="-1"></a>                  <span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>,</span>
<span id="cb761-4"><a href="generalized-linear-model.html#cb761-4" tabindex="-1"></a>                  <span class="at">data =</span> df.titanic)</span>
<span id="cb761-5"><a href="generalized-linear-model.html#cb761-5" tabindex="-1"></a></span>
<span id="cb761-6"><a href="generalized-linear-model.html#cb761-6" tabindex="-1"></a><span class="co"># fit augmented model</span></span>
<span id="cb761-7"><a href="generalized-linear-model.html#cb761-7" tabindex="-1"></a>fit.augmented <span class="ot">=</span> <span class="fu">glm</span>(<span class="at">formula =</span> survived <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> sex <span class="sc">+</span> fare,</span>
<span id="cb761-8"><a href="generalized-linear-model.html#cb761-8" tabindex="-1"></a>                    <span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>,</span>
<span id="cb761-9"><a href="generalized-linear-model.html#cb761-9" tabindex="-1"></a>                    <span class="at">data =</span> df.titanic)</span>
<span id="cb761-10"><a href="generalized-linear-model.html#cb761-10" tabindex="-1"></a></span>
<span id="cb761-11"><a href="generalized-linear-model.html#cb761-11" tabindex="-1"></a><span class="co"># likelihood ratio test</span></span>
<span id="cb761-12"><a href="generalized-linear-model.html#cb761-12" tabindex="-1"></a><span class="fu">anova</span>(fit.compact, fit.augmented, <span class="at">test =</span> <span class="st">&quot;LRT&quot;</span>)</span></code></pre></div>
<pre><code>Analysis of Deviance Table

Model 1: survived ~ 1 + fare
Model 2: survived ~ 1 + sex + fare
  Resid. Df Resid. Dev Df Deviance  Pr(&gt;Chi)    
1       889    1117.57                          
2       888     884.31  1   233.26 &lt; 2.2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Note that in order to get a p-value out of this, we need to specify what statistical test we’d like to run. In this case, we use the likelihood ratio test (“LRT”).</p>
<p>We can also test for both effects of survived and fare in one go using the <code>joint_tests()</code> function from the “emmeans” package like so:</p>
<div class="sourceCode" id="cb763"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb763-1"><a href="generalized-linear-model.html#cb763-1" tabindex="-1"></a><span class="fu">glm</span>(<span class="at">formula =</span> survived <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> sex <span class="sc">+</span> fare,</span>
<span id="cb763-2"><a href="generalized-linear-model.html#cb763-2" tabindex="-1"></a>    <span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>,</span>
<span id="cb763-3"><a href="generalized-linear-model.html#cb763-3" tabindex="-1"></a>    <span class="at">data =</span> df.titanic) <span class="sc">%&gt;%</span> </span>
<span id="cb763-4"><a href="generalized-linear-model.html#cb763-4" tabindex="-1"></a>  <span class="fu">joint_tests</span>()</span></code></pre></div>
<pre><code> model term df1 df2 F.ratio   Chisq p.value
 sex          1 Inf 201.881 201.881  &lt;.0001
 fare         1 Inf  23.869  23.869  &lt;.0001</code></pre>
<p>Notice that the F.ratio reported using <code>joint_tests()</code> (201.881) is not quite the same as the deviance value that we get through the likelihood ratio test (233.26). You can read more about why these two can come apart <a href="https://stats.stackexchange.com/questions/400101/using-emmeans-with-clmm-to-look-at-joint-effects">here</a>.</p>
</div>
<div id="logistic-mixed-effects-model" class="section level2 hasAnchor" number="13.7">
<h2><span class="header-section-number">13.7</span> Logistic mixed effects model<a href="generalized-linear-model.html#logistic-mixed-effects-model" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Just like we can build linear mixed effects models using <code>lmer()</code> instead of <code>lm()</code>, we can also build a logistic mixed effects regression using <code>glmer()</code> instead of <code>glm()</code>.</p>
<p>Let’s read in some data:</p>
<div class="sourceCode" id="cb765"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb765-1"><a href="generalized-linear-model.html#cb765-1" tabindex="-1"></a><span class="co"># load bdf data set from nlme package</span></span>
<span id="cb765-2"><a href="generalized-linear-model.html#cb765-2" tabindex="-1"></a><span class="fu">data</span>(bdf, <span class="at">package =</span> <span class="st">&quot;nlme&quot;</span>)</span>
<span id="cb765-3"><a href="generalized-linear-model.html#cb765-3" tabindex="-1"></a></span>
<span id="cb765-4"><a href="generalized-linear-model.html#cb765-4" tabindex="-1"></a>df.language <span class="ot">=</span> bdf <span class="sc">%&gt;%</span> </span>
<span id="cb765-5"><a href="generalized-linear-model.html#cb765-5" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb765-6"><a href="generalized-linear-model.html#cb765-6" tabindex="-1"></a>  <span class="fu">filter</span>(repeatgr <span class="sc">!=</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb765-7"><a href="generalized-linear-model.html#cb765-7" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">repeatgr =</span> repeatgr <span class="sc">%&gt;%</span> </span>
<span id="cb765-8"><a href="generalized-linear-model.html#cb765-8" tabindex="-1"></a>           <span class="fu">as.character</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb765-9"><a href="generalized-linear-model.html#cb765-9" tabindex="-1"></a>           <span class="fu">as.numeric</span>())</span>
<span id="cb765-10"><a href="generalized-linear-model.html#cb765-10" tabindex="-1"></a></span>
<span id="cb765-11"><a href="generalized-linear-model.html#cb765-11" tabindex="-1"></a><span class="fu">rm</span>(bdf)</span></code></pre></div>
<p>Fit the model, and print out the results:</p>
<div class="sourceCode" id="cb766"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb766-1"><a href="generalized-linear-model.html#cb766-1" tabindex="-1"></a>fit <span class="ot">=</span>  <span class="fu">glmer</span>(repeatgr <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> ses <span class="sc">+</span> minority <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> school_nr),</span>
<span id="cb766-2"><a href="generalized-linear-model.html#cb766-2" tabindex="-1"></a>             <span class="at">data =</span> df.language,</span>
<span id="cb766-3"><a href="generalized-linear-model.html#cb766-3" tabindex="-1"></a>             <span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>)</span>
<span id="cb766-4"><a href="generalized-linear-model.html#cb766-4" tabindex="-1"></a></span>
<span id="cb766-5"><a href="generalized-linear-model.html#cb766-5" tabindex="-1"></a>fit <span class="sc">%&gt;%</span></span>
<span id="cb766-6"><a href="generalized-linear-model.html#cb766-6" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code></pre></div>
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace
  Approximation) [glmerMod]
 Family: binomial  ( logit )
Formula: repeatgr ~ 1 + ses + minority + (1 | school_nr)
   Data: df.language

     AIC      BIC   logLik deviance df.resid 
  1659.1   1682.1   -825.6   1651.1     2279 

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-0.9235 -0.4045 -0.3150 -0.2249  5.8372 

Random effects:
 Groups    Name        Variance Std.Dev.
 school_nr (Intercept) 0.2489   0.4989  
Number of obs: 2283, groups:  school_nr, 131

Fixed effects:
             Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) -0.506291   0.197568  -2.563  0.01039 *  
ses         -0.060086   0.007524  -7.986 1.39e-15 ***
minorityY    0.673612   0.238659   2.822  0.00477 ** 
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Correlation of Fixed Effects:
          (Intr) ses   
ses       -0.898       
minorityY -0.308  0.208</code></pre>
<p>To visualize the results, we can use the <code>ggeffects</code> package.</p>
<div class="sourceCode" id="cb768"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb768-1"><a href="generalized-linear-model.html#cb768-1" tabindex="-1"></a><span class="fu">ggpredict</span>(<span class="at">model =</span> fit,</span>
<span id="cb768-2"><a href="generalized-linear-model.html#cb768-2" tabindex="-1"></a>          <span class="at">terms =</span> <span class="fu">c</span>(<span class="st">&quot;ses [all]&quot;</span>, <span class="st">&quot;minority&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb768-3"><a href="generalized-linear-model.html#cb768-3" tabindex="-1"></a>  <span class="fu">plot</span>()</span></code></pre></div>
<p><img src="13-generalized_linear_model_files/figure-html/unnamed-chunk-40-1.png" width="672" /></p>
<p>And for significance testing, we can use the the <code>joint_tests()</code> function from the “emmeans” package</p>
<div class="sourceCode" id="cb769"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb769-1"><a href="generalized-linear-model.html#cb769-1" tabindex="-1"></a><span class="fu">glmer</span>(<span class="at">formula =</span> repeatgr <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> ses <span class="sc">+</span> minority <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> school_nr),</span>
<span id="cb769-2"><a href="generalized-linear-model.html#cb769-2" tabindex="-1"></a>      <span class="at">data =</span> df.language,</span>
<span id="cb769-3"><a href="generalized-linear-model.html#cb769-3" tabindex="-1"></a>      <span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb769-4"><a href="generalized-linear-model.html#cb769-4" tabindex="-1"></a>  <span class="fu">joint_tests</span>()</span></code></pre></div>
<pre><code> model term df1 df2 F.ratio  Chisq p.value
 ses          1 Inf  63.783 63.783  &lt;.0001
 minority     1 Inf   7.966  7.966  0.0048</code></pre>
<p>The results show that there was both a significant effect of ses and of minority.</p>
<p>Note: This post <a href="https://stats.stackexchange.com/questions/400101/using-emmeans-with-clmm-to-look-at-joint-effects">here</a> says a little more about the relationship of the F.ratio in the <code>joint_tests()</code> function, and what a likelihood ratio test yields. In short, it’s roughly the same thing.</p>
<p>If you’d like to compute the likelihood ratio test, a convenient way of doing so is by using the <code>mixed()</code> function from the “afex” package.</p>
<div class="sourceCode" id="cb771"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb771-1"><a href="generalized-linear-model.html#cb771-1" tabindex="-1"></a><span class="fu">mixed</span>(<span class="at">formula =</span> repeatgr <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> ses <span class="sc">+</span> minority <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> school_nr),</span>
<span id="cb771-2"><a href="generalized-linear-model.html#cb771-2" tabindex="-1"></a>      <span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>,</span>
<span id="cb771-3"><a href="generalized-linear-model.html#cb771-3" tabindex="-1"></a>      <span class="at">data =</span> df.language,</span>
<span id="cb771-4"><a href="generalized-linear-model.html#cb771-4" tabindex="-1"></a>      <span class="at">method =</span> <span class="st">&quot;LRT&quot;</span>)</span></code></pre></div>
<pre><code>Contrasts set to contr.sum for the following variables: minority, school_nr</code></pre>
<pre><code>Numerical variables NOT centered on 0: ses
If in interactions, interpretation of lower order (e.g., main) effects difficult.</code></pre>
<pre><code>Mixed Model Anova Table (Type 3 tests, LRT-method)

Model: repeatgr ~ 1 + ses + minority + (1 | school_nr)
Data: df.language
Df full model: 4
    Effect df     Chisq p.value
1      ses  1 75.39 ***   &lt;.001
2 minority  1   7.53 **    .006
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;+&#39; 0.1 &#39; &#39; 1</code></pre>
<p>And we can compare that the model comparison approach gives us the same result:</p>
<div class="sourceCode" id="cb775"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb775-1"><a href="generalized-linear-model.html#cb775-1" tabindex="-1"></a>fit_a <span class="ot">=</span>  <span class="fu">glmer</span>(repeatgr <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> ses <span class="sc">+</span> minority <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> school_nr),</span>
<span id="cb775-2"><a href="generalized-linear-model.html#cb775-2" tabindex="-1"></a>             <span class="at">data =</span> df.language,</span>
<span id="cb775-3"><a href="generalized-linear-model.html#cb775-3" tabindex="-1"></a>             <span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>)</span>
<span id="cb775-4"><a href="generalized-linear-model.html#cb775-4" tabindex="-1"></a></span>
<span id="cb775-5"><a href="generalized-linear-model.html#cb775-5" tabindex="-1"></a><span class="co"># dropping ses as a predictor</span></span>
<span id="cb775-6"><a href="generalized-linear-model.html#cb775-6" tabindex="-1"></a>fit_c <span class="ot">=</span>  <span class="fu">glmer</span>(repeatgr <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span>  minority <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> school_nr),</span>
<span id="cb775-7"><a href="generalized-linear-model.html#cb775-7" tabindex="-1"></a>             <span class="at">data =</span> df.language,</span>
<span id="cb775-8"><a href="generalized-linear-model.html#cb775-8" tabindex="-1"></a>             <span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>)</span>
<span id="cb775-9"><a href="generalized-linear-model.html#cb775-9" tabindex="-1"></a></span>
<span id="cb775-10"><a href="generalized-linear-model.html#cb775-10" tabindex="-1"></a><span class="fu">anova</span>(fit_a, fit_c, <span class="at">test =</span> <span class="st">&quot;LRT&quot;</span>)</span></code></pre></div>
<pre><code>Data: df.language
Models:
fit_c: repeatgr ~ 1 + minority + (1 | school_nr)
fit_a: repeatgr ~ 1 + ses + minority + (1 | school_nr)
      npar    AIC    BIC  logLik deviance  Chisq Df Pr(&gt;Chisq)    
fit_c    3 1732.5 1749.7 -863.27   1726.5                         
fit_a    4 1659.1 1682.1 -825.57   1651.1 75.395  1  &lt; 2.2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<div id="additional-information" class="section level2 hasAnchor" number="13.8">
<h2><span class="header-section-number">13.8</span> Additional information<a href="generalized-linear-model.html#additional-information" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="misc-5" class="section level3 hasAnchor" number="13.8.1">
<h3><span class="header-section-number">13.8.1</span> Misc<a href="generalized-linear-model.html#misc-5" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><a href="https://cims.nyu.edu/~brenden/courses/labincp/chapters/14/00-logisticregression.html">Nice logistic regression explainer</a></li>
<li><a href="https://www.youtube.com/watch?v=yIYKR4sgzI8">StatQuest: Logistic regression</a></li>
</ul>
</div>
<div id="datacamp-5" class="section level3 hasAnchor" number="13.8.2">
<h3><span class="header-section-number">13.8.2</span> Datacamp<a href="generalized-linear-model.html#datacamp-5" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><a href="https://www.datacamp.com/courses/multiple-and-logistic-regression">Multiple and logistic regression</a></li>
<li><a href="https://www.datacamp.com/courses/generalized-linear-models-in-r">Generalized linear models in R</a></li>
<li><a href="https://www.datacamp.com/courses/categorical-data-in-the-tidyverse">Categorical data in the tidyverse</a></li>
</ul>
</div>
</div>
<div id="session-info-11" class="section level2 hasAnchor" number="13.9">
<h2><span class="header-section-number">13.9</span> Session info<a href="generalized-linear-model.html#session-info-11" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Information about this R session including which version of R was used, and what packages were loaded.</p>
<div class="sourceCode" id="cb777"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb777-1"><a href="generalized-linear-model.html#cb777-1" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span></code></pre></div>
<pre><code>R version 4.3.0 (2023-04-21)
Platform: aarch64-apple-darwin20 (64-bit)
Running under: macOS 14.1.1

Matrix products: default
BLAS:   /Library/Frameworks/R.framework/Versions/4.3-arm64/Resources/lib/libRblas.0.dylib 
LAPACK: /Library/Frameworks/R.framework/Versions/4.3-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.11.0

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

time zone: America/Chicago
tzcode source: internal

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
 [1] lubridate_1.9.2  forcats_1.0.0    stringr_1.5.0    dplyr_1.1.4     
 [5] purrr_1.0.2      readr_2.1.4      tidyr_1.3.0      tibble_3.2.1    
 [9] ggplot2_3.4.4    tidyverse_2.0.0  emmeans_1.9.0    afex_1.3-0      
[13] ggeffects_1.3.4  boot_1.3-28.1    lme4_1.1-35.1    Matrix_1.6-4    
[17] broom_1.0.5      janitor_2.2.0    kableExtra_1.3.4 titanic_0.1.0   
[21] knitr_1.42      

loaded via a namespace (and not attached):
 [1] sjlabelled_1.2.0    tidyselect_1.2.0    viridisLite_0.4.2  
 [4] farver_2.1.1        fastmap_1.1.1       digest_0.6.31      
 [7] timechange_0.2.0    estimability_1.4.1  lifecycle_1.0.3    
[10] survival_3.5-5      magrittr_2.0.3      compiler_4.3.0     
[13] rlang_1.1.1         sass_0.4.6          tools_4.3.0        
[16] utf8_1.2.3          yaml_2.3.7          labeling_0.4.2     
[19] RColorBrewer_1.1-3  plyr_1.8.8          xml2_1.3.4         
[22] abind_1.4-5         withr_2.5.0         numDeriv_2016.8-1.1
[25] effects_4.2-2       nnet_7.3-18         datawizard_0.9.1   
[28] grid_4.3.0          fansi_1.0.4         xtable_1.8-4       
[31] colorspace_2.1-0    scales_1.3.0        MASS_7.3-58.4      
[34] insight_0.19.7      survey_4.2-1        cli_3.6.1          
[37] mvtnorm_1.2-3       crayon_1.5.2        rmarkdown_2.21     
[40] generics_0.1.3      rstudioapi_0.14     httr_1.4.6         
[43] reshape2_1.4.4      tzdb_0.4.0          DBI_1.1.3          
[46] minqa_1.2.5         cachem_1.0.8        splines_4.3.0      
[49] rvest_1.0.3         parallel_4.3.0      mitools_2.4        
[52] vctrs_0.6.5         webshot_0.5.4       jsonlite_1.8.4     
[55] carData_3.0-5       bookdown_0.34       car_3.1-2          
[58] hms_1.1.3           systemfonts_1.0.4   jquerylib_0.1.4    
[61] glue_1.6.2          nloptr_2.0.3        stringi_1.7.12     
[64] gtable_0.3.3        lmerTest_3.1-3      munsell_0.5.0      
[67] pillar_1.9.0        htmltools_0.5.5     R6_2.5.1           
[70] evaluate_0.21       lattice_0.21-8      haven_2.5.2        
[73] highr_0.10          backports_1.4.1     snakecase_0.11.0   
[76] bslib_0.4.2         Rcpp_1.0.10         svglite_2.1.1      
[79] coda_0.19-4         nlme_3.1-162        mgcv_1.8-42        
[82] xfun_0.39           pkgconfig_2.0.3    </code></pre>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="linear-mixed-effects-models-4.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="bayesian-data-analysis-1.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"],
"google": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/psych252/psych252book/edit/master/13-generalized_linear_model.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": false,
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"toc_depth": 3
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
